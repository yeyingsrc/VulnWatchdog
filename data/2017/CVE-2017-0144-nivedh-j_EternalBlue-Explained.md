## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)