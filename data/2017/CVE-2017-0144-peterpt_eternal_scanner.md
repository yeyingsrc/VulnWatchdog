## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)