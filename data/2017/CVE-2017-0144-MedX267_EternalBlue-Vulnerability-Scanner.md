## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)