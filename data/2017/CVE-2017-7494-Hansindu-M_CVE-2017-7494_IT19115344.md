## CVE-2017-7494 - Samba 远程代码执行

**漏洞编号:** CVE-2017-7494

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Samba

**危害等级:** 高危，允许恶意客户端以 root 权限执行任意代码

**影响版本:** 3.5.0 <= version < 4.6.4, 4.5.10, 4.4.14

**利用条件:** 需要拥有对 Samba 共享目录的写权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7494 存在于 Samba 3.5.0 到 4.6.4 版本（不包括 4.6.4），以及 4.5.10 和 4.4.14 版本。该漏洞允许经过身份验证的恶意客户端，如果拥有对 Samba 共享目录的写权限，则可以上传恶意共享库，并导致服务器加载并执行该库，从而以 root 权限执行任意代码。

**利用方式：**

1.  **权限获取：** 攻击者首先需要获得对 Samba 共享目录的写权限。这可以通过爆破弱口令、利用其他漏洞或者通过社会工程学等方式实现。
2.  **恶意库上传：** 一旦拥有写权限，攻击者会将包含恶意代码的共享库（例如 `.so` 文件）上传到共享目录。
3.  **触发执行：** 攻击者通过修改共享目录配置，或者通过其他手段（如指定恶意库路径）来触发 Samba 服务器加载并执行上传的恶意库。
4.  **代码执行：** 当 Samba 服务器加载恶意库时，其中的代码会以 root 权限执行，从而允许攻击者完全控制服务器。

**有效性：**

漏洞库信息和exploit-db的公开exp确认漏洞的有效性

**投毒风险：**

提供的POC代码仓库中只包含一个README文件和一个link，指向一个演示视频。视频链接本身存在风险，但分析已给出的信息后，无法确定视频内容。代码仓库本身不存在恶意代码，因此投毒风险为 0%。需要注意的是，实际利用中上传的恶意共享库才是真正的攻击载荷，需要进行严格的安全检查。

**项目地址:** [Hansindu-M/CVE-2017-7494_IT19115344](https://github.com/Hansindu-M/CVE-2017-7494_IT19115344)

**漏洞详情:** [CVE-2017-7494](https://nvd.nist.gov/vuln/detail/CVE-2017-7494)