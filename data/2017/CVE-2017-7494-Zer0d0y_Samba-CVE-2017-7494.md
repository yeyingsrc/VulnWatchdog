## CVE-2017-7494 Samba 远程代码执行

**漏洞编号:** CVE-2017-7494

**漏洞类型:** 远程代码执行

**影响应用:** Samba

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.5.0 <= Samba < 4.6.4, 4.5.10, 4.4.14

**利用条件:** 可写共享目录，匿名或有效用户身份连接到Samba服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7494，也被称为“SambaCry”，是一个存在于Samba中的远程代码执行漏洞。攻击者可以利用此漏洞，通过上传恶意共享库到可写共享目录，然后诱使服务器加载并执行它，从而实现远程代码执行。漏洞存在于 Samba 3.5.0 及以上版本，直到修复版本。提供的漏洞利用代码（README.md文件）指向一个漏洞分析文章，本身不包含实际的利用代码，但是提供了漏洞研究的参考信息，说明漏洞的存在和利用方法。根据漏洞库信息，漏洞利用需要一个可写的共享目录。由于POC只是一个`README.md`文件，并没有包含可执行的代码，因此不存在投毒风险。利用方式总结如下：

1.  **找到可写共享目录：** 攻击者首先需要找到Samba服务器上允许写入的共享目录。
2.  **上传恶意共享库：** 将包含恶意代码的共享库（例如，`.so`文件）上传到该共享目录。
3.  **触发加载执行：**  通过Samba客户端连接到共享目录，并构造特殊的路径，迫使Samba服务器加载并执行上传的共享库。可以通过`msfconsole`等工具生成恶意payload，并上传到可写共享目录后，通过构造包含payload路径的请求来触发漏洞。

总而言之，该漏洞的利用依赖于能够写入共享目录和构造特定的请求路径。根据CISA KEV目录，该漏洞已被积极利用。

**项目地址:** [Zer0d0y/Samba-CVE-2017-7494](https://github.com/Zer0d0y/Samba-CVE-2017-7494)

**漏洞详情:** [CVE-2017-7494](https://nvd.nist.gov/vuln/detail/CVE-2017-7494)