## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)