## CVE-2018-6574 - Go "go get" 远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，允许远程代码执行

**影响版本:** Go < 1.8.7, Go 1.9.x < 1.9.4, Go 1.10 pre-releases < Go 1.10rc2

**利用条件:** 受害者需要使用存在漏洞的Go版本执行 `go get` 命令获取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Go语言的`go get`命令中，由于在编译过程中没有正确过滤`-fplugin`和`-plugin`参数，导致攻击者可以通过构造包含恶意插件的Go代码仓库，诱使受害者使用存在漏洞的Go版本执行`go get`命令时，执行任意命令。

**有效性分析：**
提供的POC代码展示了如何使用`// #cgo CFLAGS: -fplugin=./attack.so`指令指定一个插件。当使用存在漏洞的Go版本编译该代码时，`attack.so`会被加载，其中的代码会被执行，从而实现远程代码执行。

**投毒风险分析：**
提供的POC代码本身不包含明显的投毒代码，它的目的是演示漏洞利用。`attack.so`的具体内容需要进一步分析才能确定是否存在恶意代码。根据目前的信息，POC代码的投毒风险评估为0%。`main.go`本身的功能是调用`attack.so`中的函数，并打印返回值。 如果`attack.so`存在后门,执行远程命令,则存在高危风险,但此部分分析应当基于其他辅助文件,本分析只针对`main.go`进行。

**利用方式分析：**
1.  攻击者创建一个包含恶意C代码插件（如`attack.so`）的Go代码仓库。
2.  攻击者在Go源代码中使用`// #cgo CFLAGS: -fplugin=./attack.so`指令指定该插件。
3.  攻击者诱使受害者使用存在漏洞的Go版本执行`go get <attacker's repository>`命令。
4.  当Go编译受害者的代码时，会加载并执行`attack.so`中的恶意代码，从而实现远程命令执行。

**项目地址:** [YoussefSalama1/CVE-2018-6574](https://github.com/YoussefSalama1/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)