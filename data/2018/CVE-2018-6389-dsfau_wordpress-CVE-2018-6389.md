## CVE-2018-6389-WordPress-DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 中危，可能导致网站无法访问

**影响版本:** <= 4.9.2

**利用条件:** 无需认证，只需网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6389是WordPress 4.9.2及更早版本中的一个拒绝服务漏洞。未经验证的攻击者可以利用`wp-includes/script-loader.php`中注册的大量.js文件列表，构造一系列请求来多次加载每个文件，从而导致资源消耗型的拒绝服务攻击。

**有效性:**
提供的Metasploit模块代码 `wordpress_load_scripts_dos.rb` 实现了利用此漏洞的攻击。

**投毒风险:**
代码主要功能是构造HTTP请求，没有发现明显的恶意代码。但是，由于该模块允许指定`PLUGIN_LIST`，如果攻击者修改该列表，可能会尝试包含一些具有已知漏洞的插件，然后进行利用。因此，存在潜在的投毒风险。风险评估为10%。该模块本身主要是利用已存在的机制来进行DoS攻击。

**利用方式:**
1.  攻击者向WordPress服务器的`/wp-admin/load-scripts.php`或`/wp-includes/load-scripts.php`发送精心构造的HTTP请求。
2.  请求中包含一个`load[]`参数，该参数是一个很长的由逗号分隔的JavaScript文件名列表，这些文件名取自WordPress核心和已安装插件的脚本。
3.  服务器尝试加载请求中列出的所有JavaScript文件。
4.  由于文件名列表很长，服务器会消耗大量资源（CPU、内存、带宽）来处理请求，从而导致拒绝服务。
5.  攻击者可以重复发送这些请求，以进一步加剧拒绝服务的影响。

**项目地址:** [dsfau/wordpress-CVE-2018-6389](https://github.com/dsfau/wordpress-CVE-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)