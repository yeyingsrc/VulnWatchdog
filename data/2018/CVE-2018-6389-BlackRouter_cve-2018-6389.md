## CVE-2018-6389 WordPress DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可导致服务器资源耗尽，网站瘫痪

**影响版本:** <= 4.9.2

**利用条件:** 无需身份验证，只需网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-6389 存在于 WordPress 4.9.2 及更早版本中。未经身份验证的攻击者可以通过构造包含大量注册的 .js 文件 (来自 wp-includes/script-loader.php) 的请求，导致服务器重复加载这些文件，从而消耗大量资源，造成拒绝服务攻击。

**有效性：**
根据提供的漏洞信息和利用代码，该漏洞的POC代码是有效的。它利用了 WordPress 加载脚本的机制，通过`load-scripts.php`接口，并传入大量的js文件，让服务器处理大量的请求，消耗资源。

**投毒风险：**
代码仓库的主要文件 `CVE-2018-6389.BlackRouter` 包含漏洞描述、利用方法和修复建议，只是一个简单的漏洞说明文件。`README.md`文件包含作者的社交媒体链接。 `doser.py` 是引用自github上的外部链接，不是仓库本身的代码。总体来看，此仓库中作者隐藏恶意代码的可能性较低，但由于 `doser.py`引用的是外部链接，使用者需要自行判断引用的脚本是否存在投毒代码。

**利用方式：**
1.  攻击者构造包含大量 .js 文件的 URL，目标指向 WordPress 的 `wp-admin/load-scripts.php` 文件。
2.  攻击者使用 `doser.py` 脚本或其他工具，向目标 WordPress 站点发送大量的恶意请求。
3.  WordPress 服务器收到请求后，会尝试加载所有指定的 .js 文件，这会消耗大量的 CPU 和内存资源。
4.  如果攻击者发送的请求足够多，服务器资源耗尽，导致网站瘫痪，无法响应正常用户的请求。

**修复建议：**
建议升级WordPress版本，或者按照给出的`.htaccess`配置进行防御。


**项目地址:** [BlackRouter/cve-2018-6389](https://github.com/BlackRouter/cve-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)