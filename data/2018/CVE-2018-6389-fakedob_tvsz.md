## CVE-2018-6389 WordPress Denial of Service

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致服务不可用

**影响版本:** <= 4.9.2

**利用条件:** 需要能够访问 WordPress 站点

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

根据漏洞信息，未经验证的攻击者可以通过利用 WordPress 的 wp-includes/script-loader.php 文件中注册的大量 .js 文件列表，构造一系列请求来多次加载每个文件，从而导致拒绝服务（资源消耗）。

**有效性评估：**

提供的 PoC 代码是一个 Node.js 脚本，它通过大量代理服务器向目标 WordPress 站点发送请求，请求加载多个 JavaScript 文件。该脚本基于 CVE-2018-6389 漏洞，利用 `load-scripts.php` 文件，通过 `load` 参数指定多个 .js 文件，从而消耗服务器资源。该PoC通过并发请求和使用代理，理论上可以有效触发拒绝服务攻击。

**投毒风险分析：**

该仓库存在一定的投毒风险，风险评估为30%。

*   **免责声明：**  代码仓库包含免责声明，表明作者不对脚本的滥用负责，这可能是为了规避法律责任，但也可能暗示代码存在潜在的风险。
*   **外部依赖：**  脚本依赖于外部代理列表，这些列表可能被篡改或包含恶意代理，从而导致攻击者的真实 IP 地址暴露，或者被重定向到恶意站点。
*   **代码复杂性：**  虽然脚本的主要功能是发送 HTTP 请求，但代码中包含代理管理、并发控制等逻辑，可能存在隐藏的恶意代码，例如数据收集或后门。 
*   **文件分析:**  
    * `websites.js` 包含目标网站列表，如果该文件被恶意修改，可能会将攻击引导到非预期目标。
    * `userAgents.js` 包含用户代理列表，用于伪装请求，降低被识别为攻击的概率。
    * `fileList.js` 包含要加载的 JavaScript 文件列表，该列表的修改可能会影响攻击效果。
*   **弱口令/后门风险:** 虽然该POC主要目的是DDoS，作者可能在代码中植入后门或弱口令，配合DDoS掩盖真实攻击意图。

**利用方式：**

1.  **获取 JavaScript 文件列表：**  从 WordPress 的 `wp-includes/script-loader.php` 文件中获取所有注册的 JavaScript 文件列表。
2.  **构造恶意 URL：**  构造包含大量 JavaScript 文件的 URL，例如：`https://your-wordpress-site.com/wp-admin/load-scripts.php?c=1&load=file1,file2,file3,...`
3.  **发送大量请求：**  使用 PoC 脚本，通过多个代理服务器向目标 WordPress 站点发送大量包含恶意 URL 的请求，从而消耗服务器资源，导致拒绝服务。

**项目地址:** [fakedob/tvsz](https://github.com/fakedob/tvsz)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)