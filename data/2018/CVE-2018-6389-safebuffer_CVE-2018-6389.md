## CVE-2018-6389 WordPress Denial of Service

**漏洞编号:** CVE-2018-6389

**漏洞类型:** Denial of Service (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致网站服务中断

**影响版本:** <= 4.9.2

**利用条件:** 无需身份验证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者通过构造包含大量注册的.js文件的请求，向`/wp-admin/load-scripts.php`发起大量请求，从而导致服务器资源耗尽，造成拒绝服务攻击。漏洞利用方式如下：

1.  **利用 `load-scripts.php` 和 `load-styles.php` 文件：** WordPress 使用 `load-scripts.php` 和 `load-styles.php` 文件来加载多个 JavaScript 和 CSS 文件。攻击者可以利用这一点，通过 `load[]` 参数指定大量的文件名。
2.  **构造恶意请求：** 攻击者构造包含大量.js文件名的URL，并发送到目标WordPress站点的`/wp-admin/load-scripts.php`。PoC代码中`p1`变量包含了大量js文件名。
3.  **资源消耗：** 服务器会尝试加载所有请求的文件，导致 CPU 和内存资源的大量消耗。
4.  **拒绝服务：**  大量的恶意请求会使服务器不堪重负，最终导致服务中断。

**有效性评估：**根据漏洞描述和PoC代码，该漏洞是有效的，可以被利用来发起DoS攻击。

**投毒风险评估：** 代码中没有明显的投毒行为。用户代理头部的随机生成是为了避免被过滤，多线程是为了放大攻击效果。js文件名来自WordPress已注册的文件，因此被利用导致拒绝服务，本身不是后门程序。投毒概率评估为0%。

**PoC利用方式：**

1.  运行PoC脚本 `CVE-2018-6389.py`。
2.  输入目标WordPress站点的URL，例如 `example.com`。
3.  输入线程数量。线程数量越大，DoS攻击的效果越明显，但同时也可能导致攻击者自身的网络连接出现问题。
4.  脚本会向目标站点发送大量包含多个JavaScript文件的请求，最终导致目标服务器资源耗尽。

**项目地址:** [safebuffer/CVE-2018-6389](https://github.com/safebuffer/CVE-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)