## CVE-2018-6389 Wordpress DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致网站无法访问

**影响版本:** <= 4.9.2

**利用条件:** 无需身份验证，只需要可以访问 WordPress 站点的网络

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6389 漏洞存在于 WordPress 4.9.2 及更早版本中。未经身份验证的攻击者可以通过构造大量请求来消耗服务器资源，从而导致拒绝服务。攻击者利用 WordPress 注册的 JavaScript 文件列表（位于 `wp-includes/script-loader.php`）构建一系列请求，多次加载每个文件，导致服务器资源耗尽。

提供的漏洞利用代码实际上是一个修复脚本 `wp-cve2018-6389-fix.sh`，而不是攻击脚本。它通过以下步骤来缓解漏洞：

1.  **查找 WordPress 安装：** 脚本会尝试找到服务器上的所有 WordPress 安装目录。
2.  **备份关键文件：** 在每个 WordPress 目录中，脚本会备份 `wp-login.php`，`wp-admin/load-scripts.php`，`wp-admin/load-styles.php` 和 `wp-admin/includes/noop.php`。
3.  **修改 `wp-login.php`：** 在 `wp-login.php` 的第一行插入 `define('CONCATENATE_SCRIPTS', false);` 以禁用脚本连接。
4.  **修改 `load-scripts.php` 和 `load-styles.php`：** 将 `load-scripts.php` 和 `load-styles.php` 中对 `script-loader.php` 的引用替换为对 `wp-admin/admin.php` 的引用。
5.  **创建 `noop.php`：**  创建一个 `wp-admin/includes/noop.php` 文件，其中包含一个空的 `get_file` 函数。
6.  **更改文件所有者：** 尝试将备份的文件和新创建的文件所有者更改为原始文件所有者。

**有效性：** 虽然提供的代码不是攻击利用代码，但它是一个有效的补丁脚本，能够有效缓解 CVE-2018-6389 漏洞带来的拒绝服务风险。

**投毒风险：**  该脚本的目的是修复漏洞，经过分析，没有发现作者隐藏的恶意代码，因此投毒风险为0%。该脚本执行的操作都是为了防止未经身份验证的攻击者利用该漏洞。

**利用方式：**  该漏洞的利用方式是未经身份验证的攻击者发送大量精心构造的 HTTP 请求，请求加载 WordPress 注册的 JavaScript 文件。由于 WordPress 默认会将多个 JavaScript 文件连接成一个文件来减少 HTTP 请求，攻击者可以通过控制请求的参数来强制 WordPress 加载大量 JavaScript 文件，从而消耗大量的服务器资源，最终导致拒绝服务。

总结： 提供的漏洞利用代码实际上是一个修复脚本，用于缓解 CVE-2018-6389 漏洞。该漏洞允许未经身份验证的攻击者通过大量请求消耗服务器资源，导致拒绝服务。该修复脚本通过禁用脚本连接、修改关键文件和创建空函数来缓解漏洞。

**项目地址:** [Jetserver/CVE-2018-6389-FIX](https://github.com/Jetserver/CVE-2018-6389-FIX)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)