## CVE-2018-6389 WordPress DoS 漏洞修复脚本分析

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 安全补丁

**影响应用:** WordPress

**危害等级:** 低风险，该脚本旨在修复漏洞，而非利用漏洞

**影响版本:** <= 4.9.2

**利用条件:** 服务器需要安装 bash 和 sed 命令

**POC 可用性:** 否，提供的代码是修复脚本

**投毒风险:** 0%

## 详情

提供的脚本 `CVE-2018-6389-fix.sh` 并非漏洞利用代码，而是一个用于修复 CVE-2018-6389 漏洞的安全补丁脚本。该脚本主要通过以下方式修复漏洞：

1.  **禁用脚本连接：** 通过在 `wp-login.php` 中定义 `CONCATENATE_SCRIPTS` 为 `false`，禁用脚本连接功能。
2.  **修改加载脚本和样式的方式：** 修改 `load-scripts.php` 和 `load-styles.php` 文件，使其加载 `wp-admin/admin.php` 而不是 `wp-includes/script-loader.php`，从而绕过漏洞。
3.  **创建 noop.php 文件：** 创建一个 `noop.php` 文件，用于替代原始的脚本加载逻辑，以避免资源消耗。

**有效性：**该脚本的有效性取决于 WordPress 网站是否受到 CVE-2018-6389 漏洞的影响。对于受影响的网站，该脚本可以有效地缓解 DoS 攻击风险。

**投毒风险：**仔细审查了脚本，没有发现任何明显的投毒代码。脚本的功能明确，即修复已知的 WordPress 漏洞。所有操作都是围绕着禁用或修改脚本加载机制以防止未经身份验证的资源消耗。

**利用方式：** CVE-2018-6389 漏洞的利用方式是未经身份验证的攻击者可以利用 WordPress 的脚本加载机制，通过大量请求加载所有的 `.js` 文件，从而消耗服务器资源，导致拒绝服务攻击。攻击者构造包含大量 JavaScript 文件请求的 URL，发送到 WordPress 站点，由于 WordPress 默认会将多个 JS 文件连接成一个文件进行传输，攻击者利用这一点，通过构造大量请求，让服务器连接大量的 JS 文件，从而消耗大量的服务器资源，造成拒绝服务。

**项目地址:** [amit-pathak009/CVE-2018-6389-FIX](https://github.com/amit-pathak009/CVE-2018-6389-FIX)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)