## CVE-2018-14324 - Oracle GlassFish Open Source Edition JMX RMI 远程监控和控制问题

**漏洞编号:** CVE-2018-14324

**漏洞类型:** 配置缺陷/弱口令

**影响应用:** Oracle GlassFish Open Source Edition

**危害等级:** 高危，可能导致敏感信息泄露、数据库操作或远程控制

**影响版本:** 5.0

**利用条件:** 目标系统开启了GlassFish的demo功能，TCP 7676端口开放，且未修改默认管理员密码admin

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14324 存在于 Oracle GlassFish Open Source Edition 5.0 的 demo 功能中。该功能默认开启了 TCP 端口 7676，并使用 admin 作为管理员账户的默认密码。攻击者可以通过 JMX RMI 会话利用此漏洞，远程获取敏感信息，执行数据库操作，甚至控制 GlassFish 实例。

**漏洞利用方式：**

1.  **连接 JMX RMI：** 使用 JMX 客户端连接到目标 GlassFish 实例的 JMX RMI 服务（通常在 7676 端口）。
2.  **身份验证：** 使用默认用户名 "admin" 和密码 "admin" 进行身份验证。
3.  **MBean 操作：** 成功连接后，攻击者可以访问和操作 GlassFish 的 MBean，执行各种管理功能，包括：
    *   获取系统属性 (vmSystemProperties)：通过 `com.sun.management:type=DiagnosticCommand` MBean 的 `vmSystemProperties` 操作，可以获取 JVM 的系统属性，可能包含敏感信息。
    *   列出和查看 MBean 属性：可以遍历所有 MBean，并获取其属性值，从而进一步了解系统配置和状态。
    *   执行任意 MBean 操作：根据 MBean 的功能，攻击者可以执行各种操作，例如部署或卸载应用程序、修改配置等。

**POC 代码分析：**

提供的 Java 代码 `JMXFullDumper.java` 和 `DiagnosticCommand.java` 旨在演示如何利用此漏洞。代码的功能包括：

*   连接到指定的 JMX RMI URL。
*   使用默认凭据 "admin/admin" 进行身份验证。
*   调用 `com.sun.management:type=DiagnosticCommand` MBean 的 `vmSystemProperties` 操作来获取 JVM 系统属性。
*   遍历所有 MBean 并打印其详细信息（在 `JMXFullDumper.java` 中）。

**有效性评估：**

如果目标 GlassFish 实例满足以下条件，则 POC 代码有效：

*   GlassFish 5.0 正在运行。
*   demo 功能已启用，并且 7676 端口已打开。
*   管理员密码仍为默认值 "admin"。

**投毒风险评估：**

提供的 POC 代码中没有明显的投毒代码。代码的功能集中于连接 JMX RMI 服务、进行身份验证和获取/操作 MBean。所有操作都在标准 JMX API 的范围内。因此，**投毒风险为 0%**。

**缓解措施：**

*   **更改默认管理员密码：** 立即将 GlassFish 管理员账户的密码更改为强密码。
*   **禁用 demo 功能：** 如果不需要 demo 功能，请将其禁用。
*   **限制 JMX RMI 访问：** 使用防火墙或其他访问控制机制，限制对 7676 端口的访问。

**项目地址:** [matejsmycka/CVE-2018-14324-Exploit](https://github.com/matejsmycka/CVE-2018-14324-Exploit)

**漏洞详情:** [CVE-2018-14324](https://nvd.nist.gov/vuln/detail/CVE-2018-14324)