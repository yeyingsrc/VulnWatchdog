## CVE-2018-6389 - WordPress Denial of Service

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，导致服务器资源耗尽，无法正常提供服务

**影响版本:** <= 4.9.2

**利用条件:** 目标网站必须运行WordPress，且版本低于或等于4.9.2，能够通过网络访问目标网站。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress 4.9.2及更早版本中。未经身份验证的攻击者可以利用注册的.js文件的大量列表（来自wp-includes/script-loader.php）构造一系列请求，多次加载每个文件，从而导致拒绝服务（资源消耗）。

**有效性评估：**

提供的`shiva.py`脚本利用了 CVE-2018-6389 漏洞。它通过多线程方式向WordPress站点的 `load-scripts.php` 发送大量请求，请求中包含了所有已注册的 JavaScript 文件。这种攻击方式旨在消耗服务器资源，导致服务器过载，从而实现拒绝服务攻击。

**投毒风险评估：**

分析`shiva.py`脚本，发现其主要功能是发送大量请求以消耗目标服务器资源。脚本使用了 `proxify` 库来轮换代理，这有助于隐藏攻击者的真实IP地址。  脚本本身逻辑简单，主要就是发送构造好的url，并没有发现明显用于植入后门或者执行恶意代码的功能。`proxify` 虽然能隐藏IP，但本身也有可能包含恶意代码，因此存在一定的风险。 综合评估，投毒风险较低，但不能完全排除。 风险大约为10%。

**利用方式分析：**

1.  **目标确定：** 确定运行WordPress的网站，且版本在受影响范围内（<= 4.9.2）。
2.  **准备工作：** 安装 `requests` 和 `proxify` 依赖。
3.  **攻击执行：** 运行 `shiva.py` 脚本，指定目标网站的URL和线程数。线程数应根据网络速度进行调整，以达到最佳攻击效果。
4.  **原理：** 脚本构造包含大量JavaScript文件的URL，通过`load-scripts.php`批量加载，消耗服务器CPU和内存资源，达到DoS的目的。

总而言之，此POC代码有效，主要风险在于目标服务器资源耗尽，存在一定投毒的可能性，利用方式较为简单，易于实施。

**项目地址:** [s0md3v/Shiva](https://github.com/s0md3v/Shiva)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)