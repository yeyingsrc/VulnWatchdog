## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本。具体版本范围请参考漏洞库信息。

**利用条件:** 需要受害者打开包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，利用方式是诱骗用户点击邮件中的`file://`链接。根据提供的漏洞利用代码，攻击者需要设置攻击机IP地址和邮件服务器地址，然后发送包含特定HTML内容的邮件。HTML内容包含一个`file://ATTACKER_MACHINE/test!exploit`链接，当用户点击此链接时，Outlook会尝试访问攻击者机器上的指定路径，如果攻击者在相应路径放置了恶意文件，就可以实现远程代码执行。从代码本身看，没有发现明显的投毒代码。代码的目的是构建包含恶意链接的HTML邮件并发送出去。该漏洞的有效性依赖于目标系统是否受到补丁保护以及攻击者是否能够成功搭建恶意文件服务器。由于CISA已经将此漏洞添加到已知被利用漏洞列表中，并且存在可用的POC，因此利用的有效性较高。攻击者需要控制一个服务器，并在服务器上放置恶意的payload，并通过构造恶意的file://链接诱导用户点击。

**分析：**

1.  **有效性：**根据提供的POC代码和漏洞库信息，该漏洞是有效的。CISA将其添加到已知被利用漏洞列表中，说明该漏洞已被实际利用。提供的POC代码可以用于生成包含恶意链接的电子邮件。
2.  **投毒风险：**经过对POC代码的分析，没有发现明显的投毒代码。代码的功能明确，就是生成并发送包含恶意链接的电子邮件，并没有额外恶意行为。
3.  **利用方式：**
    *   攻击者构建一个包含恶意`file://`链接的HTML邮件。
    *   攻击者将邮件发送给目标用户。
    *   目标用户打开邮件并点击恶意链接。
    *   Outlook尝试访问攻击者控制的服务器上的恶意文件。
    *   如果攻击者在服务器上放置了恶意payload，且Outlook执行该payload，则实现远程代码执行。

**漏洞缓解措施：**

*   及时安装Microsoft官方发布的补丁。
*   谨慎点击邮件中的链接，特别是来自未知发件人的邮件。
*   配置Outlook的安全设置，限制对`file://`协议的使用。


**项目地址:** [hau2212/Moniker-Link-CVE-2024-21413-](https://github.com/hau2212/Moniker-Link-CVE-2024-21413-)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)