## CVE-2024-5932-GiveWP-RCE

**漏洞编号:** CVE-2024-5932

**漏洞类型:** PHP对象注入导致远程代码执行

**影响应用:** GiveWP – Donation Plugin and Fundraising Platform

**危害等级:** 严重，可导致服务器完全控制

**影响版本:** <= 3.14.1

**利用条件:** 目标WordPress站点安装了GiveWP插件，且版本小于等于3.14.1

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-5932是GiveWP插件中存在的反序列化漏洞，未经身份验证的攻击者可以注入恶意的PHP对象，通过精心构造的POP链，最终执行任意代码。攻击者利用`give_title`参数传递序列化的恶意对象。提供的POC代码演示了如何利用此漏洞，它首先提取donation form id和nonce，然后构建包含反向shell命令的payload，并发送给目标服务器，从而获得一个反向shell。投毒风险较低，主要风险点在于`attacker_ip`和`listening_port`需要使用者自行替换，存在误用风险。但该IP和端口是为了实现反向连接的必要参数，本身不属于恶意代码。

漏洞利用方式如下：
1.  **信息收集:** 通过`give_form_search`动作获取donation form ID。
2.  **nonce获取:** 通过`give_donation_form_nonce`动作获取目标form的nonce。
3.  **payload构建:** 利用POP链构建恶意payload，该payload使用`shell_exec`函数执行反向shell命令，连接攻击者的IP地址和端口。
4.  **漏洞触发:** 将payload作为`give_title`参数的值，通过`give_process_donation`动作发送POST请求。

由于此POC直接使用反向shell，因此使用者需要确保监听端口已打开，并且攻击机可以访问目标主机。

**项目地址:** [autom4il/CVE-2024-5932](https://github.com/autom4il/CVE-2024-5932)

**漏洞详情:** [CVE-2024-5932](https://nvd.nist.gov/vuln/detail/CVE-2024-5932)