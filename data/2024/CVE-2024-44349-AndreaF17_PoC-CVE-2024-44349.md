## CVE-2024-44349-AnteeoWMS-SQL注入

**漏洞编号:** CVE-2024-44349

**漏洞类型:** SQL注入

**影响应用:** AnteeoWMS

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 4.7.34

**利用条件:** 需要网络访问AnteeoWMS登录页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-44349 是 AnteeoWMS 系统中存在的一个 SQL 注入漏洞。该漏洞位于登录门户，未经身份验证的攻击者可以通过 `username` 参数执行任意 SQL 命令，从而泄露底层数据库中的数据。

**有效性:**

提供的 PoC 代码看起来有效。它包含以下组件：

*   一个 `README.md` 文件，描述了漏洞和使用方法。
*   一个 `main.py` 文件，它是一个 Python 脚本，用于利用该漏洞。该脚本接受目标 URL 和模式（dump 或 query）作为参数。
*   一个 `requirements.txt` 文件，列出了脚本所需的 Python 依赖项。
*   一个 `util/utils.py` 文件，包含用于检测漏洞和从数据库中提取数据的函数。

该 PoC 似乎能够验证漏洞的存在，并且可以执行两种模式：`dump` 模式用于转储数据库内容，`query` 模式用于执行任意 SQL 查询。

**投毒风险:**

虽然 PoC 看起来功能正常，但存在轻微的投毒风险，主要体现在以下几个方面：

*   **不透明的 `__VIEWSTATE` 参数:**  `utils.py` 中的 `PAYLOAD` 变量包含一个硬编码的 `__VIEWSTATE` 参数。 虽然这可能是从一个特定的 AnteeoWMS 实例捕获的，但依赖于一个静态的、base64编码的 `__VIEWSTATE` 可能会导致脚本在其他实例上运行不稳定。 如果此 `__VIEWSTATE` 与目标实例不匹配，可能会导致请求失败，或者更糟糕的是，可能触发应用程序中的意外行为（尽管不太可能利用）。
*   **未经验证的依赖项:**  `requirements.txt` 文件中包含依赖项。 虽然 `requests` 是一个常见的库，但在使用任何 PoC 代码之前，应该始终检查这些依赖项，以确保它们来自可信的来源并且没有已知的漏洞。
*   **`utils.py`中的SQL语句** 虽然该文件包含从数据库中提取数据的功能,存在构造恶意sql语句的可能性, 导致在目标系统上进行破坏性操作。尽管PoC的作者声明其代码仅用于研究目的，但在实际使用中，攻击者可能会修改代码以执行恶意操作, 并且程序没有提供任何安全防御措施。

总的来说，虽然该代码主要用于利用 SQL 注入漏洞，但存在引入某些破坏性代码的可能性。 我们对投毒风险评级为 10%。

**利用方式:**

该漏洞的利用方式如下：

1.  克隆 PoC 代码库。
2.  安装所需的 Python 依赖项。
3.  使用 `main.py` 脚本指定目标 URL 和模式（dump 或 query）。
4.  如果使用 `dump` 模式，脚本将枚举数据库和表，并转储内容。
5.  如果使用 `query` 模式，脚本将打开一个 shell，允许攻击者执行任意 SQL 查询。

总而言之，该漏洞是一个严重的 SQL 注入漏洞，未经身份验证的攻击者可以利用它来访问和修改数据库中的数据。 提供的 PoC 代码看起来有效，但应谨慎使用，并且在使用前应仔细检查依赖项和代码。

**项目地址:** [AndreaF17/PoC-CVE-2024-44349](https://github.com/AndreaF17/PoC-CVE-2024-44349)

**漏洞详情:** [CVE-2024-44349](https://nvd.nist.gov/vuln/detail/CVE-2024-44349)