## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android Framework

**危害等级:** 高危，允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14 (受影响版本安全补丁级别早于2024-10-01)

**利用条件:** 需要ADB访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过伪造安装会话的installerPackageName来提升权限。原始补丁试图验证 `params.installerPackageName`，但如果该参数无效，则会使用 `installerPackageName` (调用 `createSessionInternal` 方法时传入的参数)。

**有效性：**

提供的PoC代码是有效的，它描述了如何绕过最初的补丁。

**投毒风险：**

该仓库包含PoC代码和一个writeup，用于解释漏洞和绕过方法。投毒风险较低，约为10%。可能的投毒方式是，作者可能在PoC中加入恶意代码，但PoC本身是为了演示漏洞利用，因此直接植入后门的可能性较低。风险主要来自用户下载编译运行了不可信的 PoC 代码.

**利用方式：**

1.  攻击者需要通过ADB访问Android设备。
2.  攻击者创建一个恶意的安装会话，在 `SessionParams` 中设置一个无效的 `installerPackageName`。
3.  系统将使用 `installerPackageName`，攻击者可以利用这一点来运行任意代码，其UID为任意应用的UID。

**项目地址:** [canyie/CVE-2024-0044](https://github.com/canyie/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)