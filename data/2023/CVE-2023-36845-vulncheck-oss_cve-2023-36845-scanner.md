## CVE-2023-36845-Junos OS-J-Web-PHP外部变量修改-远程代码执行

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP外部变量修改

**影响应用:** Junos OS J-Web

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 所有低于 20.4R3-S9 的版本；21.1 版本 21.1R1 及更高版本；21.2 版本低于 21.2R3-S7；21.3 版本低于 21.3R3-S5；21.4 版本低于 21.4R3-S5；22.1 版本低于 22.1R3-S4；22.2 版本低于 22.2R3-S2；22.3 版本低于 22.3R2-S2, 22.3R3-S1；22.4 版本低于 22.4R2-S1, 22.4R3；23.2 版本低于 23.2R1-S1, 23.2R2。

**利用条件:** 启用了 J-Web (HTTP 或 HTTPS) 的 Junos OS 设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是 Juniper Networks Junos OS 中 J-Web 界面的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过发送特制的请求，设置 `PHPRC` 变量来修改 PHP 执行环境，从而注入和执行任意代码。由于漏洞允许远程代码执行，因此风险评级为严重。

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到易受攻击的 Junos 设备上的 J-Web 接口。
2.  此请求包含一个设置 `PHPRC` PHP 配置变量的参数。通过修改该变量，攻击者可以控制 PHP 的配置文件的路径，从而包含恶意的 PHP 代码。
3.  设备执行攻击者提供的 PHP 代码，从而允许攻击者在设备上执行任意命令。

**关于投毒风险：**

分析提供的 `Dockerfile` 和 `LICENSE` 文件，没有发现明显的恶意代码或编译过程中的可疑操作。 `Dockerfile` 只是一个简单的 Go 编译环境，`LICENSE` 是 Apache 2.0 许可。漏洞利用代码部分缺失，无法判断是否存在后门。

但是，考虑到漏洞本身允许远程代码执行，即使提供的 `Dockerfile` 和 `LICENSE` 没有直接的投毒代码，攻击者仍然可以利用该漏洞在目标系统上植入恶意软件。因此，存在一定的投毒风险，假设为10%。

**项目地址:** [vulncheck-oss/cve-2023-36845-scanner](https://github.com/vulncheck-oss/cve-2023-36845-scanner)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)