## CVE-2023-36845

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改

**影响应用:** Juniper Junos OS J-Web

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启 J-Web (http 或 https)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36845 是一个 Juniper Junos OS EX 系列和 SRX 系列设备 J-Web 组件中的 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造恶意请求设置 PHPRC 变量来修改 PHP 执行环境，从而注入并执行任意代码。

**有效性评估：**
根据漏洞库信息，该漏洞是真实存在的，CVSS 评分为 9.8 (Critical)，表明危害程度很高。CISA 已将其添加到已知被利用漏洞目录中，进一步表明该漏洞已被积极利用。

**投毒风险评估：**
提供的漏洞利用代码只是一个包含 README.md 文件的目录。README.md 文件仅包含漏洞名称和简短描述，没有实际的利用代码。因此，该代码本身不存在直接的投毒风险。

但是，需要注意的是，攻击者可能会在其他地方发布包含恶意代码的利用程序，伪装成 CVE-2023-36845 的利用程序。因此，在下载和使用任何利用代码时，都应该进行仔细审查，确保代码的安全性。
由于缺少实际的代码，无法进行更详细的分析，投毒风险评估相对保守。

**利用方式：**
1.  **前提条件：** 目标 Juniper 设备运行受影响的 Junos OS 版本，并且启用了 J-Web 服务（通过 HTTP 或 HTTPS）。
2.  **漏洞触发：** 攻击者构造一个包含 `PHPRC` 变量的 HTTP 请求发送到目标设备的 J-Web 接口。
3.  **代码注入：** 通过 `PHPRC` 变量，攻击者可以指定一个包含恶意 PHP 代码的文件路径，从而修改 PHP 的配置。
4.  **远程代码执行：** 当 J-Web 执行 PHP 代码时，恶意代码将被执行，从而允许攻击者在目标设备上执行任意命令。
5.  **进一步利用：** 攻击者可以通过执行的命令获取系统信息、修改配置、安装后门等，从而完全控制目标设备。

**项目地址:** [kopfjager007/CVE-2023-36845](https://github.com/kopfjager007/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)