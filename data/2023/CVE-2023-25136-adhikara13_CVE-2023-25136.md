## CVE-2023-25136-OpenSSH-Double-Free

**漏洞编号:** CVE-2023-25136

**漏洞类型:** Double-Free

**影响应用:** OpenSSH

**危害等级:** 高危，理论上可能导致远程代码执行

**影响版本:** 9.1

**利用条件:** 目标运行OpenSSH 9.1，默认配置且未进行相关缓解措施

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25136是OpenSSH 9.1版本中`options.kex_algorithms`处理时引入的double-free漏洞。未授权的远程攻击者可以通过发送特制的SSH数据包触发该漏洞，导致`sshd`进程中出现double free。理论上，攻击者可以利用此漏洞跳转到`sshd`地址空间中的任意位置，从而实现远程代码执行。

**利用方式分析：**

1.  **漏洞触发：**  攻击者无需进行身份验证即可触发漏洞，属于pre-auth漏洞。漏洞位于密钥交换算法（Key Exchange Algorithms）的处理过程中。攻击者发送恶意构造的KEX算法协商请求，触发 `options.kex_algorithms` 的双重释放。
2.  **代码分析：**  提供的POC代码是一个漏洞检查脚本，而非直接利用漏洞的代码。该脚本通过修改`paramiko.Transport.local_version`来模拟一个客户端，并尝试连接到目标SSH服务器。如果目标服务器存在漏洞且版本为9.1，则可能显示为“Vulnerable”。实际的利用需要更复杂的技术，例如堆喷射和ROP链等，以实现任意代码执行。
3.  **有效性评估：**  提供的Python脚本仅用于检测目标是否存在漏洞，判断目标版本，并不能直接进行漏洞利用。要完全利用该漏洞，需要更复杂的技术和针对特定目标环境的定制。因此，该POC代码的直接利用价值有限，但可以作为漏洞存在性验证的手段。
4. **投毒风险:**

    * `CVE-2023-25136.py`: 该脚本的主要功能是检查目标主机是否存在CVE-2023-25136漏洞。脚本通过尝试建立SSH连接，并根据连接结果（成功或异常）判断目标主机是否易受攻击。脚本本身没有发现明显的恶意代码，例如文件操作、命令执行等。**风险较低**。

    * `LICENSE`: MIT许可证文件，用于声明软件的使用权限，属于正常文件，不存在恶意代码。**无风险**。

    * `README.md`: 这是一个Markdown文件，通常用于提供关于代码仓库的信息，如描述、安装和使用说明。**无风险**。
总的来说，这个仓库中的代码，有很小的几率包含作者隐藏的投毒代码，主要集中在python脚本中，通过检测是否存在后门连接,从而控制目标机器。但是从代码分析来看，该POC脚本主要是用于漏洞检测，高风险函数使用较少。所以投毒风险较低。


**项目地址:** [adhikara13/CVE-2023-25136](https://github.com/adhikara13/CVE-2023-25136)

**漏洞详情:** [CVE-2023-25136](https://nvd.nist.gov/vuln/detail/CVE-2023-25136)