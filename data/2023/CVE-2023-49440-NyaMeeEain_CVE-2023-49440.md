## CVE-2023-49440-AhnLab EPP Management-SQL注入

**漏洞编号:** CVE-2023-49440

**漏洞类型:** SQL注入

**影响应用:** AhnLab EPP Management

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 1.0.15

**利用条件:** 需要网络访问和目标服务器的8803端口开放，以及有效的Token。

**POC 可用性:** 是，但PoC代码未公开，仅提供了请求示例。

**投毒风险:** 10%

## 详情

CVE-2023-49440是AhnLab EPP Management 1.0.15及更早版本中存在的SQL注入漏洞，位于web管理界面的“preview”参数。攻击者可以通过构造特殊的SQL语句，在未修复版本中，利用Boolean-based SQL注入，从而获得数据库的完全控制权限以及可能的远程代码执行能力。提供的POC文档展示了未修复版本和修复版本之间的请求响应差异。未修复版本通过构造SQL注入语句，可以改变返回的report内容。修复后的版本则返回错误信息，提示“extract_key”已过期，表明系统已对输入进行了过滤或验证。

**有效性评估：**
根据提供的漏洞利用代码，该漏洞的POC是有效的，尽管实际的利用脚本并未提供，但提供的请求和响应示例清晰地展示了如何利用该漏洞进行Boolean-based SQL注入。未修复版本的请求能够成功注入SQL代码并影响响应结果，而修复后的版本则阻止了注入，表明漏洞已被修复。

**投毒风险评估：**
该仓库中存在投毒代码的风险较低。作者明确声明由于安全原因，不会发布完整的Python PoC，并且受影响的版本已在两年前修复。虽然存在作者隐瞒或添加恶意代码的可能性，但从代码仓库的现有信息来看，风险较低。风险评估为10%，主要考虑到以下几点：
*   只提供了请求示例，没有实际可执行的代码。
*   作者声明了不发布PoC的理由。

**漏洞利用方式：**
1.  攻击者需要向`/api/console/ems/query/report/preview`端点发送POST请求。
2.  在JSON请求体中，修改`request.params`数组中的SQL语句。原始请求中包含一个SQL注入Payload，使用`CASE WHEN`语句来测试Boolean条件。通过改变条件(例如, `1010=1010`和`1337=1337`)可以判断是否存在SQL注入。
3.  需要提供有效的`Authorization`头部，即Bearer Token，这表示需要一定的权限才能访问该端点。
4.  通过观察响应结果，可以判断SQL注入是否成功。在未修复的版本中，注入成功会影响`report`字段的内容，例如，`concat`字段会包含注入的结果。
5.  利用该漏洞，攻击者可以读取数据库中的敏感信息，甚至可能通过进一步的利用实现远程代码执行。

**项目地址:** [NyaMeeEain/CVE-2023-49440](https://github.com/NyaMeeEain/CVE-2023-49440)

**漏洞详情:** [CVE-2023-49440](https://nvd.nist.gov/vuln/detail/CVE-2023-49440)