## CVE-2023-44487 HTTP/2 Rapid Reset DDoS

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2协议实现

**危害等级:** 高危，可能导致服务器资源耗尽，服务不可用

**影响版本:** 所有受影响的HTTP/2实现

**利用条件:** 需要能够建立HTTP/2连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-44487 漏洞是HTTP/2协议中的一个设计缺陷，允许攻击者通过快速建立和重置大量的HTTP/2 stream来消耗服务器资源，从而导致拒绝服务攻击。

**漏洞利用方式：**
攻击者与目标服务器建立一个或多个HTTP/2连接。针对每个连接，攻击者快速地创建新的HTTP/2 stream，并立即发送RST_STREAM帧来重置它们。由于攻击者可以在不完全发送请求的情况下重置stream，因此服务器需要花费大量的资源来处理stream的创建和销毁，而无需执行实际的请求处理工作。

**POC代码分析：**
提供的POC代码是一个增强型的HTTP/2 Rapid Reset测试工具，它提供了超过40个配置选项，可以精细地控制攻击的各个方面。主要利用方式如下：

1.  **连接设置：** 控制并发连接数、连接超时、读取超时和连接建立延迟。
2.  **请求和定时设置：**  控制每个连接的请求数、HEADERS和RST_STREAM帧之间的延迟、请求之间的延迟以及时间随机化因子。
3.  **攻击模式：** 支持多种攻击模式，包括 rapid_reset、burst_reset、gradual_reset、random_reset、continuation_flood和mixed_pattern。
4.  **HTTP/2协议设置：** 允许自定义HTTP/2的初始窗口大小、最大帧大小、HPACK header table大小，以及是否启用server push等。
5.  **Header定制：** 允许添加自定义header或生成随机header，以模拟真实流量并绕过header过滤。
6. **高级选项:** 提供stream id随机化、优先级设置等高级绕过方法.
7.  **输出与日志：**  支持多种输出格式（console, json, csv, xml），方便分析攻击结果。

**有效性：**
该POC代码的有效性较高，因为它直接利用了HTTP/2协议的设计缺陷，通过控制连接和请求的参数，可以有效地消耗服务器资源。

**投毒风险：**
此POC代码的投毒风险较低。因为它主要是用于性能测试和漏洞验证的工具，其功能集中于发送特定格式的HTTP/2请求并记录服务器的响应。尽管可以配置各种参数，但代码本身并没有执行恶意操作（例如，植入后门、窃取数据等）的逻辑。不过，如果使用者不当使用，例如，用于未授权的DDoS攻击，则会产生危害。`poison` 设置为1% 是因为存在使用者滥用的可能性.

**项目地址:** [madhusudhan-in/CVE_2023_44487-Rapid_Reset](https://github.com/madhusudhan-in/CVE_2023_44487-Rapid_Reset)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)