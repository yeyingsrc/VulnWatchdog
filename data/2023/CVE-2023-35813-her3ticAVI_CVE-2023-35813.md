## CVE-2023-35813-Sitecore-远程代码执行

**漏洞编号:** CVE-2023-35813

**漏洞类型:** 远程代码执行

**影响应用:** Sitecore Experience Manager/Platform/Commerce

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 10.3

**利用条件:** 需要能够访问Sitecore实例的网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-35813 是一个Sitecore产品中的远程代码执行漏洞，影响 Experience Manager、Experience Platform 和 Experience Commerce 直到 10.3 版本。 

**利用方式分析：**

1.  **漏洞触发点:** 漏洞存在于 `sitecore_xaml.ashx` 处理程序中，特别是在解析 XAML 内容时。
2.  **POC 代码分析:** 提供的 Python POC 代码通过构造特定的 HTTP POST 请求来利用该漏洞。 它首先定义了一个恶意的 XAML payload，该 payload 使用 `System.Runtime.Remoting.Services` 命名空间中的 `RemotingService` 类。Payload 的目的是修改响应的 `Content-Type` 头，如果成功，则表明存在漏洞。
3.  **步骤:**
    *   **构造 Payload:**  POC 构造一个包含恶意 XAML 的 Payload。该 Payload 利用 `System.Runtime.Remoting.Services` 来尝试更改 `Content-Type` 头。
    *   **URL 编码:** 对 Payload 进行 URL 编码，以确保其可以通过 HTTP 请求安全传输。
    *   **发送 HTTP 请求:**  POC 向 `/sitecore_xaml.ashx/-/xaml/Sitecore.Xaml.Tutorials.Styles.Index` 发送一个带有特制 Payload 的 HTTP POST 请求。 `Content-Type` 设置为 `application/x-www-form-urlencoded`。
    *   **验证漏洞:** POC 检查响应的 `Content-Type` 头是否包含字符串“TestVulnerability”。 如果存在，则表示目标易受攻击。

4. **投毒风险分析:** 
 该POC 代码的主要目的是验证目标是否存在漏洞，通过更改 Content-Type 来确认，并没有发现任何尝试执行恶意操作或植入后门的痕迹。因此，投毒风险极低。

**有效性评估：**

根据漏洞描述和 POC 代码分析，该 POC 具有较高的有效性，因为它直接针对 XAML 处理程序，并能够通过修改 `Content-Type` 标头来确认漏洞的存在。


**项目地址:** [her3ticAVI/CVE-2023-35813](https://github.com/her3ticAVI/CVE-2023-35813)

**漏洞详情:** [CVE-2023-35813](https://nvd.nist.gov/vuln/detail/CVE-2023-35813)