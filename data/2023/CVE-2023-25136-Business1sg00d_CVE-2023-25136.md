## CVE-2023-25136-OpenSSH-double-free

**漏洞编号:** CVE-2023-25136

**漏洞类型:** Double-Free

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 9.1

**利用条件:** 默认配置，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25136 是 OpenSSH 9.1 版本中存在的一个双重释放漏洞，发生在 options.kex_algorithms 的处理过程中。未经身份验证的远程攻击者可以利用此漏洞跳转到 sshd 进程地址空间中的任何位置，理论上可以实现远程代码执行。提供的POC代码`enumerate_sshd.py`用于枚举sshd进程的信息，包括PID和基址，并使用gdb附加到进程进行调试，在`kex_assemble_names`函数和315行设置断点。尽管README.md提及了漏洞利用分析，但当前的代码主要用于调试和信息收集，并不能直接触发双重释放漏洞。投毒风险评估：代码包含从`/proc/{pid}/maps`读取信息的行为，如果攻击者替换了这个脚本，使其尝试读取不应访问的文件或向恶意地址写入数据，则可能构成投毒。可能性较低，但存在风险。漏洞利用方式：攻击者通过发送特制的密钥交换算法（kex_algorithms）选项，触发 `sshd` 中的双重释放漏洞，从而控制程序执行流程，最终目标是实现远程代码执行。由于是预认证漏洞，攻击者无需登录即可触发。目前提供的POC只是为了方便调试，并没有直接利用此漏洞。完整利用需要更复杂的内存操作来控制程序执行。

**项目地址:** [Business1sg00d/CVE-2023-25136](https://github.com/Business1sg00d/CVE-2023-25136)

**漏洞详情:** [CVE-2023-25136](https://nvd.nist.gov/vuln/detail/CVE-2023-25136)