## CVE-2023-36845 Juniper Junos OS J-Web RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Junos OS J-Web (EX and SRX Series)

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本见CVE描述：所有版本 prior to 20.4R3-S9; 21.1 versions 21.1R1 and later; 21.2 versions prior to 21.2R3-S7; 21.3 versions prior to 21.3R3-S5; 21.4 versions prior to 21.4R3-S5; 22.1 versions prior to 22.1R3-S4; 22.2 versions prior to 22.2R3-S2; 22.3 versions prior to 22.3R2-S2, 22.3R3-S1; 22.4 versions prior to 22.4R2-S1, 22.4R3; 23.2 versions prior to 23.2R1-S1, 23.2R2.

**利用条件:** 目标设备已启用 J-Web 服务 (HTTP 或 HTTPS)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS EX 和 SRX 系列的 J-Web 组件中的一个 PHP 外部变量修改漏洞。该漏洞允许未经身份验证的远程攻击者通过构造特殊的请求来修改 PHP 的执行环境，从而实现远程代码执行。

**利用方式：**

攻击者通过设置 `PHPRC` 环境变量为 `/dev/fd/0`，并通过 `data-binary` 参数传递 PHP 代码。 由于`/dev/fd/0`代表标准输入，攻击者可以将任意PHP代码写入到标准输入中，这些代码会被作为PHP配置文件执行。 在提供的POC中，利用`auto_prepend_file`指令包含`/etc/passwd`文件，从而验证漏洞的存在。 实际的利用中，攻击者可以注入任意的恶意PHP代码，实现远程代码执行。

**有效性：**
提供的 POC 代码通过 curl 发送一个带有恶意 `PHPRC` 参数的 HTTP 请求。 该请求的目标是 `/about.php` 页面，并尝试包含 `/etc/passwd` 文件。 如果目标存在漏洞，则响应中会包含 `/etc/passwd` 的内容，证明 POC 有效。

**投毒风险：**

提供的脚本非常简单，主要功能就是发送包含恶意参数的请求。该脚本没有发现明显的投毒代码。但是，用户需要注意下载的脚本来源，防止被恶意替换。

根据现有信息，代码本身直接包含恶意代码的可能性较低。风险主要在于代码作者可能在其他地方埋藏恶意链接，或者在其他恶意软件中捆绑该脚本。 因此，判断投毒风险为0%。


**项目地址:** [iveresk/CVE-2023-36845-6-](https://github.com/iveresk/CVE-2023-36845-6-)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)