## CVE-2020-5902-F5 BIG-IP TMUI 远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要访问BIG-IP的TMUI (Traffic Management User Interface) 端口，通常是443

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于F5 BIG-IP的Traffic Management User Interface (TMUI)中，允许未经身份验证的攻击者通过构造特殊的HTTP请求执行任意代码。提供的Ruby POC脚本通过目录遍历和文件读取漏洞，尝试读取目标系统的`/etc/passwd`文件，以此判断目标是否存在漏洞。如果成功读取，则认为目标易受攻击，并将域名写入输出文件。虽然脚本的主要功能是漏洞检测，但攻击者可以修改`tmshCmd.jsp`的command参数来执行任意命令，从而实现远程代码执行。 投毒风险分析：该Ruby脚本主要是利用文件读取漏洞来进行验证，本身不存在恶意代码。风险点在于: 1. `big-ip.rb`脚本读取`list.txt`的内容，若`list.txt`被篡改，可能导致扫描非授权的IP地址或域名；2. `big-ip.rb`脚本将扫描结果写入`output.txt`，攻击者可替换此文件导致信息泄露。因此，判断投毒风险为5%。

利用方式：

1.  **目录遍历和文件读取：** 攻击者利用`login.jsp/..;`进行目录遍历，绕过身份验证。
2.  **文件读取：**  利用`fileRead.jsp`读取任意文件，例如`/etc/passwd`，`/config/bigip.conf`。
3.  **命令执行：** 攻击者通过`tmshCmd.jsp`执行任意TMSH命令，从而实现远程代码执行。

参考链接中包含大量利用方法, 包含不限于文件上传,目录遍历等, 通过上述方式可以获取服务器的控制权限.

**项目地址:** [z3n70/CVE-2020-5902](https://github.com/z3n70/CVE-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)