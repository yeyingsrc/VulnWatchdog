## CVE-2020-5902 F5 BIG-IP TMUI 远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP Traffic Management User Interface (TMUI)

**危害等级:** 高危，可能导致完全控制受影响的BIG-IP系统。

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问受影响的BIG-IP系统的TMUI (通常在443或80端口)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-5902 存在于 F5 BIG-IP 系统的 TMUI 中，允许未经身份验证的攻击者执行任意代码。该漏洞是由于TMUI在处理用户输入时存在缺陷，使得攻击者可以通过构造特殊的URL来绕过身份验证并执行任意的 tmsh 命令或读取任意文件。

**有效性：**
提供的POC代码是有效的。它通过发送包含目录遍历序列（`/tmui/login.jsp/..;`）的HTTP GET请求到易受攻击的`tmshCmd.jsp`或`fileRead.jsp`端点来利用该漏洞。该脚本尝试执行多个操作，包括列出 `/tmp/xxx` (可能用于验证命令执行), 读取 `/etc/passwd` (用于验证文件读取) 和列出 admin 用户信息。

**投毒风险：**
该POC代码本身不包含明显的恶意代码或后门。它主要用于验证漏洞的存在和进行一些基本的信息收集。它执行的操作都是相对无害的，例如读取`/etc/passwd`或者执行`tmsh`命令。代码没有创建、修改或删除文件，也没有建立持久连接或传输敏感数据。因此，投毒风险评估为0%。当然，如果将此POC用于实际攻击，攻击者可以通过执行更恶意的`tmsh`命令来植入后门或造成其他损害，但POC本身不具备这个功能。

**利用方式：**
1.  **目录遍历：** 漏洞利用的核心是目录遍历。通过在URL中使用`..;`序列，攻击者可以绕过TMUI的访问控制，访问受限的JSP页面。
2.  **命令执行/文件读取：** 访问`tmshCmd.jsp`允许攻击者执行任意tmsh命令，例如列出系统信息、创建用户或修改配置。访问`fileRead.jsp`允许攻击者读取服务器上的任意文件，例如`/etc/passwd`或其他包含敏感信息的配置文件。
3.  **未经身份验证：** 该漏洞最大的威胁在于它不需要任何身份验证。攻击者只需知道目标BIG-IP系统的IP地址和TMUI端口，就可以发起攻击。

**缓解措施：**
*   升级到不受影响的BIG-IP版本。
*   限制对TMUI的访问，只允许授权用户访问。
*   使用Web应用防火墙（WAF）来检测和阻止包含恶意目录遍历序列的请求。

**项目地址:** [ludy-dev/BIG-IP-F5-TMUI-RCE-Vulnerability](https://github.com/ludy-dev/BIG-IP-F5-TMUI-RCE-Vulnerability)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)