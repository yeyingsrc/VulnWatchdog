## CVE-2020-5902 - F5 BIG-IP TMUI 远程代码执行漏洞

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP TMUI (Configuration Utility)

**危害等级:** 高危，可导致完全控制受影响的BIG-IP设备

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问BIG-IP设备的TMUI管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5902 是 F5 BIG-IP 设备 TMUI (Traffic Management User Interface) 中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过发送特制的HTTP请求到易受攻击的TMUI页面来执行任意系统命令。

**有效性：**

提供的POC代码利用了目录遍历漏洞读取敏感文件 (如 /etc/passwd, /etc/hosts, bigip.license, bigip.conf) 以及执行任意 tmsh 命令。给出的 URL 路径中 "/tmui/login.jsp/..;/"  通过目录穿越绕过身份验证。

**投毒风险：**

提供的代码仓库主要包含以下内容：

*   `README.md`: 包含漏洞描述、POC利用示例，以及使用说明。
*   `common_path.txt`: 包含可能存在敏感信息的常见文件路径，用于爆破。
*   `exploit-CVE-2020-5902.py`: 主利用脚本。

由于没有提供主利用脚本的具体内容，因此无法完全确定是否存在恶意代码。然而，从给出的信息来看，该仓库主要目的是提供漏洞利用方法。存在投毒风险的可能性较低，估计在10%左右。具体风险取决于`exploit-CVE-2020-5902.py`的具体实现。

**利用方式：**

1.  攻击者发送包含目录遍历序列 (如 `login.jsp/..;/`) 的HTTP请求到BIG-IP设备的TMUI界面。
2.  目录遍历序列绕过身份验证。
3.  利用 `fileRead.jsp` 读取任意文件，从而获取敏感信息。
4.  利用 `tmshCmd.jsp` 执行任意 tmsh 命令，从而实现远程代码执行。
5.  攻击者还可以使用提供的 python 脚本进行自动化利用，包括指定文件读取和使用字典进行文件爆破。


**项目地址:** [amitlttwo/CVE-2020-5902](https://github.com/amitlttwo/CVE-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)