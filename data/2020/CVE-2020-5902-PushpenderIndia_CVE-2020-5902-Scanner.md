## CVE-2020-5902 - F5 BIG-IP TMUI 远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要能够访问BIG-IP的TMUI（Traffic Management User Interface），通常是443端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5902 是 F5 BIG-IP Traffic Management User Interface (TMUI) 中的一个远程代码执行漏洞。攻击者可以通过发送特制的HTTP请求到存在漏洞的URI，利用路径遍历和文件读取漏洞执行任意命令。 

**有效性：** 提供的Python脚本利用 `curl` 命令尝试访问 `https://{subdomain}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd` 或 `http://{subdomain}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd`，从而读取 `/etc/passwd` 文件。如果成功读取到包含 `root:x:0:0:root` 的内容，则判定目标存在漏洞。该方法基于已知的漏洞利用路径，因此具有一定的有效性。

**投毒风险：**  该脚本相对简单，主要功能是尝试利用CVE-2020-5902漏洞，并没有明显的恶意代码植入行为。风险点在于脚本执行时使用了 `subprocess.check_output` 函数，如果输入的文件 `subdomains` 包含恶意构造的域名，可能会导致命令注入。此外，如果攻击者替换了原始的 `subdomains` 文件，也可能被诱导扫描恶意站点。 总体上，投毒风险较低，约为10%，主要集中在用户提供的输入文件的安全性上, 以及使用者下载的源码是否被篡改。

**利用方式：** 攻击者首先需要获取目标 F5 BIG-IP 设备的 TMUI 接口的访问权限。然后，通过构造包含路径遍历的 URL，尝试读取系统文件。通过文件读取漏洞，攻击者可以进一步利用其他漏洞，例如远程代码执行，最终控制系统。

提供的POC通过读取`/etc/passwd`来验证漏洞的存在，更深入的利用可能涉及到上传恶意文件或其他RCE方式。

**项目地址:** [PushpenderIndia/CVE-2020-5902-Scanner](https://github.com/PushpenderIndia/CVE-2020-5902-Scanner)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)