## CVE-2020-5902-F5 BIG-IP TMUI-RCE

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要能够访问BIG-IP设备的TMUI (Traffic Management User Interface) 界面，通常为443端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-5902是F5 BIG-IP设备TMUI中的一个远程代码执行漏洞。攻击者可以通过发送特制的HTTP请求到易受攻击的`tmui/login.jsp` 页面，利用目录遍历和命令注入来执行任意系统命令。该漏洞的PoC代码利用了一系列HTTP请求来创建一个bash别名，将命令写入临时文件，然后执行该文件，最后删除该别名。 

**漏洞利用方式：**

1.  **创建CLI别名：** 使用一个特制的URL来创建一个名为`list`的CLI别名，该别名会执行bash命令。
2.  **写入命令到文件：** 使用另一个特制的URL将要执行的命令写入`/tmp/cmd`文件。
3.  **执行命令：** 通过执行`list+/tmp/cmd`别名来执行`/tmp/cmd`文件中的命令。
4.  **删除CLI别名：** 清理之前创建的CLI别名。

**有效性：**

提供的PoC代码与漏洞描述相符，并且在受影响的BIG-IP版本上应能有效利用该漏洞。漏洞库信息和搜索引擎结果都表明该漏洞已被广泛利用。

**投毒风险：**

经过对PoC代码的分析，没有发现明显的投毒代码。该脚本的主要功能是利用漏洞执行用户指定的命令。代码本身只是执行RCE，没有发现植入后门或者其他恶意行为。因此，投毒风险评估为0%。

**项目地址:** [superzerosec/cve-2020-5902](https://github.com/superzerosec/cve-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)