## CVE-2020-5902 F5 BIG-IP TMUI RCE

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问BIG-IP的TMUI管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5902存在于F5 BIG-IP的Traffic Management User Interface (TMUI)中，允许未经身份验证的攻击者通过发送特制的HTTP请求执行任意代码。

**有效性分析：**
提供的checker.sh脚本通过利用目录遍历漏洞读取`/etc/passwd`文件来验证漏洞是否存在。脚本首先使用`shodan`查找暴露在外的BIG-IP实例，然后尝试通过构造包含目录遍历的URL，访问`/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd`，如果能够读取到`/etc/passwd`的内容，特别是包含`root`用户的信息，则判断目标存在漏洞。此方法是有效的，因为成功读取`/etc/passwd`表明存在未授权的文件读取漏洞，可以被进一步利用执行远程代码。

**投毒风险分析：**
代码主要功能是利用Shodan扫描目标并检测漏洞是否存在。代码依赖于外部工具（Shodan CLI和curl），因此如果这些工具本身存在安全问题，则可能引入风险。脚本本身执行的操作相对简单，没有发现明显的恶意代码或后门。但是，任何依赖网络资源的代码都存在一定的风险。例如，如果Shodan搜索结果被篡改，可能会导致脚本尝试连接到恶意的IP地址。考虑到这些因素，投毒风险估计为10%。

**利用方式分析：**
漏洞利用方式主要包括以下步骤：

1.  **确定目标：** 通过Shodan等搜索引擎，或者直接指定IP地址，确定运行存在漏洞版本的F5 BIG-IP的实例。
2.  **构造恶意URL：** 构造包含目录遍历的URL，例如：`/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd`，尝试读取敏感文件。
3.  **执行任意代码：** 目录遍历漏洞可以进一步被利用来上传恶意文件（例如，webshell）或者执行任意命令。具体利用方式取决于目标系统的配置和可利用的攻击面，可以参考Packet Storm Security上的相关资料。
总而言之，此漏洞利用涉及到目录遍历，未经授权的文件读取，最终导致远程代码执行。

**项目地址:** [faisalfs10x/F5-BIG-IP-CVE-2020-5902-shodan-scanner](https://github.com/faisalfs10x/F5-BIG-IP-CVE-2020-5902-shodan-scanner)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)