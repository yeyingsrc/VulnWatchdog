## CVE-2020-5902 - F5 BIG-IP TMUI 远程代码执行漏洞

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP TMUI (Traffic Management User Interface / Configuration utility)

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 目标系统需要运行受影响版本的F5 BIG-IP，且TMUI界面可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5902 存在于 F5 BIG-IP 的 TMUI 中，允许未经身份验证的攻击者执行任意代码。根据漏洞库信息，这是一个远程代码执行漏洞。漏洞利用方式通常涉及发送特制的 HTTP 请求到 TMUI 界面，利用目录遍历或文件上传漏洞，最终在服务器上执行恶意代码。

提供的 Python 脚本 `CVE-2020-5902_bigip_ioc_checker.py` 是一个 IoC (Indicators of Compromise) 检测脚本，用于扫描 BIG-IP 系统是否存在与该漏洞相关的入侵痕迹。它会检查系统版本、热修复情况、以及是否存在可疑的文件或进程。该脚本本身并不能直接利用漏洞，而是用于检测系统是否已被攻击。

**有效性：**
虽然提供的代码本身不是漏洞利用代码，但它表明了漏洞的存在，并且其他搜索结果表明漏洞利用代码是存在的。因此，可以认为漏洞是有效的。

**投毒风险：**
该 IoC 检测脚本本身存在极小的投毒风险。原因如下：
*   **IoC 检测性质：** 该脚本的主要目的是检测是否存在已知的攻击模式。如果脚本本身被篡改，可能会导致检测结果不准确，从而误导用户。
*   **潜在的后门指令：** 脚本中可能存在隐藏的恶意代码，例如收集系统信息并发送到外部服务器。但这需要仔细分析脚本的每一行代码，并且考虑到该脚本是公开的，这种可能性相对较低。

该脚本主要功能在于检查受害者机器上是否存在已知的恶意文件，或者命令执行记录。投毒者可能会借此来扫描特定目标，进行情报收集，但直接利用此脚本进行大规模恶意投毒行为的可能性比较小。从代码角度看，没有直接发现后门相关的代码，但不能排除潜在的风险。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者可以通过发送恶意构造的HTTP请求到BIG-IP的TMUI界面。
2.  请求中可以包含目录遍历payload，从而访问受限的文件或目录。
3.  攻击者可能利用文件上传功能上传恶意Webshell或者其他可执行文件。
4.  通过触发上传的文件或执行注入的命令，攻击者可以在BIG-IP系统上执行任意代码，从而控制整个系统。

**项目地址:** [f5devcentral/cve-2020-5902-ioc-bigip-checker](https://github.com/f5devcentral/cve-2020-5902-ioc-bigip-checker)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)