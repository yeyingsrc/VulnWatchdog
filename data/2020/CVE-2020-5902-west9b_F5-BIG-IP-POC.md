## CVE-2020-5902/CVE-2021-22986/CVE-2022-1388 - F5 BIG-IP TMUI 远程代码执行/命令执行/身份验证绕过

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行/命令执行/身份验证绕过

**影响应用:** F5 BIG-IP TMUI

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** CVE-2020-5902: 11.6.1-11.6.5.1, 12.1.0-12.1.5.1, 13.1.0-13.1.3.3, 14.1.0-14.1.2.5, 15.0.0-15.1.0.3; CVE-2021-22986: 未知； CVE-2022-1388: 未知

**利用条件:** 需要网络访问和目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码包含针对F5 BIG-IP TMUI的三个漏洞的利用：CVE-2020-5902，CVE-2021-22986和CVE-2022-1388。 

**有效性：**

*   **CVE-2020-5902：** POC代码通过文件读取漏洞来验证，尝试读取`/etc/passwd`文件，如果返回内容，则表明漏洞存在。 根据漏洞库信息，此漏洞影响多个BIG-IP版本，POC较为有效。
*   **CVE-2021-22986 和 CVE-2022-1388：** POC代码通过发送POST请求到`/mgmt/tm/util/bash`，利用未授权或身份验证绕过执行命令。POC会默认执行`id`命令，如果返回{id}则漏洞存在。header信息存在异常，攻击载荷放在了url中。根据经验这两个漏洞poc大概率存在问题

**利用方式：**

*   **CVE-2020-5902：** 这是一个文件读取漏洞，攻击者可以利用目录遍历读取系统上的敏感文件。
*   **CVE-2021-22986 和 CVE-2022-1388：** 这两个漏洞允许攻击者执行任意命令。攻击者可以通过构造包含恶意命令的POST请求来控制系统。

**投毒风险：**
虽然该仓库总体来说提供的是漏洞利用代码，但仍然存在潜在的投毒风险，评估为10%。

*   **变量污染风险:** 在`F5.go`文件中，`url`和`c`变量通过flag包进行初始化。如果攻击者能够控制这些变量的值，可能导致执行恶意代码，例如反弹shell。
*   **README诱导:** 在README.md文件中，存在反弹shell的命令示例，但未明确提示风险，可能诱导用户在不了解后果的情况下执行，存在一定的风险。
*   **不明确的免责声明:** 虽然有免责声明，但表述不够具体，可能被滥用，从而免除作者的责任。

**项目地址:** [west9b/F5-BIG-IP-POC](https://github.com/west9b/F5-BIG-IP-POC)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)