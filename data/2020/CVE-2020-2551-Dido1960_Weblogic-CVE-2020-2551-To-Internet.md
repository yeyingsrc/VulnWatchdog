## CVE-2020-2551 - Oracle WebLogic Server IIOP 反序列化漏洞

**漏洞编号:** CVE-2020-2551

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0

**利用条件:** 需要网络访问 WebLogic Server 的 IIOP 端口（默认7001）。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-2551 漏洞存在于 Oracle WebLogic Server 的 WLS Core Components 组件中。该漏洞允许未经身份验证的攻击者通过 IIOP 协议进行网络访问，从而导致 Oracle WebLogic Server 被完全控制。提供的 POC 代码利用了 IIOP 协议中的反序列化漏洞。第一个 python 脚本 `CVE-2020-2551.py` 尝试利用 bind_any 方式进行攻击，它首先发送一个 LocateRequest 以获取 Key Address，然后构造包含恶意 JRMP 地址的 bind_any 请求，并将其发送到服务器，从而触发反序列化漏洞。由于bind_any请求中包含硬编码的JRMP地址 `rmi://172.21.0.1:1099/object`,如果目标主机不能访问该地址，利用会失败。第二个 python 脚本 `CVE-2020-TEST.py` 和第一个脚本实现逻辑基本相同，没有发现明显的后门代码。投毒风险主要在于攻击者可能会修改 JRMP 地址，指向恶意 RMI 服务器，从而控制目标服务器。代码中使用的IP地址 `172.21.0.1` 是一个私有IP地址，可能并非作者真实IP。因此，存在一定投毒的可能性，但考虑到该漏洞的公开性和广泛性，恶意 RMI 服务器的IP地址更容易被发现，因此投毒风险评估为10%。利用方式总结：
1.  发送 LocateRequest 获取 Key Address。
2.  构造包含恶意 JRMP 地址的 bind_any 请求，并替换 Key Address。
3.  发送 bind_any 请求触发反序列化漏洞，导致远程代码执行。

**项目地址:** [Dido1960/Weblogic-CVE-2020-2551-To-Internet](https://github.com/Dido1960/Weblogic-CVE-2020-2551-To-Internet)

**漏洞详情:** [CVE-2020-2551](https://nvd.nist.gov/vuln/detail/CVE-2020-2551)