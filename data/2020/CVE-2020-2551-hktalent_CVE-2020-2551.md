## CVE-2020-2551-Oracle WebLogic Server-IIOP反序列化

**漏洞编号:** CVE-2020-2551

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0

**利用条件:** 需要网络访问，目标WebLogic服务器IIOP端口开放（默认为7001），且未经授权

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-2551是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Core Components组件中。攻击者可以通过IIOP协议发送恶意构造的序列化数据，导致服务器执行任意代码，从而完全控制WebLogic Server实例。

**漏洞利用方式：**

1.  攻击者通过网络连接到目标WebLogic服务器的IIOP端口。
2.  攻击者发送精心构造的包含恶意代码的序列化数据。
3.  WebLogic服务器在处理该序列化数据时，会反序列化其中的恶意代码，导致代码执行。

**POC分析：**

提供的Python POC脚本 `CVE-2020-2551.py` 主要用于检测目标是否存在CVE-2020-2551漏洞。它通过发送一个特定的GIOP请求到WebLogic服务器的IIOP端口，如果服务器返回包含'GIOP'的响应，则表明服务器可能存在此漏洞。该POC代码本身并不执行攻击，只是探测漏洞是否存在。

**投毒风险分析：**

此仓库中存在一定投毒的风险。尽管给定的POC代码主要用于检测漏洞，但代码中包含以下潜在风险点：

1.  **checkOnline函数：** 代码中包含 `checkOnline` 函数，该函数会将目标URL和回调URL发送到 `http://51pwn.com/CVE-2020-2551/`。虽然表面上是为了统计漏洞利用情况，但存在泄露目标信息甚至配合远程指令执行恶意操作的潜在风险。虽然使用了 try...except 捕获异常，降低了其影响，但仍不能完全排除。
2.  **输出文件：** 代码会将检测到存在漏洞的目标URL写入到文件中。如果该文件被攻击者获取，可能会被用于进一步的攻击活动。
3. **硬编码URL:** 代码中存在硬编码的URL `http://51pwn.com/CVE-2020-2551/`，这使得该脚本在未经审查的情况下使用存在一定的风险，恶意代码可以利用此URL进行恶意行为。
4.  **依赖风险：** 脚本依赖于 `requests` 库，如果该库被恶意篡改，可能会导致代码执行恶意操作。

综合考虑，该仓库中的代码存在一定的投毒风险，建议在使用前进行详细的代码审计。

**项目地址:** [hktalent/CVE-2020-2551](https://github.com/hktalent/CVE-2020-2551)

**漏洞详情:** [CVE-2020-2551](https://nvd.nist.gov/vuln/detail/CVE-2020-2551)