## CVE-2020-2551-WebLogic-IIOP反序列化RCE

**漏洞编号:** CVE-2020-2551

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0

**利用条件:** 目标WebLogic服务器开启IIOP协议，攻击者可以从网络访问IIOP端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-2551 是 Oracle WebLogic Server 中 WLS Core Components 组件的一个反序列化漏洞。攻击者可以通过 IIOP 协议发送恶意构造的序列化数据，导致远程代码执行，从而完全控制 WebLogic 服务器。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息显示该漏洞易于利用，且成功利用会导致服务器被控制。提供的利用代码仓库包含环境搭建脚本、payload生成说明（依赖marshalsec_docker项目）和payload发送器。仓库中的README给出了明确的复现步骤，并且提示了成功利用后Weblogic日志中会出现的错误信息，表明POC是经过验证的。

**投毒风险：**
该仓库主要提供环境搭建脚本和payload发送器，payload的生成依赖于第三方项目`marshalsec_docker`。直接分析提供的代码，投毒风险较低，主要风险点可能存在于：
*   **`marshalsec_docker`项目：** 由于payload生成依赖于外部项目，如果`marshalsec_docker`项目被投毒，那么生成的payload也可能包含恶意代码。需要对`marshalsec_docker`进行安全性评估，风险评估80%。由于此项目已经被cnsimo作者归档, 此处投毒风险降低.
*   **Payload发送器（weblogic_CVE_2020_2551.jar）：** 这个jar包可能包含恶意代码，但根据描述，它主要是负责发送payload，风险评估20%。
综合来看，**仓库本身直接包含投毒代码的概率为 10%**，主要风险在于它依赖的外部项目可能被投毒。

**利用方式：**
1.  **环境准备：** 搭建受影响版本的 WebLogic Server，并确保开启 IIOP 协议。
2.  **Payload生成：** 使用 `marshalsec_docker` 项目生成恶意序列化数据 payload。
3.  **Payload发送：** 使用提供的 payload 发送器（`weblogic_CVE_2020_2551.jar`）将 payload 通过 IIOP 协议发送到 WebLogic Server。
4.  **触发漏洞：** WebLogic Server 反序列化接收到的恶意数据，执行其中的恶意代码，导致远程代码执行。

攻击成功后，攻击者可以在 WebLogic Server 上执行任意命令，从而完全控制服务器。


**项目地址:** [DaMinGshidashi/CVE-2020-2551](https://github.com/DaMinGshidashi/CVE-2020-2551)

**漏洞详情:** [CVE-2020-2551](https://nvd.nist.gov/vuln/detail/CVE-2020-2551)