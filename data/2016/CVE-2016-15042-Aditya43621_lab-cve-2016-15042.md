## CVE-2016-15042-Frontend File Manager & N-Media Post Front-end Form-Arbitrary File Upload

**漏洞编号:** CVE-2016-15042

**漏洞类型:** 任意文件上传

**影响应用:** Frontend File Manager, N-Media Post Front-end Form

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**利用条件:** 需要目标站点安装受影响的插件，并允许未经身份验证的用户访问上传功能

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2016-15042 是一个存在于 WordPress 插件 Frontend File Manager 和 N-Media Post Front-end Form 中的任意文件上传漏洞。由于插件缺乏充分的文件类型验证，未经身份验证的攻击者可以通过 `nm_filemanager_upload_file` 和 `nm_postfront_upload_file` AJAX actions 上传任意文件到服务器。 

**有效性：**
漏洞库信息显示，该漏洞存在公开的利用方法，且影响范围明确。提供的代码仓库中包含一个 `index.js` 文件，该文件建立了一个简单的 REST API。 虽然提供的代码本身没有直接利用 CVE-2016-15042 漏洞，但它的存在表明可以构建一个利用该漏洞的 Web 服务。漏洞库信息显示该漏洞已存在公开的利用方法,搜索引擎未返回验证信息,但结合漏洞库信息,推断漏洞利用有效

**投毒风险：**
提供的代码仓库包含一个简单的 Node.js REST API。虽然快速浏览代码没有发现明显的恶意代码，但存在以下风险：

*   **依赖项风险：** `package.json` 文件中包含大量依赖项，其中一些依赖项的版本较老，可能存在已知漏洞，攻击者可能利用这些漏洞进行投毒。
*   **代码混淆/隐藏：** 代码结构较为简单，易于在现有代码中插入恶意代码，例如记录用户请求、窃取敏感数据或执行恶意操作。
*   **供应链攻击：** 作者使用的第三方库可能被恶意篡改，导致引入恶意代码。

因此，尽管乍一看代码没有明显的投毒行为，但潜在风险仍然很高。考虑到依赖项的复杂性和代码的可修改性，投毒风险估计为80%。

**利用方式：**
1.  **确定目标站点：** 寻找安装了受影响插件（Frontend File Manager < 4.0 或 N-Media Post Front-end Form <= 1.0）的 WordPress 站点。
2.  **分析 AJAX actions：** 使用开发者工具或其他网络抓包工具，分析 `nm_filemanager_upload_file` 和 `nm_postfront_upload_file` AJAX actions 的请求参数和文件上传方式。
3.  **构造恶意请求：** 构造包含恶意文件（如 PHP shell）的 POST 请求，绕过文件类型验证。通常可以通过修改 Content-Type 或文件名来欺骗服务器。
4.  **上传并执行恶意文件：** 将构造的请求发送到目标站点，成功上传恶意文件后，访问该文件，执行恶意代码，从而控制服务器。

**项目地址:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**漏洞详情:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)