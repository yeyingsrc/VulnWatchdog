## CVE-2016-15042 – WordPress Frontend File Manager & N‑Media Post Front‑end Form Unauthenticated File Upload

**漏洞编号:** CVE-2016-15042

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Frontend File Manager & N‑Media Post Front‑end Form

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Frontend File Manager < 4.0, N-Media Post Front-end Form < 1.1

**利用条件:** 受影响的插件已安装并启用，目标WordPress站点允许上传文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-15042是一个WordPress插件的未授权文件上传漏洞，存在于Frontend File Manager和N-Media Post Front-end Form插件中。由于缺少文件类型验证，攻击者可以上传任意文件到服务器，包括恶意PHP脚本，从而导致远程代码执行。

**有效性：**

提供的POC代码包含一个Dockerized lab，用于重现该漏洞。它配置了一个包含两个易受攻击插件的WordPress实例，并提供使用Nuclei进行验证的步骤。 因此，该POC代码是有效的，能够成功复现和验证漏洞。

**投毒风险：**

该仓库的主要目的是提供一个可复现的漏洞环境。Dockerfile 和相关脚本文件检查了软件的下载和安装过程。`/scripts/setup.sh`脚本的主要作用是启动一个包含漏洞wordpress的docker环境。 尽管该仓库看似提供了一个漏洞验证环境，但不能完全排除潜在的风险。 比如，下载链接使用的wordpress插件，有概率存在被篡改的情况。 docker compose 脚本中存在端口映射，有被恶意利用的可能。综合以上，判定投毒风险为10%。

**利用方式：**

1.  攻击者无需身份验证。
2.  攻击者可以通过向`nm_filemanager_upload_file` 或 `nm_postfront_upload_file` AJAX action发送包含恶意文件的请求，绕过文件类型检查。
3.  成功上传后，攻击者可以访问该文件，如果上传的是PHP脚本，就可以在服务器上执行任意代码。

**项目地址:** [ImBIOS/lab-cve-2016-15042](https://github.com/ImBIOS/lab-cve-2016-15042)

**漏洞详情:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)