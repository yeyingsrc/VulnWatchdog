## CVE-2024-3661-DHCP路由选项VPN流量劫持

**漏洞编号:** CVE-2024-3661

**漏洞类型:** VPN流量劫持

**影响应用:** 所有受影响的VPN客户端

**危害等级:** 高危，可能导致VPN保护的流量泄露、篡改甚至被拦截

**影响版本:** 0（IETF DHCP）

**利用条件:** 攻击者需要在与目标客户端相同的局域网内，并能够提供DHCP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3661 漏洞（TunnelVision）源于 DHCP 协议允许服务器通过 121 选项（Classless Static Route Option）向客户端添加路由条目。攻击者通过在局域网内架设恶意的 DHCP 服务器，向 VPN 客户端发送包含恶意路由的 DHCP 响应，使原本应通过 VPN 通道传输的流量被重定向到攻击者控制的网络接口，从而绕过 VPN 的保护。

**漏洞利用方式：**
1.  攻击者在目标网络中部署一个恶意的 DHCP 服务器。
2.  目标客户端连接到网络并发送 DHCP 请求。
3.  恶意 DHCP 服务器响应一个 DHCP Offer，其中包含经过精心构造的 Classless Static Route 选项 (Option 121)。这些选项会将特定目标（例如，互联网）的流量路由到攻击者控制的网关，而不是通过 VPN 通道。
4.  客户端接受此 DHCP 响应，并更新其路由表。
5.  当用户尝试访问互联网时，流量将被发送到攻击者控制的网关，而不是通过 VPN，从而暴露用户的流量。

**POC有效性：**
提供的 HTML 代码是一个交互式的演示页面，旨在解释 TunnelVision 漏洞。 它**本身并不是漏洞利用代码**，而是一个概念验证的展示。 需要配合实际的 DHCP 服务器程序才能完成漏洞利用。

**投毒风险评估：**
代码主要为前端展示代码，用于解释漏洞原理，因此，该代码本身包含恶意投毒代码的可能性极低，可以认为投毒风险为0%。需要注意的是，实际部署的恶意 DHCP 服务器程序可能包含恶意代码，但不在本次分析范围。

**项目地址:** [YardenFadida/CVE-2024-3661_Demo](https://github.com/YardenFadida/CVE-2024-3661_Demo)

**漏洞详情:** [CVE-2024-3661](https://nvd.nist.gov/vuln/detail/CVE-2024-3661)