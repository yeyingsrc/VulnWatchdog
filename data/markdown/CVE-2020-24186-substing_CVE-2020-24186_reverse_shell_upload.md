## CVE-2020-24186-wpDiscuz-RCE

**漏洞编号:** CVE-2020-24186

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** wpDiscuz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0 - 7.0.4

**利用条件:** 目标网站安装了受影响版本的wpDiscuz插件且允许未授权用户访问评论功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于wpDiscuz插件的wmuUploadFiles AJAX action中，允许未经身份验证的用户上传任意文件，包括PHP文件。攻击者可以通过上传恶意PHP脚本，利用其执行任意代码，从而完全控制服务器。

**有效性：**
提供的POC代码（exploit.py）有效。它通过模拟上传文件到`wmuUploadFiles`接口，绕过文件类型检查，从而上传恶意的PHP反弹shell。

**投毒风险：**
虽然POC代码的主要功能是利用漏洞上传反弹shell，但仍然存在一定的投毒风险。代码中存在变量名混淆、添加不必要的延时等小技巧，可能增加分析难度。但总体来说，代码逻辑较为清晰，未发现明显的恶意代码或后门，因此投毒风险较低，约10%。风险主要在于，攻击者可能会修改此POC，在反弹shell之外添加其他恶意功能。

**利用方式：**
1.  **查找目标：** 寻找安装了wpDiscuz 7.0到7.0.4版本的WordPress网站。
2.  **获取必要信息：** 通过访问包含评论功能的页面，获取`wmuSecurity`和`wc_post_id`的值。POC代码会自动获取这些值。
3.  **配置POC：** 修改`exploit.py`脚本中的目标URL（`-u`），评论的路径（`-p`），反弹shell的IP地址（`-l`）和端口（`-s`）。
4.  **执行攻击：** 运行`exploit.py`脚本。
5.  **连接反弹shell：** 使用`nc -lvnp <端口>`监听指定的端口，等待反弹shell连接。

**项目地址:** [substing/CVE-2020-24186_reverse_shell_upload](https://github.com/substing/CVE-2020-24186_reverse_shell_upload)

**漏洞详情:** [CVE-2020-24186](https://nvd.nist.gov/vuln/detail/CVE-2020-24186)