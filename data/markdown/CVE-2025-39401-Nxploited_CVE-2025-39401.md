## CVE-2025-39401-WPAMS-任意文件上传

**漏洞编号:** CVE-2025-39401

**漏洞类型:** 任意文件上传

**影响应用:** WPAMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 44.0 (17-08-2023)

**利用条件:** 需要目标存在apartment-management插件，且版本小于等于44.0 (17-08-2023)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于mojoomla WPAMS WordPress插件中，版本小于等于44.0 (17-08-2023)。攻击者可以通过未限制的文件上传漏洞上传Web Shell到Web服务器，实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含恶意代码（Web Shell）的PHP文件（shell.php）。
2.  攻击者向目标网站的`/apartment-management-member-registration-page/`路径发送POST请求，模拟用户注册，并在`amgt_user_avatar`字段上传恶意PHP文件。
3.  由于文件上传没有进行严格的类型校验，恶意PHP文件被上传到`/wp-content/uploads/apartment_assets/`目录。
4.  攻击者通过暴力破解时间戳的方式，猜测上传文件的名称。
5.  一旦找到上传的Web Shell，攻击者就可以通过访问该文件执行任意代码。

**投毒风险评估：**

*   **POC 代码分析：**  POC代码中包含了用户代理 (user_agent)、成功结果写入文件 (success_results.txt)、上传的 shell 写入文件 (uploaded_shells.txt) 的操作。 同时代码会尝试暴力破解时间戳的方式来猜测上传文件的名称, 如果破解成功则会讲shell的URL写入`success_results.txt`与`uploaded_shells.txt`中.
*   **潜在投毒风险：**
    *   **文件操作：**  `write_result`函数将结果写入文件，如果这些文件被用于自动化扫描或漏洞利用流程，可能会被恶意修改。但鉴于这是一个PoC，并且文件内容仅包含成功利用的目标URL，直接的危害较小。
    *   **时间戳爆破：**  爆破范围可配置（`TIMESTAMP_WINDOW`），但默认值较小，对目标服务器影响有限。
    *   **shell.php文件：** 该文件是需要用户自己提供的，存在后门风险，但是这不属于POC本身的投毒代码。
*  **结论：**  PoC代码本身存在一定的投毒风险，主要集中在利用成功后生成的文件可能被篡改上。 结合POC执行逻辑, 投毒概率估计为10%。如果shell.php 包含恶意代码, 则另当别论。

**项目地址:** [Nxploited/CVE-2025-39401](https://github.com/Nxploited/CVE-2025-39401)

**漏洞详情:** [CVE-2025-39401](https://nvd.nist.gov/vuln/detail/CVE-2025-39401)