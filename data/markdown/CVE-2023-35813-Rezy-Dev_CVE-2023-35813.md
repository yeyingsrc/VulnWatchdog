## CVE-2023-35813 - Sitecore RCE

**漏洞编号:** CVE-2023-35813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Sitecore Experience Manager, Experience Platform, and Experience Commerce

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 10.3

**利用条件:** 需要网络访问Sitecore实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-35813 允许远程代码执行。根据提供的漏洞库信息，此漏洞影响 Sitecore Experience Manager, Experience Platform, 和 Experience Commerce 10.3 及更早版本。漏洞利用代码 `exploit.py` 提供了一个全面的PoC，用于测试内容操纵和提取连接字符串。该脚本包含以下功能：

*   **彩色输出：** 使用 colorama 库进行彩色输出，便于阅读和理解。
*   **HTTP请求：** 使用 requests 库发送 HTTP 请求。
*   **SSL验证绕过：** 禁用 SSL 验证，可能用于测试环境，但生产环境不应如此操作。
*   **User-Agent设置：** 设置 User-Agent 头，模拟浏览器行为。
*   **多种测试：** 包含多个测试用例，例如内容操纵和提取连接字符串。
*   **Interactsh集成：** 支持与 Interactsh 集成，用于带外（OOB）漏洞验证。
*   **详细的响应信息：** 打印详细的 HTTP 响应信息，包括状态码、头部和内容预览。
*   **敏感信息高亮：** 使用颜色高亮显示响应中的敏感信息，如用户名、密码、数据库连接字符串等。

**利用方式分析：**

1.  **目标确定：** 首先需要确定目标 Sitecore 实例的 URL。
2.  **Payload发送：** 根据漏洞的具体细节 (未提供，需要搜索结果), 构造恶意的 HTTP 请求，通常涉及向 Sitecore 实例发送特制的请求，利用未经验证的输入执行恶意代码。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标服务器上执行任意代码。
4.  **信息收集：** 可以通过执行代码收集敏感信息，例如数据库连接字符串。
5.  **控制服务器：** 攻击者可以利用 RCE 漏洞完全控制受影响的服务器。

**投毒风险评估：**

对提供的 `exploit.py` 代码进行了分析，没有发现明显的投毒代码。 该脚本的目的是验证漏洞的存在并提取敏感信息，而不是在目标系统上安装后门或进行恶意操作。 因此， 投毒风险为 0%。

**有效性评估：**

根据漏洞库信息和提供的 PoC 代码，该漏洞利用的有效性取决于目标 Sitecore 实例的版本和配置。 如果目标实例的版本早于或等于 10.3 并且没有采取缓解措施，则该 PoC 代码很可能有效。

**项目地址:** [Rezy-Dev/CVE-2023-35813](https://github.com/Rezy-Dev/CVE-2023-35813)

**漏洞详情:** [CVE-2023-35813](https://nvd.nist.gov/vuln/detail/CVE-2023-35813)