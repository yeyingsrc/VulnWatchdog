## CVE-2025-53367 - DjVuLibre MMRDecoder OOB-Write

**漏洞编号:** CVE-2025-53367

**漏洞类型:** OOB-Write (Out-of-Bounds Write)

**影响应用:** DjVuLibre

**危害等级:** 高危，可能导致堆损坏，远程代码执行

**影响版本:** < 3.5.29

**利用条件:** 需要用户打开恶意的DjVu文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53367是DjVuLibre库中 MMRDecoder::scanruns 方法中存在的越界写入漏洞。由于该方法未验证 xr 指针是否保持在已分配缓冲区的边界内，因此可能发生越界写入，导致堆损坏。 根据CISA ADP Vulnrichment 信息，存在可用的PoC。提供的漏洞利用代码库中包含 `CMakeLists.txt`, `BUILDING.md` 和 `CMakeCache.txt`。从`CMakeLists.txt`来看，该项目旨在创建一个触发 `MMRDecoder::scanruns` 中的OOB-write的DjVu文件。虽然代码看起来像是合法的漏洞利用程序，但任何构建脚本都存在轻微的投毒风险，恶意行为可能隐藏在编译过程中。但是，从目前的代码来看，直接发现恶意后门的可能性较低，所以认为投毒概率为5%。

**利用方式：**

1.  攻击者制作一个恶意的DjVu文件，该文件会触发 `MMRDecoder::scanruns` 函数中的越界写入。
2.  受害者使用存在漏洞的DjVuLibre版本（< 3.5.29）打开此恶意文件。
3.  `MMRDecoder::scanruns` 函数尝试写入超出分配缓冲区边界的数据，导致堆损坏。
4.  攻击者可以利用堆损坏来执行任意代码。

**项目地址:** [ThePhykon/CVE-2025-53367-POC](https://github.com/ThePhykon/CVE-2025-53367-POC)

**漏洞详情:** [CVE-2025-53367](https://nvd.nist.gov/vuln/detail/CVE-2025-53367)