## CVE-2025-9803-lunary-ai/lunary-不当身份验证

**漏洞编号:** CVE-2025-9803

**漏洞类型:** 不当身份验证

**影响应用:** lunary-ai/lunary

**危害等级:** 严重，可能导致账户接管

**影响版本:** < 1.9.35

**利用条件:** 需要用户点击恶意链接或授权恶意应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于lunary-ai/lunary 1.9.34版本中，由于Google OAuth集成中存在不当的身份验证。应用程序未能验证Google颁发的访问令牌中的'aud'（受众）字段，这对于确保令牌用于该应用程序至关重要。这种疏忽允许攻击者使用颁发给恶意应用程序的令牌来获得对用户帐户的未授权访问。

**有效性：**
根据漏洞描述，漏洞利用依赖于应用程序未能验证OAuth令牌的`aud`字段。攻击者可以使用为其他（恶意）应用程序签发的Google OAuth令牌来冒充受害者。提供的POC代码看起来很不完整，只有一个README.md文件和一个看似无意义的数字文件。但是考虑到CVE描述本身已经很清晰，且commit diff也验证了漏洞的存在，漏洞是可利用的。

**投毒风险：**
提供的POC代码非常简单，只包含一个README和一个数字文件，没有发现任何潜在的恶意代码。因此，投毒风险非常低。

**利用方式：**
1.  攻击者创建一个恶意应用程序，该应用程序请求Google OAuth令牌。
2.  受害者在攻击者的应用程序上进行身份验证，攻击者获得受害者的Google OAuth令牌（该令牌实际上是发给攻击者恶意应用的）。
3.  攻击者使用受害者的令牌（发给恶意应用的）向易受攻击的lunary-ai/lunary应用程序进行身份验证。
4.  由于lunary-ai/lunary应用程序没有正确验证令牌的`aud`字段，因此它错误地认为令牌是为它自己颁发的，从而允许攻击者以受害者的身份登录。

**项目地址:** [maidilling32/CVE-2025-9803-Exploit](https://github.com/maidilling32/CVE-2025-9803-Exploit)

**漏洞详情:** [CVE-2025-9803](https://nvd.nist.gov/vuln/detail/CVE-2025-9803)