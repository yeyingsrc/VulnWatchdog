## CVE-2025-62168 - Squid Proxy 信息泄露

**漏洞编号:** CVE-2025-62168

**漏洞类型:** 信息泄露

**影响应用:** Squid Proxy

**危害等级:** 高危，可能导致敏感信息泄露，包括身份验证凭据

**影响版本:** < 7.2

**利用条件:** Squid代理服务器开启且受到影响的版本，允许客户端发送自定义header

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-62168漏洞存在于Squid代理服务器7.2版本之前。由于Squid在错误处理中未能正确地删除HTTP认证凭据，导致信息泄露。攻击者可以通过发送包含敏感信息的特制HTTP请求，当Squid生成错误页面时，这些敏感信息会出现在错误页面中（特别是mailto:链接的body中），从而被攻击者获取。PoC代码通过构造包含特定header的请求，并诱发Squid产生错误页面，然后解析页面内容以提取泄露的token。该漏洞利用的有效性较高，如果目标环境符合漏洞利用的条件，即可成功利用。PoC代码本身包含MIT许可，并且作者声明仅用于教育和防御目的。投毒风险较低，主要风险在于不当使用该PoC可能导致未经授权的访问或信息泄露。

**有效性：** PoC代码看起来是有效的，因为它模拟了漏洞描述中的步骤：发送带有敏感header的请求，强制Squid生成错误页面，然后解析错误页面以提取信息。

**投毒风险：** PoC代码主要由以下几个部分组成：

*   MIT许可证声明。
*   README.md文件，详细描述漏洞，使用方法和缓解措施。
*   python脚本 `cve-2025-62168.py` 是PoC的核心。它发送特制的HTTP请求并通过解析`mailto`链接的内容尝试泄露的token。

代码审查表明，该脚本主要功能是利用该漏洞，没有明显的恶意代码注入或后门。但是，如果用户不小心使用了该脚本，可能会导致未经授权的访问或信息泄露。风险等级很低，估算为5% 

**利用方式：**

1.  攻击者向Squid代理服务器发送一个特制的HTTP请求，该请求包含一个包含敏感信息的header（例如，Authorization头，包含JWT token）。
2.  攻击者通过某种方式（例如，请求一个不存在的域名）诱使Squid服务器生成一个错误页面。
3.  Squid服务器在生成错误页面时，未能正确地删除HTTP请求头中的敏感信息。
4.  错误页面中包含了原始的HTTP请求头信息，并且这些信息出现在`mailto:`链接的body中。
5.  攻击者解析错误页面，提取`mailto:`链接中的敏感信息。

**项目地址:** [nehkark/CVE-2025-62168](https://github.com/nehkark/CVE-2025-62168)

**漏洞详情:** [CVE-2025-62168](https://nvd.nist.gov/vuln/detail/CVE-2025-62168)