## CVE-2021-43008 - Adminer Arbitrary File Read

**漏洞编号:** CVE-2021-43008

**漏洞类型:** 任意文件读取

**影响应用:** Adminer

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 4.6.2

**利用条件:** Adminer实例允许连接到外部MySQL服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Adminer 1.12.0 到 4.6.2版本中。攻击者可以利用Adminer连接到恶意的MySQL服务器，该服务器会请求Adminer读取本地文件。由于Adminer没有正确验证MySQL服务器的响应，攻击者可以读取服务器上的任意文件，例如/etc/passwd、配置文件等。

**漏洞利用方式：**

1.  攻击者搭建一个恶意的MySQL服务器（Rogue MySQL Server）。
2.  攻击者诱使Adminer连接到该恶意服务器。这可以通过多种方式实现，例如利用配置错误、公开暴露Adminer实例，或者通过供应链攻击。
3.  恶意服务器向Adminer发送`LOAD DATA LOCAL INFILE`命令，请求读取指定文件。
4.  Adminer读取该文件并将内容发送回恶意服务器。

**有效性：**

提供的PoC代码清晰地展示了漏洞的利用过程，包括搭建恶意MySQL服务器、配置Adminer连接以及读取文件。该PoC是有效的。

**投毒风险：**

该漏洞的PoC代码主要包含一个恶意的MySQL服务器脚本，该脚本模拟了攻击者如何利用该漏洞。检查了PoC代码，并未发现显式恶意代码，比如反弹shell或植入后门。但是，该脚本依赖于网络连接，且能读取文件内容并输出，具有潜在的风险。例如，脚本可能会收集目标系统的部分信息，然后发送给攻击者。由于脚本需要被运行，本身风险较低，判定为10%。这个百分比反映了即便没有明显的后门，仍然存在一些风险，例如过度收集信息或意外的行为。

总的来说，该PoC的投毒风险较低，但用户应谨慎使用，并在隔离环境中运行。

**项目地址:** [Bamolitho/adminer_CVE-2021-43008](https://github.com/Bamolitho/adminer_CVE-2021-43008)

**漏洞详情:** [CVE-2021-43008](https://nvd.nist.gov/vuln/detail/CVE-2021-43008)