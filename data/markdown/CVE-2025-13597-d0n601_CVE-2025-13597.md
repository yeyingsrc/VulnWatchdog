## CVE-2025-13597-AI Feeds-任意文件上传

**漏洞编号:** CVE-2025-13597

**漏洞类型:** 任意文件上传

**影响应用:** AI Feeds WordPress plugin

**危害等级:** 高危，远程代码执行

**影响版本:** <= 1.0.11

**利用条件:** 目标WordPress站点安装了易受攻击的AI Feeds插件，并且插件目录可写。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于AI Feeds插件的`actualizador_git.php`文件中，该文件允许未经身份验证的攻击者通过GET请求下载任意GitHub仓库并覆盖插件文件，从而导致远程代码执行。利用方法是，攻击者可以创建一个包含恶意代码的GitHub仓库，然后使用提供的Python脚本指定目标URL、仓库所有者、仓库名称和GitHub Token，脚本将从GitHub下载该仓库并将其安装到WordPress插件目录中，攻击者可以通过访问上传的shell.php文件来执行任意命令。

**有效性：**
提供的POC代码有效，可以实现未经身份验证的任意文件上传和远程代码执行。

**投毒风险：**
虽然该漏洞利用方式本身是将用户提供的GitHub仓库下载到目标服务器，存在一定的投毒风险，具体分析如下：
*   **利用方式：** 攻击者需要提供GitHub仓库的owner和repo信息。攻击者可控repo的内容，可以上传任意文件。 
*   **风险点：**  攻击者可以上传包含恶意后门的PHP文件或其他可执行文件。
*   **缓解措施：**  建议用户在使用此POC时，仔细检查提供的GitHub仓库，确认其内容安全。
*   **投毒概率评估：** 考虑到攻击者需要精心构造包含恶意代码的GitHub仓库，并且需要目标用户信任该仓库，因此投毒的概率相对较低，约10%。这个概率预估基于需要创建一个恶意的repo, 诱导他人使用这个repo来进行攻击，存在一定难度。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的GitHub仓库，例如包含一个名为`shell.php`的webshell。
2.  攻击者使用提供的Python脚本，指定目标WordPress站点的URL、GitHub仓库的所有者、仓库名称和GitHub Personal Access Token（需要权限可以下载仓库代码）。
3.  脚本通过发送GET请求到`actualizador_git.php`文件，触发漏洞。
4.  `actualizador_git.php`文件从GitHub下载指定的仓库，并将其解压到WordPress插件目录`wp-content/plugins/ai-feeds/`下，覆盖原有的文件。
5.  攻击者可以通过访问上传的`shell.php`文件来执行任意命令，例如`http://target/wp-content/plugins/ai-feeds/shell.php?cmd=whoami`。

**项目地址:** [d0n601/CVE-2025-13597](https://github.com/d0n601/CVE-2025-13597)

**漏洞详情:** [CVE-2025-13597](https://nvd.nist.gov/vuln/detail/CVE-2025-13597)