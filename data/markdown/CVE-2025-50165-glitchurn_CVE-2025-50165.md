## CVE-2025-50165 - Windows Graphics Component Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-50165

**漏洞类型:** 远程代码执行

**影响应用:** Windows Graphics Component

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Server 2025 (Server Core installation), Windows 11 Version 24H2, Windows Server 2025版本10.0.26100.0到10.0.26100.4946（不包括）

**利用条件:** 需要受害者处理恶意JPEG图像文件，例如通过浏览器、邮件客户端或任何使用Windows API渲染JPEG图像的应用程序。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-50165是Windows Graphics Component中的一个远程代码执行漏洞，源于未受信任的指针解引用。攻击者可以通过构造恶意的JPEG图像文件，利用该漏洞在目标系统上执行任意代码。

**有效性:**

提供的POC代码看起来是有效的。它描述了利用JPEG图像文件中的恶意元数据段来触发未受信任的指针解引用的过程。通过堆喷射，攻击者可以将shellcode放置到可预测的内存位置，然后通过恶意段将指令指针指向shellcode，从而实现远程代码执行。

**投毒风险:**

虽然提供的POC包含免责声明，并声称用于安全研究，但仍然存在投毒风险。以下是一些考虑因素：

*   **外部链接:**  POC的Exploit部分提供了一个tinyurl链接，这增加了风险。虽然tinyurl可能只是为了缩短URL，但也可能指向恶意文件或重定向到恶意站点。在没有进一步分析的情况下，无法确定此链接的安全性。
*   **复杂性:**  图形图像处理漏洞的POC通常比较复杂。如果攻击者故意包含细微的错误或陷阱，则可能导致研究人员在分析或修改POC时意外引入漏洞或后门。
*   **shellcode:** 虽然利用代码中明确提到了反向shell，但是不能保证shellcode的安全性，有可能被加入恶意功能。

基于以上分析，我给出的投毒风险评估为20%。

**利用方式:**

利用方式如下：

1.  **攻击者设置监听器:** 攻击者使用`nc -lvnp 4444`等工具设置监听器，等待受害者机器的反向连接。
2.  **生成恶意JPEG图像:** 攻击者使用`generatepayload.py`脚本，指定攻击者的IP地址和端口，生成恶意`.jpg`文件（`exploit.jpg`）。
3.  **传递恶意JPEG图像:** 攻击者将`exploit.jpg`文件发送给受害者。传递方式包括但不限于：
    *   嵌入在网页中
    *   通过电子邮件发送
    *   放置在受害者可能浏览的共享文件夹中
4.  **触发漏洞:** 一旦受害者处理了`exploit.jpg`文件（例如，查看文件夹中的缩略图，使用图像查看器打开文件，或浏览包含该图像的网页），漏洞就会被触发。
5.  **获得反向shell:** 受害者机器连接到攻击者的监听器，攻击者获得一个反向shell，从而可以远程控制受害者机器。

**项目地址:** [glitchurn/CVE-2025-50165](https://github.com/glitchurn/CVE-2025-50165)

**漏洞详情:** [CVE-2025-50165](https://nvd.nist.gov/vuln/detail/CVE-2025-50165)