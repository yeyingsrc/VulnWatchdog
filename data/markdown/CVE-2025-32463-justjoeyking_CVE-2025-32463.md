## CVE-2025-32463-Sudo-权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463是Sudo版本1.9.17p1之前的漏洞，允许本地用户通过利用`--chroot`选项和用户可控的`/etc/nsswitch.conf`文件获取root权限。

**有效性评估：**

提供的POC代码似乎是有效的，其利用方式如下：

1.  **创建临时工作区：** 使用`mktemp`创建临时目录，并进入该目录。
2.  **创建恶意C库：** 创建一个名为`woot1337.c`的C文件，其中包含一个构造函数`woot1337`。该函数设置有效的用户和组ID为0（root），更改当前目录到根目录，并执行`/bin/bash`，从而获得root shell。
3.  **设置chroot环境：** 创建`woot/etc`和`libnss_`目录。创建`woot/etc/nsswitch.conf`文件，内容为`passwd: /woot1337`。将`/etc/group`复制到`woot/etc/`。这使得sudo在chroot环境中查找密码数据库时加载我们编译的恶意库。
4.  **编译恶意库：** 使用`gcc`编译`woot1337.c`为共享库`libnss_/woot1337.so.2`，并设置`woot1337`函数作为初始化函数。
5.  **触发root shell：** 使用`sudo -R woot /bin/true`命令，`-R woot`参数指定了chroot的根目录为`woot`。由于修改了chroot环境下的`/etc/nsswitch.conf`，sudo会尝试加载我们创建的恶意库，从而执行`woot1337`函数，最终获得root shell。

**投毒风险评估：**

根据提供的代码，没有明显的投毒风险。该脚本的目的明确，就是为了利用漏洞提升权限。脚本的行为可预测，并且没有发现任何恶意隐藏的代码。

**利用方式总结：**

该漏洞的利用方式是利用Sudo的`--chroot`选项，并结合用户可控的`/etc/nsswitch.conf`文件。通过创建恶意的nsswitch配置文件，Sudo在chroot环境下会加载用户提供的恶意库，导致任意代码执行，从而获取root权限。

**项目地址:** [justjoeyking/CVE-2025-32463](https://github.com/justjoeyking/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)