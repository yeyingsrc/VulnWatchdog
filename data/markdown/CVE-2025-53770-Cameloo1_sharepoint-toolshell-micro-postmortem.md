## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (16.0.0 < 16.0.18526.20508)

**利用条件:** 需要能够访问存在漏洞的 SharePoint 服务器，且服务器未打补丁或应用缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 远程代码执行漏洞，源于对不可信数据的反序列化。

**漏洞利用有效性：**
根据漏洞描述，此漏洞已被公开利用（Exploit exists in the wild），且CISA已将其添加到已知被利用的漏洞列表中。提供的 PoC 代码（README.md）描述了针对此漏洞的攻击流程，包括利用精心构造的反序列化数据来部署 webshell，进而可能导致远程代码执行。因此，利用 PoC 代码是有效的。

**投毒风险：**
PoC 代码主要提供了一个事件响应工具包，用于检测和分析针对 SharePoint 服务器的“ToolShell”攻击活动。虽然代码本身看起来是为了帮助安全分析人员进行检测和响应，但仍然存在一定的投毒风险：

1.  **攻击流程描述：** PoC 详细描述了攻击者可能使用的技术和工具，如果被恶意人员利用，可能加速漏洞攻击。
2.  **检测规则误报：** 提供的检测规则（如 KQL/SPL/Sigma 查询）可能存在误报，导致安全人员浪费时间和精力。

总体来看，此 PoC 的主要目的是为了防御，但如果使用不当，也可能被用于攻击或者产生误导。仓库作者署名为Cameloo1，如果作者存在恶意，投毒风险为10%。

**漏洞利用方式：**
漏洞利用的主要方式是：

1.  **利用公开漏洞：** 利用 SharePoint 服务器中存在的反序列化漏洞。
2.  **构造恶意数据：** 构造包含恶意代码的反序列化数据，通过 HTTP POST 请求发送到服务器。
3.  **部署 WebShell：** 成功利用漏洞后，在服务器上部署 WebShell，攻击者可以通过 WebShell 执行任意命令。
4.  **权限提升和横向移动：** 攻击者可能通过 WebShell 窃取凭据，进行权限提升和横向移动。

**缓解措施：**
Microsoft 建议应用此 CVE 文档中提供的缓解措施，并且微软正在准备和全面测试更新以解决此漏洞。

**项目地址:** [Cameloo1/sharepoint-toolshell-micro-postmortem](https://github.com/Cameloo1/sharepoint-toolshell-micro-postmortem)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)