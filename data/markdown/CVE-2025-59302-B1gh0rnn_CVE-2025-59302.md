## CVE-2025-59302 - Apache CloudStack Code Injection

**漏洞编号:** CVE-2025-59302

**漏洞类型:** 代码注入

**影响应用:** Apache CloudStack

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 4.18.0 <= version < 4.20.2, 4.21.0 <= version < 4.22.0

**利用条件:** 需要管理员权限访问CloudStack API，且js.interpretation.enabled未禁用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-59302是Apache CloudStack中的一个代码注入漏洞。该漏洞存在于以下仅管理员可访问的API中：quotaTariffCreate、quotaTariffUpdate、createSecondaryStorageSelector、updateSecondaryStorageSelector、updateHost和updateStorage。攻击者可以通过在这些API的参数中注入恶意代码（JavaScript表达式），在CloudStack服务器上执行任意代码。由于漏洞需要管理员权限，因此风险相对较低。漏洞利用的有效性取决于js.interpretation.enabled全局配置标志的状态。如果启用此标志，则漏洞可被利用。否则，JavaScript表达式将不会被解释，从而减轻了代码注入的风险。

提供的POC代码只是一个README.md文件，并没有实际的漏洞利用代码。因此，根据现有信息，无法判断其有效性。然而，漏洞库信息表明此漏洞是存在的并且可以被利用。

由于POC代码内容仅为README文件，未发现任何可疑的投毒代码。

漏洞的利用方式是通过具有管理员权限的用户，调用存在漏洞的API，并在API参数中插入恶意的JavaScript代码。例如，攻击者可以修改quotaTariffCreate API，将恶意JavaScript代码插入到与配额相关的参数中，当CloudStack处理此请求时，恶意代码将被执行。升级到4.20.2或4.22.0版本，或者禁用js.interpretation.enabled全局配置标志可以修复此漏洞。

**项目地址:** [B1gh0rnn/CVE-2025-59302](https://github.com/B1gh0rnn/CVE-2025-59302)

**漏洞详情:** [CVE-2025-59302](https://nvd.nist.gov/vuln/detail/CVE-2025-59302)