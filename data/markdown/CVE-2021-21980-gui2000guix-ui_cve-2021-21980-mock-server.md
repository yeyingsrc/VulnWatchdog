## CVE-2021-21980 - VMware vSphere Web Client 任意文件读取

**漏洞编号:** CVE-2021-21980

**漏洞类型:** 任意文件读取

**影响应用:** VMware vCenter Server and VMware Cloud Foundation

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** VMware vCenter Server (6.7 before 6.7 U3p and 6.5 before 6.5 U3r) and VMware Cloud Foundation 3.x

**利用条件:** 需要网络访问vCenter Server的443端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-21980是一个存在于vSphere Web Client（FLEX/Flash）中的未经授权的任意文件读取漏洞。具有vCenter Server 443端口网络访问权限的恶意攻击者可以利用此问题来获取对敏感信息的访问权限。

**漏洞利用有效性：**
提供的POC代码模拟了该漏洞。Dockerfile搭建了一个Flask应用，模拟了存在漏洞的vSphere Web Client。该应用接受一个名为'id'的参数，并通过`/eam/vib`路径处理文件读取请求。如果'id'参数中包含'..'和'/etc/passwd'或'passwd'，应用程序将尝试读取文件。POC代码包含一个`passwd-mock`文件来模拟`/etc/passwd`的内容，以便测试漏洞。

**投毒风险：**
该存储库的目的是提供一个用于测试CVE-2021-21980漏洞的环境。作者提供了Dockerfile、docker-compose.yml和一些脚本，可以轻松地构建和运行模拟服务器。没有发现任何明显的恶意代码或后门。所有提供的文件都用于重现漏洞，而不是进行恶意活动。因此，投毒风险较低，接近0%。

**漏洞利用方式：**
1.  攻击者需要具有对vCenter Server 443端口的网络访问权限。
2.  攻击者构造一个包含目录遍历序列（'..'）以及目标文件名的URL，例如`/eam/vib?id=../../../../../../../../../../etc/passwd`。
3.  vSphere Web Client在处理此请求时，由于未进行充分的输入验证，将读取目标文件（例如`/etc/passwd`）的内容并将其返回给攻击者。
4.  攻击者可以利用此漏洞读取其他敏感文件，例如配置文件、私钥等，从而获取对系统的进一步访问权限。

**项目地址:** [gui2000guix-ui/cve-2021-21980-mock-server](https://github.com/gui2000guix-ui/cve-2021-21980-mock-server)

**漏洞详情:** [CVE-2021-21980](https://nvd.nist.gov/vuln/detail/CVE-2021-21980)