## CVE-2024-25600 - WordPress Bricks Builder 远程代码执行

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WordPress Bricks Builder

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标站点运行受影响版本的Bricks Builder插件，且未打补丁。需要能够访问目标站点的网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600 是 WordPress Bricks Builder 插件中的一个远程代码执行漏洞。该漏洞存在于`render_element`函数中，由于对用户输入处理不当，允许未经身份验证的攻击者执行任意PHP代码。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于REST API端点`/wp-json/bricks/v1/render_element`或`/?rest_route=/bricks/v1/render_element`。
2.  **Nonce获取：** 利用代码首先尝试从目标网站的HTML源代码中提取nonce值。这是通过查找包含`bricks-scripts-js-extra` ID 的`<script>`标签，然后使用正则表达式从中提取nonce来实现的。
3.  **构造恶意请求：**  POC代码构造包含恶意PHP代码的JSON数据，并将其发送到漏洞端点。该JSON数据包含`postId`、`nonce`和`element`字段。`element`字段指定要利用的组件（`code`），并且`settings`字段包含要执行的PHP代码。恶意PHP代码使用`throw new Exception` 来执行命令，并利用异常处理来获取命令输出。
4.  **命令执行：**  服务器执行恶意PHP代码，并将命令输出包含在响应的HTML数据中。
5.  **交互式Shell：**  POC代码提供了一个交互式shell，允许攻击者执行任意命令。该shell使用户可以输入命令，这些命令被插入到恶意JSON数据中，并发送到目标服务器以进行执行。命令的输出显示在shell中。

**有效性评估：**

根据漏洞描述和提供的POC代码，该POC代码应该能够有效利用此漏洞。该POC已经进行了修改，简化了代码并提供直接的shell访问，增加了易用性。

**投毒风险评估：**

该POC代码主要功能是利用漏洞，但仍存在轻微的投毒风险，大约10%。风险点在于:

*   **依赖项安装：** 该POC代码依赖于`requests`, `beautifulsoup4`, `rich`, `prompt_toolkit`这些python库。如果攻击者控制了安装过程或篡改了安装源，则可能引入包含恶意代码的库。
*   **执行任意命令的风险：** POC本身旨在执行任意命令，但使用者可能会在不知情的情况下执行危险命令，从而对目标系统造成损害。
*   **后门植入的可能：** 虽然目前代码没有明显的后门，但是理论上，攻击者可以通过修改POC，在成功利用漏洞后植入后门，方便后续的控制和访问，但这种行为需要进一步的分析和确认。

**总结：**

CVE-2024-25600 是一个高危漏洞，允许未经身份验证的远程代码执行。提供的POC代码可以有效利用此漏洞。虽然存在一定的投毒风险，但主要集中在使用不安全的依赖项和使用者自身操作上，代码层面的投毒风险较低。

**项目地址:** [ranjithxploit/CVE-2024-25600](https://github.com/ranjithxploit/CVE-2024-25600)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)