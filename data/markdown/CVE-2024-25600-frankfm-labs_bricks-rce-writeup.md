## CVE-2024-25600-Bricks Builder-远程代码执行

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行

**影响应用:** Bricks Builder

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 需要目标安装了存在漏洞的Bricks Builder主题，并且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600是一个存在于WordPress Bricks Builder主题中的未经验证的远程代码执行漏洞。攻击者可以通过向漏洞REST API端点发送特制的请求，注入并执行任意PHP代码，从而获得服务器的控制权。

**有效性：**

根据漏洞库信息和提供的漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出这是一个未经身份验证的远程代码执行漏洞，且存在公开的利用代码。

**投毒风险：**

虽然README.md文件中没有直接显示投毒代码，但是考虑到以下几点，存在一定的投毒风险：

*   **私有仓库：** 提及"custom Python exploit（exploit code in private repo）"表明完整的利用代码不在公开的仓库中，这意味着我们无法完全审查利用代码的安全性。
*   **复杂利用：** 利用过程包含提取nonce、构造PHP代码等步骤，攻击者可能在这些环节中植入恶意代码，例如上传webshell，反弹shell，收集敏感信息等。
*   **其他步骤：** 利用描述中包含“Obtained shell access, created reverse shell and found a hidden `.txt` flag”，表明攻击者可以进一步操作系统，因此植入后门的可能性不能排除。

综合来看，虽然公开信息中没有明显的投毒代码，但是考虑到私有仓库和利用的复杂性，我给出的投毒风险为10%。

**利用方式：**

1.  **确定目标：** 确定目标网站是否使用了受影响版本的Bricks Builder主题。
2.  **提取Nonce：** 从目标网站的JavaScript代码中提取nonce值。这个值通常用于CSRF保护，但在漏洞利用中需要绕过或利用。
3.  **构造恶意请求：** 构造包含恶意PHP代码的请求，该请求会被发送到Bricks Builder主题中存在漏洞的REST API端点。通常，攻击者会利用PHP的`eval()`或`system()`等函数来执行任意命令。
4.  **发送请求：** 使用提取的nonce和构造的恶意请求，通过HTTP POST或其他方式发送到目标服务器。
5.  **执行代码：** 如果漏洞利用成功，目标服务器将执行攻击者注入的PHP代码。
6.  **获取Shell：** 通过执行系统命令，攻击者可以尝试获取反向shell或上传webshell，从而进一步控制服务器。
7. **权限提升和恶意行为:** 通过渗透测试信息知道，可以利用该漏洞来提取隐藏flag, 挖掘矿池信息，进一步溯源。

**项目地址:** [frankfm-labs/bricks-rce-writeup](https://github.com/frankfm-labs/bricks-rce-writeup)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)