## CVE-2018-10933-libssh-Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** 严重，允许未经授权的远程访问

**影响版本:** 0.7.0-0.7.5, 0.8.0-0.8.3

**利用条件:** 目标服务器运行受影响版本的libssh，并且启用了服务器端身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2018-10933存在于libssh服务器端的状态机中，在0.7.6和0.8.4之前的版本中。恶意客户端可以在未经身份验证的情况下创建通道，从而导致未经授权的访问。提供的Python漏洞利用代码通过以下步骤利用此漏洞：

1.  **建立连接：** 使用socket连接到目标主机的SSH端口。
2.  **启动传输：** 使用paramiko库启动SSH传输客户端。
3.  **伪造身份验证成功消息：** 构造一个伪造的`USERAUTH_SUCCESS`消息，并将其发送到服务器。这会欺骗服务器认为客户端已成功通过身份验证。
4.  **打开通道：** 在未经实际身份验证的情况下，打开一个SSH通道。
5.  **获取 PTY 和调用 Shell：** 获取伪终端（PTY）并调用一个shell，从而允许攻击者执行任意命令。
6.  **交互式 Shell：** 启动一个交互式shell，允许攻击者与目标系统进行交互。

该POC代码有效。因为漏洞的核心在于服务器端状态机的缺陷，允许在身份验证之前创建通道。攻击者发送伪造的`USERAUTH_SUCCESS`消息利用了这个缺陷。

**投毒风险分析：**
该POC代码本身不包含任何明显的恶意或后门代码。它直接利用了CVE-2018-10933漏洞，目的是绕过身份验证并获得对目标系统的访问权限。代码结构清晰，功能明确，没有发现任何隐藏或混淆的代码。

**利用方式：**
1.  确定目标服务器正在运行易受攻击的libssh版本。
2.  运行漏洞利用代码，提供目标主机的hostname和端口。
3.  漏洞利用代码将连接到目标服务器，发送伪造的身份验证成功消息，并打开一个交互式shell。
4.  攻击者现在可以使用此shell在目标系统上执行任意命令。

**项目地址:** [opsifiz/CVE-2018-10933](https://github.com/opsifiz/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)