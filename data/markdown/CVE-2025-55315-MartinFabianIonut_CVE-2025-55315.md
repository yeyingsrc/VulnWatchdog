## CVE-2025-55315 - ASP.NET Core HTTP Request Smuggling

**漏洞编号:** CVE-2025-55315

**漏洞类型:** HTTP Request Smuggling

**影响应用:** ASP.NET Core

**危害等级:** 高危，允许未经授权的攻击者绕过安全功能

**影响版本:** ASP.NET Core 8.0 (小于 8.0.21), 9.0 (小于 9.0.10), 2.3 (小于 2.3.6); Visual Studio 2022 (17.10.0 - 17.10.19, 17.12.0 - 17.12.12, 17.14.0 - 17.14.16)

**利用条件:** 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-55315 是一个 ASP.NET Core 中的 HTTP 请求走私漏洞。该漏洞源于 ASP.NET Core 对 HTTP 请求的不一致解释，允许授权的攻击者通过网络绕过安全功能。提供的漏洞利用代码包括一个 Python 代理（PythonProxy），该代理被设计为演示如何利用此漏洞。Docker 文件用于搭建易受攻击的 ASP.NET Core 应用程序和利用它的代理。 

**利用方式：**

1.  攻击者利用 PythonProxy 控制 Content-Length 和 Transfer-Encoding 标头，导致服务器对 HTTP 请求的边界产生歧义。
2.  通过精心构造的恶意请求，攻击者可以将后续请求“走私”到受害服务器，从而绕过安全策略或访问受保护的资源。
3.  漏洞利用代码中的 `proxy_server.py` 被配置为优先考虑 Content-Length 而不是 Transfer-Encoding, 这是一种可能导致请求走私的易受攻击的行为。

**有效性：**

提供的代码似乎是有效的漏洞利用 PoC。它包含必要的组件来设置易受攻击的环境（Unsafe API），一个利用代理（PythonProxy），以及一个用于测试负载均衡的代理（YARPProxy）。 `DOCKER.md` 文件详细说明了如何构建、运行以及与这些服务交互。

**投毒风险：**

虽然主要目的是演示漏洞，但是仍然存在一定的投毒风险：

*   **依赖风险：** 虽然没有直接在提供的代码段中发现恶意代码，但构建镜像依赖 Dockerfile，如果 Dockerfile 中使用了不安全的镜像源或者包含了额外的构建步骤，可能引入恶意软件或后门。
*   **代理服务器行为：** PythonProxy 代理服务器可以被修改以执行恶意操作，例如记录或修改流量。虽然当前的 PoC 专注于演示请求走私，但可以轻松扩展为执行其他恶意行为。
*   **供应链攻击：** 该项目使用 Docker 镜像，这些镜像本身可能容易受到供应链攻击。如果基础镜像受到损害，则所有派生镜像也会受到影响。

综上，虽然 PoC 的主要意图是演示漏洞，但考虑到 Docker 构建过程和 Python 代理服务器的灵活性，仍然存在约 10% 的投毒风险，需要进行进一步的安全审计。

**项目地址:** [MartinFabianIonut/CVE-2025-55315](https://github.com/MartinFabianIonut/CVE-2025-55315)

**漏洞详情:** [CVE-2025-55315](https://nvd.nist.gov/vuln/detail/CVE-2025-55315)