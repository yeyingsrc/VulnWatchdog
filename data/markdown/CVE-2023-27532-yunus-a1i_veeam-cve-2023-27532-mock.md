## CVE-2023-27532 - Veeam Backup & Replication 敏感信息泄露

**漏洞编号:** CVE-2023-27532

**漏洞类型:** 敏感信息泄露

**影响应用:** Veeam Backup & Replication

**危害等级:** 高危，可能导致备份基础设施被攻陷

**影响版本:** < v12 (build 12.0.0.1420 P20230223), < 11a (build 11.0.1.1261 P20230227)

**利用条件:** 需要网络访问 Veeam Backup & Replication 服务器，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27532 漏洞允许未授权的攻击者获取存储在 Veeam Backup & Replication 配置数据库中的加密凭据。攻击者可以通过访问特定的API端点（例如 /api/v1/BackupInfrastructure/managedServers 或 /api/configuration）获取这些凭据。这些加密凭据可以用于访问备份基础设施主机。

**漏洞利用有效性：**
提供的PoC代码模拟了一个易受攻击的 Veeam Backup & Replication 服务器。该服务器通过Flask框架搭建，模拟了返回加密凭据的API端点。攻击者可以通过发送GET请求到`/api/v1/BackupInfrastructure/managedServers`、`/api/configuration`或`/Backup/Configuration`来获取模拟的加密凭据。因此，PoC代码可以有效地演示漏洞并验证其存在。

**投毒风险：**
PoC代码主要用于模拟漏洞环境，风险较低。其中requirements.txt 安装的包 flask==2.3.3 版本较老，有可能包含一些已知的漏洞，但是该项目本身风险不高，主要是为了快速搭建模拟环境。模拟端口9392 9393 9394,增加了模拟真实环境的可能，但本身并不是恶意代码。

**漏洞利用方式：**
1.  攻击者向目标 Veeam Backup & Replication 服务器发送未经身份验证的HTTP GET请求到特定的API端点。
2.  服务器返回包含加密凭据的JSON响应。
3.  攻击者利用获取的加密凭据来访问和控制备份基础设施主机。

**项目地址:** [yunus-a1i/veeam-cve-2023-27532-mock](https://github.com/yunus-a1i/veeam-cve-2023-27532-mock)

**漏洞详情:** [CVE-2023-27532](https://nvd.nist.gov/vuln/detail/CVE-2023-27532)