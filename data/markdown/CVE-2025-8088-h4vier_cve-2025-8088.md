## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 需要用户交互，解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是 WinRAR 中存在的路径遍历漏洞。攻击者可以构造恶意的压缩文件，其中包含精心设计的路径，利用 WinRAR 解压时的路径处理缺陷，将恶意 payload 写入到任意位置，例如 Windows 的启动目录，从而实现开机自启动并执行恶意代码。POC 代码中利用了 ADS（NTFS 备用数据流）来隐藏 payload，并修改了 RAR 头部结构以实现路径注入，最后重新计算 CRC 值以保证压缩包的完整性。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用方法是有效的。POC 包含了生成恶意压缩包的 Python 脚本，并通过构造特定的目录结构，将 payload 放置在启动目录，实现任意代码执行。

**投毒风险：**
POC 代码主要包含以下文件：
*   README.md：描述漏洞利用方式和工具的使用方法。
*   config.py：配置文件，用于配置 payload 路径和内容。
*   main.py：主程序，用于生成恶意压缩包。
*   extract.py：文件主要用于和目标建立链接，用于密钥交换，不属于漏洞利用的主要代码

其中 `config.py` 文件中定义了 `PAYLOAD` 变量，用于指定要执行的恶意代码。如果攻击者修改了 `PAYLOAD` 变量，将其指向恶意的可执行文件或脚本，则可能导致受害者执行攻击者预设的恶意操作。

`extract.py` 文件存在部分网络请求代码，请求的目标由`TARGET_HOST, TARGET_PORT`决定，如果攻击者修改了`TARGET_HOST, TARGET_PORT` ,可能导致隐私数据泄露，因此判定存在10%的投毒风险

**利用方式：**
1.  攻击者首先需要创建一个恶意的 RAR 压缩文件。这个压缩文件中包含一个经过特殊构造的文件路径，该路径利用路径遍历漏洞，指向 Windows 的启动目录。
2.  压缩包中还包含一个 payload 文件，该文件是要执行的恶意代码，例如一个 bat 脚本或一个可执行文件。
3.  攻击者将恶意 RAR 文件发送给受害者。
4.  受害者使用受影响版本的 WinRAR 解压该 RAR 文件。
5.  WinRAR 在解压过程中，由于路径遍历漏洞，会将 payload 文件写入到 Windows 的启动目录。
6.  当受害者下次启动计算机时，payload 文件会自动执行，从而导致攻击者控制受害者的计算机。

**项目地址:** [h4vier/cve-2025-8088](https://github.com/h4vier/cve-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)