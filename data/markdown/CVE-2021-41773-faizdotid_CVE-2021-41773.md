## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行 (如果CGI脚本启用)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，以及未对外部目录进行 "require all denied" 保护。如果aliased的路径启用了CGI脚本，则可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录中的文件未受到 "require all denied" 配置的保护，则请求可能会成功。如果目标服务器同时启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

该漏洞的利用方式是通过构造包含特殊字符（如 `%2e` 和 `/`）的恶意 URL，以绕过 Apache HTTP Server 的路径规范化机制。POC代码 `main.py` 通过遍历预定义的 base 路径（`/cgi-bin`, `/assets`, `/icons`）和 payloads （包含多层 `%2e` 编码的 `../`）来尝试访问 `/etc/passwd` 文件。如果服务器存在漏洞且配置不当，攻击者将能够读取到 `/etc/passwd` 的内容，验证方式是通过检查返回内容中是否包含 `root:x:0:0:root` 字符串。

**有效性评估：**

提供的 POC 代码 `main.py` 旨在检测 CVE-2021-41773 漏洞。该脚本通过发送构造好的 HTTP 请求来尝试读取 `/etc/passwd` 文件，如果成功读取，则认为目标存在漏洞。该POC代码根据漏洞描述来看是有效的。

**投毒风险评估：**

在查看了提供的 `main.py` 文件的内容后，没有发现任何明显的恶意代码或后门。该脚本的主要功能是发送 HTTP 请求并检查响应，这符合路径遍历漏洞检测的预期行为。代码中也没有发现任何可疑的网络连接或文件操作。因此，投毒风险评估为 0%。

**项目地址:** [faizdotid/CVE-2021-41773](https://github.com/faizdotid/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)