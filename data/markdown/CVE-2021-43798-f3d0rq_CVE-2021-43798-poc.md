## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，允许未经身份验证的攻击者读取服务器上的任意文件

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** Grafana实例运行在受影响的版本，且可以通过网络访问/public/plugins/ 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的/public/plugins/<plugin_id>路径下，由于对plugin_id参数处理不当，导致目录遍历漏洞。攻击者可以通过构造包含`..%2F`的payload，读取服务器上的任意文件，例如/etc/passwd或者Grafana的数据库文件grafana.db。提供的POC代码通过发送包含目录遍历payload的HTTP GET请求到目标Grafana服务器，检查响应状态码和内容，判断是否存在漏洞。代码从url.txt读取目标URL，多线程并发执行检测，并将存在漏洞的URL保存到hit.txt。未发现明显的投毒代码。

**项目地址:** [f3d0rq/CVE-2021-43798-poc](https://github.com/f3d0rq/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)