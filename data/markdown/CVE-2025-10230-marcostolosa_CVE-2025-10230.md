## CVE-2025-10230-Samba-WINS 命令注入

**漏洞编号:** CVE-2025-10230

**漏洞类型:** 命令注入

**影响应用:** Samba

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 4.21.0 <= version < 4.21.9, 4.22.0 <= version < 4.21.5, 4.23.0 <= version < 4.23.2

**利用条件:** 目标系统开启WINS服务，攻击者位于与Samba服务器相同的网络或可以访问WINS服务端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-10230 存在于 Samba 的 WINS 服务钩子脚本中，由于对 WINS 注册数据包中的 NetBIOS 名称处理不当，未经身份验证的攻击者可以通过构造恶意的 NetBIOS 名称，将其注入到由 Samba AD 域控制器的 WINS 钩子执行的 shell 命令中，实现远程代码执行。

**有效性评估：**
漏洞库信息显示存在PoC，尽管未直接提供，但严重性评级为Critical，以及关于漏洞细节的描述，表明漏洞利用是可行的。

**投毒风险：**
提供的文件是 React + Vite 项目的模板，与 Samba 的 WINS 命令注入漏洞无关。这意味着这些文件可能是一个诱饵，真正的恶意代码可能隐藏在其他地方，或者根本不存在。由于这些文件主要是前端代码，与后端漏洞的利用无关，因此投毒的可能性较低，估计为10%。

**利用方式：**
1.  攻击者需要与运行 Samba 且启用 WINS 服务的服务器位于同一网络，或者可以访问 WINS 服务端口。
2.  攻击者构造包含恶意命令的 NetBIOS 名称的 WINS 注册数据包。
3.  当 Samba 服务器接收到此数据包时，会将恶意 NetBIOS 名称插入到 shell 命令中。
4.  由于缺乏适当的验证和转义，恶意命令会被执行，导致远程代码执行。

**项目地址:** [marcostolosa/CVE-2025-10230](https://github.com/marcostolosa/CVE-2025-10230)

**漏洞详情:** [CVE-2025-10230](https://nvd.nist.gov/vuln/detail/CVE-2025-10230)