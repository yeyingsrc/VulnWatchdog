## CVE-2021-4462 - Employee Records System v1.0 Arbitrary File Upload RCE

**漏洞编号:** CVE-2021-4462

**漏洞类型:** 任意文件上传

**影响应用:** Employee Records System

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.0

**利用条件:** 无需身份验证，需要网络访问 uploadID.php 页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-4462 是 Employee Records System 1.0 版本中的一个未经授权的文件上传漏洞。攻击者可以通过向 uploadID.php 端点上传恶意文件来利用此漏洞，由于应用程序没有执行适当的服务器端验证，上传的文件可以被执行，从而实现远程代码执行。

**漏洞利用有效性：**

提供的 Dockerfile、docker-compose.yml 和其他脚本旨在创建一个可复现漏洞的测试环境。README.md 文件提供了详细的设置和使用说明，包括如何下载源代码、启动环境和使用 Nuclei 进行测试。Nuclei 是一个漏洞扫描工具，其提供的 YAML 文件针对此 CVE 漏洞，能够验证漏洞的存在。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

此仓库的主要目的是为了复现和测试 CVE-2021-4462 漏洞，代码中存在潜在的后门或者恶意代码的可能性较低。以下为分析结果：

*   **Dockerfile：** Dockerfile 用于构建包含易受攻击应用程序的环境。其中没有发现明显的恶意命令。虽然它安装了 MySQL 客户端，但这对于数据库初始化和访问是必要的。
*   **docker-compose.yml：** docker-compose 文件用于定义和运行多容器 Docker 应用程序。它配置了 MySQL 和 Employee Records System 应用程序。没有检测到任何可疑配置。
*   **init-db.sh：** init-db.sh 脚本用于初始化 MySQL 数据库。它检查 SQL 文件是否存在并将其导入到数据库中。SQL 文件的位置（/docker-entrypoint-initdb.d/database/sharp_db.sql 或 /docker-entrypoint-initdb.d/database file/sharp_db.sql）需要注意，如果从不可信的源获取了 SQL 文件，则可能存在风险。 但是整体只是初始化数据库的操作,恶意风险较低
*   **README.md：** README 文件提供了有关设置和使用测试环境的说明。要求用户从 SourceCodester 下载源代码，这是一个潜在的风险点，因为下载的源代码本身可能包含恶意代码。由于需要用户手动下载，所以风险降低.

总体而言，该存储库的目的是为了漏洞复现和测试，投毒的可能性较低，为5%。主要的风险在于从 SourceCodester 下载的源代码是否被篡改过。如果从其他未知来源下载了该源代码，那么存储库的投毒风险会增加。

**漏洞利用方式：**

1.  **未经身份验证的文件上传：** 攻击者无需登录即可访问 uploadID.php 页面。
2.  **上传恶意文件：** 攻击者可以上传包含恶意代码的文件，例如 PHP webshell。
3.  **绕过服务器端验证：** 由于应用程序没有进行适当的服务器端验证，因此攻击者可以绕过文件类型限制，上传任意类型的文件。
4.  **远程代码执行：** 上传的恶意文件被服务器执行，从而允许攻击者在服务器上执行任意命令。

**项目地址:** [Pranjal6955/CVE-2021-4462](https://github.com/Pranjal6955/CVE-2021-4462)

**漏洞详情:** [CVE-2021-4462](https://nvd.nist.gov/vuln/detail/CVE-2021-4462)