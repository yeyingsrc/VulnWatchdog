## CVE-2025-13595 - CIBELES AI 未授权任意文件上传

**漏洞编号:** CVE-2025-13595

**漏洞类型:** 任意文件上传

**影响应用:** CIBELES AI WordPress 插件

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.10.8

**利用条件:** 目标服务器运行 WordPress，安装了 CIBELES AI 插件，且目标主机可以访问互联网。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-13595 漏洞存在于 CIBELES AI WordPress 插件的 `actualizador_git.php` 文件中。该文件未进行任何身份验证或授权检查，允许未经身份验证的攻击者直接通过 HTTP 访问，下载任意 GitHub 存储库并覆盖插件文件，从而导致远程代码执行。

**有效性分析：**

提供的 POC 代码 `CVE-2025-13595.py` 利用了 `actualizador_git.php` 文件的漏洞，通过指定 GitHub 仓库的所有者、仓库名称、分支以及 GitHub Token，将指定仓库的内容下载并覆盖到 CIBELES AI 插件目录下。攻击者可以通过创建一个包含恶意 PHP 代码的 GitHub 仓库，例如上传一个 `shell.php` 文件，然后利用此漏洞将其部署到目标服务器上，从而实现远程代码执行。

`README.md` 文件中给出的示例也验证了 POC 的有效性。

**投毒风险分析：**

该漏洞利用的本质是通过未授权的文件覆盖来实现的。攻击者控制了要上传的 GitHub 仓库，因此存在一定的投毒风险。

*   **直接投毒：** 攻击者可以在自己控制的 GitHub 仓库中放置恶意代码，例如后门程序、恶意脚本等。当目标服务器执行被覆盖的文件时，恶意代码就会被执行，从而导致服务器被入侵。
*   **供应链投毒：** 如果攻击者能够控制或篡改 CIBELES AI 插件官方使用的 GitHub 仓库，那么攻击者就可以直接向插件中注入恶意代码，从而影响所有使用该插件的 WordPress 网站。

评估投毒风险为10%原因如下，该POC的主要目的是通过上传webshell到目标站点,从而控制目标站点, 恶意代码的注入依赖于攻击者使用的GitHub仓库,因此存在一定的投毒风险。

**利用方式：**

1.  **查找目标：** 找到安装了 CIBELES AI 插件，且插件版本低于或等于 1.10.8 的 WordPress 网站。
2.  **准备恶意代码：** 创建一个包含恶意 PHP 代码的 GitHub 仓库，例如 `shell.php`。
3.  **利用 POC：** 使用 `CVE-2025-13595.py` 脚本，指定目标 URL、GitHub 仓库的所有者、仓库名称、GitHub Token，以及要执行的命令。
4.  **远程代码执行：** 成功上传恶意代码后，通过访问 `shell.php` 文件，并传递 `cmd` 参数来执行任意命令。

**项目地址:** [d0n601/CVE-2025-13595](https://github.com/d0n601/CVE-2025-13595)

**漏洞详情:** [CVE-2025-13595](https://nvd.nist.gov/vuln/detail/CVE-2025-13595)