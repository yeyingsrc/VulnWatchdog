## CVE-2025-8088 WinRAR路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-8088 是 WinRAR Windows 版本中的一个路径遍历漏洞。攻击者可以通过构造恶意 RAR 压缩包，利用路径遍历将可执行文件放置到 Windows 启动文件夹中，从而实现任意代码执行。

**漏洞利用方式：**

1.  攻击者创建一个恶意的 RAR 压缩包。
2.  该压缩包包含一个或多个利用路径遍历的恶意文件。这些文件包含相对路径，例如 `..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`。
3.  当用户使用存在漏洞的 WinRAR 版本解压此压缩包时，恶意文件将被解压到目标路径，即 Windows 启动文件夹。
4.  `payload.bat` 文件在系统启动时执行，从而执行攻击者的恶意代码。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于生成利用此漏洞的恶意 RAR 压缩包。脚本的主要功能包括：

1.  **创建诱饵文件：**  创建看似无害的诱饵文件，以欺骗用户。
2.  **嵌入 Payload：**  将恶意 payload 嵌入到压缩包中，利用多层路径遍历和 ADS (Alternate Data Streams) 将其放置到启动文件夹。
3.  **修改压缩包结构：**  修改 RAR 压缩包的结构，以实现路径遍历。
4.  **CRC 校验：**  重新计算 CRC 值，以保证压缩包的完整性。
5.  **输出恶意压缩包：**  将生成的恶意压缩包保存到输出文件夹中。

**投毒风险分析：**

该POC本身就是一个利用代码。 仔细阅读代码，发现`extract.py`文件存在潜在风险，虽然文件命名为`extract.py`，但实际功能更像是用来做服务端交互，包含了发送和接收数据包，并且与`TARGET_HOST`和`TARGET_PORT`进行通信，这部分代码逻辑与 WinRAR 路径遍历漏洞的利用没有直接关系。存在作者通过该部分代码搜集使用者信息，或进行其他恶意行为的可能性。但是，由于缺乏完整的代码上下文（例如 `TARGET_HOST` 和 `TARGET_PORT` 的定义，`keys.txt`文件内容，以及服务端的具体功能），目前还不能确认具体的恶意行为，因此判定投毒风险为 20%。

**项目地址:** [4daysday/cve-2025-8088](https://github.com/4daysday/cve-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)