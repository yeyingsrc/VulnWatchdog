## CVE-2021-3129 - Laravel Ignition Remote Code Execution

**漏洞编号:** CVE-2021-3129

**漏洞类型:** 远程代码执行

**影响应用:** Laravel (使用 Ignition)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Ignition < 2.5.2, Laravel < 8.4.2 (debug mode enabled)

**利用条件:** 目标网站使用 Laravel 且开启了 debug 模式，并使用了受影响版本的 Ignition。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3129 漏洞存在于 Laravel 的 Ignition 组件中，该组件在 debug 模式下使用。攻击者可以利用 `file_get_contents()` 和 `file_put_contents()` 函数的不安全使用来执行任意代码。利用过程通常涉及发送特制的 HTTP 请求到易受攻击的端点，如 `/ignition/execute-solution`。漏洞利用代码通过扫描多个已知端点来判断是否存在未授权访问，如果存在则尝试利用。 存在投毒风险，虽然代码主要是漏洞扫描，但如果作者在结果输出部分添加恶意代码，或者篡改请求部分，则可能存在投毒风险。

**有效性：** 根据漏洞库信息和现有的漏洞利用代码，该漏洞是真实存在的，并且有可用的利用方式。CISA KEV 将该漏洞列为已知被利用的漏洞，也佐证了其有效性。

**利用方式：**

1.  **前提条件：** Laravel 应用程序必须启用 debug 模式，并且使用易受攻击的 Ignition 版本。
2.  **攻击步骤：** 攻击者发送特制的 HTTP 请求到特定的 Ignition 端点（例如 `/ignition/execute-solution`） ，请求中包含恶意 PHP 代码。
3.  **代码执行：** Ignition 组件会执行请求中包含的 PHP 代码，导致远程代码执行。

**投毒风险分析：**

给定的Python脚本主要是扫描目标是否存在该漏洞，本身不具备明显的投毒特征，但是仍然存在一定的投毒风险，例如：

*   **结果篡改：** 脚本可能会在扫描结果中插入虚假信息，误导用户认为某个站点存在漏洞，实际上并不存在。
*   **恶意下载：** 脚本可能会尝试下载并执行额外的恶意代码。
*   **信息收集：** 脚本可能会收集目标站点的信息（例如，服务器版本、操作系统等），并将这些信息发送给攻击者。
*   **后门植入：** 扫描过程中，脚本如果具备写入权限，可能写入后门
考虑到代码的整体结构，以及其主要功能是漏洞扫描而非攻击，投毒的概率较低，估计为10%。主要的风险点在于作者可能在扫描逻辑中插入恶意步骤，或者在扫描结果的处理中进行投毒。

**项目地址:** [GodOfServer/CVE-2021-3129](https://github.com/GodOfServer/CVE-2021-3129)

**漏洞详情:** [CVE-2021-3129](https://nvd.nist.gov/vuln/detail/CVE-2021-3129)