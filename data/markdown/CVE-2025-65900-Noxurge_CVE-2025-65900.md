## CVE-2025-65900: Kalmia CMS v0.2.0 - Incorrect Access Control

**漏洞编号:** CVE-2025-65900

**漏洞类型:** Incorrect Access Control

**影响应用:** Kalmia CMS

**危害等级:** 高危，可导致敏感信息泄露和账户完全控制

**影响版本:** 0.2.0

**利用条件:** 需要一个低权限（只读）的用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-65900 存在于 Kalmia CMS v0.2.0 版本中，是一个不正确的访问控制漏洞。攻击者利用一个具备只读权限的合法用户，通过访问 `/kal-api/auth/users` API 端点，可以获取所有用户的敏感信息，包括 Blowfish 加密的密码哈希。攻击者可以使用 Hashcat 等密码破解工具离线破解这些密码，一旦破解成功，就能完全控制用户账户，包括管理员账户。利用步骤包括：

1.  使用只读权限用户登录系统。
2.  利用Burp Suite等工具访问 `/kal-api/auth/users` API接口。
3.  提取所有用户的密码哈希。
4.  使用 Hashcat 等工具破解密码哈希。
5.  使用破解后的密码登录系统，完全控制用户账户。

提供的 Python 脚本 `cve-2025-65900.py` 可以自动化此过程。

**有效性：**

提供的 PoC 代码有效，因为它能够利用只读权限用户获取所有用户的密码哈希，从而导致潜在的账户完全控制。

**投毒风险：**

PoC代码本身看起来比较直接，用于获取JWT token和用户数据。投毒风险较低，评估为1%。主要风险点可能在于通过URL访问目标系统，如果URL被篡改，可能导致访问到恶意站点。或者依赖的第三方库被投毒。检查脚本，未发现明显的恶意代码，但考虑到代码需要执行网络请求，存在潜在的风险。

**利用方式：**

1.  攻击者需要一个只读权限的 Kalmia CMS 用户账户。
2.  运行 `cve-2025-65900.py` 脚本，提供目标 URL、用户名和密码。
3.  脚本会自动获取 JWT token，访问 `/kal-api/auth/users` 端点，并提取所有用户的密码哈希。
4.  攻击者可以使用密码破解工具（如 Hashcat）离线破解这些哈希。
5.  破解成功后，攻击者可以使用破解的密码登录系统，获取用户权限。

**项目地址:** [Noxurge/CVE-2025-65900](https://github.com/Noxurge/CVE-2025-65900)

**漏洞详情:** [CVE-2025-65900](https://nvd.nist.gov/vuln/detail/CVE-2025-65900)