## CVE-2025-43504 - Xcode debugserver 远程预认证缓冲区溢出

**漏洞编号:** CVE-2025-43504

**漏洞类型:** 缓冲区溢出

**影响应用:** Xcode debugserver

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 26.1

**利用条件:** 需要位于特权网络位置，能够连接到目标设备的 debugserver

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-43504 存在于 Xcode 的 debugserver 中，允许未经身份验证的远程攻击者通过发送特制的 `qSpeedTest` 数据包来触发缓冲区溢出，导致拒绝服务。漏洞位于`RNBRemote::HandlePacket_qSpeedTest`函数中，该函数处理`qSpeedTest:response_size:<hex>;`数据包。攻击者可以控制`response_size`的值，该值用于`memset`函数，从而导致`g_data`缓冲区溢出。虽然攻击者可以控制溢出的长度，但填充内容固定为 'a' 字符，这限制了漏洞的利用，使得利用难度增大，通常只能导致拒绝服务。

**利用方式：**

1.  攻击者需要位于与目标设备相同的网络，或者能够通过网络访问目标设备上的 debugserver。
2.  攻击者向 debugserver 发送一个 `qSpeedTest:response_size:<hex>;` 数据包，其中 `<hex>` 是一个十六进制数，表示要溢出的字节数。该值可以超过`g_data`缓冲区的大小（4 * 1024 * 1024 + 16）。
3.  `RNBRemote::HandlePacket_qSpeedTest` 函数接收到数据包后，将 `<hex>` 转换为整数，并使用该整数作为 `memset` 函数的长度参数。
4.  `memset` 函数将 'a' 字符写入 `g_data` 缓冲区，直到达到指定的长度，从而导致缓冲区溢出。
5.  缓冲区溢出可能导致 debugserver 崩溃，从而导致拒绝服务。

**投毒风险分析：**

提供的漏洞利用代码主要是一个 README.md 文件，用于解释漏洞原理和利用方法，并提供了一个可以复现漏洞的commit ID。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。 但是，该仓库如果被黑客控制，替换成了带后门的llvm项目，则存在投毒风险。因此，投毒风险评估为10%。实际使用时，需要仔细检查clone的llvm项目git commit id,确认是否和官方代码一致。

**项目地址:** [calysteon/CVE-2025-43504](https://github.com/calysteon/CVE-2025-43504)

**漏洞详情:** [CVE-2025-43504](https://nvd.nist.gov/vuln/detail/CVE-2025-43504)