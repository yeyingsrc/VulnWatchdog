## CVE-2018-17254-Joomla JCK Editor-SQL注入

**漏洞编号:** CVE-2018-17254

**漏洞类型:** SQL注入

**影响应用:** Joomla JCK Editor

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 6.4.4

**利用条件:** 需要Joomla JCK Editor 6.4.4组件存在，且目标服务器允许外部访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Joomla JCK Editor 6.4.4版本的`/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php`文件中，通过`parent`参数进行SQL注入。攻击者可以构造恶意的SQL语句，利用`UNION SELECT`语句获取数据库敏感信息，甚至可能通过`INTO OUTFILE`写入webshell（虽然可能性较低，受限于权限和配置）。

**有效性分析：**
提供的POC代码针对CVE-2018-17254，代码完整，包含漏洞验证、数据库信息提取、数据导出以及尝试RCE的功能。代码通过构造特殊的URL参数利用SQL注入漏洞。`is_vulnerable`函数用于验证漏洞是否存在，`get_db_names`、`get_table_names`、`get_column_names`和`dump_columns`函数用于提取数据库信息。`rce`函数尝试写入webshell。

**投毒风险分析：**
代码本身主要功能是利用SQL注入漏洞。但依旧存在一定的风险:
1.  **依赖外部资源：** POC代码使用了`curl`函数，如果目标服务器没有安装或配置`curl`，可能会导致脚本无法正常运行。这本身不属于投毒，但会影响利用的成功率。
2.  **RCE尝试的潜在风险：** `rce`函数尝试写入webshell，虽然成功几率不高，但如果成功写入，会导致非常严重的后果。这可以视为一种潜在的风险。
3.  **代码审计难度**：虽然代码总体思路清晰，但是代码中存在变量名不规范、缺乏注释的情况，一定程度上会增加代码审计难度。
4. **代理设置:** 代码中存在`#curl_setopt($ch, CURLOPT_PROXY, "127.0.0.1:8080");`注释，这意味着作者可能在开发过程中使用了代理，这暗示着payload可能需要特定环境才能触发，具有一定的隐蔽性，可能通过修改代理地址，将payload发到恶意服务器，具有一定的风险。

**利用方式总结：**
1.  **漏洞验证：** 使用`is_vulnerable`函数检测目标是否存在漏洞。
2.  **数据库信息提取：** 使用`get_db_names`函数获取数据库名，然后使用`get_table_names`函数获取表名，最后使用`get_column_names`函数获取列名。
3.  **数据导出：** 使用`dump_columns`函数导出指定表的数据。
4.  **RCE（尝试）：** 使用`rce`函数尝试写入webshell，但成功率较低。
总的来说，该POC代码的有效性较高，能够成功利用SQL注入漏洞获取数据库信息。投毒风险较低，主要是利用RCE的尝试行为可能带来潜在风险。建议在使用该POC代码前进行仔细的代码审计，确保其安全性。

**项目地址:** [Nickguitar/Joomla-JCK-Editor-6.4.4-SQL-Injection](https://github.com/Nickguitar/Joomla-JCK-Editor-6.4.4-SQL-Injection)

**漏洞详情:** [CVE-2018-17254](https://nvd.nist.gov/vuln/detail/CVE-2018-17254)