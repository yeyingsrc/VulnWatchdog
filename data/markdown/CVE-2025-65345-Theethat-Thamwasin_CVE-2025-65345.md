## CVE-2025-65345 - laravel-file-manager Authenticated Path Traversal

**漏洞编号:** CVE-2025-65345

**漏洞类型:** 路径遍历

**影响应用:** laravel-file-manager

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** <= 3.3.1

**利用条件:** 需要有效的用户凭据和访问laravel-file-manager的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于laravel-file-manager的zip/archiving功能中。经过身份验证的攻击者可以利用路径遍历漏洞，通过构造包含目录遍历序列（如../）的ZIP请求，访问和下载服务器上的任意文件。POC利用方式如下：

1.  使用有效用户凭据登录laravel-file-manager。
2.  在文件管理器GUI中选择一个文件或文件夹。
3.  使用zip功能压缩所选文件。
4.  使用Burp Suite等工具拦截HTTP请求。
5.  修改请求中的目录参数，插入路径遍历payload，例如`../../../../../var/www`或`/etc/passwd`。
6.  触发ZIP创建，后端会解析路径并创建包含外部文件的ZIP文件。
7.  下载生成的ZIP文件，其中包含服务器上的敏感文件，如.env配置文件，SSH密钥，或者其他应用程序的敏感信息。

该POC的投毒风险较低，主要风险在于用户如果未仔细审查代码，直接在生产环境中使用，可能会导致意外的文件系统访问，但从代码本身看，不存在明显的恶意代码。

**项目地址:** [Theethat-Thamwasin/CVE-2025-65345](https://github.com/Theethat-Thamwasin/CVE-2025-65345)

**漏洞详情:** [CVE-2025-65345](https://nvd.nist.gov/vuln/detail/CVE-2025-65345)