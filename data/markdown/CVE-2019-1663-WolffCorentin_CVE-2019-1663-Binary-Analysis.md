## CVE-2019-1663 Cisco RV系列路由器远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W 路由器

**危害等级:** 高危，可导致完全控制受影响设备

**影响版本:** RV110W < 1.2.2.1, RV130W < 1.0.3.45, RV215W < 1.3.1.1

**利用条件:** 目标设备开启web管理界面，且漏洞版本存在

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-1663漏洞存在于Cisco RV110W、RV130W和RV215W路由器的web管理界面中，由于未能正确验证用户提交的数据，未经身份验证的远程攻击者可以通过发送恶意HTTP请求，以高权限用户身份在受影响设备的底层操作系统上执行任意代码。利用方式通常涉及构造包含恶意payload的HTTP请求，其中payload利用`strcpy`函数的缓冲区溢出漏洞。漏洞利用代码分析显示，该漏洞是由于在`Login`函数中不当使用`strcpy`造成的缓冲区溢出。`strcpy`函数没有检查源字符串的大小，允许覆盖相邻的内存区域。远程利用需要访问路由器的web配置服务器，如果服务器未暴露在WAN上，则利用仅限于LAN访问。攻击者拦截并修改请求，附加恶意payload，例如`&enc=1&user=cisco&pwd=AAAA...AAAAZZZZ&sel_lang=EN`。POC代码中的`exploit.py`脚本创建了payload，涉及计算偏移量、libc基址、system地址和gadget地址，以执行任意命令。虽然`README.md`文件对漏洞进行了分析，`exploit.py`提供了exp，但是为了防止恶意用户恶意使用，需要进行漏洞修复或者及时更新， 漏洞投毒风险较低，为5%。

**项目地址:** [WolffCorentin/CVE-2019-1663-Binary-Analysis](https://github.com/WolffCorentin/CVE-2019-1663-Binary-Analysis)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)