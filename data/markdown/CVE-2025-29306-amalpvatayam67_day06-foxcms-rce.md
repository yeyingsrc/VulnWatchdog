## CVE-2025-29306-FoxCMS-RCE

**漏洞编号:** CVE-2025-29306

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** FoxCMS

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 1.2.5

**利用条件:** 需要目标服务器开启了FoxCMS服务，且可以通过HTTP访问到存在漏洞的 `index.php` 页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-29306 存在于 FoxCMS v.1.2.5 中，允许远程攻击者通过 `index.html` 组件中的 case display 页面执行任意代码。提供的漏洞利用代码模拟了该漏洞的核心思想：通过 `unserialize()` 函数处理攻击者可控的输入，从而导致远程代码执行。

**有效性：**
POC 代码是有效的。`exploit.sh` 脚本通过构造一个序列化的 PHP 字符串，该字符串包含 `system('cat /opt/flag.txt')` 代码，并将其作为 URL 参数 `id` 传递给 `index.php`。 `index.php` 页面接收到 URL 参数后，对其进行 `urldecode()` 解码，然后通过 `unserialize()` 函数反序列化。如果反序列化成功并且结果是字符串，则使用 `eval()` 函数执行该字符串，从而执行 `system('cat /opt/flag.txt')` 命令，读取 `/opt/flag.txt` 文件内容（即flag）。

**投毒风险：**
该仓库的投毒风险为 0%。 代码库内容看起来是用于教育目的的漏洞演示，目的是重现 `unserialize()` 函数利用的场景。`Dockerfile` 文件只是构建一个包含易受攻击代码的环境。 `entrypoint.sh` 脚本负责生成一个随机 flag 并启动 Apache 服务器。 `exploit.sh` 脚本演示了如何利用该漏洞读取 flag。没有发现任何隐藏的恶意代码。

**利用方式：**
1.  攻击者构造恶意的 PHP 序列化字符串，该字符串包含要执行的 PHP 代码。
2.  攻击者将该序列化字符串进行 URL 编码，并通过 GET 请求的 `id` 参数传递给 `index.php` 页面。
3.  `index.php` 页面接收 `id` 参数，使用 `urldecode()` 进行解码，然后使用 `unserialize()` 函数进行反序列化。
4.  如果反序列化成功并且结果是字符串，则使用 `eval()` 函数执行该字符串，从而实现远程代码执行。

**项目地址:** [amalpvatayam67/day06-foxcms-rce](https://github.com/amalpvatayam67/day06-foxcms-rce)

**漏洞详情:** [CVE-2025-29306](https://nvd.nist.gov/vuln/detail/CVE-2025-29306)