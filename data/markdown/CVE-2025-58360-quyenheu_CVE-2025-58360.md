## CVE-2025-58360-GeoServer-XXE

**漏洞编号:** CVE-2025-58360

**漏洞类型:** XXE

**影响应用:** GeoServer

**危害等级:** 高危，可能导致敏感信息泄露和拒绝服务攻击

**影响版本:** >= 2.26.0, < 2.26.2 和 < 2.25.6

**利用条件:** GeoServer服务对外开放，攻击者可以访问/geoserver/wms endpoint

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于GeoServer的WMS GetMap功能中。攻击者可以通过构造包含恶意外部实体引用的XML请求，读取服务器上的敏感文件（如/etc/passwd）或者发起对外请求。

**有效性分析：**
提供的POC代码利用了XXE漏洞，通过向`/geoserver/wms` endpoint发送包含恶意XML数据的POST请求，尝试读取`/etc/passwd`文件。如果响应中包含`root:`字符串，则判断漏洞存在。代码使用`requests`库发送请求，并包含必要的headers和cookies。根据漏洞描述，POC代码对于受影响的GeoServer版本是有效的。

**投毒风险分析：**
分析提供的POC代码和相关文件，未发现明显的恶意代码或后门。`CVE-2025-58360.py`文件是一个简单的Python脚本，用于发送包含XXE payload的HTTP POST请求。`README.md`文件提供了漏洞的简要描述和利用方法，以及一张POC演示图片。`payload.xml`文件包含一个简单的XXE payload，用于发起对外HTTP请求，尝试访问`http://10.63.150.228:8000`。综合判断，该仓库中不存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的XML请求。例如，可以使用以下payload读取`/etc/passwd`文件：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE StyledLayerDescriptor [
 <!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<StyledLayerDescriptor version="1.0.0">
<NamedLayer><Name>&xxe;</Name></NamedLayer>
</StyledLayerDescriptor>
```

2.  攻击者将构造的XML数据作为POST请求的body发送到GeoServer的`/geoserver/wms` endpoint。

3.  GeoServer解析XML数据时，会尝试解析外部实体引用，从而导致XXE漏洞。

4.  攻击者可以根据响应内容判断漏洞是否成功利用。如果成功利用，攻击者可以读取服务器上的敏感文件，或者发起对外HTTP请求。

**项目地址:** [quyenheu/CVE-2025-58360](https://github.com/quyenheu/CVE-2025-58360)

**漏洞详情:** [CVE-2025-58360](https://nvd.nist.gov/vuln/detail/CVE-2025-58360)