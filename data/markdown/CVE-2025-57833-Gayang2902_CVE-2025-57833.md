## CVE-2025-57833-Django-SQL注入

**漏洞编号:** CVE-2025-57833

**漏洞类型:** SQL注入

**影响应用:** Django

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.2 < 4.2.24, 5.1 < 5.1.12, 5.2 < 5.2.6

**利用条件:** 需要目标系统存在受影响版本的Django应用，且存在可利用的`search_field`接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-57833 是 Django 框架中的一个 SQL 注入漏洞，影响 4.2.x、5.1.x 和 5.2.x 版本。该漏洞位于 FilteredRelation 中，通过构造恶意的 column aliases，利用字典扩展的方式作为 **kwargs 传递给 QuerySet.annotate() 或 QuerySet.alias()，可以实现 SQL 注入。

**有效性分析：**

提供的 exploit.py 脚本尝试利用此漏洞进行远程代码执行。它向目标 URL 的 `/api/search/` 端点发送 POST 请求，其中包含一个 `search_field` 参数，该参数的值为精心构造的 SQL 注入 payload。该 payload 旨在执行反向 shell，连接到攻击者的 IP 地址和端口。

**投毒风险分析：**

代码中存在少量投毒风险，主要体现在以下几点：

*   **requirements.txt:**  `requirements.txt` 文件包含了一些常见的 Django 依赖项。虽然这些依赖项本身没有明显的恶意代码，但如果攻击者能够控制此文件，他们可以引入存在已知漏洞的旧版本库，或者引入名称相似但包含恶意代码的“撞库”库。这是一个潜在的投毒向量，但相对概率较低，因为这是一个常见的文件且容易被检测。 *   **DB 配置:** 配置文件 `cve_2025_57833/cve_2025_57833/settings.py` 设置了数据库连接信息，如果攻击者修改这个文件，则可能会引导用户连向恶意的数据库，这有一定风险。

综合来看，投毒风险较低（5%）。主要风险在于攻击者利用反向shell获取服务器控制权。 

**利用方式：**

1.  确定目标系统上运行着受影响版本的 Django 应用。
2.  确定存在可利用的 `/api/search/` 接口（或其他使用了 `FilteredRelation` 和 `annotate/alias` 的接口）。
3.  修改 `exploit.py` 脚本中的 `attacker_ip` 和 `attacker_port` 变量，将其设置为攻击者的 IP 地址和监听端口。
4.  运行 `exploit.py` 脚本，将恶意 SQL 注入 payload 发送到目标系统。
5.  如果漏洞利用成功，目标系统将执行反向 shell，攻击者可以在攻击者的机器上监听指定端口，从而获得对目标系统的控制权。

**项目地址:** [Gayang2902/CVE-2025-57833](https://github.com/Gayang2902/CVE-2025-57833)

**漏洞详情:** [CVE-2025-57833](https://nvd.nist.gov/vuln/detail/CVE-2025-57833)