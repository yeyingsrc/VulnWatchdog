## CVE-2025-50165-Windows Graphics Component-远程代码执行

**漏洞编号:** CVE-2025-50165

**漏洞类型:** 远程代码执行

**影响应用:** Windows Graphics Component

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** Windows Server 2025 (10.0.26100.0 <= version < 10.0.26100.4946), Windows 11 Version 24H2 (10.0.26100.0 <= version < 10.0.26100.4946)

**利用条件:** 需要目标系统处理恶意构造的JPEG图像文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

漏洞 CVE-2025-50165 存在于 Windows Graphics Component 中，属于一个Untrusted Pointer Dereference漏洞。攻击者可以利用此漏洞，通过发送特制的JPEG图像文件，在目标系统上执行任意代码。POC代码显示，该漏洞可以通过生成一个恶意的`.jpg`文件来触发，该文件在被处理时会触发漏洞，允许攻击者通过heap spraying将shellcode注入到可预测的内存地址，最终实现远程代码执行。攻击向量包括Web浏览器、电子邮件客户端以及任何使用 Windows API 渲染 JPEG 图像的应用程序。 

**有效性：** 提供的POC代码通过构造恶意的JPEG图像触发漏洞，利用heap spraying技术在目标系统上执行任意代码，因此判断POC代码有效。

**投毒风险：** 评估投毒风险较低（约为10%）。 虽然代码托管在外部链接，存在一定的风险，但是代码的自述文件内容详细的描述了漏洞原理，利用方法以及免责声明。而且提供了作者联系方式，降低了投毒风险。

**利用方式：**
1.  攻击者首先需要设置一个监听器，以便接收反向shell。
2.  然后，攻击者使用 `generatepayload.py` 脚本生成包含恶意代码的JPEG图像文件 (`exploit.jpg`)，需要指定攻击者的IP地址和端口。
3.  攻击者需要将此文件传递给受害者，可以通过多种方式，例如，通过电子邮件发送，将其放置在网页上，或者利用其他任何允许文件传输的方式。
4.  一旦受害者打开或预览此文件，Windows Graphics Component就会尝试渲染该图像，触发漏洞，从而执行攻击者嵌入的shellcode。
5.  攻击者从而在监听器上获得受害系统的控制权限。

**项目地址:** [crashnests/CVE-2025-50165](https://github.com/crashnests/CVE-2025-50165)

**漏洞详情:** [CVE-2025-50165](https://nvd.nist.gov/vuln/detail/CVE-2025-50165)