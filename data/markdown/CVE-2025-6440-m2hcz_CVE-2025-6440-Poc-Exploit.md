## CVE-2025-6440-WooCommerce Designer Pro-未授权任意文件上传

**漏洞编号:** CVE-2025-6440

**漏洞类型:** 未授权任意文件上传

**影响应用:** WooCommerce Designer Pro

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.26

**利用条件:** 目标网站安装了WooCommerce Designer Pro插件且版本小于等于1.9.26，且/wp-admin/admin-ajax.php可访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6440是WooCommerce Designer Pro插件中的一个未授权任意文件上传漏洞。攻击者可以通过向/wp-admin/admin-ajax.php发送包含恶意PHP代码的文件上传请求，利用`wcdp_save_canvas_design_ajax`函数中缺失的文件类型验证机制，将恶意文件上传到服务器上。成功上传后，攻击者可以通过访问上传的文件来执行任意代码，从而控制整个网站。

**有效性：**

根据漏洞库信息和提供的漏洞利用代码（README.md），该漏洞的POC是有效的。漏洞库信息明确指出`wcdp_save_canvas_design_ajax`函数存在文件类型验证缺失，允许未经验证的攻击者上传任意文件。漏洞利用代码详细说明了如何构造包含PHP shell的multipart/form-data请求，并将其发送到/wp-admin/admin-ajax.php。

**投毒风险：**

漏洞利用代码（README.md）本身只包含漏洞的描述、利用方法和示例代码。其中“shell.php”示例代码为一段简单的命令执行代码。没有发现明显的恶意或隐藏代码。requirements.txt中requests、urllib3、rich均为常见的python库，没有发现异常。
虽然不能完全排除作者在其他地方（如`exploit.py`中，但未提供代码）隐藏恶意代码的可能性，但仅从现有信息来看，投毒的可能性较低，估计为1%。建议下载后阅读`exploit.py`，确认代码安全性。

**利用方式：**

1.  **漏洞发现/确认：** 检测目标网站是否安装了受影响版本的WooCommerce Designer Pro插件。可以通过检查插件版本或尝试访问特定的CSS文件进行确认。
2.  **构造恶意请求：**  构造一个multipart/form-data POST请求，将其发送到/wp-admin/admin-ajax.php。请求应包含以下参数：
    *   `action`:  设置为`wcdp_save_canvas_design_ajax`。
    *   `params`:  包含`mode`, `editor`, `uniq`, `files`等信息的JSON字符串，其中`files`数组包含文件名和扩展名等信息。
    *   `file1`:  包含恶意PHP代码的payload，例如一个简单的webshell。
3.  **上传恶意文件：**  发送构造好的请求到目标服务器。
4.  **远程代码执行：**  如果上传成功，可以通过访问上传的PHP文件来执行任意代码。漏洞利用代码中提供了一个预测文件路径的方案，通常位于`/wp-content/uploads/wcdp-uploads/temp/[uniq]/shell.php`，可以尝试访问该路径。
5.  **持久化（可选）：**  为了长期控制目标服务器，攻击者可以尝试上传一个更复杂的webshell或后门程序。

**项目地址:** [m2hcz/CVE-2025-6440-Poc-Exploit](https://github.com/m2hcz/CVE-2025-6440-Poc-Exploit)

**漏洞详情:** [CVE-2025-6440](https://nvd.nist.gov/vuln/detail/CVE-2025-6440)