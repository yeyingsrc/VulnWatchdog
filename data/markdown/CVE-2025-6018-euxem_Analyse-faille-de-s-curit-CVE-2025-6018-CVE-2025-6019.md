## CVE-2025-6018-pam-config 本地权限提升

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地权限提升

**影响应用:** pam-config

**危害等级:** 高危，允许本地未授权用户提升权限

**影响版本:** < 1.1.8-24.71.1

**利用条件:** 需要本地用户权限（例如通过SSH登录）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和提供的POC代码，该漏洞是一个PAM配置相关的本地权限提升漏洞(LPE)。

**有效性：**

提供的Vagrantfile配置了一个易受攻击的环境，使用了openSUSE-Leap-15.6镜像，并通过`zypper`安装特定版本的`polkit`和`udisks2`软件包以复现漏洞环境。它还创建了一个普通用户`etudiant`。这表明POC代码旨在验证漏洞，并提供了一个可重复的环境来演示漏洞利用。

**投毒风险：**

查看Vagrantfile中的shell provision脚本，主要执行以下操作：

1.  更新系统软件包。
2.  安装特定版本的`polkit`和`udisks2`。
3.  创建一个名为`etudiant`的用户。
4.  启用并启动SSH服务。

该脚本没有发现任何恶意或隐藏的命令，例如下载并执行未知脚本、修改系统关键文件等。因此，投毒风险较低，可以认为投毒的可能性为0%。Vagrantfile的主要目的是配置一个包含漏洞的环境，而不是执行恶意操作。

**利用方式：**

根据漏洞描述，攻击者可以利用此漏洞获得`allow_active`用户的权限，从而执行通常仅限于物理控制台用户的Polkit操作。具体利用方式取决于受影响系统上的Polkit策略和配置，但通常涉及以下步骤：

1.  利用`pam-config`中的漏洞获得`allow_active`权限。
2.  使用`pkexec`或其他Polkit授权机制执行需要`allow_active`权限的操作。

由于没有完整的漏洞利用代码，无法提供具体的利用步骤，但整体思路是利用该漏洞绕过Polkit的访问控制，从而提升权限。

**项目地址:** [euxem/Analyse-faille-de-s-curit-CVE-2025-6018-CVE-2025-6019](https://github.com/euxem/Analyse-faille-de-s-curit-CVE-2025-6018-CVE-2025-6019)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)