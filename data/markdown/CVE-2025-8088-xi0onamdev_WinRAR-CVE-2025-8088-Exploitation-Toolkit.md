## CVE-2025-8088 WinRAR Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 需要用户交互，打开恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-8088是WinRAR的一个路径遍历漏洞。攻击者可以构造恶意的RAR压缩包，利用`..\`进行目录穿越，将恶意文件写入到任意位置，例如启动文件夹，从而实现开机自启动并执行恶意代码。

**有效性评估：**

提供的漏洞利用代码包含一个图形界面`gui.py`，以及漏洞利用核心代码`exploit_core.py`。从代码的结构和描述来看，该POC的有效性较高。

1.  **利用方式：**
    *   利用NTFS的ADS (Alternate Data Streams)隐藏payload，提高隐蔽性。
    *   修改RAR5的header，插入路径遍历字符`..\`。
    *   将恶意程序写入到Windows启动目录，实现持久化。

2.  **投毒风险：**

    代码中存在一定的潜在风险，需要进一步分析。

    *   `exploit_core.py`中包含了创建恶意压缩包的核心逻辑，包括ADS注入、RAR header修改等，这些操作本身没有明显的投毒行为。
    *   `gui.py`未提供，但其行为可能涉及恶意代码的静默执行，例如在生成恶意RAR包时，在后台执行某些操作，或者在受害者机器上执行后门程序。因此，`gui.py`部分存在潜在的风险，但无法确认，需要进一步检查。
    *   `_run`函数使用`shell=True`执行命令，可能存在命令注入的风险，但由于该函数用于WinRAR的命令行操作，相对可控。
    *   默认情况下，payload被写入`Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`目录，如果用户权限较高，可能导致更大的危害。
    *   代码存在WinRAR路径硬编码，可能在一些特殊环境下失效。但如果`WinRAR CLI`不在系统path或默认位置，可能导致工具失效，而非投毒。因此，这个更多是可靠性问题。

考虑到以上因素，判断此仓库中存在作者隐藏的投毒代码的可能性为20%。主要风险在于未提供的`gui.py`脚本以及可能被滥用的`_run`函数，需要人工审查才能确认是否包含恶意逻辑。


**项目地址:** [xi0onamdev/WinRAR-CVE-2025-8088-Exploitation-Toolkit](https://github.com/xi0onamdev/WinRAR-CVE-2025-8088-Exploitation-Toolkit)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)