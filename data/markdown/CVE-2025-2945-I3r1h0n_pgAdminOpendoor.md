## CVE-2025-2945-pgAdmin4-远程代码执行

**漏洞编号:** CVE-2025-2945

**漏洞类型:** 远程代码执行

**影响应用:** pgAdmin 4

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** < 9.2

**利用条件:** 需要有效的pgAdmin登录凭据和网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2945是pgAdmin 4中的一个远程代码执行漏洞，存在于Query Tool和Cloud Deployment模块中。

**有效性：**

提供的POC代码利用了`sqleditor/query_tool/download`和`/cloud/deploy`两个POST端点，这两个端点的`query_commited`和`high_availability`参数会被不安全地传递给Python的`eval()`函数，从而允许执行任意代码。从漏洞库信息和POC代码来看，利用是可行的。

**投毒风险：**

代码仓库中存在一定的投毒风险，可能性为10%。风险点主要存在于exploit/src/main.py代码不完整，存在故意截断，如果攻击者没有注意到，可能造成shell无法成功反弹，从而浪费时间。此外，虽然docker-compose.yaml和初始化脚本本身看起来是安全的，但攻击者可能在配置（例如.env文件，需要手动修改）中误导受害者，或者在真实攻击中提供修改后的恶意配置。

**利用方式：**

1.  **获取pgAdmin访问权限：** 攻击者需要有效的pgAdmin登录凭据。
2.  **构造恶意请求：** 攻击者构造包含恶意Python代码的POST请求，将恶意代码注入到`query_commited`（针对`/sqleditor/query_tool/download`端点）或`high_availability`（针对`/cloud/deploy`端点）参数中。
3.  **执行代码：** pgAdmin后端在处理请求时，会使用`eval()`函数执行注入的恶意代码，从而实现远程代码执行。
4.  **反弹Shell：** 恶意代码通常用于反弹shell，从而使攻击者能够完全控制服务器。
5. 按照README文件提供的操作步骤设置环境，修改config.toml配置，运行攻击脚本，发起攻击。

**项目地址:** [I3r1h0n/pgAdminOpendoor](https://github.com/I3r1h0n/pgAdminOpendoor)

**漏洞详情:** [CVE-2025-2945](https://nvd.nist.gov/vuln/detail/CVE-2025-2945)