## CVE-2019-1663 - Cisco RV系列路由器远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W 路由器

**危害等级:** 高危，允许未授权的远程攻击者以高权限执行任意代码。

**影响版本:** RV110W Wireless-N VPN Firewall < 1.2.2.1
RV130W Wireless-N Multifunction VPN Router < 1.0.3.45
RV215W Wireless-N VPN Router < 1.3.1.1

**利用条件:** 目标设备需要开启web管理界面，且版本低于受影响版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2019-1663 是 Cisco RV110W, RV130W, 和 RV215W 路由器web管理界面中存在的一个远程命令执行漏洞。该漏洞是由于对用户提供的web管理界面的数据验证不充分造成的。攻击者可以通过向目标设备发送恶意 HTTP 请求来利用此漏洞。成功利用此漏洞可能允许攻击者以高权限用户身份在受影响设备的底层操作系统上执行任意代码。

漏洞利用代码分析：

提供的代码段看起来是从 `Base_httpd` 和 `Pseudo_httpd` 二进制文件中提取的反编译代码。`FUN_0002bf64` 函数很可能与用户认证过程相关。它接收用户名 (`param_1`)、`param_2` (可能是密码或加密后的密码) 和 `param_3` (可能包含加密信息)。 函数的功能涉及密码验证和会话管理，通过对提交的用户凭据(`acStack150`, `acStack350`, `acStack450`)与设备配置和会话信息进行对比来决定认证结果。

从提供的代码片段本身无法直接确认如何进行命令注入。但是根据漏洞描述信息,可以推测该漏洞可能存在于对用户输入数据 (例如用户名或密码) 的处理过程中，比如某些参数可能存在缓冲区溢出或命令注入点，从而允许攻击者在系统上执行任意命令。

**有效性评估：**

根据漏洞库信息，此漏洞是可利用的，并且已经有公开的漏洞利用代码 (exploit-db 和 packetstormsecurity)。提供的反编译代码片段涉及用户身份验证和会话管理，这暗示了攻击者可能通过操控这些过程来利用漏洞。

**投毒风险分析：**

提供的代码片段看起来是从二进制文件中提取的，而不是完整的、可执行的漏洞利用脚本。因此，直接在此代码中植入后门的可能性较低。但是，如果攻击者通过篡改固件或者修改 `Base_httpd` 文件，则可能会存在投毒风险。由于无法确定代码的完整性以及代码仓库的来源，我们认为存在 10% 的投毒风险。

**利用方式：**

1.  **确定目标设备：**  识别运行存在漏洞的 Cisco RV110W、RV130W 或 RV215W 路由器。确认设备的固件版本低于受影响的版本。
2.  **发送恶意 HTTP 请求：**  构造包含恶意负载的 HTTP 请求，目标是web管理界面。这些恶意负载可能会利用输入验证漏洞，例如，缓冲区溢出或者命令注入。
3.  **执行任意代码：**  如果成功利用漏洞，攻击者可以在目标设备上以高权限执行任意代码。常见的利用方法包括执行 shell 命令来添加后门、修改设备配置或窃取敏感信息。

搜索引擎结果中提供的链接（如果存在）可能包含更具体的利用方法和 payload 示例。

**项目地址:** [StealYourCode/CVE-2019-1663](https://github.com/StealYourCode/CVE-2019-1663)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)