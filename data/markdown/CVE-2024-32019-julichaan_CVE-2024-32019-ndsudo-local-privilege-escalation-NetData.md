## CVE-2024-32019-Netdata-本地权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** Netdata

**危害等级:** 高危，允许低权限用户以root权限执行任意命令

**影响版本:** >= 1.45.0, < 1.45.3 和 >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统安装了存在漏洞版本的Netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是Netdata中的一个本地权限提升漏洞。`ndsudo`工具以root权限运行，但其搜索路径由`PATH`环境变量控制。攻击者可以通过创建一个恶意的可执行文件，并将其路径添加到`PATH`环境变量中，从而欺骗`ndsudo`执行该恶意文件，最终以root权限执行任意命令。

**漏洞利用方式：**
1.  找到存在漏洞的`ndsudo`工具的路径。
2.  创建一个恶意的可执行文件，例如名为`nvme-list`的shell脚本，内容为提升权限的命令 (`/bin/sh -p`)。
3.  将当前工作目录添加到`PATH`环境变量中，确保恶意文件优先于系统中的同名文件被搜索到。
4.  执行`ndsudo`命令，触发漏洞，从而以root权限执行恶意代码。
5.  清理恶意文件。

**有效性：**
提供的POC代码有效，它模拟了上述攻击流程，可以成功提升权限。

**投毒风险：**
经过分析，该POC代码本身没有明显的投毒代码。它只包含用于利用漏洞的代码和清理操作。因此，投毒风险为0%。

**项目地址:** [julichaan/CVE-2024-32019-ndsudo-local-privilege-escalation-NetData](https://github.com/julichaan/CVE-2024-32019-ndsudo-local-privilege-escalation-NetData)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)