## CVE-2025-4658-OPKSSH-Authentication Bypass

**漏洞编号:** CVE-2025-4658

**漏洞类型:** Authentication Bypass

**影响应用:** OPKSSH

**危害等级:** 高危，允许未授权访问系统

**影响版本:** < 0.5.0

**利用条件:** 需要能够与OPKSSH服务器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-4658 是 OPKSSH 中由于依赖的 OpenPubkey 库存在的签名验证绕过漏洞。攻击者可以利用特制的 JWS 绕过签名验证，从而绕过身份验证并访问系统。

**漏洞利用有效性:**

根据漏洞库信息，OpenPubkey 库的 0.10.0 之前的版本存在此漏洞，影响 OPKSSH 0.5.0 之前的版本。漏洞利用代码 `cve_2025_4658_pentest.py` 旨在测试此漏洞。代码逻辑看起来合理，首先创建一个测试用户 `cvetest`，然后生成 RSA 密钥对并将公钥添加到该用户的 `authorized_keys` 文件中。此脚本的目的是模拟攻击者在不知道私钥的情况下尝试使用无效签名进行身份验证，因为受影响版本的 OPKSSH 没有正确验证签名，该脚本尝试利用此行为。

**投毒风险分析:**

Dockerfile 用于构建包含存在漏洞的 Dropbear 版本和测试脚本的 Docker 镜像。该脚本 `cve_2025_4658_pentest.py` 本身旨在验证漏洞，而不是植入后门。但是，Dockerfile 中包含 `GITHUB_TOKEN_BASE64` 和 `GITHUB_USERNAME` 变量用于克隆 Dropbear 仓库。虽然这本身不是恶意行为，但如果这些凭据泄露，则可能被滥用。此外,该Dockerfile执行 `curl -LsSf https://astral.sh/uv/install.sh | sh`直接从网络执行脚本. 存在一定的供应链风险。

该漏洞利用代码的主要目的是利用漏洞而不是植入恶意代码，因此投毒风险较低。风险主要集中在供应链安全上，以及潜在的凭据泄露，但没有直接的代码表明作者有意添加后门。

综合考量，投毒风险估计为5%。该风险主要源于Dockerfile构建过程中使用的外部资源。

**漏洞利用方式:**

1.  攻击者需要能够与运行 OPKSSH 的服务器建立网络连接。
2.  OPKSSH 服务器必须使用受影响的 OpenPubkey 库版本（低于 0.10.0）。
3.  攻击者创建一个特制的 JWS，该 JWS 将绕过签名验证。
4.  攻击者尝试使用此 JWS 进行身份验证。由于签名验证存在漏洞，因此身份验证成功，允许攻击者访问系统。

**项目地址:** [stuxbench/dropbear-cve-2025-4658](https://github.com/stuxbench/dropbear-cve-2025-4658)

**漏洞详情:** [CVE-2025-4658](https://nvd.nist.gov/vuln/detail/CVE-2025-4658)