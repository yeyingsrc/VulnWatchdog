## CVE-2025-9435 - ADManager Plus Elevation of Privilege

**漏洞编号:** CVE-2025-9435

**漏洞类型:** 权限提升

**影响应用:** ADManager Plus

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** < 7230

**利用条件:** 需要 Technician 用户权限和 ADManager Plus 服务运行

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-9435 存在于 ADManager Plus Build 小于 7230 的版本中。一个具有默认 `Modify User General Properties` 角色的 technician 用户可以将权限提升到服务帐户（如果 ADManager 作为服务安装）或者以提升的权限运行 ADManager 的用户帐户。 

**有效性：**
提供的 PoC 代码看起来有效。它详细描述了利用该漏洞的步骤，包括：
1.  使用 Technician 用户登录。
2.  修改用户属性，特别是 Home 目录配置，并使用 BurpSuite 截取请求。
3.  通过修改 `homeDirectory` 参数，创建一个位于 `C:\Program Files\ManageEngine\ADManager Plus\jre\lib\ext` 下的 `amd64` 目录。
4.  利用 Technician 用户对新建目录的完全控制权限，上传恶意的 DLL 文件 (sunmscapi.dll 或 sunec.dll)。
5.  重启 ADManager Plus 服务，导致恶意的 DLL 文件被加载执行，从而获得反向 shell。

**投毒风险：**
该 PoC 代码本身主要展示了如何利用漏洞，直接包含恶意后门代码的可能性较低。PoC描述了如何创建恶意 DLL 并利用该漏洞部署执行。虽然存在恶意 DLL 本身来自不可信源的可能性，但PoC本身包含的投毒代码的概率较低。这里的风险在于使用者自己创建的 DLL 是否可信。因此，投毒风险较低，估计为 5%。

**利用方式：**
1.  攻击者首先需要获得一个具有特定权限（`Modify User General Properties`）的 Technician 用户的凭据。
2.  利用 Home 目录配置功能，结合 BurpSuite 等工具，修改请求，创建一个特定的目录结构。
3.  利用对该目录的写权限，上传恶意的 DLL 文件。
4.  通过重启 ADManager Plus 服务，触发 DLL 加载，执行恶意代码，从而获得更高的权限。

**项目地址:** [passtheticket/CVE-2025-9435](https://github.com/passtheticket/CVE-2025-9435)

**漏洞详情:** [CVE-2025-9435](https://nvd.nist.gov/vuln/detail/CVE-2025-9435)