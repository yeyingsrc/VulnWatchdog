## CVE-2018-17254-Joomla JCK Editor-SQL注入

**漏洞编号:** CVE-2018-17254

**漏洞类型:** SQL注入

**影响应用:** Joomla JCK Editor

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 6.4.4

**利用条件:** JCK Editor 组件版本为6.4.4，目标Joomla网站存在此组件且允许远程访问/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-17254是Joomla JCK Editor 6.4.4版本中的一个SQL注入漏洞，存在于`/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php`文件的`parent`参数中。攻击者可以通过构造恶意的SQL语句，利用UNION注入来获取数据库中的敏感信息，甚至可以写入webshell执行任意代码（需要满足数据库用户具有写入权限）。

**有效性分析：**

提供的漏洞利用代码（CVE-2018-17254.php）通过构造特定的URL，在`parent`参数中注入SQL语句。代码通过`UNION SELECT`语句来读取数据库版本、数据库名、表名、列名，甚至尝试写入webshell。

`is_vulnerable()`函数用于检测目标是否易受攻击，通过注入`0x6861636b6564`（即"hacked"的十六进制表示）来验证是否存在SQL注入漏洞。

**投毒风险分析：**

该POC代码主要功能是SQL注入，用于信息泄露和代码执行（通过写入webshell）。没有明显的恶意代码或后门植入行为，但存在以下风险:

1.  **依赖外部资源:** 利用代码使用了`curl`库发送HTTP请求。如果`curl`库本身存在漏洞，或者攻击者控制了`curl`的配置，就可能存在安全风险。
2.  **代码可修改性:** 攻击者可以修改POC代码，例如修改写入webshell的路径、内容，或者添加其他的恶意功能。
3.  **RCE的潜在风险:** 虽然webshell写入的成功率不高，但如果成功，则会带来极高的风险。

基于上述分析，我们认为该POC代码的投毒风险较低，大约为10%。主要的风险在于代码的可修改性和潜在的RCE风险。

**利用方式总结：**

1.  **检测漏洞：** 使用`is_vulnerable()`函数检测目标是否存在SQL注入漏洞。
2.  **信息收集：** 使用`get_db_names()`、`get_table_names()`、`get_column_names()`函数来获取数据库名、表名、列名等信息。
3.  **数据提取：** 使用`dump_columns()`函数来提取数据库中的数据。
4.  **尝试RCE：** 使用`rce()`函数尝试写入webshell，执行任意代码。该方法依赖于数据库用户的权限以及数据库配置。

攻击者可以根据实际情况，选择合适的利用方式，例如仅提取敏感数据，或者尝试写入webshell来获取服务器的控制权。

**项目地址:** [MataKucing-OFC/CVE-2018-17254](https://github.com/MataKucing-OFC/CVE-2018-17254)

**漏洞详情:** [CVE-2018-17254](https://nvd.nist.gov/vuln/detail/CVE-2018-17254)