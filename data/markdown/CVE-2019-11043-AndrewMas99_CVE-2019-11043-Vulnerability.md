## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** NGINX + PHP-FPM 特定配置，PATH_INFO 未充分验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个影响 PHP-FPM 的缓冲区溢出漏洞。在特定的 NGINX + PHP-FPM 配置中，由于 PHP-FPM 对 PATH_INFO 的处理不当，攻击者可以通过构造畸形的请求，造成缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞存在可利用的PoC，并且在真实环境中已经观察到利用。

**投毒风险：**

虽然提供的代码仓库主要用于演示漏洞利用和持久化，但仍存在潜在的投毒风险。分析显示, `README.md` 文件是代码仓库里主要内容, 该文件描述了漏洞详情和利用方法,但是缺乏实际可以运行的利用代码,存在一定误导使用者认为可以快捷使用的可能性。攻击者可能通过修改 `README.md` 的指令，引导用户下载恶意文件，或者执行非预期的操作。因此，虽然主要目的是漏洞演示，但不能完全排除作者有意或无意引入投毒代码的风险。投毒风险评估为 10%。

**利用方式：**

1.  **漏洞触发：** 攻击者构造包含特定格式的 URL，利用 PHP-FPM 对 PATH_INFO 的处理缺陷，触发缓冲区溢出。
2.  **溢出覆盖：** 通过溢出，覆盖 FCGI 协议数据，篡改 FPM 的行为。
3.  **代码执行：** 篡改后的 FCGI 数据可以被用来执行任意代码，例如，执行系统命令，植入后门等。
4.  **持久化：** 漏洞利用代码中提到了使用反向隧道进行持久化访问，攻击者可以通过建立反向 SSH 隧道或类似技术，长期控制受害系统。

**项目地址:** [AndrewMas99/CVE-2019-11043-Vulnerability](https://github.com/AndrewMas99/CVE-2019-11043-Vulnerability)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)