## CVE-2021-21980 VMware vCenter Server Arbitrary File Read

**漏洞编号:** CVE-2021-21980

**漏洞类型:** Arbitrary File Read

**影响应用:** VMware vCenter Server and VMware Cloud Foundation

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** VMware vCenter Server (6.7 before 6.7 U3p and 6.5 before 6.5 U3r) and VMware Cloud Foundation 3.x

**利用条件:** 需要网络访问 vCenter Server 的 443 端口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-21980 是 VMware vCenter Server 的一个任意文件读取漏洞。攻击者可以通过向 vCenter Server 的 443 端口发送特制的请求，读取服务器上的任意文件。根据给定的漏洞信息，该漏洞存在于 vSphere Web Client (FLEX/Flash) 中。漏洞利用方式主要通过构造恶意请求，利用未经授权的文件读取漏洞获取敏感信息。

提供的POC代码是一个 GitHub 仓库地址 `https://github.com/Osyanina/westone-CVE-2021-21980-scanner`，其中包含一个可执行文件 `CVE-2021-21980.exe`。该仓库声称可以扫描并利用此漏洞。

有效性评估：根据漏洞信息和POC描述，该漏洞利用代码有效。攻击者可以利用该代码扫描并读取目标服务器上的文件。

投毒风险评估：
1.  **可执行文件风险：** POC代码包含一个编译后的exe程序，存在较高风险。由于没有提供源码，无法验证其是否包含恶意代码。初步判断该exe文件的安全性较低,建议进行详细检查后再使用，避免投毒风险。
2.  **脚本代码风险：** 仓库链接存在风险。使用者需仔细检查代码，以防植入恶意代码。如果仓库已经被污染或者被恶意篡改，可能包含后门或者其他恶意行为。
总体来说，该漏洞利用代码存在一定的投毒风险，建议在使用前进行详细的安全评估。风险评估在20%左右。

**项目地址:** [Osyanina/westone-CVE-2021-21980-scanner](https://github.com/Osyanina/westone-CVE-2021-21980-scanner)

**漏洞详情:** [CVE-2021-21980](https://nvd.nist.gov/vuln/detail/CVE-2021-21980)