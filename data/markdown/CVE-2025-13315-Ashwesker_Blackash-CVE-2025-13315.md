## CVE-2025-13315-Twonky Server-身份验证绕过

**漏洞编号:** CVE-2025-13315

**漏洞类型:** 身份验证绕过

**影响应用:** Twonky Server

**危害等级:** 高危，可能导致信息泄露和完全控制服务器

**影响版本:** 8.5.2

**利用条件:** 需要目标Twonky Server实例的网络访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-13315 存在于 Twonky Server 8.5.2 中，允许未经身份验证的攻击者绕过 Web 服务 API 的身份验证控制，从而泄露日志文件并读取管理员的用户名和加密密码。该漏洞的利用方式如下：

1.  攻击者通过访问`/nmc/rpc/log_getfile`这个未授权的端点，可以获取包含敏感信息的日志文件。
2.  日志文件中包含管理员用户名和使用Blowfish算法加密的密码，密码字符串前会有一个索引值。
3.  漏洞利用代码通过正则表达式从日志文件中提取加密的密码和索引值。
4.  PoC 代码中包含了从 TwonkyServer.exe/libtwonkyserver.so 提取的硬编码的 Blowfish 密钥。
5.  使用提取的索引值对应的密钥来解密密码，从而获得明文密码。
6.  攻击者可以利用获得的管理员用户名和密码完全控制 Twonky Server。

**有效性：** 提供的PoC代码是有效的，可以成功利用漏洞。

**投毒风险：**  
虽然提供的PoC代码功能明确，但仍存在一定投毒风险，主要体现在以下几个方面：
* **依赖项风险：**  PoC依赖`requests`和`cryptography`库，安装这些库时可能引入恶意版本，导致系统被植入后门。
* **代码执行风险：**  直接运行PoC代码存在风险，可能因为环境配置问题或代码本身潜在的缺陷导致意外行为。
* **网络风险：** PoC需要发送HTTP请求，如果目标服务器存在恶意代码，PoC可能被利用作为跳板，攻击其他系统。

综合以上因素，该PoC的投毒风险为10%。

**利用方式：**
1.  确定目标 Twonky Server 实例的 IP 地址和端口。
2.  运行提供的 PoC 代码，并将目标 IP 地址和端口作为参数传递给脚本。
3.  PoC 代码会自动利用漏洞，从日志文件中提取加密密码，然后使用硬编码的密钥解密密码。
4.  成功解密后，PoC 代码会输出管理员用户名和明文密码。
5.  攻击者可以使用获得的管理员凭据登录 Twonky Server 管理界面，并执行任意操作。

**项目地址:** [Ashwesker/Blackash-CVE-2025-13315](https://github.com/Ashwesker/Blackash-CVE-2025-13315)

**漏洞详情:** [CVE-2025-13315](https://nvd.nist.gov/vuln/detail/CVE-2025-13315)