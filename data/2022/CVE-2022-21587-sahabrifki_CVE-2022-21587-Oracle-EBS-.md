## CVE-2022-21587-Oracle Web Applications Desktop Integrator-任意文件上传导致RCE

**漏洞编号:** CVE-2022-21587

**漏洞类型:** 任意文件上传导致RCE

**影响应用:** Oracle Web Applications Desktop Integrator

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 12.2.3-12.2.11

**利用条件:** 需要网络访问，目标服务器运行受影响版本的Oracle E-Business Suite，并且Web Applications Desktop Integrator组件可用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21587 存在于 Oracle Web Applications Desktop Integrator 中。该漏洞允许未经身份验证的攻击者通过 HTTP 发送恶意请求，上传任意文件，从而导致远程代码执行。 

**有效性：**
根据漏洞信息和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞易于利用，且无需身份验证。提供的POC代码通过上传包含恶意Perl代码的ZIP文件，然后通过访问特定URL来执行该Perl脚本，从而实现远程命令执行。CISA KEV也收录了该漏洞，表明该漏洞在野外被利用。

**投毒风险：**
分析POC代码，存在一定的投毒风险，虽然代码主要功能是利用漏洞，但仍然有可疑之处：
*   **对 slipit 的依赖：**  POC 需要安装 `slipit` 模块来创建特定目录结构的 zip 文件。虽然 `slipit` 本身不是恶意软件，但如果攻击者修改了 POC 代码，利用 `slipit` 创建包含恶意文件的 zip 包，可能导致更严重的后果，例如覆盖系统文件。此风险点占比 5%。
*   **uuencode的使用:** poc中使用了`uuencode`命令，此命令功能为将文件编码为ASCII字符，没有发现明显的投毒点，但是如果修改编码流程有可能将恶意代码隐藏其中，此风险点占比 5%。

**利用方式：**
1.  **上传恶意ZIP文件：** POC首先生成包含恶意Perl脚本`txkFNDWRR.pl`的ZIP文件`txkFNDWRR.zip`，该Perl脚本的功能是接收HTTP Header中的`cmd`参数，并执行该参数指定的命令。
2.  **绕过认证:** 利用`BneUploaderService`组件的漏洞，未经身份验证直接上传文件。
3.  **文件上传位置构造:** 使用`slipit`工具构造特定的目录结构，将Perl脚本放置在Oracle服务器指定位置，实现Web服务器可以访问到该脚本。
4.  **远程命令执行：**  通过访问`OA_CGI/FNDWRR.exe`并设置`cmd`请求头，即可执行任意命令。

总结：攻击者利用`BneUploaderService`未授权上传漏洞，上传构造好的ZIP文件，其中的Perl脚本放置在指定位置，结合`OA_CGI/FNDWRR.exe`解析执行用户可控的命令，实现RCE。

**项目地址:** [sahabrifki/CVE-2022-21587-Oracle-EBS-](https://github.com/sahabrifki/CVE-2022-21587-Oracle-EBS-)

**漏洞详情:** [CVE-2022-21587](https://nvd.nist.gov/vuln/detail/CVE-2022-21587)