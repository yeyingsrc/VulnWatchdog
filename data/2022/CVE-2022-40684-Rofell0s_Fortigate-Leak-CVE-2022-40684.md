## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作。

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备运行存在漏洞的Fortinet产品版本，且管理界面可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP或HTTPS请求，在受影响的FortiOS, FortiProxy和FortiSwitchManager的管理界面上执行操作。漏洞存在于7.2.0到7.2.1以及7.0.0到7.0.6版本的FortiOS和FortiProxy，以及7.2.0和7.0.0版本的FortiSwitchManager中。CISA已经将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

提供的“漏洞利用代码”实际上是一个IP地址列表，加上对应的端口。这看起来像是扫描的结果，旨在寻找暴露的Fortinet设备管理端口。虽然这个列表本身不是漏洞利用代码，但是可以作为漏洞利用的先期侦察步骤，用于识别潜在的攻击目标。真正的漏洞利用代码会构造恶意的HTTP/HTTPS请求绕过身份验证，目前没有直接提供，但结合搜索引擎搜索结果(虽为空)可以找到相关的漏洞利用脚本或工具。

**有效性评估：**
根据漏洞描述，以及CISA将此漏洞添加到已知被利用的漏洞目录中，可以判断该漏洞**有效**。IP地址列表作为辅助信息，可加快漏洞验证。

**投毒风险评估：**
提供的IP地址列表本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者使用此列表进行大规模扫描和漏洞利用，可能会对目标系统造成拒绝服务攻击。该文件作为一个文本，不具备运行环境，代码投毒风险极低, 但是不能保证使用这个文件的人不会投毒。
  *   IP地址列表本身是良性的，但可能被滥用。
  *   风险评估：低 (约为 5%)

**利用方式：**
1.  **扫描：** 攻击者首先使用类似nmap的工具扫描网络，识别运行Fortinet FortiOS, FortiProxy 或 FortiSwitchManager 的设备，并确定其管理界面是否暴露在网络上(通过IP地址列表体现)。
2.  **版本识别：** 攻击者尝试确定Fortinet设备的版本，以便确认其是否受到CVE-2022-40684漏洞的影响。
3.  **身份验证绕过：** 攻击者构造特殊的HTTP/HTTPS请求，利用身份验证绕过漏洞，无需提供有效的用户名和密码即可访问管理界面。
4.  **执行操作：** 一旦成功绕过身份验证，攻击者就可以执行各种管理操作，例如更改配置、创建用户、上传恶意文件等。

总而言之，提供的文件本身没有投毒风险，但会被用于扫描和攻击，应警惕。

**项目地址:** [Rofell0s/Fortigate-Leak-CVE-2022-40684](https://github.com/Rofell0s/Fortigate-Leak-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)