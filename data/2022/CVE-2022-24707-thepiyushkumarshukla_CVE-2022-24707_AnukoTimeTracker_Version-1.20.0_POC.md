## CVE-2022-24707-Anuko Time Tracker-SQL注入

**漏洞编号:** CVE-2022-24707

**漏洞类型:** SQL注入

**影响应用:** Anuko Time Tracker

**危害等级:** 高危，可能导致数据泄露和权限提升

**影响版本:** < 1.20.0.5642

**利用条件:** 需要有效的用户名和密码，以及启用Puncher插件，且当前用户属于具有项目权限的组。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-24707是Anuko Time Tracker中Time Tracker Puncher插件存在的一个SQL注入漏洞。由于Puncher插件重用其他地方的代码，并依赖于POST请求中未经过滤的日期参数，导致攻击者可以通过构造恶意的SQL语句注入到Time Tracker数据库中。

**有效性：**
提供的POC代码看起来是有效的，它首先尝试登录，然后尝试利用puncher插件的SQL注入漏洞，提取tt_users表的所有信息。 README.md 文件描述了利用过程，并提供了使用示例，表明该漏洞可以被成功利用。

**投毒风险：**
POC代码本身具有一定的投毒风险。 风险较低，因为代码相对简单且目标明确。 但始终存在作者引入恶意行为的可能性，例如将提取的数据发送到外部服务器或修改数据库内容。  `anuko_exploit.py` 文件开头声明了作者和版本，表明作者可能在持续维护该代码，增加了投毒的可能性。`print`函数过多，有可能是方便调试留下的后门，也可以是恶意代码,所以投毒风险评定为10%。

**利用方式：**
1.  攻击者首先需要获得Anuko Time Tracker实例的访问权限，并拥有一个有效的用户名和密码。
2.  确保Time Tracker的`Puncher`插件已启用，并且当前用户属于具有项目权限的组。
3.  攻击者使用提供的Python脚本，通过`--host`，`--username`和`--password`参数指定目标URL，用户名和密码。
4.  脚本首先尝试登录到应用程序。
5.  登录成功后，脚本将利用Puncher插件中未经过滤的日期参数，构造恶意的SQL注入语句，从而从数据库中提取信息，特别是`tt_users`表。
6.  最终，攻击者将能够获得所有用户的凭据，包括管理员帐户，从而完全控制Anuko Time Tracker实例。

**项目地址:** [thepiyushkumarshukla/CVE-2022-24707_AnukoTimeTracker_Version-1.20.0_POC](https://github.com/thepiyushkumarshukla/CVE-2022-24707_AnukoTimeTracker_Version-1.20.0_POC)

**漏洞详情:** [CVE-2022-24707](https://nvd.nist.gov/vuln/detail/CVE-2022-24707)