## CVE-2022-40684-Fortinet身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，且目标设备运行受影响的Fortinet产品版本并暴露管理界面

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。漏洞利用的有效性较高，因为 CVE 信息显示具有可用的功能性PoC，且已被 CISA 添加到已知被利用的漏洞目录中。但是给出的POC代码库包含一个README声称只有购买后才能获得完全的POC，并且代码库内的几个python文件都指向一个购买链接，这增加了投毒的风险。因为仓库提供了多个脚本，包括目标检测 (check_targets.py)、漏洞利用 (CVE-2022-40684.py) 和自动化脚本 (automate.py)，这些脚本可能包含恶意代码，例如反向 shell 或数据窃取，只有购买才能使用，无法分析。尽管存在免责声明，表明该项目仅用于教育目的，但通过限制完全POC的使用，并引导用户付费购买，增加了用户下载和运行恶意代码的可能性。 综上，判定仓库中存在投毒的可能性为60%。利用方式涉及发送特制的 HTTP/HTTPS 请求绕过身份验证，从而可以在受影响的 Fortinet 设备上执行未经授权的操作和命令，最终导致远程代码执行。

**项目地址:** [Bendalledj/CVE-2022-40684](https://github.com/Bendalledj/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)