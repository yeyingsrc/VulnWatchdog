## CVE-2022-40684 - Fortinet 认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0 - 7.2.1, 7.0.0 - 7.0.6; FortiProxy 7.2.0, 7.0.0 - 7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面（HTTP/HTTPS）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 是一个 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中的认证绕过漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 或 HTTPS 请求在管理界面上执行操作。该漏洞利用方式是利用备用路径或通道绕过身份验证 [CWE-288]。

**有效性：**
提供的 README.md 文件分析了一个名为 Belsen_Group 的网络犯罪论坛用户声称拥有 15,000 个受损 Fortinet 设备的信息，并指出他们实际上是利用 CVE-2022-40684 漏洞获得的这些访问权限。该文件包含从泄漏的数据中提取的各种信息，包括受影响的 Fortinet 设备数量、版本以及检测到的入侵指标 (IOC)。IOC 包括 "user=Local_Process_Access" 和添加伪造管理员帐户 "fortigate-tech-support"。这些信息表明已经存在可用的漏洞利用方式，并且该漏洞已被积极利用。

**投毒风险：**
提供的扫描脚本 `scan_fortigate.py` 主要用于分析从 FortiGate 设备获取的配置文件，提取 IP 地址、电子邮件地址和 FortiOS 版本等信息。它本身不包含任何明显的恶意代码。但存在很小的风险，如果攻击者篡改了存储扫描结果的文本/CSV文件，例如 `scan_results.txt` 或 `scan_results.csv`，并将其共享给其他用户，则可能导致虚假信息传播。此外，虽然脚本本身没有恶意行为，但依赖脚本进行审计可能忽略系统中已经存在的后门或恶意配置更改。因此，投毒风险相对较低，估计为 10%。脚本意图为扫描和报告，但不保证结果的完整性和安全性，使用者需自行承担风险。

**利用方式：**
根据漏洞库信息和分析文件，利用方式是构造特制的 HTTP/HTTPS 请求，利用备用路径或通道绕过身份验证，从而在未经授权的情况下访问 Fortinet 设备的管理界面。利用此访问权限，攻击者可以执行任意管理操作，包括更改配置、添加用户、执行命令等。根据分析的泄漏数据，攻击者通常会添加一个名为 "fortigate-tech-support" 的伪造管理员帐户，以便保持持久访问。

**项目地址:** [Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684](https://github.com/Yami0x777/Belsen_Group-et-exploitation-de-la-CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)