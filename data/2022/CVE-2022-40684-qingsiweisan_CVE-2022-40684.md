## CVE-2022-40684-Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，未经身份验证的攻击者可以执行管理操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的HTTP/HTTPS管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS、FortiProxy 和 FortiSwitchManager 中。该漏洞允许未经身份验证的攻击者通过精心构造的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据提供的漏洞利用代码，攻击者可以通过PUT请求向目标设备的 `/api/v2/cmdb/system/admin/admin` 路径上传SSH公钥，从而实现未授权访问。漏洞利用代码通过 `Forwarded` header 绕过身份验证检查。漏洞利用的有效性较高，因为漏洞库信息明确指出该漏洞已在野外被利用，并且存在可用的功能性漏洞利用代码。提供的exp.py脚本的功能是上传ssh公钥，如果成功并且22端口开放，则可以通过ssh密钥登录。由于脚本需要用户提供公钥文件，因此投毒风险较低，主要风险在于用户可能从不可信的来源获取公钥文件。投毒风险预估为10%, 主要是因为攻击者可能分发修改过的利用脚本，诱导用户上传攻击者控制的公钥，从而控制目标设备。

**项目地址:** [qingsiweisan/CVE-2022-40684](https://github.com/qingsiweisan/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)