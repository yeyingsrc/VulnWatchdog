## CVE-2025-32463-Sudo-权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得Root权限

**影响版本:** 1.9.14 <= 版本 < 1.9.17p1

**利用条件:** 本地用户权限，需要能够执行sudo命令。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Sudo 1.9.14 到 1.9.17p1 版本之间。攻击者可以通过 `--chroot` 选项，利用用户可控目录下的 `/etc/nsswitch.conf` 文件来获取 root 权限。

**利用方式：**
1. 创建一个临时目录`${STAGE}`。
2. 在 `${STAGE}` 下创建恶意的 `nsswitch.conf` 文件，指定 passwd 数据库指向 `/woot1337`。
3. 创建一个共享库 `libnss_/woot1337.so.2`，其中包含一个构造函数 `woot`，该函数在库加载时执行，设置 reuid 和 regid 为 0，然后执行 `/bin/bash`，从而获得 root shell。
4. 使用 `sudo -R woot woot` 命令，该命令会 chroot 到 `${STAGE}/woot` 目录，并加载恶意的 `nsswitch.conf` 文件。
5. 由于 `nsswitch.conf` 文件被篡改，当 sudo 尝试解析 passwd 数据库时，会加载我们创建的共享库，从而执行 `woot` 函数，获得 root 权限。

**有效性评估：**
提供的 POC 代码有效，可以成功利用该漏洞提升权限。

**投毒风险：**
POC 代码中未发现明显的投毒代码。该脚本的功能是利用漏洞，在本地提升权限。所有的操作都在用户的控制之下，并且没有尝试连接外部服务器或者执行其他恶意行为。该POC执行过程比较清晰，并没有发现隐藏的后门或者恶意行为。因此，投毒风险评估为0%。

**项目地址:** [0x3c4dfa1/CVE-2025-32463](https://github.com/0x3c4dfa1/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)