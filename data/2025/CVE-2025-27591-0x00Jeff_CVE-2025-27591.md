## CVE-2025-27591-below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** below

**危害等级:** 高危，可能导致root权限获取

**影响版本:** < 0.9.0

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-27591 漏洞存在于 below v0.9.0 之前的版本。由于程序创建了一个全局可写的日志目录 `/var/log/below`，导致本地非特权用户可以通过符号链接攻击将日志文件替换为指向敏感文件（例如 `/etc/shadow` 或 `/etc/ld.so.preload`）的符号链接，从而实现权限提升。

**利用方式：**

1.  创建或利用已存在的全局可写日志目录 `/var/log/below`。
2.  删除原有的日志文件 `error_root.log`。
3.  创建一个符号链接 `error_root.log`，指向 `/etc/ld.so.preload`。
4.  触发 below 程序的日志记录操作，该操作会尝试修改 `error_root.log`，实际上会修改 `/etc/ld.so.preload` 的权限，使其可写。
5.  将包含恶意代码的共享库的路径写入 `/etc/ld.so.preload`。
6.  触发任何需要加载共享库的程序，以执行恶意代码。  POC中通过执行 `sudo -l` 触发共享库加载。
7.  利用共享库中的构造函数执行反弹shell代码。
8. 清理痕迹，包括删除preload文件和共享库文件。

**POC有效性：**

提供的 POC 代码看起来是有效的。它针对 `/etc/ld.so.preload` 文件进行攻击，通过将恶意共享库的路径写入该文件，可以实现任意代码执行。 其中的`shared.c` 中包含反弹shell的代码，能够连接到攻击者的机器。

**投毒风险：**

分析 POC 代码，未发现明显的投毒代码。 代码较为直接，目的是利用漏洞实现权限提升和反弹 shell。清理痕迹的行为表明作者没有植入后门或恶意代码的意图。

因此，判断投毒风险为 0%。

**项目地址:** [0x00Jeff/CVE-2025-27591](https://github.com/0x00Jeff/CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)