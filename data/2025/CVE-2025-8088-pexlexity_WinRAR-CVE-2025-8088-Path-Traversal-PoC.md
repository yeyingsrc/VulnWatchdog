## CVE-2025-8088-WinRAR-Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要使用存在漏洞的WinRAR版本解压恶意构造的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-8088 是 WinRAR 7.12 及更早版本中的一个路径遍历漏洞。该漏洞允许攻击者通过构造恶意的 RAR 压缩文件，将文件放置到解压目录之外，从而执行任意代码。漏洞利用方式是：

1.  **利用原理**: 通过精心构造的 RAR 压缩文件，其中包含带有特殊命名的 ADS (Alternate Data Streams，备用数据流) 的文件，ADS 的名称包含 `..\` 这样的路径遍历序列。
2.  **具体步骤**: 当 WinRAR 解压这样的压缩文件时，由于路径遍历的存在，ADS 中的内容会被写入到目标路径，例如 `%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\`，从而实现恶意代码的持久化执行。
3.  **POC 代码分析**: 提供的 POC 代码 `poc.py` 主要实现了以下功能：
    *   **参数解析**: 接受 `--decoy` (诱饵文件), `--payload` (payload 文件), `--out` (输出的 RAR 文件名), `--max_up` (最大路径遍历层数), `--target_path` (目标路径) 等参数。
    *   **诱饵文件创建**: 如果指定的诱饵文件不存在，则创建一个。
    *   **ADS 创建**: 循环创建多个 ADS，每个 ADS 的名称都包含不同数量的 `..\` 路径遍历序列，并将 Payload 数据写入到 ADS 中。目标路径为`%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\malware.bat`
    *   **RAR 压缩文件创建**: 使用 `rar.exe` 命令将诱饵文件 (包含 ADS) 压缩成 RAR 压缩文件。

**有效性评估**:  提供的 POC 代码基本有效，能够成功生成利用 CVE-2025-8088 漏洞的恶意 RAR 压缩文件。通过 WinRAR 解压后，可以将 Payload 写入到指定目录。

**投毒风险评估**: 该代码主要用于漏洞验证，存在非常低的投毒风险(1%)。代码未发现任何恶意行为或后门，其主要功能是生成漏洞利用所需的恶意RAR文件。


**项目地址:** [pexlexity/WinRAR-CVE-2025-8088-Path-Traversal-PoC](https://github.com/pexlexity/WinRAR-CVE-2025-8088-Path-Traversal-PoC)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)