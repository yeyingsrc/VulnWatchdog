## CVE-2025-61765-python-socketio-RCE

**漏洞编号:** CVE-2025-61765

**漏洞类型:** 反序列化漏洞/RCE

**影响应用:** python-socketio

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 5.14.0

**利用条件:** 多服务器部署，且攻击者已获得消息队列（如Redis）的访问权限。单服务器部署或安全的消息队列不受影响

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于python-socketio的多服务器部署环境中。服务器之间通过消息队列（如Redis）进行通信，消息使用pickle序列化。如果攻击者能够访问消息队列，则可以发送恶意的pickle payload，当服务器反序列化该payload时，会导致任意Python代码执行。提供的Dockerfile和docker-compose.yml文件构建了一个包含Redis消息队列、脆弱的socketio服务器和攻击者客户端的测试环境。攻击者客户端发送特制的pickle payload到Redis，socketio服务器接收并反序列化该payload，从而触发RCE。Dockerfile.edge_server 和 socketio_server 中都包含requirements.txt，虽然看起来安全，但可能存在版本依赖上的投毒，需要进一步分析requirements.txt的内容才能确认，由于没有提供具体文件,因此认为投毒风险较低。attacker 镜像通过 volume 挂载了poc.py, 执行 pip 安装 requests 后直接执行 poc.py, 该行为看起来也相对安全。综上所述, 投毒风险较低。

漏洞利用方式如下：
1.  **环境准备：** 使用docker-compose部署包含redis, socketio_server和edge_server的环境。
2.  **消息队列访问：** 攻击者需要能够访问Redis消息队列。
3.  **构造Payload：** 攻击者构造包含恶意代码的pickle payload。
4.  **发送Payload：** 攻击者将payload发送到Redis消息队列。
5.  **触发RCE：** SocketIO服务器从Redis消息队列接收payload并反序列化，执行恶意代码。

**项目地址:** [locus-x64/CVE-2025-61765_PoC](https://github.com/locus-x64/CVE-2025-61765_PoC)

**漏洞详情:** [CVE-2025-61765](https://nvd.nist.gov/vuln/detail/CVE-2025-61765)