## CVE-2025-59287-Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，远程代码执行

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要网络访问WSUS服务器，可能需要一定的认证绕过或权限提升（未在提供信息中明确说明）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-59287 是一个 Windows Server Update Service (WSUS) 中的远程代码执行漏洞。该漏洞是由于 WSUS 在反序列化不可信数据时存在缺陷造成的。未经授权的攻击者可以通过网络利用此漏洞执行任意代码。提供的POC代码 `BinaryFormatterPayloadGenerator.cs` 用于生成恶意的 BinaryFormatter 序列化 payload。它使用 `ObjectDataProvider` gadget chain，允许攻击者通过反序列化执行任意命令。具体来说，POC代码创建了一个 `ObjectDataProvider` 对象，将 `MethodName` 设置为 "Start"，`ObjectInstance` 设置为 `Process`。 随后，它将要执行的命令解析为 `ProcessStartInfo` 对象，并将其作为 `ObjectDataProvider` 的 `MethodParameters` 传递。最后，它使用 `BinaryFormatter` 将 `ObjectDataProvider` 对象序列化为二进制数据，并将其保存为文件。攻击者可以将该文件通过存在漏洞的WSUS接口进行反序列化，从而执行任意命令。

**有效性：**
该POC代码利用了已知的 .NET 反序列化 gadget (`ObjectDataProvider`)，因此具有较高的有效性。从CISA ADP的描述来看，这个漏洞是可被自动化利用的。

**投毒风险：**
POC代码本身主要是生成恶意 payload。通读代码，该代码的目的是根据用户输入的命令生成可利用的序列化payload。 投毒风险较低，主要风险在于生成恶意payload并滥用，因此判定投毒风险为1%。

**利用方式：**
1.  使用 `BinaryFormatterPayloadGenerator.exe` 生成恶意 payload，指定要执行的命令作为参数。
2.  将生成的 payload（二进制或Base64编码）传递给易受攻击的 WSUS 服务。
3.  WSUS 反序列化 payload，导致执行攻击者指定的命令。

**项目地址:** [dexterm300/cve-2025-59287-exploit-poc](https://github.com/dexterm300/cve-2025-59287-exploit-poc)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)