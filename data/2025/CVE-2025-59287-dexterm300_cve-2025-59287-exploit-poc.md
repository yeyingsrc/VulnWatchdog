## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025, 23H2 受影响版本请参考CVE信息。

**利用条件:** 需要网络访问WSUS服务，并能够发送特制的反序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-59287是Windows Server Update Service (WSUS)中的一个反序列化漏洞。攻击者可以通过构造恶意的BinaryFormatter payload发送到WSUS服务器，导致服务器执行任意代码。提供的POC代码`BinaryFormatterPayloadGenerator.cs`利用ObjectDataProvider gadget chain来执行任意命令。它首先创建一个ObjectDataProvider对象，设置MethodName为"Start"，ObjectInstance为Process对象。然后，将要执行的命令解析为ProcessStartInfo对象，并通过MethodParameters传递给ObjectDataProvider。最后，使用BinaryFormatter将ObjectDataProvider对象序列化为二进制数据，并将payload保存为.bin和.b64文件。该漏洞利用方式是典型的.NET反序列化漏洞利用模式。

**有效性：**
根据CISA ADP Vulnrichment的信息，该漏洞存在可利用的PoC，并且自动化程度高，影响范围广。因此，提供的POC代码应该能够有效利用该漏洞，在未修复的WSUS服务器上执行任意代码。

**投毒风险：**
分析POC代码，代码功能明确，目的是生成恶意序列化payload。代码本身没有发现任何恶意或后门代码，用于生成payload的程序没有明显的投毒迹象，可以认为投毒风险为0%。但需要注意的是，生成的payload本身是恶意的，如果被恶意使用，会造成严重危害。

**利用方式：**
1.  使用`BinaryFormatterPayloadGenerator.exe`生成恶意的BinaryFormatter payload，指定要执行的命令，例如`BinaryFormatterPayloadGenerator.exe calc.exe`。
2.  将生成的payload（.bin或.b64文件）发送到存在漏洞的WSUS服务器。发送方法可能需要结合其他的漏洞利用脚本或方法，例如`wsus_exploit.py`，该脚本可能用于利用漏洞发送payload并触发反序列化。
3.  WSUS服务器反序列化接收到的payload，从而执行payload中指定的命令，最终实现远程代码执行。

**项目地址:** [dexterm300/cve-2025-59287-exploit-poc](https://github.com/dexterm300/cve-2025-59287-exploit-poc)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)