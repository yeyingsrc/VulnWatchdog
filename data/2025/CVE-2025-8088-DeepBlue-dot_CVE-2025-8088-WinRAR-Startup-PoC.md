## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是一个 WinRAR 路径遍历漏洞，攻击者可以制作恶意的 RAR 压缩文件，当用户解压这些文件时，恶意代码会被写入到系统的任意位置，例如 Startup 文件夹，从而实现持久化和自动执行。该漏洞利用了 WinRAR 对文件流的处理以及不充分的路径验证。

**有效性：**
根据漏洞信息和提供的 PoC 代码，该漏洞利用是有效的。PoC 代码详细描述了如何利用 Alternate Data Stream (ADS) 和路径遍历，将 payload 写入 Windows 的 Startup 文件夹。

**投毒风险：**
该 PoC 代码的投毒风险较低，约为 10%。PoC 代码的主要功能是生成利用漏洞的恶意 RAR 压缩包，本身没有明显的恶意代码。风险点在于使用者可能将生成的恶意压缩包用于非法用途，或者在payload脚本中加入恶意代码。此处的`--payload`参数指定的脚本，可能会被替换为恶意代码。 

**利用方式：**
1.  **准备文件：** 创建一个诱饵文件（decoy）和一个 payload 文件（payload.bat）。诱饵文件用于迷惑用户，payload 文件包含要执行的恶意代码。
2.  **附加 ADS：** 将 payload 文件作为 Alternate Data Stream 附加到诱饵文件。
3.  **创建基本压缩包：** 使用 WinRAR 创建包含诱饵文件（包含 ADS）的 RAR 压缩包。
4.  **修改压缩包：** 修改压缩包，将 ADS 占位符替换为指向 Startup 文件夹的路径遍历序列。这使得 WinRAR 在解压时将 payload 写入 Startup 文件夹。
5.  **执行：** 当用户解压恶意 RAR 压缩包时，payload 被写入 Startup 文件夹，从而实现自动执行。

**项目地址:** [DeepBlue-dot/CVE-2025-8088-WinRAR-Startup-PoC](https://github.com/DeepBlue-dot/CVE-2025-8088-WinRAR-Startup-PoC)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)