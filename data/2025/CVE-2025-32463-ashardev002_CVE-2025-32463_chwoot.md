## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之间的版本。该漏洞允许本地用户通过 `--chroot` 选项使用用户控制的目录中的 `/etc/nsswitch.conf` 文件来获得 root 权限。

**漏洞利用方式：**

1.  攻击者首先需要创建一个恶意 `/etc/nsswitch.conf` 文件。这个文件会引导 `sudo` 使用攻击者控制的共享库来解析用户名或组名。
2.  然后，攻击者使用 `sudo --chroot <攻击者控制的目录> <任意命令>` 来执行命令。`sudo` 会将根目录更改为攻击者控制的目录，并使用该目录下的 `/etc/nsswitch.conf` 文件。
3.  当 `sudo` 尝试解析用户名或组名时，它会加载攻击者提供的恶意共享库。该库可以执行任意代码，从而使攻击者获得 root 权限。

**POC 代码分析：**

提供的 Dockerfile 用于构建一个包含易受攻击版本的 Sudo 的环境，并提供了一个 PoC 脚本（`sudo-chwoot.sh`，未提供）。Dockerfile的步骤如下：

1.  基于 Ubuntu 24.04 构建镜像。
2.  安装编译 Sudo 所需的依赖项。
3.  下载、解压并编译存在漏洞的 Sudo 1.9.16p2 版本。
4.  创建一个名为 `pwn` 的普通用户。
5.  将 PoC 脚本复制到 `pwn` 用户的 home 目录，并更改所有者。
6.  切换到 `pwn` 用户。
7.  启动 shell。

**有效性：**

根据漏洞信息和提供的 Dockerfile 来看，该 POC 代码大概率有效，因为它构建了一个存在漏洞的环境，并为利用漏洞提供了基础环境和用户。

**投毒风险：**

该代码存在一定的投毒风险，风险程度约为20%。风险主要在于两个方面：

1.  **`sudo-chwoot.sh` 脚本内容未知：**  这是 PoC 的核心部分，但是没有提供，如果上传者在脚本中加入恶意代码，可能会导致漏洞利用过程中执行额外的恶意操作。
2.  **Docker镜像构建过程：** 虽然Dockerfile本身看起来是标准流程，但理论上可以在任何步骤中插入恶意命令，例如在编译sudo时添加后门，尽管这种可能性较低。

由于缺乏 `sudo-chwoot.sh` 脚本的内容，无法完全排除投毒的可能性。因此，在使用该 PoC 代码时，建议仔细审查 `sudo-chwoot.sh` 脚本的内容，并了解 Dockerfile 中每个步骤的作用，以降低潜在的安全风险。

**项目地址:** [ashardev002/CVE-2025-32463_chwoot](https://github.com/ashardev002/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)