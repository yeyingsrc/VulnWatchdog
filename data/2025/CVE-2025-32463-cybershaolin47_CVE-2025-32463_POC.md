## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** 1.9.14 直到 1.9.17p1 之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 是一个 Sudo 的本地提权漏洞。该漏洞允许本地用户通过 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 获取 root 权限。利用方式如下：

1.  **创建恶意环境:** 创建一个目录（例如 `shaolin`），并在其中创建 `etc/nsswitch.conf` 文件，指定使用该目录下的 NSS 模块。
2.  **编译恶意 NSS 模块:** 编译一个共享库（例如 `libnss_/shaolin.so.2`），该库在加载时会执行提权操作（通过 `setreuid(0,0)` 和 `setregid(0,0)`）。
3.  **运行 Sudo 命令:** 使用 `sudo -R shaolin shaolin` 命令，使 Sudo 在 `shaolin` 目录下 chroot，并加载恶意的 NSS 模块，从而执行提权操作。

**有效性评估：**

根据提供的 POC 代码，该漏洞利用方式有效。`privesc.sh` 脚本自动化了创建恶意环境、编译恶意 NSS 模块和运行 Sudo 命令的过程。`exp.c` 文件包含了提权的代码。

**投毒风险评估：**

经过分析，该 POC 代码**不存在明显的投毒风险 (0%)**。虽然该脚本可以提权，但这正是漏洞利用的目的。没有发现任何作者隐藏的恶意代码，例如：

*   下载并执行恶意二进制文件
*   修改系统关键文件
*   向外部服务器发送敏感信息

`exp.c` 的功能也很直接，仅仅是将当前用户 ID 和组 ID 设置为 root。

**利用方式总结：**

该漏洞的利用方式是通过欺骗 Sudo 加载用户控制的 NSS 模块来实现提权。攻击者通过 `--chroot` 选项指定一个恶意目录，该目录下包含一个 `etc/nsswitch.conf` 文件，该文件指示系统使用恶意 NSS 模块来解析用户名和密码。当 Sudo 加载该模块时，模块中的代码会被执行，从而提升用户的权限。


**项目地址:** [cybershaolin47/CVE-2025-32463_POC](https://github.com/cybershaolin47/CVE-2025-32463_POC)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)