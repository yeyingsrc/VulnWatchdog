## CVE-2025-6440-WooCommerce Designer Pro-任意文件上传

**漏洞编号:** CVE-2025-6440

**漏洞类型:** 任意文件上传

**影响应用:** WooCommerce Designer Pro

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.26

**利用条件:** 目标站点安装了WooCommerce Designer Pro插件，版本小于等于1.9.26，并且允许未授权访问 wp-admin/admin-ajax.php。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6440是WooCommerce Designer Pro插件中的一个任意文件上传漏洞，存在于'wcdp_save_canvas_design_ajax'函数中。由于缺少文件类型验证，未经身份验证的攻击者可以上传任意文件到服务器，这可能导致远程代码执行。

**有效性：**
根据提供的漏洞库信息和漏洞利用代码，该POC代码看起来是有效的。它通过向`wp-admin/admin-ajax.php`发送包含恶意文件的POST请求，绕过文件类型验证，从而实现任意文件上传。利用代码中的`mass-CVE-2025-6440.py`脚本旨在批量利用此漏洞。

**投毒风险：**
分析提供的文件，发现存在一定的投毒风险，但风险较低。主要风险在于`mass-CVE-2025-6440.py`脚本可能被修改为上传恶意PHP后门，或者在批量扫描时进行其他恶意操作。虽然脚本本身的功能是利用漏洞上传文件，但被篡改的可能性始终存在。`README.md`中指示使用`template nuclei`和`mass uploader`， 这意味着该仓库倾向于批量化利用，增加了一定的投毒可能性。`Dork.txt` 收集相关网站可以为批量利用提供前提。总体来说，由于脚本的复杂性和可能存在的依赖，以及它批量化利用的特性，我评估投毒风险为10%。

**利用方式：**
1.  确定目标站点是否安装了受影响版本的WooCommerce Designer Pro插件。
2.  使用POC代码（`/tmp/vulnwatchdog_76f70e59c3bbea6054f74b2cb9ede656/CVE-2025-6440.yaml`或者`mass-CVE-2025-6440.py`）构造一个恶意的POST请求，将其发送到`wp-admin/admin-ajax.php`，其中包含要上传的恶意文件(比如PHP文件)。
3.  服务器接收到请求后，由于缺少文件类型验证，会将恶意文件保存到`wp-content/uploads/wcdp-uploads/temp/{uniq}/{filename}` 目录。
4.  攻击者可以通过访问上传的文件，执行恶意代码，从而控制服务器。

**项目地址:** [smuft1707/CVE-2025-6440](https://github.com/smuft1707/CVE-2025-6440)

**漏洞详情:** [CVE-2025-6440](https://nvd.nist.gov/vuln/detail/CVE-2025-6440)