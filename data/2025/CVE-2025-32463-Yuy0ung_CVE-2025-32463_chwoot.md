## CVE-2025-32463 Sudo 本地提权漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，目标系统存在漏洞版本的Sudo

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `sudo -R` 选项和用户可控的 `/etc/nsswitch.conf` 文件获取 root 权限。漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之前的版本。利用方式是利用 `--chroot` 选项，使用用户控制目录下的 `/etc/nsswitch.conf` 文件。该漏洞的PoC代码首先会创建一个临时目录，然后在该目录下创建一个 `woot/etc/nsswitch.conf` 文件，内容指向一个伪造的 NSS 模块 `/woot1337`。如果目标系统没有 gcc, POC代码会使用预编译的 `woot1337.so.2`。否则，POC会编译生成动态链接库 `libnss_/woot1337.so.2`。随后，通过 `sudo -R woot woot` 命令触发漏洞。由于 `nsswitch.conf` 文件被劫持，系统会加载攻击者控制的恶意动态链接库，从而执行任意代码，将当前用户提升到 root 权限。

**有效性评估：**
提供的PoC代码有效，经过分析，该漏洞利用过程清晰，利用了sudo的 `-R` 参数和对nsswitch.conf文件的错误处理。

**投毒风险评估：**
代码中存在一定的投毒风险，但风险较低。具体分析如下：
1.  **预编译的二进制文件 `woot1337.so.2`：** 这是最主要的潜在风险点。预编译的二进制文件可能包含恶意代码，在没有gcc环境的目标机器上，会直接使用该二进制文件，如果该二进制文件被篡改，可能导致安全问题。
2.  **exp.sh脚本本身：**  脚本本身也可能被植入恶意代码，例如在提权之后执行其他操作。但是脚本相对简单，容易审计。
3.  **网络连接风险：** 代码本身没有明显的网络连接操作，但是如果gcc编译过程中，存在依赖需要从网络下载，可能被中间人攻击，替换成恶意的依赖。
综合来看，预编译二进制文件 `woot1337.so.2` 是最主要的风险点，因此判断投毒风险为10%。

**项目地址:** [Yuy0ung/CVE-2025-32463_chwoot](https://github.com/Yuy0ung/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)