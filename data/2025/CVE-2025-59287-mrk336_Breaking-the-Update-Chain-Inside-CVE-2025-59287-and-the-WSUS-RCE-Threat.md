## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025, 23H2 (受影响版本见漏洞库信息)

**利用条件:** 需要网络可达WSUS服务器，并且WSUS服务允许从远程源获取更新。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-59287是一个Windows Server Update Services (WSUS)中的远程代码执行漏洞，源于对不可信数据的反序列化。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞允许未经身份验证的远程攻击者在受影响的WSUS服务器上执行任意代码。PoC 代码提供了一个示例 XML 负载和一个 PowerShell 脚本，用于生成恶意 `UpdateStream.xml` 文件，并通过 HTTP PUT 将其上传到 WSUS 服务器。该XML文件中可以指定要执行的命令。

**投毒风险：**
检查提供的`LICENSE`和`README.md`文件，没有发现恶意代码或可疑行为。`README.md` 详细描述了漏洞原理和利用方法，提供的PowerShell脚本是为了构建和上传payload，没有后门或者其它恶意行为。因此，该漏洞利用代码的投毒风险评估为0%。

**利用方式：**
1.  攻击者构建恶意的 `UpdateStream.xml` 文件，其中包含要执行的命令。
2.  攻击者通过 HTTP PUT 方法将该文件上传到 WSUS 服务器。
3.  WSUS 服务器反序列化该 XML 文件，执行其中的命令，导致远程代码执行。

攻击者通过修改 `<SourcePath>` 元素来指定执行的命令，并通过 `<Command>` 元素来指定要执行的 PowerShell 脚本。

该漏洞的成功利用将允许攻击者完全控制受影响的 WSUS 服务器。

**项目地址:** [mrk336/Breaking-the-Update-Chain-Inside-CVE-2025-59287-and-the-WSUS-RCE-Threat](https://github.com/mrk336/Breaking-the-Update-Chain-Inside-CVE-2025-59287-and-the-WSUS-RCE-Threat)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)