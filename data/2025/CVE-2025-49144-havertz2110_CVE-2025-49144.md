## CVE-2025-49144 - Notepad++ Installer Privilege Escalation

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 特权提升 (Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高危，允许低权限用户提升至 SYSTEM 权限

**影响版本:** < 8.8.2

**利用条件:** 需要用户下载并运行恶意 regsvr32.exe 与易受攻击的 Notepad++ 安装程序到同一目录，并执行安装程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Notepad++ 8.8.1 及其之前的版本的安装程序中。由于安装程序在调用 `regsvr32` 时未使用绝对路径，导致攻击者可以将恶意的 `regsvr32.exe` 放置在与安装程序相同的目录下（如Downloads目录）。当用户运行安装程序时，Windows 会优先在当前目录搜索 `regsvr32.exe`，从而执行恶意程序，并继承安装程序的管理员权限。提供的 PoC 代码 `regsvr32.c` 实现了token窃取功能,可以生成反向shell连接。

**有效性分析：**
提供的 PoC 代码和漏洞描述清晰地展示了漏洞利用过程。通过替换 `regsvr32.exe`，攻击者可以在安装过程中执行任意代码，从而提升权限。漏洞利用依赖于用户交互（运行安装程序），但攻击复杂度较低。

**投毒风险分析：**
`regsvr32.c` 代码包含建立反向 shell 的功能。 虽然这本身是PoC的一部分，但部署到生产环境中可能被视为恶意行为。代码中定义的 `LHOST` 和 `LPORT` 指示了连接回攻击者的 IP 地址和端口。此外，利用token窃取，意味着它可以创建一个SYSTEM权限的 shell。尽管提供了漏洞利用的示例，但潜在用户需要非常小心，不要在未经授权的系统上部署它。代码的意图是用于验证漏洞，而不是进行恶意活动。
评估仓库整体投毒风险时，需要考虑以下几个方面：

*   **文件组成：**仓库包含一个漏洞说明文档和一个 PoC 代码文件。这种结构倾向于漏洞演示而非恶意利用。
*   **代码可读性：**PoC 代码相对清晰，方便审查，降低了隐藏恶意代码的可能性。
*   **功能：**PoC 的主要功能是演示权限提升，虽然包含反向 shell 功能，但属于权限提升的后续利用，而非主要目的。
*  **自启动逻辑**: 恶意代码并不会自启动，需要用户双击，安装等动作。

基于以上分析，认为该仓库存在较低的投毒风险 (10%)，主要风险点在于反向 shell 功能可能被滥用。但总体而言，仓库内容更侧重于漏洞演示和验证。

**利用方式：**
1.  攻击者创建一个恶意的 `regsvr32.exe` 文件，该文件可以执行任意代码，例如建立反向 shell 连接或执行其他恶意操作。
2.  攻击者诱骗用户下载 Notepad++ 8.8.1 及其之前的版本的安装程序，并将恶意的 `regsvr32.exe` 文件放置在与安装程序相同的目录下（通常是用户的 Downloads 目录）。
3.  用户运行 Notepad++ 安装程序。由于安装程序在调用 `regsvr32` 时未使用绝对路径，Windows 会优先执行当前目录下的 `regsvr32.exe`，从而执行攻击者的恶意代码。
4.  恶意代码以管理员权限运行，攻击者可以利用此权限执行任意操作，例如安装后门程序、窃取敏感数据或控制受害者计算机。

**项目地址:** [havertz2110/CVE-2025-49144](https://github.com/havertz2110/CVE-2025-49144)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)