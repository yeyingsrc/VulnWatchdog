## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，目标主机存在漏洞版本Sudo

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32463是Sudo的一个本地提权漏洞，存在于1.9.14到1.9.17p1之前的版本中。该漏洞允许本地用户通过利用`--chroot`选项和用户控制的`/etc/nsswitch.conf`文件获得root权限。

**利用方式：**

1.  **创建临时目录：** 脚本首先创建一个临时目录，用于存放利用所需的文件。
2.  **生成恶意共享库：**  脚本创建一个C程序（woot.c），该程序在加载时会设置uid和gid为0，然后执行/bin/bash。该程序被编译为共享库libnss_/woot.so.2。
3.  **创建nsswitch.conf：**  脚本创建了一个定制的`/etc/nsswitch.conf`文件，其中指定passwd数据库从`/woot`文件中获取信息。`/woot`实际并不存在，但是由于`-R woot`参数，sudo 会将当前目录 chroot 到 `./woot`, 从而使用临时的 `nsswitch.conf`，导致nss库加载我们构造的 `libnss_/woot.so.2`。
4.  **利用sudo提权：** 脚本使用`sudo -R woot woot`命令。`-R woot`参数指定sudo将根目录更改为`./woot`，使用户可以控制`/etc/nsswitch.conf`。sudo尝试在chroot环境下解析passwd数据库时，会加载恶意的共享库，从而执行其中设置uid和gid为0的代码，最终获得root权限。

**有效性：**

根据漏洞库信息和利用代码，该漏洞利用代码有效，可以成功提权。

**投毒风险：**

该仓库中存在作者隐藏的投毒代码的可能性极低，接近0%。主要理由如下：

*   **代码审查：** 提供的代码比较简洁明了，主要功能是编译一个共享库，并利用sudo的chroot功能加载该库来提权。
*   **开源和公开：**  该漏洞利用代码已经公开，如果存在恶意代码，很容易被发现。
*   **自毁型利用：** 该利用本身就是提权，如果加入其他恶意代码，很容易导致利用失败，反而暴露自己。

但是仍然不能完全排除投毒的可能，始终需要谨慎。例如，作者可能在编译选项中加入一些不明显的恶意选项，或者在C代码中加入一些难以察觉的后门。

为了进一步降低风险，可以：

*   **手动审查代码：** 仔细阅读每一行代码，特别是C代码和编译选项。
*   **在隔离环境运行：** 在虚拟机或者容器中运行该漏洞利用代码，防止对真实系统造成损害。
*   **使用代码分析工具：** 使用静态代码分析工具和动态代码分析工具来检测潜在的恶意行为。

**项目地址:** [r3dBust3r/CVE-2025-32463](https://github.com/r3dBust3r/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)