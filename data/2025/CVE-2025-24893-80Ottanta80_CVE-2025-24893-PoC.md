## CVE-2025-24893-XWiki-Unauthenticated-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 15.10.11, < 16.4.1, < 16.5.0RC1

**利用条件:** 目标XWiki实例存在漏洞且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893 存在于 XWiki 平台的 SolrSearch 宏中，允许未经身份验证的攻击者执行任意 Groovy 代码，从而实现远程代码执行。该漏洞的利用方式是构造包含恶意 Groovy 代码的 HTTP GET 请求，发送到目标 XWiki 服务器的 `/xwiki/bin/get/Main/SolrSearch` 端点。PoC 代码 `xwiki_groovy_rce.py` 通过以下步骤利用此漏洞：

1.  **构造 Payload：** 使用 Base64 编码的反向 shell 命令，并将其嵌入到 Groovy 代码中。
2.  **URL 编码：** 对包含 Groovy 代码的 Payload 进行 URL 编码，确保特殊字符不会破坏请求。
3.  **发送 HTTP 请求：** 向目标 XWiki 服务器的 `/xwiki/bin/get/Main/SolrSearch` 端点发送包含 Payload 的 HTTP GET 请求。
4.  **监听反向 Shell：** PoC 脚本可以选择自动启动一个 Netcat 监听器，或者使用现有的监听器，等待目标服务器建立反向 shell 连接。

**有效性：** 根据漏洞库信息和 PoC 代码，该漏洞利用方法有效。漏洞库信息中提供了重现步骤，PoC 代码也提供了完整的利用流程。

**投毒风险：** 经过分析，`xwiki_groovy_rce.py` 主要功能是利用漏洞实现反向 Shell。潜在的投毒风险可能在于:
    *  IP地址和端口硬编码，攻击者可能会诱导使用者使用攻击者控制的IP地址。
    * 脚本可能尝试收集用户信息或执行其他恶意操作，但代码中未发现明显痕迹。检查发现创建了socket监听，这个可能存在植入后门，但更多是等待被攻击端连接的逻辑。
    * 该脚本依赖于bash和base64等系统命令，确保在目标机器上这些命令可用。

综上，POC 代码存在轻微投毒风险，可能性约为 10%。 主要来自于潜在的IP地址被纂改。



**项目地址:** [80Ottanta80/CVE-2025-24893-PoC](https://github.com/80Ottanta80/CVE-2025-24893-PoC)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)