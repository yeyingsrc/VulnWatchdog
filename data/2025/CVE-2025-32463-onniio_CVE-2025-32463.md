## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取Root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Sudo版本1.9.14到1.9.17p1之间。利用方式是利用sudo的`--chroot`选项，结合用户可控的`/etc/nsswitch.conf`文件，导致本地用户可以提升到root权限。 

**漏洞利用分析：**

1.  **Dockerfile:** 用于构建包含漏洞版本的Sudo（1.9.16p2）的环境。创建了一个名为`test`的普通用户，并将PoC脚本`sudo-cherrooe.sh`复制到该用户的home目录下。
2.  **sudo-cherrooe.sh:**  这个脚本是漏洞利用的核心。它创建了一个临时目录，并在该目录下构造了一个恶意的`/etc/nsswitch.conf`文件，该文件将passwd数据库的查找指向一个自定义的库`libnss_/errooe2025.so.2`。
3.  **errooe2025.c:** 这个C代码会被编译成动态链接库`libnss_/errooe2025.so.2`。当`/etc/nsswitch.conf`指向它时，构造函数`errooe`会被执行，将当前用户的UID和GID设置为0（root），然后以root权限执行指定的命令（默认为/bin/bash，如果提供了其他参数，则执行这些参数）。
4.  **利用过程：**
    *   脚本首先创建一个临时目录，并生成一个自定义的`nsswitch.conf`，将密码查找指向自定义的so库。
    *   然后，编译C代码`errooe2025.c`，生成恶意动态链接库 `libnss_/errooe2025.so.2`
    *   最后，使用`sudo -R errooe errooe`命令，通过`--chroot`选项，并指定`errooe`目录为根目录，从而加载恶意`nsswitch.conf`文件，执行恶意库里的代码。
5. **有效性：** 根据漏洞描述，POC代码能够利用该漏洞实现本地提权，因此POC有效。
6. **投毒风险：** 脚本本身的目的就是利用漏洞进行提权，没有发现其他隐藏的恶意代码。脚本行为符合漏洞利用的预期，即通过修改nsswitch.conf并利用chroot提权，因此投毒风险评估为0%。

**项目地址:** [onniio/CVE-2025-32463](https://github.com/onniio/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)