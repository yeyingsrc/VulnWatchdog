## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows Server版本包括2012、2012 R2、2016、2019、2022和2025，具体版本范围参见CVE描述。

**利用条件:** 需要网络访问WSUS服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是由于Windows Server Update Service (WSUS)中存在反序列化不可信数据导致。攻击者可以通过构造恶意的序列化数据，发送到WSUS服务器，从而执行任意代码。

**利用方式：**

1.  攻击者首先需要能够访问WSUS服务器。
2.  攻击者利用POC代码生成恶意的序列化payload。POC代码中，使用了`BinaryFormatter`进行序列化，该类已被标记为不安全，容易被利用于反序列化漏洞。POC构造了一个`TextFormattingRunPropertiesMock`对象，其中`ForegroundBrush`属性被设置为包含恶意XAML的字符串。该XAML利用`ObjectDataProvider`执行命令`cmd`。命令`cmd`是可以通过命令行参数指定的，具有很高的灵活性。
3.  POC代码发送精心构造的SOAP请求到WSUS服务器的ReportingWebService.asmx，其中包含base64编码的序列化payload。
4.  WSUS服务器在反序列化该payload时，会执行XAML中嵌入的恶意命令，导致远程代码执行。

**有效性：**

根据漏洞信息和POC代码，此POC极有可能有效。漏洞库信息明确指出存在反序列化漏洞，并且CISA ADP Vulnrichment将其标记为具有可利用的POC。POC代码实现了利用`BinaryFormatter`反序列化执行任意命令，这符合漏洞描述。

**投毒风险：**

此POC的投毒风险较低（约5%）。虽然`BinaryFormatter`本身存在安全风险，但POC代码的主要功能是根据用户提供的`cmd`参数生成payload，执行远程命令。代码中没有发现明显用于植入后门或执行其他恶意操作的隐藏代码。但是仍需人工审核，防止存在隐藏的恶意逻辑。风险点在于攻击者可以利用此POC进行攻击，从而控制目标服务器。

**项目地址:** [0xBruno/WSUSploit.NET](https://github.com/0xBruno/WSUSploit.NET)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)