## CVE-2025-62726-n8n-Remote Code Execution via Git Node Pre-Commit Hook

**漏洞编号:** CVE-2025-62726

**漏洞类型:** 远程代码执行

**影响应用:** n8n

**危害等级:** 高危，可能导致系统完全控制和敏感信息泄露

**影响版本:** < 1.113.0

**利用条件:** 需要低权限用户，并能访问 n8n 实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞存在于n8n的Git Node组件中。攻击者可以创建一个包含恶意git pre-commit hook的git仓库，然后诱导n8n用户克隆该仓库。当n8n用户尝试使用Git Node的commit操作时，恶意hook会被执行，从而导致远程代码执行。

**有效性：**
根据漏洞信息和POC代码，可以判断漏洞利用有效。POC代码展示了如何通过n8n工作流利用该漏洞。步骤包括：
1. 清理/tmp/app-deploy目录（如果存在）。
2. 克隆包含恶意pre-commit hook的Git仓库到/tmp/app-deploy。
3. 修改/tmp/app-deploy/.git/hooks/pre-commit文件，注入反向shell代码。
4. 配置Git用户名和邮箱。
5. 生成build.properties文件。
6. 将build.properties文件添加到暂存区。
7. 提交更改，触发恶意pre-commit hook，执行反向shell。
8. 输出调试信息。

**投毒风险：**
提供的代码段本身并没有明显的投毒风险。其中`baktistr/bare-repo`这个仓库被用于clone，用于触发漏洞。该仓库仅仅是作为一个启动点，漏洞利用的核心在于覆盖`.git/hooks/pre-commit`文件，植入恶意代码。因此，该POC的投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 pre-commit hook 的 git 仓库。
2.  攻击者诱导 n8n 用户克隆该恶意仓库，可以使用URL scheme之类的技巧。
3.  n8n 用户使用 Git Node 的 commit 操作时，触发 pre-commit hook。
4.  恶意 hook 执行，攻击者实现在 n8n 服务器上的远程代码执行，例如反向 shell，权限继承于n8n运行用户。

**项目地址:** [baktistr/cve-2025-62726-poc](https://github.com/baktistr/cve-2025-62726-poc)

**漏洞详情:** [CVE-2025-62726](https://nvd.nist.gov/vuln/detail/CVE-2025-62726)