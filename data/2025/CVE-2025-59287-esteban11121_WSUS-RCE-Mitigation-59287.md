## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码。

**影响版本:** 受影响的Windows Server版本：2012, 2012 R2, 2016, 2019, 2022, 2025 和 23H2，具体版本范围见漏洞库信息。

**利用条件:** 需要目标服务器安装并运行WSUS服务，且存在网络连通性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个 Windows Server Update Service (WSUS) 中的反序列化远程代码执行漏洞。攻击者可以利用此漏洞通过网络在目标服务器上执行任意代码。\n\n**漏洞利用方式：**
根据漏洞库信息，该漏洞是由于 WSUS 中存在不安全的反序列化操作导致的。攻击者可能通过构造恶意的序列化数据，发送给 WSUS 服务器，服务器在反序列化该数据时执行攻击者预先设定的恶意代码。利用可能涉及拦截或伪造WSUS客户端与服务器之间的通信，或者直接攻击WSUS服务器的端口。\n\n**有效性：**
漏洞库信息中CISA ADP部分存在指向GIST的exploit参考链接，表明该漏洞存在可用的利用代码。提供的powershell脚本并非直接的exp利用代码，而是用于检测目标服务器是否安装了WSUS角色，以及是否已经安装了缓解此漏洞的补丁。该脚本通过`Get-WmiObject`获取操作系统信息，然后根据操作系统版本判断需要安装的补丁KB号，最后通过`Get-HotFix`检查补丁是否已经安装。如果WSUS角色已安装但缺少相应的补丁，则认为服务器存在漏洞。\n\n**投毒风险：**
提供的 PowerShell 脚本的主要功能是检测 WSUS 角色和相应的补丁程序，不包含直接的漏洞利用代码，但是存在以下潜在的投毒风险：
1.  **信息收集：** 脚本会收集服务器的操作系统版本和已安装的补丁信息，如果脚本被恶意修改，可能会将这些敏感信息发送给攻击者。
2.  **后门植入：** 脚本可能被修改为在检测漏洞的同时，植入后门程序，例如创建计划任务、修改注册表等。
3.  **拒绝服务：** 恶意修改后的脚本可能会消耗大量系统资源，导致服务器拒绝服务。

尽管存在以上风险，但就脚本本身而言，其主要目的是检测而非利用漏洞。因此，可以认为该脚本直接包含投毒代码的概率较低，约为 10%（主要考虑到被恶意修改的可能性）。更直接的POC应该关注如何构造恶意的序列化数据，并发送给WSUS服务器。


**项目地址:** [esteban11121/WSUS-RCE-Mitigation-59287](https://github.com/esteban11121/WSUS-RCE-Mitigation-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)