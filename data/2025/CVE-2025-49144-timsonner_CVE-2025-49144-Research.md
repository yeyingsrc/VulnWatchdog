## CVE-2025-49144-Notepad++-权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** < 8.8.2

**利用条件:** 需要用户运行包含恶意文件的Notepad++安装包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Notepad++ v8.8.1 及之前的版本中，攻击者通过将恶意可执行文件与官方安装包放置于同一目录，利用安装程序不安全的可执行文件搜索路径，在安装过程中以 SYSTEM 权限执行恶意代码，从而提升权限。

**漏洞利用方式：**
1.  攻击者诱骗用户下载包含恶意文件的Notepad++安装包。这可以通过社会工程学或者点击劫持等手段实现。
2.  用户在同一目录下同时存在 Notepad++ 的官方安装包和一个精心构造的恶意可执行文件。
3.  当用户运行官方安装包时，由于不安全的可执行文件搜索路径，安装程序会执行攻击者放置的恶意程序，从而提升到 SYSTEM 权限。

**漏洞利用代码分析：**
*   `archive-org.txt`: 包含指向 Notepad++ v8.8.1 下载页面的链接，用于获取受影响版本的安装包。
*   `call-agent-no-prompt.cs` 和 `call-agent.cs`: 这两个C#代码文件用于启动 Notepad++ 安装程序。`call-agent-no-prompt.cs` 尝试删除 Zone.Identifier，以绕过安全警告。关键代码是使用 `Process.Start` 启动 installer_Win8_Win11_x64_*.exe 安装程序，利用漏洞触发点。
*   `npp.8.8.1.checksums.sha256`: 包含 Notepad++ v8.8.1 各个版本的 SHA256 校验和，用于验证下载的安装包的完整性。
*   `pop-shell.cs`: 该 C# 代码文件用于弹出一个 PowerShell 窗口，这可能是恶意代码的一部分，用于在 SYSTEM 权限下执行任意命令。

**有效性分析：**
根据漏洞库信息，该漏洞的存在已经被证实，并且提供了修复版本。提供的 POC 代码通过模仿用户下载安装包的流程，并提供启动安装包的脚本，验证了漏洞的可利用性。攻击者可以通过替换 `pop-shell.cs` 或者在 `pop-shell.cs`基础上增加其他恶意代码来实现攻击。

**投毒风险分析：**
该仓库中的主要代码是用于启动安装程序和弹出一个 PowerShell 窗口。虽然`pop-shell.cs`本身可被用于恶意目的，但它更像是漏洞验证的一部分，而不是隐藏的、与漏洞本身无关的恶意代码。整个仓库的目的是为了演示漏洞，没有发现明显的额外后门或恶意行为，因此投毒风险较低。


**项目地址:** [timsonner/CVE-2025-49144-Research](https://github.com/timsonner/CVE-2025-49144-Research)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)