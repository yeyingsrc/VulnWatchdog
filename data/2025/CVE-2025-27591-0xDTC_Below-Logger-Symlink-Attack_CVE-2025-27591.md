## CVE-2025-27591-below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** below

**危害等级:** 中危，本地用户可提升至root权限

**影响版本:** < 0.9.0

**利用条件:** 目标系统安装了低于0.9.0版本的below，且/var/log/below目录存在且世界可写。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-27591漏洞存在于低于0.9.0版本的below服务中，原因是/var/log/below目录被创建为世界可写。攻击者可以利用此漏洞，通过创建指向/etc/shadow等敏感文件的符号链接，然后诱导below服务向该符号链接写入内容，从而修改敏感文件，达到权限提升的目的。

**有效性分析：**
提供的POC代码针对CVE-2025-27591漏洞，利用了`/var/log/below`目录世界可写的特性，通过创建指向`/etc/passwd`的符号链接，并利用`below`命令写入内容，从而达到修改`/etc/passwd`文件，添加具有root权限的恶意用户的目的。该POC代码逻辑清晰，包含了漏洞验证、清理、利用等步骤，具有较高的有效性。

**投毒风险分析：**
POC代码中存在一定的投毒风险，虽然整体代码逻辑是为了利用漏洞，但攻击者可能在其中加入恶意代码，例如：
1.  **后门植入:**  在`/etc/passwd`中添加恶意用户时，可能会添加SSH密钥，方便后续远程登录。
2.  **数据窃取:**  在利用过程中，可能会窃取`/etc/shadow`等敏感文件。
3.  **破坏系统:**  恶意修改系统配置文件，导致系统崩溃或无法正常运行。

考虑到POC的主要目的是演示漏洞利用，以及代码中已经包含了添加用户的行为，如果将添加用户的行为判定为后门,那么投毒风险相对较低。风险点在于是否会在添加用户之外,添加其他的恶意操作,比如密钥。因此，投毒风险判断为5%。

**利用方式：**
1.  **漏洞验证：** 检查`/var/log/below`目录是否存在且世界可写。
2.  **环境准备：** 如果存在目标日志文件，需要进行清理。
3.  **符号链接创建：** 创建从`/var/log/below/error_root.log`到`/etc/passwd`的符号链接。
4.  **Payload生成：** 生成包含恶意用户信息的`/etc/passwd`格式的payload，存储在临时文件中。
5.  **触发漏洞：** 运行`below`命令，使其写入日志，从而将payload写入`/etc/passwd`。
6.  **验证利用：** 检查`/etc/passwd`是否被修改，恶意用户是否成功添加。
7.  **清理痕迹：**  删除临时文件和符号链接（如果需要）。

**项目地址:** [0xDTC/Below-Logger-Symlink-Attack_CVE-2025-27591](https://github.com/0xDTC/Below-Logger-Symlink-Attack_CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)