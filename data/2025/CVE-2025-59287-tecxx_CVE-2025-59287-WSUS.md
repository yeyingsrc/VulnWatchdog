## CVE-2025-59287-WSUS 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，远程代码执行

**影响版本:** Windows Server 2012/2012 R2/2016/2019/2022/2025/23H2 受影响版本

**利用条件:** 需要网络可访问WSUS服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个 Windows Server Update Service (WSUS) 中的远程代码执行漏洞，由于WSUS服务存在反序列化未授权数据，未经授权的攻击者可以通过网络利用此漏洞在受影响的服务器上执行任意代码。

**漏洞利用有效性分析：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞存在有效的POC。POC利用了WSUS服务中存在的未经授权的反序列化漏洞。POC通过构造恶意的SOAP消息，发送到WSUS服务器的SimpleAuthWebService或ReportingWebService，从而触发反序列化漏洞并执行任意代码。

根据提供的wsus-rce.ps1和README.md，该利用方式如下：
1.  禁用SSL证书验证(仅用于测试环境)。
2.  使用Get-AuthCookie 函数获取身份验证cookie，该函数通过向SimpleAuthWebService发送SOAP请求来获取。
3.  使用Get-ServerId 函数获取ServerId，该函数尝试从ReportingWebService获取，如果失败，则生成一个新的GUID作为fallback ID。
4.  使用Get-ReportingCookie函数从ClientWebService获取cookie。
5.  使用Ysoserial.net生成恶意payload，payload被嵌入到SOAP消息中。
6.  将包含恶意payload的SOAP消息发送到WSUS服务器，触发反序列化漏洞。
7.  （重新）打开WSUS控制台以触发漏洞。

**投毒风险分析：**

检查提供的 PowerShell 脚本 `wsus-rce.ps1` 和 `README.md` 文件，未发现明显的恶意代码，例如删除文件、上传敏感信息或植入持久性后门等操作。但仍存在一定的投毒风险：

*   **依赖项风险：** 该POC依赖于 ysoserial.net 来生成payload，该工具本身可能存在安全风险，如果下载源被篡改，可能导致下载恶意版本的 ysoserial.net。
*   **网络钓鱼：** 攻击者可能会修改 POC 中的 URL，将受害者引导到恶意的 WSUS 服务器。
*   **Payload定制：** POC 代码可以被修改，嵌入恶意的payload，从而在目标系统上执行恶意操作。

综合考虑以上因素，该POC存在一定的投毒风险，但不算高，大概在10%左右。

**利用方式总结：**

1.  攻击者无需身份验证，可直接与WSUS服务器通信。
2.  通过构造特定的SOAP消息，触发WSUS服务器的反序列化漏洞。
3.  利用Ysoserial.net等工具生成payload，实现远程代码执行。

**项目地址:** [tecxx/CVE-2025-59287-WSUS](https://github.com/tecxx/CVE-2025-59287-WSUS)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)