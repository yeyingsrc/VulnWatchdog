## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2012/2012 R2/2016/2019/2022/2025/23H2 受影响版本

**利用条件:** 需要获得WSUS服务器密钥才能利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows Server Update Service (WSUS)中，由于对AuthorizationCookie对象进行不安全的反序列化处理导致远程代码执行。攻击者通过发送特制的恶意序列化对象到GetCookie()端点，服务端使用AES-128-CBC解密cookie数据，然后使用BinaryFormatter反序列化，但没有进行类型验证，从而允许攻击者执行任意代码。

**有效性：**
POC代码看起来有效，它演示了如何使用AES-128-CBC加密一个恶意的.NET序列化payload，利用BinaryFormatter的反序列化漏洞。

**投毒风险：**
该POC代码的主要功能是加密payload，其中payload是一个序列化的对象，用于执行任意代码。投毒风险较低，大约10%。主要风险在于使用者可能不清楚payload的具体行为，导致意外执行恶意操作。代码本身的功能较为明确，就是加密指定的序列化字符串，因此直接植入恶意代码的可能性相对较低。但不能完全排除payload本身存在后门的可能，因为序列化数据的内容是base64编码的，需要解码后才能分析。

**利用方式：**
1.  **获取WSUS服务器密钥：** 这是利用此漏洞的先决条件。需要使用其他方法获取WSUS服务器的AES密钥。
2.  **生成恶意.NET序列化payload：** 使用`cve-2025-59287-encrypt.py`脚本中提供的序列化字符串或其他方式生成包含恶意代码的.NET序列化payload。  该脚本的示例 payload 是执行 `cmd /c calc`。
3.  **加密payload：**  使用`cve-2025-59287-encrypt.py`脚本提供的 AES-128-CBC 加密方法，使用WSUS服务器密钥加密payload。  脚本会先生成16字节的非零salt，然后加密，再拼接上payload的加密结果。
4.  **发送加密后的cookie：** 将加密后的数据作为AuthorizationCookie发送到WSUS服务器的GetCookie()端点。
5.  **远程代码执行：**  WSUS服务器在接收到cookie后，会使用其自身的密钥解密数据并反序列化，从而执行payload中的恶意代码，实现远程代码执行。

**项目地址:** [jiansiting/CVE-2025-59287](https://github.com/jiansiting/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)