## CVE-2025-49844 - Redis Lua Interpreter UAF

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本支持，并具有执行EVAL/EVALSHA命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是 Redis 中 Lua 解释器存在的一个 Use-After-Free 漏洞。未经授权的用户可以通过构造特制的 Lua 脚本来操作垃圾回收器，触发 UAF 漏洞，最终可能导致远程代码执行。

**有效性：**
提供的漏洞利用代码（redis_exploit.py）看起来较为完整，包含初始化、连接、版本检测、架构检测、堆喷射、UAF对象创建、内存泄漏、ROP链构造和Shellcode执行等多个阶段。其README.md 也描述了利用流程以及需要的参数。总体来看，此PoC 有效的可能性较高，具体取决于目标环境和Redis配置。

**投毒风险：**
在分析提供的漏洞利用代码片段中，虽然没有发现明显的恶意代码或后门植入行为，但考虑到完整代码未完全提供，仍存在一定的投毒风险。可能的风险点包括：
*   **Shellcode的来源与功能：** exploit.py 中使用了 shellcode，如果shellcode的功能被篡改，可能会导致恶意行为。虽然给出了reverse shell的功能，如果shellcode的功能被篡改，可能会导致恶意行为。
*   **依赖库风险：**  `requirements.txt` 中指定的依赖库，如果被替换为恶意版本，可能导致安全问题。
综合来看，投毒风险评估为 10%。这是一个经验判断，因为在部分代码的情况下无法进行完整分析。

**利用方式：**
该漏洞的利用方式如下：
1.  **连接目标Redis服务器：**  使用 redis 客户端连接到目标服务器。
2.  **版本检测：**  检测 Redis 服务器的版本，确认其是否受漏洞影响。
3.  **架构检测：**  确定目标系统的架构（x86/x64），以便选择合适的 Shellcode 和 ROP gadgets。
4.  **堆喷射：**  进行堆喷射，在内存中填充大量数据，提高漏洞利用的可靠性。
5.  **UAF对象创建：**  创建用于触发 Use-After-Free 漏洞的对象。
6.  **内存泄漏：**  泄漏内存地址，绕过地址空间布局随机化 (ASLR)。
7.  **ROP链构造：**  构造 Return-Oriented Programming (ROP) 链，绕过数据执行保护 (DEP/NX)。
8.  **Shellcode执行：**  执行 Shellcode，实现任意代码执行。通常用于建立反向Shell或执行其他恶意操作。
9.  **持久化（可选）：** 尝试建立持久化后门，以便长期控制目标系统。

**项目地址:** [Yuri08loveElaina/CVE-2025-49844](https://github.com/Yuri08loveElaina/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)