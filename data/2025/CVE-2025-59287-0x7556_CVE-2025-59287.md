## CVE-2025-59287 Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows Server版本（见漏洞库信息）

**利用条件:** 需要攻击者能够访问WSUS服务器的网络，并且WSUS服务正在运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS) 的远程代码执行漏洞。该漏洞源于WSUS服务中存在反序列化未受信任的数据的缺陷，攻击者可以通过发送特制的序列化数据到WSUS服务器，在服务器上执行任意代码。

**有效性分析：**

提供的漏洞利用代码显示了如何利用该漏洞，该代码通过将包含恶意payload的序列化数据发送到WSUS服务器，实现远程代码执行。 提供的`README.md`文件给出了用法示例，包括植入WolfShell内存马和允许特定端口通过防火墙。结合漏洞库信息中CISA ADP的信息，可确认该漏洞存在可利用的POC。

**投毒风险分析：**

根据提供的文件，`allow7556.txt` 包含序列化的数据，用于配置防火墙规则。 虽然这个文件本身的功能是为了方便利用，但攻击者可能会修改这个文件，使其包含恶意代码或者执行其他恶意操作。如果攻击者在不知情的情况下使用了被修改的`allow7556.txt`或其他类似的payload文件，就存在投毒的风险。但是整体代码逻辑较为清晰，投毒概率较低。考虑到用户可能自定义payload，误判的可能性加大，故将投毒风险概率定为10%。

**利用方式：**

1.  攻击者首先需要确定目标WSUS服务器的URL。
2.  利用ysoserial.net或其他序列化工具生成包含恶意代码的payload。
3.  使用提供的CVE-2025-59287利用脚本将payload发送到目标WSUS服务器。
4.  当WSUS管理员打开控制台时（或者经过一段时间后，由WSUS自动执行某些操作），payload将被反序列化，从而执行恶意代码。
5.  通过成功执行的恶意代码，攻击者可以在目标服务器上植入后门，执行命令或进行其他恶意活动。

**项目地址:** [0x7556/CVE-2025-59287](https://github.com/0x7556/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)