## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得Root权限

**影响版本:** < 1.9.17p1 (版本 >= 1.9.14)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 允许本地用户通过 `--chroot` 选项利用用户可控目录下的 `/etc/nsswitch.conf` 获取 root 权限。利用方式如下：

1.  **创建恶意动态链接库：**  `poc.sh` 脚本编译了一个名为 `woot1337.so.2` 的动态链接库，该库在加载时会执行 `woot` 函数，此函数设置进程的 EUID 和 EGID 为 0（root），然后启动一个 root shell。
2.  **创建自定义 `nsswitch.conf`：**  脚本创建一个包含自定义 `/etc/nsswitch.conf` 文件的目录结构 `woot/etc`。此 `nsswitch.conf` 文件将 `passwd` 数据库的查找指向 `/woot1337`，这是一个不存在的文件。关键在于，当 `sudo` 使用 `--chroot` 选项时，它会使用此自定义 `nsswitch.conf`。
3.  **利用sudo --chroot:** 脚本没有展示如何触发漏洞，但是根据漏洞描述可以得知，用户可以通过具有 `--chroot` 选项的 `sudo` 命令，指定 `woot` 目录作为 chroot 环境，从而使 `sudo` 使用用户提供的 `nsswitch.conf` 文件。由于 `nsswitch.conf` 文件将密码查找指向一个恶意动态库，因此动态库将被加载并执行。

**有效性：**  POC 代码有效，它展示了如何创建一个恶意的动态链接库和一个 `nsswitch.conf` 文件，这些文件可以被 `sudo` 利用以获得 root 权限。

**投毒风险：**  `poc.sh` 脚本本身没有明显的投毒代码。但是，`woot1337.c` 创建的 root shell 可能会被利用于恶意目的。作者可以通过添加额外的恶意代码到`woot1337.c`或`poc.sh`来隐藏恶意行为，比如持续性的后门，或者删除某些系统文件。虽然当前的 PoC 主要用于演示提权，但潜在的风险在于，不熟悉代码的用户可能会直接执行 PoC，而忽略了潜在的风险。因此，认为存在一定的投毒风险。


**项目地址:** [muhammedkayag/CVE-2025-32463](https://github.com/muhammedkayag/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)