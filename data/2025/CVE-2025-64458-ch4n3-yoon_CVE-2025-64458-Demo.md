## CVE-2025-64458 - Django Redirect DoS on Windows

**漏洞编号:** CVE-2025-64458

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Django

**危害等级:** 高危，可能导致服务中断

**影响版本:** 4.2 < 4.2.26, 5.1 < 5.1.14, 5.2 < 5.2.8

**利用条件:** Windows服务器，需要目标应用存在用户可控的URL跳转

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64458 是一个存在于 Django 框架中的拒绝服务漏洞。当 Django 在 Windows 平台上运行时，如果 `HttpResponseRedirect` 或 `HttpResponsePermanentRedirect` 使用了包含大量 Unicode 字符的 URL，会导致 Python 的 NFKC 规范化过程非常缓慢，消耗大量 CPU 资源，从而导致拒绝服务攻击。

**有效性分析：**

POC 代码 `poc.py` 通过构建包含大量全角 Unicode 字符的 URL，然后重复实例化 `HttpResponseRedirect` 对象来模拟攻击。 它测量了不同 URL 长度下实例化所需的时间，证明了攻击的可行性。 POC的README.md也详细描述了漏洞原理和修复方案，可信度较高。搜索引擎没有搜索结果，暂时不能提供排序依据。

**投毒风险分析：**

查看提供的文件，包括 `README.md`、`poc.py` 和 `requirements.txt`，没有发现任何隐藏的恶意代码。 `poc.py` 的作用是演示漏洞，而不是执行恶意操作。`requirements.txt` 文件仅声明了项目依赖项，包括Django，没有发现第三方恶意依赖包。 因此，该仓库中存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  攻击者找到一个使用了 `django.http.HttpResponseRedirect`，`django.http.HttpResponsePermanentRedirect` 或者 `django.shortcuts.redirect` 的页面，并且该页面接受用户输入作为跳转的 URL。
2.  攻击者构造一个包含大量全角 Unicode 字符的 URL，例如 `https://ＡＡＡＡＡ.../`。
3.  攻击者将构造的 URL 作为参数传递给存在漏洞的页面。
4.  当 Django 尝试处理该 URL 时，会触发缓慢的 NFKC 规范化过程，消耗大量 CPU 资源。
5.  如果攻击者发送大量包含恶意 URL 的请求，服务器可能会因为 CPU 资源耗尽而崩溃，导致拒绝服务。

**项目地址:** [ch4n3-yoon/CVE-2025-64458-Demo](https://github.com/ch4n3-yoon/CVE-2025-64458-Demo)

**漏洞详情:** [CVE-2025-64458](https://nvd.nist.gov/vuln/detail/CVE-2025-64458)