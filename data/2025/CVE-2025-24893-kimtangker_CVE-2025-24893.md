## CVE-2025-24893 XWiki RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** XWiki Platform

**危害等级:** 严重，允许未经身份验证的攻击者执行任意代码

**影响版本:** >= 5.3-milestone-2, < 15.10.11 和 >= 16.0.0-rc-1, < 16.4.1

**利用条件:** 需要网络访问到XWiki实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于XWiki Platform的SolrSearch功能中，由于模板引擎处理不当，导致攻击者可以通过构造恶意的请求，利用Groovy脚本引擎执行任意代码。具体来说，攻击者可以向`/bin/get/Main/SolrSearch`端点发送带有恶意`text`参数的请求，其中`text`参数包含经过URL编码的Groovy脚本。该脚本会在服务器端执行，从而导致RCE。

**有效性：**
根据提供的漏洞利用代码和日志，POC代码是有效的。日志显示成功执行了`whoami`和`ls`命令，证明了RCE的存在。

**投毒风险：**
仓库中的代码主要包含docker-compose文件，用于搭建易受攻击的XWiki环境，以及一些简单的测试脚本。主要关注的是`xwiki_exploit.log`，其中记录了漏洞利用的尝试。虽然目前没有明显的证据表明存在恶意投毒代码，但考虑到其RCE的性质，有必要保持警惕。docker-compose文件拉取的镜像`xwiki:15.10.10`本身可能存在其他未知的安全问题。并且exploit代码中通过Groovy脚本执行系统命令，存在潜在的后门风险。相对来说，投毒风险较低，约为5%。

**利用方式：**
1.  目标系统运行存在漏洞版本的XWiki Platform。
2.  攻击者构造包含恶意Groovy脚本的HTTP GET请求，该请求的目标URL为`/bin/get/Main/SolrSearch?media=rss&text=[payload]`，其中`[payload]`是经过URL编码的Groovy脚本。
3.  XWiki Platform解析请求中的`text`参数，由于模板注入漏洞，将恶意Groovy脚本传递给模板引擎进行执行。
4.  模板引擎执行恶意Groovy脚本，导致RCE。
5.  攻击者通过RCE执行任意系统命令，控制目标服务器。

**项目地址:** [kimtangker/CVE-2025-24893](https://github.com/kimtangker/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)