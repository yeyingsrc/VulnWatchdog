## CVE-2025-65345 - laravel-file-manager 文件系统泄露

**漏洞编号:** CVE-2025-65345

**漏洞类型:** 路径遍历导致的文件系统泄露

**影响应用:** laravel-file-manager

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** <= 3.3.1

**利用条件:** 需要有效的用户身份认证，且用户有权访问laravel-file-manager界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于laravel-file-manager v3.3.1及更早版本中。攻击者利用文件管理器的zip/压缩功能，通过构造包含路径遍历的恶意请求，绕过路径验证，从而创建包含服务器上任意文件的压缩包。通过下载该压缩包，攻击者可以读取到服务器上的敏感文件，如.env配置文件、SSH密钥、日志文件等，可能导致权限提升和横向渗透。

**漏洞利用方式：**

1.  攻击者首先需要登录到laravel-file-manager。
2.  选择一个文件或文件夹。
3.  使用zip压缩功能。
4.  使用Burp Suite或其他HTTP代理工具拦截请求。
5.  修改请求中的`directories`参数，插入路径遍历payload，例如`../../../../../../../../../var/www`或者`/etc/passwd`。
6.  发送修改后的请求。
7.  下载生成的zip文件。
8.  解压文件，即可读取到目标文件或目录的内容。

**有效性：**

根据提供的POC代码，该漏洞利用方式清晰且步骤详细，提供了截图，使得漏洞验证有效。

**投毒风险：**

该POC仅仅是描述了如何利用路径遍历漏洞来读取文件，没有发现任何恶意代码，因此投毒风险较低。

**结论：**

该漏洞利用方式有效，且未发现明显的投毒风险。

**项目地址:** [Theethat-Thamwasin/CVE-2025-65345](https://github.com/Theethat-Thamwasin/CVE-2025-65345)

**漏洞详情:** [CVE-2025-65345](https://nvd.nist.gov/vuln/detail/CVE-2025-65345)