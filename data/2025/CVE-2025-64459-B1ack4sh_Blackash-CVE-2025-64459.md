## CVE-2025-64459 Django SQL 注入

**漏洞编号:** CVE-2025-64459

**漏洞类型:** SQL 注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露和数据篡改

**影响版本:** 4.2 < 4.2.26, 5.1 < 5.1.14, 5.2 < 5.2.8

**利用条件:** 需要存在使用了`QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()`或者`Q()`函数，并且这些函数使用了来自用户可控的字典作为参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64459 漏洞是 Django 框架中存在的一个 SQL 注入漏洞。该漏洞源于 Django 的 ORM 在处理 `QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()` 以及 `Q()` 函数时，如果使用了用户可控的字典作为参数传递给 `_connector`，可能导致 SQL 注入。 

**有效性：**

根据漏洞信息和提供的漏洞利用代码（README.md），该漏洞利用代码演示了如何通过构造恶意的请求参数，例如 `?username=admin&_connector=OR&is_superuser=True` 来利用此漏洞。 由于漏洞信息明确指出`_connector`参数可以被恶意利用，并且提供了攻击示例，因此可以判断提供的PoC代码有效。

**投毒风险：**

提供的漏洞利用代码主要是一个 README.md 文件，用于描述漏洞信息和利用方式。 仓库本身只包含文档说明，没有包含任何可执行的代码。因此，可以认为不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**

1.  攻击者需要找到使用了受影响的 Django 版本，并且在`QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()` 或者 `Q()` 函数中使用了用户可控的字典作为参数的应用。
2.  攻击者可以通过构造包含恶意 `_connector` 或 `_negated` 键值的 URL 参数或 POST 数据，将其传递给受影响的函数。
3.  Django 的 ORM 会错误地解析这些恶意参数，导致生成包含恶意 SQL 代码的查询语句。
4.  执行这些恶意 SQL 查询语句可能导致数据泄露、数据篡改或未经授权的访问。

**缓解措施：**

*   升级 Django 到安全版本（4.2.26+, 5.1.14+, 5.2.8+）。
*   避免直接使用用户提供的字典作为 `filter()` 等函数的参数。
*   使用参数化查询以防止 SQL 注入。
*   限制数据库权限，使用最小权限原则。
*   监控日志，查找包含 `_connector` 或 `_negated` 关键字的请求。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-64459](https://github.com/B1ack4sh/Blackash-CVE-2025-64459)

**漏洞详情:** [CVE-2025-64459](https://nvd.nist.gov/vuln/detail/CVE-2025-64459)