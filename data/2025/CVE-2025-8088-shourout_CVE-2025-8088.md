## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要打开恶意构造的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-8088 是 WinRAR 的一个路径遍历漏洞，攻击者可以构造恶意的RAR压缩包，当用户使用存在漏洞的WinRAR版本打开并解压该压缩包时，恶意代码会被释放到指定的目录下，例如Windows启动目录，从而实现开机自启动。攻击利用方式主要通过以下步骤实现：

1.  **构造恶意RAR压缩包：** 攻击者利用路径遍历漏洞，在RAR压缩包中包含指向敏感目录的文件路径，例如 `..\..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`。
2.  **放置可执行Payload：** 将恶意可执行文件（或脚本）放置在RAR压缩包中，并将其路径设置为启动目录，或者使用ADS（Alternate Data Streams）隐藏payload。
3.  **诱导用户解压：** 攻击者诱导用户使用WinRAR打开并解压恶意RAR压缩包。
4.  **执行Payload：** 当用户解压压缩包时，恶意可执行文件会被释放到启动目录，并在系统启动时自动执行。

分析提供的PoC代码，该脚本的主要功能是生成包含恶意Payload的RAR文件。该PoC可以有效利用漏洞，该POC也存在一定的投毒风险，风险主要来自于以下几个方面：

*   **可执行Payload：**  `PAYLOAD` 变量中定义了要执行的命令，如果攻击者修改此处的Payload，可能导致受害者执行任意恶意代码。PoC中提供的示例只是简单的启动 `C:\Users\Public\file.exe`，但攻击者可以替换为更具破坏性的Payload。
*   **文件名和路径：** `DROP_PATH`定义了Payload释放的路径，攻击者可以修改此路径以覆盖或篡改其他文件。
*   **依赖的库：** PoC中可能需要安装其他库才能运行，不排除有投毒者在依赖库中做手脚的可能。

虽然PoC本身是为了演示和测试漏洞，但潜在的滥用风险需要注意。其中extract.py代码存在较多无意义的模拟数据发送和接受，有一定概率迷惑使用者，需要进行代码审计才能确定。综合来看，投毒风险评估为30%。

**项目地址:** [shourout/CVE-2025-8088](https://github.com/shourout/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)