## CVE-2025-11953 - React Native CLI 命令注入

**漏洞编号:** CVE-2025-11953

**漏洞类型:** 命令注入

**影响应用:** @react-native-community/cli-server-api

**危害等级:** 严重，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** < 20.0.0 (受影响示例: 4.8.0)

**利用条件:** React Native CLI 启动的 Metro Development Server 绑定到外部接口并且目标系统运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-11953 是一个命令注入漏洞，存在于 @react-native-community/cli-server-api 包的 Metro Development Server 中。该服务器默认绑定到外部接口，并暴露了一个易受攻击的 `/open-url` 端点。未经身份验证的远程攻击者可以通过向该端点发送特制的 POST 请求来执行任意的操作系统命令。

**有效性：**
提供的漏洞利用代码包括用于设置易受攻击环境、安全环境以及利用该漏洞的脚本。`README.md` 文件和提供的脚本（如 `basic-exploit.sh`, `windows-exploit.sh`, `advanced-exploit.py`, `full-demo.ps1`）清楚地表明该漏洞可以被成功利用。`full-demo.ps1` 脚本展示了如何在 Windows 环境下检测和利用此漏洞，并通过健康检查接口确认了服务器状态。

**投毒风险：**
尽管该漏洞利用代码库提供了用于演示和利用漏洞的脚本，但存在轻微的投毒风险。`LICENSE` 文件声明该软件仅用于教育和研究目的，但攻击者可能会修改或重新分发这些脚本用于恶意目的。虽然原始代码本身似乎没有直接植入后门，但用户需要仔细审查所有脚本，特别是 `advanced-exploit.py` 和 `windows-exploit.sh`，以确保它们没有被篡改以包含额外的恶意功能。投毒风险评估为5%，主要来自于用户下载使用未经审核的脚本可能性.

**利用方式：**
1.  **环境准备：** 首先，需要设置一个包含易受攻击版本的 `@react-native-community/cli-server-api` 的 React Native 项目。这通常涉及使用 `npm install` 安装特定版本的包。
2.  **启动服务器：** 运行 React Native 开发服务器，确保它绑定到外部接口。默认配置可能已经满足此条件。
3.  **发送恶意请求：** 使用漏洞利用脚本（例如 `basic-exploit.sh` 或 `advanced-exploit.py`）向 `/open-url` 端点发送包含恶意操作系统命令的 POST 请求。该命令将由服务器执行。
4.  **Windows 利用:** 在 Windows 系统上，可以使用 `windows-exploit.sh` 或者 `full-demo.ps1` 来利用漏洞，脚本中会构造特定的命令和参数绕过安全限制，执行任意 shell 命令。
5.  **利用成功：** 成功利用漏洞后，攻击者可以在服务器上执行任意代码，从而可能导致完全控制系统。这包括读取敏感数据、安装恶意软件或破坏系统。

**项目地址:** [SaidBenaissa/cve-2025-11953-vulnerability-demo](https://github.com/SaidBenaissa/cve-2025-11953-vulnerability-demo)

**漏洞详情:** [CVE-2025-11953](https://nvd.nist.gov/vuln/detail/CVE-2025-11953)