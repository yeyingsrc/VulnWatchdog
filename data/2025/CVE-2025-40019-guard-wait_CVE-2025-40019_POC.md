## CVE-2025-40019

**漏洞编号:** CVE-2025-40019

**漏洞类型:** 缓冲区溢出/整数溢出

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或信息泄露

**影响版本:** Linux kernel 5.4 及以上，但不包括5.4.301, 5.10.246, 5.15.195, 6.1.157, 6.6.113, 6.12.54, 6.17.4, 6.18-rc1

**利用条件:** 需要能够触发ESSIV加密/解密操作

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2025-40019 存在于 Linux 内核的 ESSIV 加密实现中。漏洞位于 `crypto/essiv.c` 文件中，是由于在ESSIV (Encrypted Salt-Sector Initialization Vector) 模式下使用 AEAD (Authenticated Encryption with Associated Data) 加密算法进行加密/解密和就地加密时，未正确检查输入大小 (ssize)。攻击者可以利用此漏洞发送精心构造的输入数据，导致缓冲区溢出或整数溢出，从而可能导致拒绝服务或信息泄露。根据漏洞描述，修复方案是将 `ssize` 的检查移到 `essiv_aead_crypt` 函数的开始处，以确保在任何加密操作之前都进行了适当的输入大小验证。

**有效性：**
根据漏洞信息，该漏洞可以通过提供特制的输入数据来触发。因为没有找到相关的搜索引擎结果和漏洞利用代码，无法直接验证漏洞利用的有效性。但是漏洞描述中明确指出未检查输入大小，则此漏洞可能通过输入超长字符造成溢出。

**投毒风险：**
提供的代码是GNU GPL v3许可协议，不包含漏洞利用代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标系统运行的 Linux 内核版本是否在受影响的范围内。
2.  构造一个能够触发 ESSIV 加密/解密操作的场景。这可能涉及到文件系统加密、网络加密或其他使用 ESSIV 的应用。
3.  向 ESSIV 加密/解密函数提供一个长度超出预期 `ssize` 的输入数据，触发溢出。
4.  溢出的结果可能导致内核崩溃（拒绝服务）或覆盖相邻的内存区域（可能导致信息泄露或权限提升，取决于溢出位置和内容）。

**项目地址:** [guard-wait/CVE-2025-40019_POC](https://github.com/guard-wait/CVE-2025-40019_POC)

**漏洞详情:** [CVE-2025-40019](https://nvd.nist.gov/vuln/detail/CVE-2025-40019)