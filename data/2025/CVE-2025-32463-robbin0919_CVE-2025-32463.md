## CVE-2025-32463 Sudo 本地权限提升漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 严重，本地用户可获取 root 权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是一个 Sudo 本地权限提升漏洞。攻击者可以利用 Sudo 的 `--chroot` 选项，在用户指定的根目录中创建一个恶意的 `/etc/nsswitch.conf` 文件。当 Sudo 在此特制环境中执行时，会读取该恶意配置，导致加载攻击者提供的库文件，进而可能取得 root 权限。

**漏洞利用方式：**

1.  **创建恶意 chroot 环境：** 低权限用户创建一个目录，并在其中构造一个恶意的 `/etc/nsswitch.conf` 文件。该文件会指向攻击者控制的恶意动态链接库。
2.  **利用 Sudo 的 `--chroot` 选项：** 使用 `sudo --chroot` 命令，将根目录切换到攻击者创建的恶意 chroot 环境。
3.  **触发动态链接库加载：** Sudo 在 chroot 环境中运行时，会读取 `/etc/nsswitch.conf` 文件，并按照其中的配置加载动态链接库。由于 `/etc/nsswitch.conf` 文件已被篡改，Sudo 会加载攻击者提供的恶意动态链接库。
4.  **权限提升：** 恶意动态链接库中的代码会在 Sudo 的上下文中执行，由于 Sudo 通常以 root 权限运行，因此攻击者可以在系统中执行任意命令，从而获取 root 权限。

**有效性：**

根据漏洞信息和利用代码，此漏洞利用是有效的。漏洞库信息表明该漏洞的 CVSS 3.1 分数为 9.3，属于严重级别。漏洞利用代码中提供了详细的漏洞分析和复现步骤，进一步验证了漏洞的有效性。

**投毒风险：**

根据对提供的漏洞利用代码的分析，存在一定的投毒风险，但几率较低。漏洞利用代码包含一些中文注释以及漏洞分析，这降低了投毒的可能性，因为作者的目标更倾向于漏洞演示和分析，而非恶意利用。此外，提供的代码主要集中于漏洞的原理分析和环境搭建，没有发现直接的恶意代码。但是，不能完全排除存在隐藏的、不易被发现的恶意代码的可能性。所以综合评定投毒风险为10%。需要进一步审计才能确定代码中是否存在隐藏的后门或其他恶意行为。

**项目地址:** [robbin0919/CVE-2025-32463](https://github.com/robbin0919/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)