## CVE-2025-8088-WinRAR路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 需要用户交互，打开恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2025-8088是WinRAR Windows版本中的一个路径遍历漏洞。攻击者可以通过构造恶意的RAR压缩包，利用路径遍历写入任意文件，从而执行任意代码。提供的POC代码旨在利用此漏洞。

**有效性：**
该POC代码尝试创建利用 WinRAR 路径遍历漏洞的恶意 RAR 文件。它通过以下步骤工作：
1.  **Payload 生成：** 创建一个简单的批处理脚本 (`payload.bat`) 作为 payload，该脚本会弹出消息框，并启动 chrome.exe 和 calc.exe。这证明了任意代码执行的能力。
2.  **路径遍历构造：**  使用 `PATH_TRAVERSALS` 列表定义了一系列路径遍历字符串，如 `../`。这些字符串将被用于构造恶意压缩包中的文件路径，以便将payload写入启动目录。
3. **文件覆盖** 利用软件的自身的机制，将bat文件写入`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`,实现开机自启。
4.  **RAR5 构造：** 代码使用RAR5的文件格式创建恶意压缩包

鉴于以上分析，该POC代码似乎是有效的，能够利用 WinRAR 的路径遍历漏洞实现任意代码执行。

**投毒风险：**
该POC代码主要功能是生成一个恶意的RAR文件，其中包含一个payload和一个利用路径遍历漏洞的机制。以下是对投毒风险的分析：
* **Payload:** 该POC自带的payload（`payload.bat`）用于弹出消息框和启动计算器以及chrome浏览器。这是一个相对无害的 payload，用于验证漏洞。但是，攻击者可以轻松地替换此 payload 为更具恶意性的代码，例如下载和执行恶意软件，窃取用户数据等。
* **创建假的简历:** 该POC会创建Alicia_Sheree_CV,但是并没有使用该文件进行攻击，所以该功能没有投毒的特性
* **潜在风险：** 代码中存在创建文件和执行命令的操作，这些操作本身就具有潜在的风险。如果该 POC 代码被恶意修改，例如在创建恶意 RAR 文件之前或之后执行某些恶意操作，则可能存在投毒风险。
根据代码功能和已知行为， 投毒风险评估为10%， 因为该代码依赖用户执行`payload.bat`,并没有发现其它恶意的代码。

**利用方式：**
1.  攻击者创建一个包含恶意构造的文件路径的RAR文件。
2.  攻击者诱使用户使用易受攻击的WinRAR版本打开此RAR文件。
3.  WinRAR解压文件时，会将payload.bat文件写入到启动目录。
4.  当下一次系统启动时，payload.bat文件将被执行，导致恶意代码执行。

**总结：**
该漏洞利用方式是标准的路径遍历，利用WinRAR解压缩过程中的不安全处理来写入任意位置的文件。POC代码的有效性较高，可以用于验证和利用该漏洞。需要注意的是，攻击者可以替换POC中的payload，从而实现更具破坏性的攻击。

**项目地址:** [techcorp/CVE-2025-8088-Exploit](https://github.com/techcorp/CVE-2025-8088-Exploit)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)