## CVE-2025-58034 FortiWeb OS Command Injection

**漏洞编号:** CVE-2025-58034

**漏洞类型:** OS Command Injection

**影响应用:** FortiWeb

**危害等级:** 高危，允许攻击者执行任意操作系统命令，导致系统完全受损

**影响版本:** FortiWeb 8.0.0 through 8.0.1, FortiWeb 7.6.0 through 7.6.5, FortiWeb 7.4.0 through 7.4.10, FortiWeb 7.2.0 through 7.2.11, FortiWeb 7.0.0 through 7.0.11

**利用条件:** 需要有效的管理员权限才能利用该漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-58034是FortiWeb中的一个操作系统命令注入漏洞。经过身份验证的攻击者可以通过发送特制的HTTP请求或CLI命令，在底层系统上执行未经授权的代码。漏洞利用PoC的工作流程如下：

1.  **版本检查：** PoC首先尝试从`/api/v2/monitor/system/status`端点获取FortiWeb的版本信息。它验证版本是否在受影响的范围内（7.6.x, 8.0.x等，且不是已修复的版本）。
2.  **注入测试：** 如果版本被确定为易受攻击，PoC会尝试通过向`/api/v2/cmdb/system/interface`端点发送带有恶意负载的POST请求来测试命令注入。该负载包括URL编码的命令，例如`; id`。如果响应包含命令的输出（例如`uid=0(root)`），则PoC会报告潜在的注入。

**利用方式：**

该漏洞需要有效的管理员权限才能利用。利用方式涉及构造恶意的HTTP请求，通过API接口将恶意命令注入到系统命令中执行。

**有效性：**

根据漏洞信息和提供的PoC代码，该PoC代码的有效性较高，因为它涵盖了版本检查和命令注入测试，并根据响应内容确认漏洞是否存在。

**投毒风险：**

PoC代码本身旨在测试漏洞，而不是安装后门。PoC使用`id`命令进行验证，相对安全。但PoC中包含`session.verify = False`，禁用SSL证书验证，可能存在中间人攻击风险。虽然PoC的目的是验证漏洞，而非植入恶意代码，但在实际使用时，由于使用者权限较高，如被恶意篡改，可能被用于非法目的。因此，投毒风险评估为10%。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-58034](https://github.com/B1ack4sh/Blackash-CVE-2025-58034)

**漏洞详情:** [CVE-2025-58034](https://nvd.nist.gov/vuln/detail/CVE-2025-58034)