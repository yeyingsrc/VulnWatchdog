## CVE-2025-49844-Redis Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要能够执行Lua脚本的已认证用户

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。低权限的已认证用户可以通过构造恶意的 Lua 脚本来操纵垃圾回收器，触发释放后重用 (Use-After-Free) 漏洞，从而可能导致远程代码执行。

**有效性评估:**
根据漏洞库信息，该漏洞存在于 Redis 8.2.1 及更早版本，并在 8.2.2 版本中修复。漏洞利用需要能够执行 Lua 脚本的已认证用户。漏洞利用代码部分只包含 AWS ElastiCache Redis/Valkey 集群的网络分析工具，和 Redis Lua Use-After-Free 漏洞没有任何联系, 因此无法直接验证该漏洞.

**投毒风险分析:**
提供的代码为 ElastiCache Redis/Valkey 网络分析工具，用于审计 AWS ElastiCache Redis 和 Valkey 集群的网络暴露情况。代码主要是 bash 脚本，用于列出集群、检查网络配置等。脚本功能清晰，依赖的外部命令主要是 `aws cli` 和 `jq`。 代码内容没有发现任何恶意行为，例如反弹 shell、上传文件、执行恶意命令等。
因此，该仓库中存在作者隐藏的投毒代码的可能性极低，风险评估为0%.

**利用方式分析:**
根据漏洞库信息，攻击者需要利用 Lua 脚本操纵 Redis 的垃圾回收机制来触发 Use-After-Free 漏洞。具体步骤可能包括:

1.  认证用户连接到 Redis 服务器。
2.  构造一个恶意的 Lua 脚本，该脚本会创建一些对象，然后释放它们，但保留指向已释放内存的指针。
3.  通过某种方式（例如，再次调用 Lua 脚本），触发对已释放内存的访问，从而导致 Use-After-Free 漏洞。
4.  如果成功利用该漏洞，攻击者可能能够执行任意代码。

**项目地址:** [gopinaath/CVE-2025-49844-discovery](https://github.com/gopinaath/CVE-2025-49844-discovery)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)