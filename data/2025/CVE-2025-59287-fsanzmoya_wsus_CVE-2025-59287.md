## CVE-2025-59287-WSUS远程代码执行

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞导致的远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致完全控制受影响的WSUS服务器

**影响版本:** Windows Server 2012/2012 R2/2016/2019/2022/2025和23H2的受影响版本（见漏洞库信息）

**利用条件:** 需要能够访问目标WSUS服务器的ClientWebService/Client.asmx endpoint，通常在8530端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)中的反序列化漏洞，攻击者可以利用此漏洞通过网络执行任意代码。漏洞存在于WSUS处理客户端请求的ClientWebService中。

**有效性：**
提供的Python POC脚本尝试利用`GetCookie` endpoint，这是一个已知的WSUS攻击面。该脚本首先检查WSUS服务器是否可访问，然后发送包含`TEST_PAYLOAD`的SOAP请求到`GetCookie` endpoint。这是一种常见的探测方式，用于验证漏洞是否存在。

**投毒风险：**
查看提供的代码，未发现明显的投毒代码。该脚本的主要功能是检查目标WSUS服务器是否存在CVE-2025-59287漏洞，而不是植入恶意代码或后门。存在风险是，如果攻击者修改此脚本以包含恶意负载，可能会导致受害者运行恶意代码。因此，该代码存在一定投毒风险，但源文件本身未发现。

**利用方式：**
1.  **确定目标：** 确定运行易受攻击的WSUS版本的Windows Server。
2.  **访问WSUS服务：** 确保能够通过HTTP访问目标WSUS服务器的`ClientWebService/Client.asmx` endpoint (默认端口8530)。
3.  **发送恶意SOAP请求：** 使用特制的SOAP请求，将恶意的序列化对象嵌入到`GetCookie` endpoint中。攻击者需要将`TEST_PAYLOAD`替换成真正的恶意payload，比如，用于执行任意命令的反序列化payload。
4.  **执行代码：** 如果服务器成功反序列化恶意对象，攻击者可以在服务器上执行任意代码。

根据漏洞库信息,确认了此漏洞是由于不安全的反序列化造成的。 因此，攻击者需要构造特定的序列化payload，来达到远程代码执行的目的。
根据CISA ADP Vulnrichment，该漏洞可被自动化利用，且技术影响是完全的。

**项目地址:** [fsanzmoya/wsus_CVE-2025-59287](https://github.com/fsanzmoya/wsus_CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)