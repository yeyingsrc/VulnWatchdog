## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/符号链接攻击

**影响应用:** Git

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0 < 2.44.4, >= 2.45.0-rc0 < 2.45.4, >= 2.46.0-rc0 < 2.46.4, >= 2.47.0-rc0 < 2.47.3, >= 2.48.0-rc0 < 2.48.2, >= 2.49.0-rc0 < 2.49.1, >= 2.50.0-rc0 < 2.50.1

**利用条件:** 需要用户检出包含恶意配置的Git仓库，且目标Git版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞源于Git在处理配置文件时的不当引用。攻击者可以通过在 submodule 的路径中注入回车符（CR），导致 Git 将 submodule 检出到错误的位置。如果攻击者精心构造一个符号链接，将这个错误的位置指向 `.git/hooks` 目录，并且 submodule 中包含一个可执行的 `post-checkout` 钩子，那么在检出 submodule 后，这个钩子就会被执行，从而实现任意代码执行。

**POC有效性：** 提供的POC代码包含一个 `post-checkout` 钩子脚本，该脚本会将 `/home/gamma/.ssh/id_ed25519` 的内容复制到 `/tmp/recipes.txt`。这个脚本本身可以成功运行，并达到预期的效果，因此POC有效。

**投毒风险：** 从提供的POC代码来看，没有发现明显的恶意投毒行为。该POC主要演示了漏洞的利用方式，即通过执行 `post-checkout` 钩子来窃取SSH私钥。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含恶意配置的Git仓库，该仓库中的 submodule 路径包含一个尾随回车符。
2.  攻击者创建一个符号链接，将错误的 submodule 检出位置指向 `.git/hooks` 目录。
3.  攻击者在 submodule 中添加一个可执行的 `post-checkout` 钩子，该钩子包含恶意代码。
4.  攻击者诱骗受害者检出该Git仓库。
5.  受害者检出 submodule 时，由于配置解析错误，submodule 会被检出到错误的位置，从而触发符号链接，使得 `.git/hooks/post-checkout` 钩子被执行。
6.  恶意代码被执行，导致任意代码执行。

**项目地址:** [ceevase/CVE-2025-48384-sub](https://github.com/ceevase/CVE-2025-48384-sub)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)