## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞的Next.js版本，且授权检查位于中间件中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 存在于 Next.js 中，允许攻击者绕过授权检查。如果授权检查发生在中间件中，则可能利用此漏洞。POC 利用方式为发送包含 `X-Middleware-Subrequest` 头的恶意请求，绕过中间件的授权逻辑。

**有效性：**
根据漏洞库信息，该漏洞已被确认，并且提供了受影响的版本范围和修复版本。漏洞利用代码尝试通过设置 `X-Middleware-Subrequest` 请求头来绕过授权检查，这与漏洞描述中提供的缓解措施（阻止包含该头的请求）相符，因此 POC 代码很可能有效。

**投毒风险：**
该 POC 代码主要功能是发送带有特定header的请求，尝试绕过授权，代码中包含一些常见的网络请求操作和参数配置，例如设置 User-Agent、处理重定向等。虽然代码比较长，但没有发现明显的恶意代码，例如执行系统命令、上传文件等。考虑到代码主要目的是验证授权绕过漏洞，因此推测投毒的可能性较低，但仍不能完全排除（例如，通过精心构造的请求头来触发服务器的未知漏洞或资源消耗）。因此，这里评估投毒风险为10%。

**利用方式：**
1.  确定目标 Next.js 应用的版本是否在受影响的范围内。
2.  构造包含 `X-Middleware-Subrequest` 头的 HTTP 请求。
3.  将请求发送到目标应用。
4.  如果漏洞存在，授权检查将被绕过，攻击者可以访问原本需要授权才能访问的资源。

缓解措施：
*   升级到 Next.js 14.2.25 或 15.2.3 及以上版本。
*   阻止包含 `x-middleware-subrequest` 头的外部用户请求到达 Next.js 应用。

**项目地址:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)