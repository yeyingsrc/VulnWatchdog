## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14到1.9.17p1之前

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之前的版本。该漏洞允许本地用户通过利用 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件来获取 root 权限。

**漏洞利用方式：**

1.  创建一个临时目录，并在其中构造一个恶意的 `/etc/nsswitch.conf` 文件。该文件指向一个自定义的 NSS 模块（例如 `woot1337.so.2`）。
2.  编译一个共享库 `woot1337.so.2`，其中包含一个在加载时运行的构造函数 `woot()`。这个函数会设置有效的用户和组 ID 为 0 (root)，然后执行 `/bin/bash`。
3.  使用 `sudo -R woot woot` 命令，其中 `-R` 选项与 `--chroot` 类似，会将根目录更改为 `woot` 目录，并运行 `woot` 命令（实际上并不存在这个命令，但 `-R` 选项会处理目录变更）。由于 chroot 环境使用了用户提供的 `/etc/nsswitch.conf`，系统会加载恶意的 `woot1337.so.2` NSS 模块。
4.  `woot1337.so.2` 加载时，`woot()` 函数会执行，从而获得 root shell。

**漏洞利用代码分析：**

*   `exploit.sh` 脚本自动化了上述步骤：
    *   创建临时目录。
    *   创建 `woot/etc/nsswitch.conf`，指向 `/woot1337`，实际上是相对chroot根目录的libnss模块。
    *   编译 `woot1337.c` 为共享库 `libnss_/woot1337.so.2`，其中包含提权代码。
    *   使用 `sudo -R woot woot` 触发漏洞。
    *   清理临时目录。

**有效性评估：**

提供的POC代码看起来是有效的，因为它实现了 CVE 描述中的漏洞利用方式。该漏洞允许本地用户获取root权限，属于高危漏洞。

**投毒风险评估：**

POC 代码中没有明显的投毒代码。`woot1337.c` 中的代码只是简单地将有效用户和组 ID 设置为 0 并执行 `/bin/bash`，这是预期的提权行为。脚本也只是自动执行漏洞利用步骤。因此，投毒风险为 0%。

**项目地址:** [NewComrade12211/CVE-2025-32463](https://github.com/NewComrade12211/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)