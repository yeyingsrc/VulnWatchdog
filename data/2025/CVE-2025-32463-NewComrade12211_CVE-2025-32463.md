## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 1.9.14 到 1.9.17 (不包含1.9.17p1)

**利用条件:** 本地用户权限，目标主机存在受影响的Sudo版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件获取 root 权限。根据漏洞描述和提供的利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Sudo 在使用 `--chroot` 选项时，如果指定了用户可控的目录作为chroot根目录，且未正确处理 `nsswitch.conf`，则可能加载该目录下的 `nsswitch.conf` 文件，从而影响名称服务的查找行为。
2.  **利用步骤：**
    *   创建一个临时目录 `${STAGE}`。
    *   在该目录下创建一个 `woot/etc` 目录结构，用于存放伪造的 `nsswitch.conf` 文件。
    *   创建 `woot/etc/nsswitch.conf` 文件，内容指向 `/woot1337`（一个不存在的文件）。
    *   创建共享库 `libnss_/woot1337.so.2`，其中包含一个构造函数 `woot()`，该函数会设置用户和组 ID 为 0 (root)，然后执行 `/bin/bash`。
    *   使用 `sudo -R woot woot` 命令触发漏洞。这个命令的含义是：以 chroot 到 `woot` 目录的方式运行 `woot` 命令（实际上并不存在这个命令，只是用于触发sudo的nsswitch查找）。由于 `nsswitch.conf` 配置，sudo 会尝试加载 `libnss_/woot1337.so.2`。
    *   共享库的构造函数 `woot()` 执行，获得 root 权限，并启动一个新的 shell。

3.  **有效性分析：** 提供的 POC 代码与漏洞描述一致，能够有效利用该漏洞，在本地提升权限。

4.  **投毒风险分析：** 提供的脚本代码逻辑清晰，主要功能是构建特定目录结构和文件，用于触发漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险评估为0%。

**项目地址:** [NewComrade12211/CVE-2025-32463](https://github.com/NewComrade12211/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)