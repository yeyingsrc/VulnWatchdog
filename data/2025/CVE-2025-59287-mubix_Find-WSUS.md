## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2012/2012 R2/2016/2019/2022/2025/23H2受影响版本

**利用条件:** 攻击者需要能够访问WSUS服务器的网络，并能发送恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个Windows Server Update Service (WSUS)的远程代码执行漏洞，由于WSUS服务存在未授权的反序列化漏洞，攻击者可以通过发送特制的序列化数据到WSUS服务器，从而执行任意代码。\n\n**有效性评估：**\n根据CISA ADP Vulnrichment的信息，此漏洞存在可利用的POC（[https://gist.github.com/hawktrace/880b54fb9c07ddb028baaae401bd3951](https://gist.github.com/hawktrace/880b54fb9c07ddb028baaae401bd3951)）。漏洞库信息也表明该漏洞危害严重，CVSS评分为9.8。\n\n提供的/tmp/vulnwatchdog_cfdeec5cf325f8139a03d4a21208fe61/Find-WSUS.ps1脚本用于发现配置了WSUS服务器的Group Policy Objects(GPOs)。这个脚本本身不是直接的漏洞利用代码，而是信息收集工具，用于找到WSUS服务器地址。\n\n**投毒风险分析：**\n提供的`Find-WSUS.ps1`脚本主要功能是扫描域内GPO，查找WSUS服务器的配置信息。该脚本本身的行为是信息收集，并无明显的恶意代码植入行为。但是，从以下几个方面考虑，仍然存在一定的投毒风险：\n1.  **信息泄露：** 该脚本会收集域内所有WSUS服务器的地址，如果被恶意攻击者利用，可能会导致大规模的WSUS服务器被攻击。\n2.  **脚本替换：** 如果攻击者能够替换原始脚本，则可以在脚本中加入恶意代码，例如下载并执行恶意程序等。\n3.  **GPO篡改：** 虽然该脚本本身不会篡改GPO，但是攻击者可能会利用该脚本收集的信息，然后篡改GPO，将恶意WSUS服务器地址写入GPO，从而将域内机器引导到恶意WSUS服务器，进行恶意软件传播。\n\n由于该脚本的主要功能是信息收集，且存在一定的风险，因此认为存在10%的投毒风险。\n\n**利用方式分析：**\n1.  **信息收集阶段：** 使用`Find-WSUS.ps1`脚本扫描域内的GPO，获取WSUS服务器的地址。\n2.  **漏洞利用阶段：** 攻击者利用反序列化漏洞(CVE-2025-59287)，构造恶意序列化数据，发送到WSUS服务器。\n3.  **代码执行阶段：** WSUS服务器反序列化恶意数据，执行攻击者预先设定的恶意代码，从而控制WSUS服务器。\n\n攻击者通常会利用第一步的信息收集脚本确定目标WSUS服务器，然后利用反序列化漏洞进行攻击。

**项目地址:** [mubix/Find-WSUS](https://github.com/mubix/Find-WSUS)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)