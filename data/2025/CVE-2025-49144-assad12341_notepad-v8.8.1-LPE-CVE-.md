## CVE-2025-49144-Notepad++-特权提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 特权提升

**影响应用:** Notepad++

**危害等级:** 高危，允许本地低权限用户获取SYSTEM权限

**影响版本:** < 8.8.2

**利用条件:** 需要用户运行包含恶意regsvr32.exe的Notepad++安装包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49144是Notepad++ v8.8.1及之前版本安装程序中存在的本地特权提升漏洞。该漏洞源于安装过程中不安全的可执行文件搜索路径行为，允许本地攻击者通过将恶意可执行文件放置在与安装程序相同的目录中来获得SYSTEM级别的权限。

**有效性分析：**
提供的PoC代码描述了利用该漏洞的步骤，包括生成恶意`regsvr32.exe`，并将其与合法的Notepad++安装程序放置在同一目录中。当用户运行安装程序时，由于Windows搜索路径的问题，会执行恶意的`regsvr32.exe`，从而以SYSTEM权限执行攻击者的Payload。该方法利用了Windows在查找可执行文件时的默认行为，以及Notepad++安装程序在调用`regsvr32.exe`时未使用完整路径的疏忽。根据描述，该PoC代码是有效的。

**投毒风险分析：**
PoC代码描述中，包含了利用`msfvenom`生成Payload，然后嵌入到`regsvr32_loader.c`中，并编译成`regsvr32.exe`。这部分是漏洞利用的必要步骤，不应视为投毒代码。但是，由于PoC中让用户下载一个`regsvr32_loader.c`的文件，并让用户编辑后编译成`regsvr32.exe`，存在一定的风险。攻击者可能在提供的`regsvr32_loader.c`或者引导下载的PoC安装程序中添加恶意代码，虽然readme中已经提醒用户，但仍然存在潜在的投毒风险，大约占10%。

**利用方式：**
1.  **准备恶意`regsvr32.exe`：** 使用`msfvenom`或其他工具生成恶意Payload。将Payload嵌入到`regsvr32_loader.c`，或直接利用其他方法生成`regsvr32.exe`。
2.  **放置恶意文件：** 将生成的恶意`regsvr32.exe`与合法的Notepad++安装程序放置在同一目录下（例如，用户的Downloads目录）。
3.  **诱导用户运行：** 通过社会工程学或其他手段，诱导用户运行Notepad++安装程序。
4.  **权限提升：** 当用户运行安装程序时，会执行恶意的`regsvr32.exe`，攻击者从而获取SYSTEM权限。

**项目地址:** [assad12341/notepad-v8.8.1-LPE-CVE-](https://github.com/assad12341/notepad-v8.8.1-LPE-CVE-)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)