## J2V8 V8引擎漏洞利用

**漏洞编号:** CVE-2025-61472

**漏洞类型:** V8引擎漏洞利用 (n-day)

**影响应用:** J2V8

**危害等级:** 高危，远程代码执行

**影响版本:** 9.3.345.11 (存在多个n-day漏洞)

**利用条件:** 需要目标系统安装了受影响版本的J2V8，并且JAVA_HOME环境变量配置正确

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞利用代码针对J2V8使用的V8引擎版本9.3.345.11，此版本包含多个已知的n-day漏洞。

**有效性评估：**

*   **漏洞利用代码分析：** 代码通过利用V8引擎中的漏洞，例如JSON.stringify的hole，实现内存泄漏和越界读写（OOB）。它首先触发了一个hole，然后利用Map对象和一个数组oob_arr来进行内存布局控制。`addressOf`函数用于获取对象的地址，`AAR`和`AAW`函数分别用于绝对地址读写。最终，通过JIT喷射shellcode，并修改shellcode地址，实现远程代码执行。
*   **环境依赖：** 该漏洞利用代码依赖特定的V8编译选项，例如禁用指针压缩。作者提供的Dockerfile以及编译指令确保了这一点。同时, 该PoC在Ubuntu 22.04.5 LTS x64下测试成功.
*   **java test code** java测试代码确保了可以执行js脚本.并且js脚本是poc.js
*   **有效性结论：** 总体来看，如果J2V8的V8引擎版本和编译配置与漏洞利用代码的要求匹配，则该POC**可能有效**。

**投毒风险评估：**

*   **代码审查：** 从提供的漏洞利用代码来看，没有明显的恶意代码或后门。该代码主要用于漏洞利用和演示。
*   **构建过程审查：** 构建过程中，下载了预编译的libv8库。理论上，此处存在一定的投毒风险，因为预编译的库可能包含恶意代码。但代码中包含了下载链接，可以人工审计。
*   **投毒风险结论：** 总体来看，投毒风险较低，约为1%。最主要的风险在于下载的预编译库，但是可以通过验证checksum规避。

**利用方式分析：**

1.  **环境准备：** 设置JDK环境，下载并编译J2V8。
2.  **漏洞触发：** 执行JavaScript代码，触发V8引擎的漏洞。
3.  **内存布局控制：** 利用Map对象和数组控制内存布局。
4.  **信息泄露：** 利用越界读写漏洞泄漏内存地址。
5.  **地址读写：** 使用AAR和AAW函数进行任意地址读写。
6.  **JIT喷射：** 喷射shellcode到JIT代码区域。
7.  **ROP劫持：** 修改shellcode地址，劫持控制流，执行shellcode，实现远程代码执行。
8.  **Java调用** 通过Java代码调用V8引擎执行恶意JS，完成利用。


**项目地址:** [flywithjoey/CVE-2025-61472](https://github.com/flywithjoey/CVE-2025-61472)

**漏洞详情:** [CVE-2025-61472](https://nvd.nist.gov/vuln/detail/CVE-2025-61472)