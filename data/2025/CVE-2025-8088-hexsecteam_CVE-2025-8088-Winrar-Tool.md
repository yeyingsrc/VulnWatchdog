## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12 (Windows)

**利用条件:** 需要用户交互（主动解压恶意RAR文件）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 WinRAR 在 Windows 平台上的一个路径遍历漏洞。攻击者可以构造恶意的 RAR 压缩文件，利用路径遍历机制将 payload 写入到任意目录。提供的 POC 代码利用 NTFS 的 Alternate Data Streams (ADS) 和 RAR5 的头部操作来隐藏 payload 并进行路径注入，最终将 payload 写入 Windows 的启动目录，实现开机自启动。 

**漏洞利用方式：**

1.  **恶意RAR文件制作：** 使用提供的工具创建包含恶意路径的RAR压缩包。
2.  **ADS隐藏：**  将 payload 隐藏在 NTFS 的 ADS 中，绕过部分安全检测。
3.  **RAR5头部篡改：** 通过修改 RAR5 头部信息，将 payload 释放到目标目录（例如：启动目录）。
4.  **诱骗用户解压：**  诱使用户在受影响的 WinRAR 版本中解压恶意RAR文件。
5.  **代码执行：**  Payload 被释放到启动目录，系统重启后自动执行，从而控制目标系统。

**投毒风险分析：**

虽然该POC主要目标是展示漏洞利用方式，但仍然存在一定的投毒风险。

1.  **依赖项风险：** `requirements.txt` 文件中可能包含恶意或存在漏洞的第三方库。
2.  **Payload植入：** 攻击者可能在GUI工具中集成恶意payload，诱导用户生成包含后门的RAR文件。
3.  **源码篡改：** 代码本身可能包含隐藏的恶意行为，例如收集用户信息或执行其他恶意操作。
4.  **C&C通信：** Payload可能包含与外部服务器通信的代码，从而在受害者系统上建立持久性后门。

该漏洞exp作者在Telegram上发布其他漏洞利用工具，可能存在打包后门的情况，因此评定投毒风险为10%。用户在使用时需要谨慎，避免在生产环境中使用未经验证的代码。

**总结：**

该漏洞利用较为成熟，存在可行的 POC 代码。 攻击者可以利用该漏洞在目标系统上执行任意代码。 尽管提供的代码明确声明仅用于教育目的，但仍然存在潜在的投毒风险。 使用者应该谨慎对待，在安全的环境中进行测试，并避免直接使用未经审查的代码。

**项目地址:** [hexsecteam/CVE-2025-8088-Winrar-Tool](https://github.com/hexsecteam/CVE-2025-8088-Winrar-Tool)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)