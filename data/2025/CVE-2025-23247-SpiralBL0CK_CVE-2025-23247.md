## CVE-2025-23247-NVIDIA CUDA Toolkit-缓冲区长度验证失败导致代码执行

**漏洞编号:** CVE-2025-23247

**漏洞类型:** 缓冲区溢出

**影响应用:** NVIDIA CUDA Toolkit

**危害等级:** 中危，可能导致拒绝服务或任意代码执行

**影响版本:** All versions up to CUDA Toolkit 12.9

**利用条件:** 需要用户运行受感染的CUDA目标文件（.cubin）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-23247 存在于 NVIDIA CUDA Toolkit 的 cuobjdump 工具中。由于 cuobjdump 在处理 CUDA 目标文件时，没有充分验证 .nv_debug_source section中文件名字段的长度，导致整数溢出，触发缓冲区溢出。攻击者可以创建一个恶意的CUDA目标文件（.cubin），当用户使用 cuobjdump 工具解析该文件时，可能导致程序崩溃或执行任意代码。

**漏洞利用方式：**

1.  **生成CUDA目标文件（.cubin）：**  攻击者首先需要一个有效的CUDA目标文件作为基础，例如使用 `nvcc` 编译简单的CUDA程序得到 `.cubin` 文件。
2.  **修改.cubin文件：** 使用 `modify_simple.c` 程序修改 `.cubin` 文件。这个程序的主要功能是：
    *   读取现有的 `.cubin` 文件。
    *   在文件末尾添加一个恶意的 `.nv_debug_source` section。
    *   这个恶意的section包含一个畸形的条目，其中 `filename_size` 设置为 `0xffff`，而 `filename_offset` 指向section内的偏移，构造整数溢出漏洞的触发条件
    *   同时添加了其他的marker信息，用于调试和确认偏移。
    *   修改section header table，增加新section的信息
    *   更新 ELF header，增加section数量
    *   将修改后的 `.cubin` 文件写入新的文件。
3.  **利用cuobjdump触发漏洞:** 用户使用 NVIDIA CUDA Toolkit 提供的 `cuobjdump` 工具，并带上 `--dump-elf` 参数，处理被修改后的 `.cubin` 文件。`cuobjdump` 工具在解析 `.nv_debug_source` section 时，由于文件名字段长度验证的缺失，导致缓冲区溢出，进而可能导致程序崩溃或执行恶意代码。

**有效性：**

提供的POC代码看起来是有效的。它提供了一个 `modify_simple.c` 程序，该程序可以用来修改现有的 `.cubin` 文件，从而触发 cuobjdump 工具中的缓冲区溢出漏洞。从 `README.md` 和代码注释可以分析出作者已经验证了该漏洞的存在并且可以控制缓冲区和偏移，实现了崩溃PoC。

**投毒风险：**

提供的代码中没有明显的投毒代码。 `modify_simple.c` 的目的是生成一个包含恶意section的 `.cubin` 文件，以触发 cuobjdump 的漏洞。虽然利用本身具有潜在危害，但代码本身并没有执行恶意操作，例如植入后门或收集用户数据。因此，投毒风险为0%。

**项目地址:** [SpiralBL0CK/CVE-2025-23247](https://github.com/SpiralBL0CK/CVE-2025-23247)

**漏洞详情:** [CVE-2025-23247](https://nvd.nist.gov/vuln/detail/CVE-2025-23247)