## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要能够向WSUS服务器发送特制的SOAP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)远程代码执行漏洞。该漏洞源于WSUS在处理数据时存在不安全的反序列化操作。未经授权的攻击者可以通过网络发送特制的SOAP请求到WSUS服务器，利用漏洞执行任意代码，从而完全控制受影响的系统。

**有效性评估：**
根据提供的漏洞库信息和POC代码，该漏洞具有较高的有效性。漏洞库信息中明确指出该漏洞的类型为“Deserialization of Untrusted Data”，并且给出了CVSS评分9.8，属于危急漏洞。POC代码的说明文档中也明确指出，该代码旨在演示此漏洞的Proof-of-Concept，可以通过发送精心构造的SOAP请求触发漏洞并执行任意代码。

**投毒风险分析：**
虽然POC代码的README文件中声明该工具仅用于教育目的，但仍然存在一定的投毒风险。
1. `encypt.py` 主要进行加密和数据处理，代码功能相对独立，投毒可能性较低。
2. `exp.py` 负责构建和发送SOAP请求，是漏洞利用的核心部分。虽然代码中没有明显的恶意代码，但攻击者可能会修改payload，或者在其他地方添加后门代码，从而在目标系统上植入恶意软件。例如，攻击者可能修改`send_malicious_event`函数，在发送SOAP请求之前或之后执行恶意操作。
总体来说，投毒风险较低，作者声明仅用于教育用途，且exp.py中的逻辑较为清晰, 但是如果用于实际渗透, 还是需要仔细检查代码. 这里评估的投毒风险概率为10%。

**利用方式分析：**
1.  攻击者首先需要确定目标WSUS服务器的URL。
2.  攻击者需要生成一个恶意的.NET对象，该对象在反序列化时会执行攻击者指定的代码。
3.  使用.NET BinaryFormatter将恶意的.NET对象序列化，然后使用Base64编码。
4.  攻击者需要使用`encrypt.py`脚本来准备看起来像是WSUS加密和打包的数据。
5.  攻击者使用`exp.py`脚本构建包含恶意payload的SOAP请求，并将payload插入到WSUS服务器可以解密和反序列化的字段中。
6.  将构造好的SOAP请求发送到目标WSUS服务器的Web endpoint。
7.  如果服务器存在漏洞，WSUS服务将解密并反序列化payload，从而触发代码执行。
8.  攻击者利用执行的代码获得对目标系统的控制权。

**项目地址:** [th1n0/CVE-2025-59287](https://github.com/th1n0/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)