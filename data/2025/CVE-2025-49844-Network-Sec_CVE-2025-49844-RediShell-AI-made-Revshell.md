## CVE-2025-49844 Redis Lua Use-After-Free / CVE-2025-62507 Redis XACKDEL Stack Overflow

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free / Stack Overflow

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要已认证用户权限和网络访问Redis服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-49844 描述了 Redis 在 Lua 脚本处理中存在 Use-After-Free 漏洞，攻击者通过精心构造的 Lua 脚本，可操纵垃圾回收器，触发该漏洞，可能导致远程代码执行。修复版本为 8.2.2。缓解措施包括限制用户执行 Lua 脚本的权限。

搜索引擎结果为空，但提供了漏洞利用代码和相关文档。该文档提及了 CVE-2025-62507，并指出该漏洞（Redis `XACKDEL` 命令中的栈溢出）是比 Use-After-Free (CVE-2025-49844) 更简单的 RCE 利用方式，并提供了exp。

POC代码 (`CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py`) 利用 Redis 的 `XACKDEL` 命令处理 stream ID 时的栈溢出漏洞。该脚本首先建立与 Redis 服务的连接，然后创建一个 stream 和 consumer group。接着，脚本构造一个包含大量 stream ID 的 `XACKDEL` 命令，这些 stream ID 的长度经过精心设计，可以溢出栈缓冲区。`NUM_IDS_TO_SEND` 设置为大于 8 的值，确保溢出到重要的栈数据上。脚本发送该命令后，Redis 服务器预计会崩溃。

**有效性：**
根据 README 文档和 POC 代码分析，POC 脚本 `CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py` 可以触发 Redis 服务器的崩溃，表明该 POC 代码在一定程度上是有效的。README 提到已经成功触发了崩溃。因此，该漏洞的利用是有效的。

**投毒风险：**
考虑到以下因素，投毒风险较低：
*   代码相对简单，主要功能是构造并发送恶意 `XACKDEL` 命令。
*   代码使用了 `pwn` 库，但其使用方式是标准用法，未发现任何异常操作。
*   README 文件中描述了作者的测试过程和遇到的问题，没有发现任何恶意代码或意图。
*   代码文件都是文本文件，没有发现隐藏的二进制文件或混淆的代码。

综合分析，认为该仓库存在恶意投毒代码的可能性较低，大约为 5%。虽然存在风险，但从代码本身来看，没有明显的投毒迹象。

**利用方式：**
1.  攻击者需要能够连接到 Redis 服务。
2.  攻击者需要至少具有可以执行 `XGROUP CREATE` 和 `XACKDEL` 命令的权限，也就是需要认证。
3.  攻击者利用脚本构造包含超长 stream ID 的 `XACKDEL` 命令，触发栈溢出。
4.  攻击可能导致 Redis 服务崩溃或被远程代码执行（尽管 README 提到 RCE 实现比较困难）。

**项目地址:** [Network-Sec/CVE-2025-49844-RediShell-AI-made-Revshell](https://github.com/Network-Sec/CVE-2025-49844-RediShell-AI-made-Revshell)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)