## CVE-2025-49144 Notepad++ 本地提权漏洞

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，允许本地用户以SYSTEM权限执行任意代码

**影响版本:** < 8.8.2

**利用条件:** 需要用户下载并运行包含恶意 regsvr32.exe 的 Notepad++ 安装包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49144 是 Notepad++ v8.8.1 及更早版本安装程序中的一个本地权限提升漏洞。攻击者可以通过将恶意的 `regsvr32.exe` 文件与合法的 Notepad++ 安装程序放在同一目录下，诱骗用户运行安装程序，从而以 SYSTEM 权限执行任意代码。

**利用方式：**
1.  攻击者创建一个恶意的 `regsvr32.exe` 文件，该文件包含反弹 shell 的 shellcode。
2.  攻击者将此恶意文件与合法的 Notepad++ 安装程序（版本低于 8.8.2）放在同一目录下，例如用户的 Downloads 文件夹。
3.  攻击者诱骗用户运行 Notepad++ 安装程序。
4.  安装程序在执行过程中会调用 `regsvr32.exe`，但由于恶意文件与安装程序在同一目录下，Windows 会优先执行该恶意文件，从而以 SYSTEM 权限执行恶意代码。

**有效性：**
提供的 PoC 代码包括了生成恶意 `regsvr32.exe` 的步骤，以及运行 Metasploit 监听器的配置方法。该 PoC 代码描述清晰，逻辑完整，能够有效利用该漏洞。

**投毒风险：**
该漏洞利用代码中存在潜在的投毒风险。虽然PoC的主要目的是演示漏洞利用，但攻击者可能在`regsvr32_loader.c`中加入额外的恶意代码，例如安装后门、窃取信息等。虽然提供的LICENSE是MIT授权，并且readme描述的是无任何担保，但是从软件安全角度考虑，仍然存在一定的风险。风险点在于用户可能会直接使用提供的`regsvr32_loader.c`而未进行充分的代码审计。综上，判定存在5%的投毒风险。

**项目地址:** [TheTorjanCaptain/CVE-2025-49144_PoC](https://github.com/TheTorjanCaptain/CVE-2025-49144_PoC)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)