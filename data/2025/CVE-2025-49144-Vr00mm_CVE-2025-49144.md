## CVE-2025-49144 - Notepad++ Installer Privilege Escalation

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** < 8.8.2

**利用条件:** 用户需要下载并运行恶意的regsvr32.exe以及Notepad++的installer到同一个目录。用户需要运行Installer，且Installer版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Notepad++ v8.8.1 及其之前版本的安装程序中。攻击者可以通过将恶意的 `regsvr32.exe` 文件放置在与 Notepad++ 安装程序相同的目录下，利用不安全的可执行文件搜索路径来提升权限。当用户运行安装程序时，它会搜索并执行当前目录下的 `regsvr32.exe`，如果该文件是恶意的，攻击者就可以通过 SYSTEM 权限执行任意代码。

**有效性：**
POC 代码有效。PoC 描述清晰地说明了漏洞的利用方式，提供了构建恶意 `regsvr32.exe` 的说明，以及攻击流程的详细步骤。

**投毒风险：**
该 PoC 代码具有潜在的投毒风险。风险评估为10%，
   *   代码中包含CGO调用，允许执行C代码，C代码部分可能包含恶意代码或后门。
   *   代码使用了很多混淆技巧，增加了分析难度，可能隐藏恶意行为。
   *   代码中实现了反向 shell 功能，如果监听的 IP 地址和端口被修改为攻击者控制的服务器，可能会导致用户设备被远程控制。

**利用方式：**
1.  攻击者首先需要诱骗用户下载 Notepad++ 的安装程序以及一个伪装成 `regsvr32.exe` 的恶意程序到同一目录下（通常是用户的 Downloads 目录）。这通常需要通过社会工程学或点击劫持等手段。
2.  用户运行 Notepad++ 安装程序。
3.  安装程序在执行过程中，由于不安全的可执行文件搜索路径，会优先在当前目录下查找 `regsvr32.exe` 并执行。
4.  如果攻击者放置的 `regsvr32.exe` 是恶意的，它将以 SYSTEM 权限运行，从而允许攻击者执行任意代码并完全控制系统。

**项目地址:** [Vr00mm/CVE-2025-49144](https://github.com/Vr00mm/CVE-2025-49144)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)