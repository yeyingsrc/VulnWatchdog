## CVE-2025-47916 - Invision Community Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-47916

**漏洞类型:** 远程代码执行

**影响应用:** Invision Community

**危害等级:** 高危，允许未授权用户执行任意PHP代码

**影响版本:** 5.0.0 - 5.0.6

**利用条件:** 目标Invision Community实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

漏洞存在于 `IPS\core\modules\front\system\themeeditor::customCss()` 方法中。该方法未进行身份验证即可调用，并接受 `content` 参数的值传递给 `Theme::makeProcessFunction()` 进行处理。攻击者可以通过构造包含恶意PHP代码的模板字符串，利用`content`参数发送POST请求到目标URL，从而实现远程代码执行。 

**有效性评估：**
提供的POC代码看起来有效。它构造了一个包含PHP代码的payload，并将其作为`content`参数发送到目标URL。代码使用base64编码绕过了一些简单的过滤。

**投毒风险评估：**
代码的 `main.py` 文件相对简单，主要功能是构造和发送恶意请求，执行命令或测试漏洞。`README.md` 文件提供了漏洞描述和使用说明。 尽管目前来看没有明显的恶意代码，但存在以下潜在风险：
*   **依赖风险：** 代码使用了 `requests` 库，如果该库本身存在安全问题，可能会引入风险。
*   **命令执行风险：** 攻击者可以利用此代码在目标系统上执行任意命令，这本身就具有极高的风险。代码没有对执行的命令进行任何过滤或限制。
*   **潜在后门：** 如果攻击者修改了 `main.py` 文件，例如添加额外的请求或修改payload生成方式，可能会在不知情的情况下引入后门代码。考虑到潜在的风险（例如，在base64编码的命令中插入恶意代码），以及依赖项的安全性，投毒风险评估为10%。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问存在漏洞的 `themeeditor.php`。
2.  攻击者构造一个包含恶意PHP代码的模板字符串，并将其作为POST请求的 `content` 参数发送到目标URL。
3.  服务器端的 `Theme::makeProcessFunction()` 方法会解析并执行该模板字符串，从而执行攻击者提供的PHP代码。

**项目地址:** [Web3-Serializer/CVE-2025-47916](https://github.com/Web3-Serializer/CVE-2025-47916)

**漏洞详情:** [CVE-2025-47916](https://nvd.nist.gov/vuln/detail/CVE-2025-47916)