## CVE-2025-8088-WinRAR路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户使用受影响的WinRAR版本解压恶意构造的RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是WinRAR Windows版本中的一个路径遍历漏洞。攻击者可以创建一个恶意RAR压缩文件，当用户使用受影响的WinRAR版本（<= 7.12）解压该文件时，恶意文件会被写入到文件系统的任意位置，从而导致任意代码执行。该漏洞利用方式如下：

1.  **漏洞原理：** WinRAR在处理压缩文件时，没有充分验证压缩文件中包含的文件路径。攻击者可以利用`..\`这样的路径遍历字符，将文件写入到压缩包指定目录以外的位置。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意文件的RAR压缩包。
    *   压缩包中的恶意文件路径被设置为包含路径遍历字符的路径，例如`..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\important_update.lnk`，这将会把恶意文件写入到启动目录。
    *   用户使用受影响的WinRAR版本解压该恶意RAR压缩包。
    *   WinRAR会将恶意文件写入到启动目录，当用户下次启动计算机时，恶意代码会被执行。
3.  **POC有效性：** 提供的POC代码描述了如何生成包含恶意文件和路径的RAR压缩包，且该POC代码针对的是 CVE-2025-8088 漏洞，该漏洞存在于 WinRAR 7.12 及更早版本中，因此 POC 大概率有效。
4.  **投毒风险：** POC 代码本身主要功能是生成具有漏洞利用的RAR文件，并没有明显的恶意行为。但是需要注意的是，payload部分是完全由使用者控制的，使用者可以将任意恶意代码作为 payload 嵌入到生成的RAR文件中。payloads文件夹下创建sample函数存在风险，如果脚本被修改，生成的文件本身可能携带恶意代码。 builder.py不完整,函数find_rar() 无返回，可能存在问题,综上，判断存在10%的投毒风险。
5. **ADS流：** POC 使用了 ADS(Alternate Data Streams)，会将 payload 附加到文本文件中，利用 WinRAR 的路径遍历漏洞写入到指定目录。


**项目地址:** [papcaii2004/CVE-2025-8088-WinRAR-builder](https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)