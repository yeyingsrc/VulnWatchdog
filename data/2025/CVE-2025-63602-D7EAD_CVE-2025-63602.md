## CVE-2025-63602 - Awesome Miner 11.2.4 本地提权漏洞

**漏洞编号:** CVE-2025-63602

**漏洞类型:** 内核读写/代码执行

**影响应用:** Awesome Miner

**危害等级:** 高危，可能导致系统崩溃和任意代码执行

**影响版本:** 11.2.4

**利用条件:** 需要本地管理员权限或能够加载恶意驱动

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-63602 漏洞存在于 Awesome Miner 11.2.4 中，该版本包含一个不安全的驱动程序（WinRing0_1_2_0）。

**有效性分析：**
提供的 PoC 代码（poc.cpp）尝试利用该驱动程序执行以下操作：
1.  **获取驱动句柄：** 通过 `CreateFileA` 函数打开 `\\.\WinRing0_1_2_0` 设备，获得与驱动程序的交互句柄。
2.  **读取 MSR 寄存器：** 使用 `IOCTL_OLS_READ_MSR` IOCTL 命令读取 `MSR_LSTAR` 寄存器的值。
3.  **写入 MSR 寄存器：** 使用 `IOCTL_OLS_WRITE_MSR` IOCTL 命令向 `MSR_LSTAR` 寄存器写入一个无效地址(`INT64_MAX`)。
4.  **导致系统崩溃：** 向 `MSR_LSTAR` 写入错误的值会导致系统尝试在无效地址执行代码，从而导致内核崩溃。

该 PoC 代码的功能是读取 `MSR_LSTAR` 寄存器的值并尝试写入一个非法地址，预期结果是导致系统崩溃。 该PoC的有效性取决于漏洞是否真实存在，以及提供的驱动文件是否与受影响的版本匹配。

**投毒风险分析：**
分析提供的 PoC 代码，发现投毒风险较低。主要原因如下：
1.  代码功能清晰： 代码主要用于读取和写入 MSR 寄存器，目的明确。
2.  没有恶意行为： 代码的主要行为是尝试向 `MSR_LSTAR` 寄存器写入一个无效的值，目的是导致系统崩溃，而非植入后门或窃取数据。
3.  依赖特定环境： PoC 代码依赖于存在漏洞的驱动程序，脱离该环境后无法执行恶意行为。

但仍然存在少量投毒风险，例如：
1.  **修改写入值：** 攻击者可能修改 PoC 代码，将 `MSR_LSTAR` 寄存器写入其他更有危害的值，例如修改中断向量表，从而实现更高级的攻击。
2.  **替换驱动文件：** 攻击者可能提供一个被篡改的驱动文件，该文件包含恶意代码，可以在系统启动时执行。

综合考虑，投毒风险较低，估计为 5%。

**利用方式：**
该漏洞的利用方式如下：
1.  **获取漏洞驱动：** 获取存在漏洞的 WinRing0_1_2_0 驱动程序。
2.  **提升权限：** 在目标系统上以管理员权限运行 PoC 代码。
3.  **执行内核读写：** PoC 代码通过 DeviceIoControl 与驱动程序交互，执行对 MSR 寄存器的读写操作。
4.  **代码执行：** 向 `MSR_LSTAR` 寄存器写入无效地址，导致系统崩溃，或者写入恶意代码的地址，劫持控制流，执行任意内核代码。

**项目地址:** [D7EAD/CVE-2025-63602](https://github.com/D7EAD/CVE-2025-63602)

**漏洞详情:** [CVE-2025-63602](https://nvd.nist.gov/vuln/detail/CVE-2025-63602)