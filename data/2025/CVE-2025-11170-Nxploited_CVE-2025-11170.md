## CVE-2025-11170-WP迁移专用插件 for CPI-Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-11170

**漏洞类型:** 任意文件上传

**影响应用:** WP迁移专用插件 for CPI

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0.2

**利用条件:** 插件已安装并启用，目标服务器允许通过wp-admin/admin-ajax.php进行POST请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-11170 存在于WP迁移专用插件 for CPI <= 1.0.2版本中。攻击者无需身份验证即可通过向wp-admin/admin-ajax.php发送POST请求，利用Cpiwm_Import_Controller::import函数中缺失的文件类型验证，上传任意文件。  

**利用方式：**

1.  确定目标WordPress站点上安装并启用了受影响版本的WP迁移专用插件 for CPI。
2.  构造一个包含恶意代码（例如PHP webshell）的文件。
3.  使用提供的PoC脚本 (CVE-2025-11170.py)，指定目标URL、恶意文件名、base64编码的恶意文件内容，以及index参数（默认为0）。
4.  PoC脚本会将恶意文件上传到`wp-content/plugins/cpi-wp-migration/storage/`目录下。
5.  攻击者可以通过访问上传的webshell来执行任意代码。

**有效性评估：**

提供的PoC代码针对CVE-2025-11170，利用未授权任意文件上传漏洞。该脚本通过构造特定的POST请求，绕过身份验证，将恶意文件上传到目标服务器。因此，该PoC代码在受影响的WordPress站点上是有效的。

**投毒风险分析：**

该脚本主要功能是利用漏洞进行文件上传，虽然可以上传webshell，但本身没有明显的恶意代码用于投毒。

*   脚本从命令行参数获取URL、文件名和文件内容，这意味着攻击者可以控制上传的文件及其内容。
*   脚本使用`requests`库发送HTTP请求，存在网络通信。
*   脚本包含重试机制和User-Agent设置，较为规范。

因此，判断此仓库中是否存在作者隐藏的投毒代码风险较低, 风险大概为1%。

**项目地址:** [Nxploited/CVE-2025-11170](https://github.com/Nxploited/CVE-2025-11170)

**漏洞详情:** [CVE-2025-11170](https://nvd.nist.gov/vuln/detail/CVE-2025-11170)