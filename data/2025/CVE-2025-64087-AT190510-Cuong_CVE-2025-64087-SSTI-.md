## CVE-2025-64087 (SSTI FreeMarker)

**漏洞编号:** CVE-2025-64087

**漏洞类型:** 服务器端模板注入 (SSTI)

**影响应用:** XDocReport (versions 1.0.0 through 2.1.0)

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 1.0.0 - 2.1.0

**利用条件:** 需要上传.docx文档文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于XDocReport处理包含FreeMarker模板的DOCX文件时。由于`FreemarkerTemplateEngine.java`没有对用户上传的`.docx`文件中的模板内容进行充分验证和过滤，攻击者可以在`.docx`文件中嵌入恶意的FreeMarker表达式，导致远程代码执行 (RCE)。

**有效性：**
提供的POC代码是有效的。它展示了如何通过在.docx文件中插入FreeMarker表达式来执行系统命令，例如打开计算器、获取用户名或列出目录内容。更进一步的利用可以通过执行PowerShell命令来建立反向shell，从而实现远程控制。

**投毒风险：**
虽然提供的利用代码本身没有明显的恶意行为，但考虑到攻击者可能使用该漏洞进行各种恶意活动，包括数据窃取、系统破坏和进一步的攻击渗透，因此存在一定的投毒风险。风险评估为10%， 主要考虑到该POC本身较为基础，更高级的攻击手段可能隐藏在实际利用中，比如捆绑其他恶意文件或者利用RCE下载执行恶意代码。

**利用方式：**
1.  攻击者构造包含恶意FreeMarker表达式的`.docx`文件。
2.  攻击者将该`.docx`文件上传到存在漏洞的XDocReport应用程序。
3.  应用程序使用FreeMarker模板引擎处理该文件，执行恶意表达式。
4.  攻击者利用执行结果，例如反向shell，控制服务器。

**项目地址:** [AT190510-Cuong/CVE-2025-64087-SSTI-](https://github.com/AT190510-Cuong/CVE-2025-64087-SSTI-)

**漏洞详情:** [CVE-2025-64087](https://nvd.nist.gov/vuln/detail/CVE-2025-64087)