## CVE-2025-49844 (RediShell) - Redis Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要 Redis 服务运行，并且允许执行 Lua 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844 是 Redis 中 Lua 解释器中的一个 Use-After-Free 漏洞，存在于 Redis 8.2.2 之前的版本中。攻击者可以利用精心构造的 Lua 脚本来操纵垃圾回收器，触发 Use-After-Free 漏洞，最终导致远程代码执行。

**利用方式：**

1.  **连接 Redis 服务器：** 攻击者首先需要连接到目标 Redis 服务器，可以是认证的或未认证的，取决于服务器的配置。
2.  **发送恶意 Lua 脚本：** 通过 `EVAL` 命令将恶意的 Lua 脚本发送到 Redis 服务器。该脚本旨在利用 Lua 解释器的内存管理缺陷。
3.  **触发 Use-After-Free：** Lua 脚本会精心构造内存操作，通过垃圾回收机制，触发 Use-After-Free 漏洞。
4.  **绕过 Lua 沙箱（如果需要）：** 某些情况下，漏洞利用可能需要绕过 Lua 沙箱的限制，以执行更高级的操作。
5.  **执行任意代码：** 成功触发 Use-After-Free 漏洞后，攻击者可以利用内存损坏实现任意代码执行。
6.  **控制系统：**  最终，攻击者可以获得对 Redis 服务器所在主机的完全控制权，进行数据窃取、恶意软件安装等恶意活动。

**POC有效性：**

提供的 `Dockerfile` 和 `README.md` 描述了一个用于测试 CVE-2025-49844 漏洞的实验环境。`Dockerfile` 设置了一个运行 Redis 7.2.0 版本的 Docker 容器，该版本已知存在此漏洞。`README.md` 提供了快速启动说明和使用示例，包括检查漏洞状态、触发 UAF、测试沙箱逃逸和执行内存损坏模式。根据描述，POC 代码的目的是触发 UAF 漏洞并展示其潜在影响。因此，可以认为提供的 POC 代码是有效的，至少在指定的实验环境中可以验证该漏洞的存在。

**投毒风险评估：**

查看提供的 `Dockerfile` 和 `README.md` 文件，没有发现明显的恶意代码或后门。 `Dockerfile` 只是创建了一个包含易受攻击的Redis版本的环境,`README.md` 只提供了如何使用POC的说明，没有证据表明作者在这些文件中隐藏了任何投毒代码。因此，投毒风险非常低。


**项目地址:** [pedrorichil/CVE-2025-49844](https://github.com/pedrorichil/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)