## CVE-2025-64446 - FortiWeb RCE via Path Traversal + Auth Bypass

**漏洞编号:** CVE-2025-64446

**漏洞类型:** 路径遍历 + 身份验证绕过导致RCE

**影响应用:** Fortinet FortiWeb

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** 7.0.0 <= version <= 8.0.1 (受影响版本详见漏洞库信息)

**利用条件:** 目标FortiWeb实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-64446 是一个 FortiWeb 中的路径遍历漏洞，结合了内部 CGI 处理程序暴露和通过伪造标头绕过身份验证。 攻击者可以通过构造的 HTTP/HTTPS 请求在系统上执行管理命令，从而实现未经身份验证的远程命令执行。 

**漏洞利用方式：**

1.  **路径遍历:** 通过`../`等字符，访问受限目录外的文件。
2.  **内部 CGI 处理程序暴露:**  利用路径遍历访问原本不应该直接暴露的CGI程序 `fwbcgi`。
3.  **身份验证绕过:**  通过在 HTTP 请求头中设置 `CGIINFO` 标头，伪造管理员身份。该标头使用Base64编码的JSON字符串，包含用户名等信息。
4.  **命令执行：** 通过构造包含恶意命令的请求，利用 `fwbcgi` 执行任意命令。

**POC有效性：**

根据提供的漏洞库信息和POC代码，该POC很可能有效。漏洞库信息中提到CISA的已知被利用漏洞目录中包含该漏洞，并且GitHub上存在相关的利用代码。POC代码的逻辑也符合漏洞描述，通过构造特殊的HTTP请求头和请求体，可以绕过身份验证并执行命令。

**投毒风险分析：**

代码中存在添加用户的功能，利用了`/api/v2.0/cmdb/system/admin`，存在被恶意利用的风险。例如，攻击者可以修改脚本，添加一个具有root权限的后门用户，或者执行其他恶意操作。虽然该脚本本身目的是演示漏洞，但如果被不信任的来源修改，则可能引入恶意代码。因此，存在一定的投毒风险，保守估计为10%。

**缓解措施：**

*   升级到FortiWeb的修复版本（8.0.2, 7.6.5, 7.4.10, 7.2.12, 7.0.12 或更高版本）。
*   限制对FortiWeb管理界面的访问。
*   监控FortiWeb的日志，检测可疑的请求。

**项目地址:** [verylazytech/CVE-2025-64446](https://github.com/verylazytech/CVE-2025-64446)

**漏洞详情:** [CVE-2025-64446](https://nvd.nist.gov/vuln/detail/CVE-2025-64446)