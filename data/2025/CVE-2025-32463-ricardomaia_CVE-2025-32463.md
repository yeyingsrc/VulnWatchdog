## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463漏洞存在于Sudo 1.9.14到1.9.17p1版本中。该漏洞允许本地用户通过使用用户控制目录中的/etc/nsswitch.conf文件以及--chroot选项来获得root访问权限。漏洞的根本原因是Sudo在chroot环境下不正确地处理nsswitch.conf，导致它可以从用户可控的位置加载，从而允许恶意用户修改名称服务查找行为并加载恶意动态链接库以提升权限。

**有效性：**
提供的POC代码有效，因为它包含Dockerfile设置，模拟了易受攻击的和已修补的Sudo版本。此外，README.md 文件提供了使用Nuclei模板或直接利用exploit.sh脚本来测试漏洞的清晰说明。执行后，脆弱的容器应显示有效的UID和EUID。

**投毒风险：**
虽然该存储库似乎是为安全研究和漏洞验证而设计的，但是它确实包含利用代码，可能被滥用。投毒风险较低（约为10%），原因是：

*   该存储库主要关注漏洞概念验证，而不是隐蔽的恶意软件分发。
*   利用需要特定的环境设置（Docker容器）。
*   使用了代码签名，降低了篡改的风险

但是，必须注意，任何利用代码都存在被修改或重新用于恶意目的的潜在风险。攻击者可以修改提供的exploit.sh脚本，使其包含后门或其他恶意行为，然后在不知情的系统上部署修改后的版本。

**利用方式：**

1.  **环境准备：** 设置一个chroot环境，通常使用`sudo`命令的`--chroot`选项。
2.  **恶意`nsswitch.conf`：** 创建一个恶意的`/etc/nsswitch.conf`文件，该文件指向攻击者控制的动态链接库（.so文件）。
3.  **欺骗名称服务查找：** 当Sudo在chroot环境下执行名称服务查找（例如，查找用户或组信息）时，它将使用攻击者提供的`nsswitch.conf`文件。
4.  **加载恶意库：** 恶意`nsswitch.conf`文件配置名称服务查找以使用攻击者控制的动态链接库，从而允许攻击者执行任意代码。
5.  **权限提升：** 由于Sudo以root权限运行，因此攻击者控制的动态链接库中的代码也将以root权限执行，从而导致权限提升。

**项目地址:** [ricardomaia/CVE-2025-32463](https://github.com/ricardomaia/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)