## CVE-2025-34227-Nagios XI-命令注入

**漏洞编号:** CVE-2025-34227

**漏洞类型:** 命令注入

**影响应用:** Nagios XI

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2026R1

**利用条件:** 需要有效的Nagios XI用户凭据

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-34227是Nagios XI Configuration Wizard模块中的一个经过身份验证的命令注入漏洞。攻击者可以使用有效的Nagios XI凭据登录，然后利用monitoringwizard.php中的mysqlquery向database参数中注入恶意命令，从而以`nagios`用户的身份在底层主机上执行任意系统命令。

**有效性分析：**
提供的POC代码（CVE-2025-34227.py）通过模拟HTTP请求，首先尝试登录Nagios XI，然后使用`mysqlquery`配置向导，在`database`参数中注入命令。利用过程涉及获取nsp值，构造包含恶意命令的payload，并发送POST请求。根据漏洞库信息和提供的PoC，该利用方法是有效的。

**投毒风险分析：**
代码本身看起来简单直接，没有明显的投毒行为。它旨在利用命令注入漏洞，通过在 `database` 参数中附加恶意命令来执行系统命令。 考虑到代码的清晰性和目的的明确性，投毒风险极低，为0%。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录Nagios XI。
2.  **获取 NSP 值：** 从登录页面和Configuration Wizard页面获取必要的 `nsp` (nonce security parameter) 值。
3.  **构造 Payload：** 构造包含恶意命令的 HTTP POST 请求，该命令被注入到 `database` 参数中。例如，使用 `information_schema;touch /tmp/rceproof;` 在目标系统上创建一个文件。
4.  **发送请求：**  将构造的 POST 请求发送到 `/config/monitoringwizard.php` 端点。
5.  **命令执行：**  如果成功，该命令将以 `nagios` 用户的身份在目标系统上执行。
6.  **清理：**  建议删除创建的恶意服务，以避免潜在的监控问题。

**项目地址:** [mcorybillington/CVE-2025-34227_Nagios-XI-Command-Injection-Configuration-Wizard](https://github.com/mcorybillington/CVE-2025-34227_Nagios-XI-Command-Injection-Configuration-Wizard)

**漏洞详情:** [CVE-2025-34227](https://nvd.nist.gov/vuln/detail/CVE-2025-34227)