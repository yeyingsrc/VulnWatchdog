## CVE-2025-49144-Notepad++-权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，允许低权限用户获得 SYSTEM 权限

**影响版本:** < 8.8.2

**利用条件:** 需要用户下载并运行恶意文件，且用户必须运行 Notepad++ 安装程序。

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2025-49144 是 Notepad++ 安装程序中的一个权限提升漏洞。攻击者可以通过将恶意 DLL 文件与合法的 Notepad++ 安装程序放在同一目录下，当用户运行安装程序时，由于不安全的可执行文件搜索路径，恶意 DLL 文件会被以 SYSTEM 权限加载和执行。

**有效性：**
根据提供的漏洞信息和 POC 代码，该漏洞利用的有效性较高。POC 代码提供了一个示例利用方式，其中包含了 DLL 文件（在regsvr32_loader.c中通过shellcode体现）和说明文档。攻击者可以将该 DLL 文件放置在与 Notepad++ 安装程序相同的目录下，诱导用户运行安装程序，从而利用该漏洞提升权限。

**投毒风险：**
提供的 POC 代码中存在潜在的投毒风险。尽管包含了 MIT 许可证，并声明是为了帮助安全研究人员测试，但 regsvr32_loader.c 中的 `shellcode` 可以是任意恶意代码。该shellcode的具体内容被省略，无法判断shellcode本身的恶意程度，**因此，投毒的风险极高，保守估计为85%**。
从README.md文件中, 提供的下载链接指向 `raw.githubusercontent.com` 域名下的 `brauna/CVE-2025-49144_PoC.zip` 文件, 而kali Linux和CVE Details的链接也指向该zip文件，存在诱导用户下载恶意zip文件的潜在风险。

**利用方式：**
1.  **准备恶意 DLL 文件：**  攻击者需要创建一个恶意的 DLL 文件，该文件包含用于提升权限的 shellcode。`regsvr32_loader.c` 文件展示了一种加载 shellcode 的方式。
2.  **诱骗用户下载：**  攻击者需要诱骗目标用户下载 Notepad++ 的合法安装程序。同时，攻击者还需要诱骗用户下载该恶意 DLL 文件，并放置在与安装程序相同的目录下，例如用户的“下载”目录。
3.  **执行安装程序：**  当用户运行 Notepad++ 安装程序时，由于存在漏洞，恶意 DLL 文件将以 SYSTEM 权限加载和执行。
4.  **权限提升：**  恶意 DLL 文件中的 shellcode 将执行，从而允许攻击者以 SYSTEM 权限在目标系统上执行任意操作。

**项目地址:** [ammarm0010/CVE-2025-49144_PoC](https://github.com/ammarm0010/CVE-2025-49144_PoC)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)