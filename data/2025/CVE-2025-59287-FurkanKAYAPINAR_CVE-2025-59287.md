## CVE-2025-59287-Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，远程代码执行

**影响版本:** Windows Server 2012/2012 R2/2016/2019/2022/2025/23H2受影响版本

**利用条件:** 需要网络访问WSUS服务器，可能需要一定程度的权限，取决于WSUS的配置。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)中的远程代码执行漏洞，利用方式是通过发送特制的XML数据，触发反序列化漏洞，从而在服务器上执行任意代码。

**有效性：**根据CISA ADP Vulnrichment的信息，该漏洞存在利用的POC，并且可自动化利用，技术影响为total，因此POC代码有效。

**投毒风险：** 该POC代码主要功能是探测目标WSUS服务器，获取ServerId和AuthorizationCookie，最后构造恶意的SOAP请求，其中最核心的部分是构造包含恶意反序列化payload的XML数据。仔细审查POC代码，没有发现明显的投毒行为，例如植入后门或者篡改系统文件等恶意操作。但是，该代码确实存在一定风险，如果攻击者利用该代码进行攻击，可能会导致目标系统被植入恶意软件。因此，我们将投毒风险设置为1%。

**利用方式：**
1.  **探测端点：** 首先，脚本会探测目标WSUS服务器上可用的端点，如`/ClientWebService/Client.asmx`，`/SimpleAuthWebService/SimpleAuth.asmx`和`/ReportingWebService/ReportingWebService.asmx`。
2.  **获取Server ID：** 脚本尝试通过`ReportingWebService`获取WSUS服务器的ServerId。如果无法获取，则会生成一个随机的UUID作为ServerId。
3.  **获取认证Cookie：**  使用SimpleAuthWebService获取AuthorizationCookie，需要提供ServerId，这个cookie用于后续的认证。
4.  **构造恶意SOAP请求：** 脚本的关键部分是构造包含恶意反序列化payload的SOAP请求，利用ClientWebService的GetCookie接口发送该请求，触发漏洞。
5.  **执行任意代码：**  如果漏洞利用成功，攻击者可以在WSUS服务器上执行任意代码。

**项目地址:** [FurkanKAYAPINAR/CVE-2025-59287](https://github.com/FurkanKAYAPINAR/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)