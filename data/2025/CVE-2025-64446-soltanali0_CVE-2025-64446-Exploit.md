## CVE-2025-64446-FortiWeb-路径遍历

**漏洞编号:** CVE-2025-64446

**漏洞类型:** 路径遍历

**影响应用:** FortiWeb

**危害等级:** 高危，可导致权限提升和命令执行

**影响版本:** 8.0.0 <= 版本 <= 8.0.1
7.6.0 <= 版本 <= 7.6.4
7.4.0 <= 版本 <= 7.4.9
7.2.0 <= 版本 <= 7.2.11
7.0.0 <= 版本 <= 7.0.11

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64446是Fortinet FortiWeb中的一个相对路径遍历漏洞。攻击者可以通过构造恶意HTTP或HTTPS请求，在系统上执行管理命令。

**有效性：** 提供的POC代码利用了路径遍历漏洞，通过修改URL中的路径`/api/v2.0/cmdb/system/admin%3f/../../../../../cgi-bin/fwbcgi`，结合`CGIINFO`头部的base64编码的JSON数据，绕过身份验证，然后通过POST请求的body部分添加新的管理员用户。

**投毒风险：** 代码本身功能明确，目的是利用漏洞创建管理员用户，未发现明显的恶意代码或者后门，因此投毒风险较低。代码逻辑集中于漏洞利用，没有发现隐藏的、与漏洞利用无关的功能。

**利用方式：**
1.  **目标确定：**  确定存在漏洞的FortiWeb实例。需要目标IP地址和端口（通常是HTTPS的443端口）。
2.  **构造Payload：**  POC代码构造包含目标用户名和密码的JSON payload，并通过HTTP POST请求发送到目标服务器。利用路径遍历，访问`fwbcgi`，绕过权限验证。
3.  **发送请求：**  使用Python的`http.client`和`ssl`库发送构造好的恶意POST请求。由于使用了未验证的SSL上下文(`ssl._create_unverified_context()`)，可能存在中间人攻击的风险，因此攻击者应当确认目标的SSL证书。
4.  **创建用户：**  如果漏洞利用成功，将在FortiWeb系统中创建一个新的管理员用户，攻击者可以使用该用户登录并执行管理操作。

**项目地址:** [soltanali0/CVE-2025-64446-Exploit](https://github.com/soltanali0/CVE-2025-64446-Exploit)

**漏洞详情:** [CVE-2025-64446](https://nvd.nist.gov/vuln/detail/CVE-2025-64446)