## CVE-2025-64446-FortiWeb-路径遍历-权限提升

**漏洞编号:** CVE-2025-64446

**漏洞类型:** 路径遍历

**影响应用:** FortiWeb

**危害等级:** 高危，允许未经身份验证的远程攻击者执行管理命令。

**影响版本:** 7.0.0 <= version <= 8.0.1

**利用条件:** 目标FortiWeb实例可从网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64446是Fortinet FortiWeb产品中的一个相对路径遍历漏洞。未经身份验证的远程攻击者可以通过构造的HTTP或HTTPS请求在系统上执行管理命令。

**有效性评估：**

根据漏洞库信息，该漏洞影响FortiWeb 7.0.0到8.0.1的多个版本，且CVSS评分为9.1（CRITICAL）。CISA的已知被利用漏洞目录中也包含了此CVE，表明该漏洞已被积极利用。提供的POC代码（scanner.py）旨在探测目标FortiWeb实例是否存在此身份验证绕过漏洞。它通过发送包含特定路径的HTTP请求到`/api/v2.0/cmdb/system/admin/../../../../../cgi-bin/fwbcgi`，并检查返回的HTTP状态码和JSON响应内容来判断目标是否易受攻击。如果返回状态码为200，并且JSON响应中的errcode为"0"，message为"(null)"，则认为目标存在漏洞。状态码为403则表示已修复。因此，该POC代码看起来是有效的。

**投毒风险分析：**

查看提供的`scanner.py`代码，主要功能是发送特定构造的HTTP请求并分析响应。代码的功能相对简单直接，主要涉及以下操作：
*   构造HTTP请求，包括URL和路径。
*   发送请求并获取响应。
*   解析HTTP状态码和响应体（JSON格式）。
*   根据状态码和响应体的内容判断是否存在漏洞。
代码中没有发现任何明显的可疑行为，如执行系统命令、上传文件、修改配置等。代码逻辑主要集中于漏洞检测，而非利用。虽然存在通过网络请求与目标系统交互，但所有操作都服务于漏洞检测的目的。代码只读状态，没有写入，所以投毒风险可以判断为 **0%**。

**利用方式分析：**

该漏洞的利用方式是利用路径遍历绕过身份验证，从而执行管理命令。具体步骤如下：

1.  攻击者发送一个特制的HTTP或HTTPS请求到FortiWeb设备，请求包含类似`/api/v2.0/cmdb/system/admin/../../../../../cgi-bin/fwbcgi`的路径，该路径利用了相对路径遍历来访问受保护的资源。
2.  由于漏洞，FortiWeb设备错误地处理了这个请求，导致身份验证被绕过。
3.  攻击者可以执行原本需要身份验证才能执行的管理命令，从而控制FortiWeb设备。

**项目地址:** [sensepost/CVE-2025-64446](https://github.com/sensepost/CVE-2025-64446)

**漏洞详情:** [CVE-2025-64446](https://nvd.nist.gov/vuln/detail/CVE-2025-64446)