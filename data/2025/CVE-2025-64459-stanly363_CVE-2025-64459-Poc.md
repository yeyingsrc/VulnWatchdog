## CVE-2025-64459-Django-SQL注入

**漏洞编号:** CVE-2025-64459

**漏洞类型:** SQL注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露、权限提升和远程代码执行

**影响版本:** 5.1 < 5.1.14, 4.2 < 4.2.26, 5.2 < 5.2.8

**利用条件:** 需要存在接受用户输入并将其用于查询的Django应用，并使用了易受攻击的`QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()`或`Q()`，且没有对用户输入进行严格的白名单过滤。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Django的ORM中，攻击者可以通过构造包含恶意`_connector`参数的字典，并利用字典解包的方式将其传递给`QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()`或`Q()`，从而注入恶意的SQL代码。

**有效性：**
提供的POC代码通过Docker容器构建了一个包含漏洞版本的Django环境，并演示了如何利用该漏洞绕过身份验证。

**投毒风险：**
查看Dockerfile，只是下载依赖，安装依赖包，没有发现恶意代码，从README分析，作者没有动机投毒，只有安全研究的描述，所以投毒的可能性很低，几乎没有。评估投毒风险为 1%。

**利用方式：**
1.  攻击者向存在漏洞的Django应用程序发送包含恶意`_connector`参数的HTTP请求，例如`{'is_admin': False, 'username': 'nonexistent_user', '_connector': ') OR 1=1 OR ('}`。
2.  应用程序接收到请求后，将请求参数传递给`Q()`或`QuerySet.filter()`等方法，而没有对`_connector`参数进行充分的验证和过滤。
3.  Django ORM在构建SQL查询时，会将恶意`_connector`参数直接插入到SQL语句中，从而导致SQL注入。
4.  攻击者可以利用SQL注入执行任意SQL命令，例如绕过身份验证、获取敏感数据或执行其他恶意操作。

**项目地址:** [stanly363/CVE-2025-64459-Poc](https://github.com/stanly363/CVE-2025-64459-Poc)

**漏洞详情:** [CVE-2025-64459](https://nvd.nist.gov/vuln/detail/CVE-2025-64459)