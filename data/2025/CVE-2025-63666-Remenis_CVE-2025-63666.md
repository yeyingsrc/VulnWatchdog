## CVE-2025-63666 - Tenda AC15 身份验证绕过和会话劫持

**漏洞编号:** CVE-2025-63666

**漏洞类型:** 身份验证绕过/会话劫持

**影响应用:** Tenda AC15

**危害等级:** 高危，可能导致未经授权的访问和控制路由器

**影响版本:** V15.03.05.18_multi

**利用条件:** 需要与目标Tenda AC15路由器在同一网络，并且能够访问其Web管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Tenda AC15固件V15.03.05.18_multi中。Web管理界面中的`/login/Auth`接口在设置cookie时存在缺陷：

1.  **密码哈希泄露：** 使用`password=<MD5(password)><6-char suffix>`的格式设置cookie，直接将密码的MD5哈希值暴露给客户端。
2.  **缺乏安全标志：** Cookie缺少`HttpOnly`、`Secure`和`SameSite`等安全标志，使得攻击者可以通过JavaScript获取cookie，并容易受到跨站脚本攻击(XSS)和跨站请求伪造(CSRF)攻击。
3.  **可预测的会话ID：** 6字符的后缀熵值很低，容易被预测，允许攻击者重放或者劫持会话。

**漏洞利用方式：**

1.  攻击者可以首先通过任何方式获取目标路由器的管理员密码的MD5哈希值（例如，通过信息泄露漏洞或社会工程学）。
2.  攻击者使用已知的用户名（例如admin）和计算得到的密码哈希值通过`/login/Auth`接口进行认证。
3.  服务器返回一个包含密码哈希和6位后缀的cookie。
4.  由于cookie缺乏安全标志，攻击者可以使用JavaScript轻易地获取该cookie。
5.  攻击者可以通过在后续的请求中设置相同的cookie值，从而绕过身份验证，获得对路由器的控制权。
6.  也可以通过暴力破解6位后缀，尝试劫持已登录用户的会话。

**投毒风险分析：**

该POC代码本身主要用于演示漏洞的利用，虽然执行了curl请求，并使用了awk等命令提取cookie，但未发现直接执行恶意操作的代码。潜在的投毒风险在于，如果该仓库被用于其他恶意目的，例如，攻击者修改POC，加入后门代码或恶意脚本，则可能存在风险。根据代码逻辑的分析,判断投毒风险为10%。

**项目地址:** [Remenis/CVE-2025-63666](https://github.com/Remenis/CVE-2025-63666)

**漏洞详情:** [CVE-2025-63666](https://nvd.nist.gov/vuln/detail/CVE-2025-63666)