## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要非特权用户具有sudo访问权限，且sudo配置允许使用--chroot选项

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463 允许本地用户通过利用`--chroot`选项中的问题获得root权限。漏洞利用的方式是：

1.  **创建临时目录：** 利用代码首先创建一个临时目录 `/tmp/sudowoot.stage.*`。
2.  **生成恶意C代码：**  生成名为 `woot1337.c` 的恶意C代码，该代码包含执行root shell的逻辑。
3.  **设置伪造的chroot环境：** 设置一个伪造的chroot环境，包含特制的NSS配置 ( `/etc/nsswitch.conf`)。这个配置文件指示系统在查找用户时加载特定的共享库。
4.  **编译成共享库：** 将恶意C代码编译成共享库 `libnss_/woot1337.so.2`。当sudo在chroot环境下尝试解析用户名时，会加载这个共享库。
5.  **利用sudo -R执行：** 使用 `sudo -R woot woot` 命令，该命令会在chroot环境下执行，并加载伪造的nsswitch.conf, 从而加载恶意共享库，恶意共享库会设置UID/GID为0，并启动root shell。
6.  **清理临时文件：**  漏洞利用完成后，会自动清理临时文件。

**有效性：** 根据漏洞描述和POC代码，此漏洞利用是有效的。POC代码描述了利用漏洞的具体步骤，包括创建恶意共享库，配置nsswitch.conf，并使用sudo -R 触发漏洞。

**投毒风险：** 代码中存在轻微的投毒风险 (5%)。风险点主要在于：

*   **Go依赖：** `go.mod` 文件可能会包含未知的依赖项。尽管可能性很低，但如果依赖项被恶意篡改，则可能会引入投毒代码。但是, `go.sum` 文件的存在降低了这种风险，因为它记录了依赖项的哈希值, 防止被篡改。
*   **二进制预编译包：** 如果下载使用预编译二进制文件，可能包含恶意代码。

总体而言，直接投毒的可能性较低，更应该关注是否编译过程中是否存在安全风险。


**项目地址:** [Nowafen/CVE-2025-32463](https://github.com/Nowafen/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)