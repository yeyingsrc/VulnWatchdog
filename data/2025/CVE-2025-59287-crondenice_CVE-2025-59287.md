## CVE-2025-59287 Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 受影响的Windows Server版本见CVE信息

**利用条件:** 需要能够访问WSUS服务器的Client.asmx接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Windows Server Update Service (WSUS)中对不可信数据进行反序列化。攻击者可以通过构造恶意的`AuthorizationCookie`参数，发送到`GetCookie()` endpoint of the WSUS `Client.asmx` web service。通过`generate_payload.py`脚本生成包含恶意命令的序列化对象，并使用`exploit.py`脚本将该payload发送到目标WSUS服务器。成功利用此漏洞可以以SYSTEM权限执行任意代码。

**有效性：**
提供的POC代码（`generate_payload.py`和`exploit.py`）声称能够利用CVE-2025-59287漏洞在受影响的WSUS服务器上实现远程代码执行。其利用方式是利用不安全的反序列化漏洞。

**投毒风险：**
由于没有提供 `generate_payload.py` 和 `exploit.py` 脚本的具体内容，只能根据README.md文件进行推测。README.md中提及的 `ysoserial.exe` 是一个常用的payload生成工具，本身没有毒，但是利用它生成的payload可能包含恶意代码。另外，其中使用了从github引用的Key 1和从 hawktrace.com和github引用的Key 2，需要进一步确认该链接的安全性。假设作者有意投毒，可能的手段包括：

1.  **篡改Payload生成：** `generate_payload.py` 脚本可能被修改，以生成包含恶意代码的Payload。例如，除了执行攻击者指定的命令外，还额外执行一些恶意操作，如安装后门、删除数据等。
2.  **后门植入：**`exploit.py` 脚本可能包含后门代码，在成功利用漏洞后，允许攻击者后续访问受感染的系统。
3.  **信息窃取：** 脚本可能在利用漏洞的同时，收集受感染系统的信息，并将其发送给攻击者。

由于缺乏实际代码，无法准确判断是否存在投毒行为。初步估计存在10%的投毒风险。

**利用方式：**
1.  使用`generate_payload.py`脚本，指定监听IP地址和端口，生成base64编码的恶意payload。
2.  运行Metasploit或netcat监听指定端口。
3.  使用`exploit.py`脚本，指定目标WSUS服务器的`Client.asmx` URL和生成的base64编码的payload。
4.  如果漏洞利用成功，将在目标WSUS服务器上以SYSTEM权限执行payload中包含的命令，从而获取服务器的控制权。

**项目地址:** [crondenice/CVE-2025-59287](https://github.com/crondenice/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)