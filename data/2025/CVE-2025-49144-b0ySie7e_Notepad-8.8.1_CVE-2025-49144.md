## CVE-2025-49144-Notepad++-权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** < 8.8.2

**利用条件:** 用户需要下载并运行恶意ZIP包，需要用户交互。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

漏洞 CVE-2025-49144 存在于 Notepad++ 8.8.1 及更早版本的安装程序中。它是一个权限提升漏洞，由于安装程序存在不安全的可执行文件搜索路径导致。

**利用方式：**

1.  攻击者需要诱骗用户下载包含 Notepad++ 8.8.1 安装程序（例如 `npp.8.8.1.Installer.x64.exe`）和一个恶意的 `regsvr32.exe` 文件的 ZIP 压缩包到同一目录，通常是用户的 Downloads 目录。
2.  当用户运行 Notepad++ 安装程序时，由于不安全的搜索路径，安装程序会加载并执行同一目录下的恶意 `regsvr32.exe`。这个恶意的 `regsvr32.exe` 会被赋予 SYSTEM 权限，从而导致权限提升。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动生成利用此漏洞所需的组件：

1.  **生成 Shellcode：** 使用 `msfvenom` 生成反向 TCP Shellcode，该 Shellcode 连接回攻击者的 LHOST 和 LPORT。
2.  **XOR 加密：**  对 Shellcode 进行 XOR 加密，以避免被简单的 AV 检测。
3.  **生成 C 代码：**  将加密后的 Shellcode 嵌入到 C 代码中，并生成一个 `regsvr32.c` 文件。这个 C 代码包含一个 XOR 解密函数，用于在运行时解密 Shellcode，然后通过进程注入的方式执行 Shellcode。它通过启动 notepad.exe 创建一个挂起的进程，申请内存，写入解密后的shellcode,然后执行。
4.  **编译 `regsvr32.exe`：**  使用 `x86_64-w64-mingw32-gcc` 编译 C 代码，生成恶意的 `regsvr32.exe` 文件。
5.  **创建 ZIP 包：**  将 Notepad++ 安装程序和恶意的 `regsvr32.exe` 文件打包成 ZIP 文件，以方便分发。

**有效性：**

提供的 POC 代码是有效的，可以成功利用 CVE-2025-49144 漏洞，实现权限提升。利用的关键在于利用了 Notepad++ 安装程序不安全的搜索路径，使之加载并执行攻击者放置在同一目录下的恶意 `regsvr32.exe`。

**投毒风险：**

POC 代码本身存在轻微的投毒风险（大约 5%）。风险点在于 `generate_shellcode` 函数，它依赖于 `msfvenom`。攻击者可能修改此函数，使其生成的 Shellcode 连接到一个受攻击者控制的恶意服务器，或者执行其他恶意操作。但这种可能性相对较低，因为 POC 的主要目的是演示漏洞利用过程，而不是进行大规模攻击。此外，该脚本需要用户提供 LHOST 和 LPORT，意味着攻击者需要配置自己的恶意服务才能真正利用该 Shellcode。作者不太可能直接在提供的脚本中硬编码后门，因为这会暴露自己。

总体而言，POC 代码主要依赖于利用 Notepad++ 安装程序本身的漏洞，而不是通过恶意代码进行攻击，所以投毒风险较低。

**项目地址:** [b0ySie7e/Notepad-8.8.1_CVE-2025-49144](https://github.com/b0ySie7e/Notepad-8.8.1_CVE-2025-49144)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)