## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2025-32463是Sudo在1.9.17p1之前的版本中存在的一个本地权限提升漏洞。攻击者可以利用用户可控目录下的/etc/nsswitch.conf文件，在使用--chroot选项时，获得root权限。

**有效性评估：**

提供的Dockerfile、README.md和sudo-chwoot.sh文件构成了漏洞利用的完整POC。
*   Dockerfile：构建了一个包含漏洞版本的Sudo的Ubuntu 24.04环境，并添加了poc用户。
*   sudo-chwoot.sh：这是利用漏洞的关键脚本，它利用了--chroot选项和用户可控的/etc/nsswitch.conf文件。
*   README.md：提供了漏洞的详细信息，影响系统和利用方式，以及免责声明。
run.sh文件简化了 Docker 镜像的构建和运行过程，使漏洞复现更加便捷。综合分析，提供的POC代码有效。

**利用方式：**
1.  构建包含易受攻击的Sudo版本的Docker镜像。
2.  创建一个普通用户（例如pwn）。
3.  运行`sudo-chwoot.sh`脚本，该脚本会创建一个恶意的`/etc/nsswitch.conf`文件并利用`sudo`的`--chroot`选项执行命令，从而获得root权限。
脚本主要逻辑：
*   创建一个临时目录。
*   如果未提供命令，则默认启动交互式root shell，否则执行提供的命令。
*   对命令进行转义，以确保其安全地包含在chroot环境中。

**投毒风险：**

分析POC代码，投毒风险较低，约为10%。主要考虑以下几点：

*   `Dockerfile` 中未发现明显的恶意行为，只是构建了一个包含特定版本 Sudo 的环境。
*   `sudo-chwoot.sh` 脚本的主要目的是利用漏洞提升权限，未发现额外恶意代码，但存在植入后门的风险，例如在获取root权限后，修改系统文件或安装恶意软件。
*   `README.md` 只是提供漏洞信息和利用说明，没有发现恶意内容。

因此，虽然POC的主要目的是展示漏洞利用，但仍存在潜在的投毒风险，例如作者可能在成功提权后执行一些恶意操作。然而，这些风险相对较低，因为POC的主要目的是演示漏洞，而不是进行实际攻击。

**项目地址:** [yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)