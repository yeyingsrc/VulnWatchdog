## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 1.9.14 - 1.9.17 (不包含1.9.17p1)

**利用条件:** 需要本地用户权限，能执行sudo命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Sudo 的 chroot 功能中。攻击者可以通过控制 chroot 环境下的 /etc/nsswitch.conf 文件，加载恶意的 NSS 库，从而在 sudo 执行用户/组查找时，利用该库以 root 权限执行任意代码。POC 代码通过 Dockerfile 构建包含漏洞版本的 sudo 环境，并提供 poc.sh 脚本来演示漏洞利用过程。poc.sh 脚本编译一个恶意的 NSS 库，设置 UID/GID 为 0，并生成一个 root shell。然后，它会创建一个假的 chroot 环境，其中包含一个恶意的 nsswitch.conf 文件，将查找重定向到攻击者的 NSS 库。最后，它使用 `sudo -R <chroot_path> /bin/true` 命令来触发漏洞。由于构造的恶意nsswitch.conf会优先于系统配置，且在高权限下运行恶意NSS库，导致提权。该代码未发现明显的投毒代码，因为整个利用链条是公开且符合漏洞描述的。

**项目地址:** [lowercasenumbers/CVE-2025-32463_sudo_chroot](https://github.com/lowercasenumbers/CVE-2025-32463_sudo_chroot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)