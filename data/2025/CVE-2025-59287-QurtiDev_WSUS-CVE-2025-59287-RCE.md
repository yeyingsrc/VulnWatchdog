## CVE-2025-59287-Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025, 23H2 (受影响版本见漏洞库信息)

**利用条件:** 需要能够访问WSUS服务器的 ClientWebService/Client.asmx 端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-59287是一个Windows Server Update Services (WSUS) 远程代码执行漏洞。该漏洞源于对不可信数据的反序列化。攻击者可以通过构造恶意请求，向WSUS服务器的`ClientWebService/Client.asmx`端点发送包含恶意序列化数据的SOAP请求，从而在服务器上执行任意代码，获取SYSTEM权限。

**利用方式：**

1.  生成PowerShell反向Shell命令。
2.  使用`ysoserial.net`工具（TypeConfuseDelegate gadget）序列化payload。
3.  使用AES-128-CBC算法（固定密钥，随机salt）加密序列化的payload。
4.  对加密后的数据进行Base64编码。
5.  将编码后的payload嵌入到SOAP信封的`AuthorizationCookie`字段中。
6.  将SOAP请求发送到目标WSUS服务器的`GetCookie`端点。
7.  服务器解密并反序列化payload，执行PowerShell命令，建立反向shell连接。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞存在有效的POC代码，并且已经被利用。

**投毒风险：**

该POC代码主要实现了漏洞的利用，加密和编码方式在代码中清晰可见，未发现明显的恶意代码或后门。虽然代码在加密过程中使用了固定的AES密钥，降低了加密的安全性，但这不是投毒行为。代码中存在的风险较低，因为漏洞利用本身依赖于反序列化漏洞，而不是POC代码引入的新的安全问题。投毒风险较低，初步评估约为5%。

**项目地址:** [QurtiDev/WSUS-CVE-2025-59287-RCE](https://github.com/QurtiDev/WSUS-CVE-2025-59287-RCE)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)