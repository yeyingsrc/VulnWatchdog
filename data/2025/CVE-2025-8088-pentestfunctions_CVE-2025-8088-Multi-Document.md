## CVE-2025-8088-WinRAR-路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者通过构造恶意压缩文件执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意的RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是WinRAR中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过创建特制的RAR压缩文件，当用户使用WinRAR解压时，将恶意文件释放到Windows启动目录等敏感位置，从而实现任意代码执行。

**漏洞利用方式：**

1.  **构造恶意RAR压缩文件：** 攻击者创建一个RAR文件，其中包含使用特殊路径的文件条目。这些路径利用路径遍历字符（`../`）来尝试在文件系统上写入到目标目录之外的位置。
2.  **利用ADS (Alternate Data Streams):** 漏洞利用代码使用了ADS，将payload.bat附加到解压的诱饵文件。当目标文件被访问时，payload.bat会被执行
3.  **诱骗用户解压：** 攻击者将恶意RAR文件发送给受害者，并诱骗他们使用易受攻击的WinRAR版本打开它。
4.  **代码执行：** 当WinRAR尝试解压RAR文件时，路径遍历漏洞允许将恶意文件（例如payload.bat）写入启动目录。系统重启后，payload.bat会被自动执行，导致攻击者控制系统。

**POC有效性：**

根据提供的漏洞信息和POC代码，该POC代码很可能有效。漏洞库信息表明该漏洞已经在野外被利用。POC代码模拟了恶意RAR文件的创建过程，并尝试将payload写入启动目录。

**投毒风险：**

虽然POC代码本身实现了漏洞利用，但仍然存在一定的投毒风险。以下是一些考虑因素：

*   **代码复杂性：** 尽管代码相对简单，但仔细检查每一行以确保没有隐藏的恶意行为仍然很重要。
*   **依赖项：** POC代码依赖于标准的Python库，例如`os`、`struct`、`subprocess`和`zlib`。这些库本身不太可能包含恶意代码。
*   **目标：** 该POC的目的是演示漏洞利用，而不是进行实际攻击。但是，修改此POC以包含恶意负载相对容易。
*   **作者意图：** 假设作者的意图是好的，但无法保证。

综合考虑以上因素，我估计此仓库存在10%的投毒风险。这个估计基于以下几点：代码看起来直接实现路径遍历利用，但是无法完全排除一些混淆或隐蔽的代码的存在。因为攻击者可能在payload本身做手脚, 这使得评估投毒风险变得困难. 代码中存在一些可配置的参数，例如`PAYLOAD`和`RELATIVE_DROP_PATH`，这些参数可以被修改为执行恶意操作。

**项目地址:** [pentestfunctions/CVE-2025-8088-Multi-Document](https://github.com/pentestfunctions/CVE-2025-8088-Multi-Document)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)