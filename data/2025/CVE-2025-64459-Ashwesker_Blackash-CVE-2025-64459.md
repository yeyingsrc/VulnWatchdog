## CVE-2025-64459-Django-SQL注入

**漏洞编号:** CVE-2025-64459

**漏洞类型:** SQL注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露和数据篡改，权限提升

**影响版本:** 4.2 < 4.2.26, 5.1 < 5.1.14, 5.2 < 5.2.8

**利用条件:** 需要存在使用不安全方式处理用户输入并传递给ORM查询的接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-64459 是一个 Django 框架中的 SQL 注入漏洞，存在于 `QuerySet.filter()`、`QuerySet.exclude()`、`QuerySet.get()` 和 `Q()` 方法中。 攻击者可以通过操纵 `_connector` 参数来改变 SQL 查询的逻辑。漏洞利用方式是通过构造恶意的字典，利用字典展开作为这些函数的 `**kwargs` 参数，从而控制 `_connector` 和 `_negated` 内部参数，最终实现 SQL 注入。例如，攻击者可以修改username参数，并且通过_connector=OR来绕过用户名密码验证直接登录系统。提供的 README.md 文件描述了漏洞的详细信息、影响版本、利用方法以及缓解措施。代码片段中展示了如何利用请求参数 `_connector` 来改变查询行为，导致 SQL 注入。

**有效性：**
提供的 README.md 文件包含了漏洞的详细信息和利用方法，说明了漏洞利用是有效的。通过构造恶意的 HTTP 请求，可以触发 SQL 注入。

**投毒风险：**
该文件仅包含漏洞信息和利用说明，没有发现任何隐藏的恶意代码或后门。 投毒风险评估为5%，因为理论上存在篡改文档内容误导使用者的可能性，但从目前的文件内容来看，更像是漏洞说明而非恶意Payload。

**利用方式：**
1.  确定目标 Django 应用使用的版本在受影响范围内 (4.2 < 4.2.26, 5.1 < 5.1.14, 5.2 < 5.2.8)。
2.  找到应用中使用 `QuerySet.filter()`、`QuerySet.exclude()`、`QuerySet.get()` 或 `Q()` 方法，并且接收用户输入作为 `**kwargs` 参数的接口。
3.  构造包含恶意 `_connector` 参数的 HTTP 请求，例如：`?username=admin&_connector=OR&is_superuser=True`，绕过身份验证或其他安全检查。
4.  根据实际情况调整 Payload，实现任意 SQL 查询。

**项目地址:** [Ashwesker/Blackash-CVE-2025-64459](https://github.com/Ashwesker/Blackash-CVE-2025-64459)

**漏洞详情:** [CVE-2025-64459](https://nvd.nist.gov/vuln/detail/CVE-2025-64459)