## CVE-2025-32434-PyTorch-RCE

**漏洞编号:** CVE-2025-32434

**漏洞类型:** 远程代码执行

**影响应用:** PyTorch

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.6.0

**利用条件:** 需要加载恶意的torch模型文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PyTorch的`torch.load`函数中，当`weights_only=True`时，由于使用了不安全的pickle反序列化，可能导致远程代码执行。攻击者可以构造包含恶意代码的torch模型文件，诱导受害者加载，从而执行任意代码。

**有效性：**
根据漏洞信息和利用代码，POC代码是有效的。它利用了`torch.load`在`weights_only=True`时对pickle反序列化的不安全性。漏洞利用代码生成了一个包含恶意payload的tar文件，payload利用`__builtin__.eval`执行任意代码。虽然poc尝试绕过`weights_only=True`时的安全检查失败，但是可以通过设置`weights_only=False`来成功利用，从而达到远程代码执行的效果。

**投毒风险：**
该仓库存在一定的投毒风险，大约10%。原因如下：
*   虽然POC代码本身的功能是利用已知的漏洞，但如果攻击者修改了POC代码，例如在payload中添加恶意行为，则可能导致用户在不知情的情况下执行恶意代码。例如, 可以尝试替换`print("Something Executed!")`为更具破坏性的命令。
*   `requirements.txt`文件中指定了`torch==2.5.0`，这是一个存在漏洞的版本，强制用户使用存在漏洞的环境本身也是一种隐形的投毒。

**利用方式：**
1.  攻击者构造一个包含恶意payload的torch模型文件（例如，`storages.tar`），该payload利用pickle反序列化漏洞执行任意代码。
2.  攻击者将该恶意模型文件发送给受害者。
3.  受害者使用`torch.load(tar, weights_only=False)`加载该恶意模型文件。
4.  `torch.load`函数在反序列化过程中执行了恶意payload，导致远程代码执行。

**项目地址:** [cyhe50/cve-2025-32434-poc](https://github.com/cyhe50/cve-2025-32434-poc)

**漏洞详情:** [CVE-2025-32434](https://nvd.nist.gov/vuln/detail/CVE-2025-32434)