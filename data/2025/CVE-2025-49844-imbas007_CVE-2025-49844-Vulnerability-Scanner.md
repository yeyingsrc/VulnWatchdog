## CVE-2025-49844-Redis Lua Use-After-Free 远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务开启，并且Lua脚本功能未被禁用，以及能与redis建立连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-49844 是一个 Redis 数据库中 Lua 脚本引擎的 Use-After-Free 漏洞，可能导致远程代码执行。攻击者可以利用精心设计的 Lua 脚本来操纵垃圾回收器，触发 Use-After-Free 漏洞。该漏洞影响 Redis 8.2.2 之前的版本。

**有效性：**
提供的 Python 脚本是一个漏洞扫描器，用于检测 Redis 服务是否存在 CVE-2025-49844 漏洞，通过连接目标 Redis 服务，获取 Redis 版本信息，并根据版本号判断是否存在漏洞，并判断Lua脚本是否可用。

**投毒风险：**
该脚本的主要功能是检测漏洞，没有发现明显的恶意代码或后门。脚本行为符合漏洞扫描器的预期，风险较低，评估为1%。

**利用方式：**
1.  攻击者需要能够访问目标 Redis 服务，端口默认 6379。
2.  攻击者需要确保 Redis 服务没有禁用 Lua 脚本功能（可以通过 ACL 限制 EVAL 和 EVALSHA 命令来缓解）。
3.  攻击者发送特制的 Lua 脚本到 Redis 服务器。
4.  该脚本利用 Redis 的 Lua 脚本引擎中的 Use-After-Free 漏洞。
5.  成功利用后，攻击者可以在 Redis 服务器上执行任意代码，从而完全控制服务器。


**项目地址:** [imbas007/CVE-2025-49844-Vulnerability-Scanner](https://github.com/imbas007/CVE-2025-49844-Vulnerability-Scanner)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)