## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取Root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，目标系统sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17 版本（不包含 1.9.17p1）。该漏洞允许本地用户利用 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件获取 root 权限。

**漏洞利用方式：**

1.  **准备环境：** 漏洞利用脚本创建一个临时目录作为 `chroot` 的根目录，并在该目录中创建必要的目录结构（例如 `king/etc`、`libnss_`）。
2.  **放置恶意`nsswitch.conf`：** 在 `chroot` 根目录的 `etc` 目录下放置一个恶意的 `nsswitch.conf` 文件。该文件将密码数据库的查找指向一个恶意共享库（`king.so.2`）。
3.  **放置恶意共享库：** 将预编译的恶意共享库 `king.so.2` 放置在 `libnss_` 目录下。此共享库会在密码查找时执行恶意代码，从而提升权限。
4.  **执行Sudo命令：** 使用 `sudo -R king king` 命令，指定 `chroot` 根目录为之前创建的临时目录。`sudo` 在执行命令时会读取该目录下的 `nsswitch.conf` 文件，并加载恶意共享库。
5.  **权限提升：** 恶意共享库执行，通常通过 `setuid` 等方式将当前用户的权限提升为 root。

**有效性：**

根据漏洞库信息和提供的PoC代码，该漏洞利用是有效的。PoC代码已经实现了自动化利用过程，包括架构检测、payload选择和执行。

**投毒风险：**

存在一定的投毒风险，概率为10%。

*   **脚本的执行流程相对清晰:**  脚本的主要功能是选择合适的payload并执行提权操作, 代码可读性较高。
*   **二进制Payload:** 脚本依赖于预编译的二进制 payload (`king.so.2`)，这些payload可能包含未公开的恶意行为。尽管脚本尝试选择与目标架构匹配的 payload，但无法保证这些 payload 的安全性，存在被篡改的风险。不过PoC的目的是验证漏洞存在，因此payload是预先准备好的，不应被判定为投毒。
*   **临时文件:** 脚本创建临时目录，并写入文件。虽然脚本最后会清理临时文件，但是也存在风险。 
*   **漏洞利用本质:**  利用 `sudo --chroot` 选项和用户可控的 `nsswitch.conf` 文件，来加载恶意的共享库，从而实现提权，符合漏洞描述。

**项目地址:** [shazed-x/CVE-2025-32463](https://github.com/shazed-x/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)