## CVE-2025-49844 (RediShell) - Redis Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis开启Lua脚本支持，以及具有执行EVAL和EVALSHA命令的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 RediShell 是一个Redis Lua 解释器中的 Use-After-Free 漏洞，存在于 Redis 8.2.2 之前的版本中。利用该漏洞，经过身份验证的用户可以使用特制的 Lua 脚本来操纵垃圾收集器，触发 Use-After-Free 漏洞，并可能导致远程代码执行。

**有效性:**

提供的 Dockerfile 和 README.md 文件构成了一个用于复现 CVE-2025-49844 的实验环境。Dockerfile 设置了一个易受攻击的 Redis 实例（7.2.0 版本），禁用了 protected-mode，并允许从任何地址绑定，暴露了6379 端口。README.md 提供了关于漏洞的信息和利用说明，其中包含使用 python 脚本 `exploit_poc.py` 的利用示例。这个 POC 看起来是有效的，因为它明确针对了漏洞，并提供了不同模式的测试，例如 basic UAF 触发，沙箱逃逸和内存破坏。同时也说明了修复版本以及绕过缓解措施。

**投毒风险:**

对提供的 Dockerfile 和 README.md 文件内容进行分析，发现投毒风险较低。以下是分析结果：

*   **Dockerfile:** Dockerfile 的主要目的是创建一个存在漏洞的 Redis 实例，禁用了安全设置，以便于漏洞利用的演示和测试。该 Dockerfile 本身没有发现恶意代码或后门。
*   **README.md:** README.md 文件提供了漏洞的信息和利用说明，以及如何使用 `exploit_poc.py` 脚本来测试漏洞。该文件本身没有发现恶意代码或后门。
*   **exploit_poc.py (未提供全部代码，但分析思路相同):**  如果 `exploit_poc.py` 脚本包含恶意代码，例如在成功利用漏洞后安装后门或执行其他恶意操作，那么就存在投毒风险。但是，从提供的 `README.md` 文件的描述来看，该脚本的主要目的是验证漏洞的存在，而不是执行恶意操作。需要检查脚本内容才能确认。

因此，综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，估计为 10%。 重点需要review `exploit_poc.py` 代码

**利用方式:**

漏洞利用方式如下：

1.  **环境准备：** 构建包含漏洞版本的 Redis 实例，例如使用提供的 Dockerfile。
2.  **连接 Redis：** 使用 Redis 客户端连接到 Redis 服务器。
3.  **执行恶意 Lua 脚本：** 使用 EVAL 或 EVALSHA 命令执行特制的 Lua 脚本。该脚本会操纵垃圾收集器，触发 Use-After-Free 漏洞。
4.  **沙箱逃逸（如果需要）：** 利用漏洞绕过 Lua 沙箱的限制，访问受限函数。
5.  **远程代码执行：** 执行任意本地代码，从而获得对主机的完全访问权限。

**项目地址:** [raminfp/redis_exploit](https://github.com/raminfp/redis_exploit)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)