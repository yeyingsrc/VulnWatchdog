## CVE-2025-55752：Apache Tomcat 路径遍历漏洞

**漏洞编号:** CVE-2025-55752

**漏洞类型:** 路径遍历

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致敏感信息泄露，如果PUT方法开启，可能导致RCE

**影响版本:** 11.0.0-M1 到 11.0.10, 10.1.0-M1 到 10.1.44, 9.0.0.M11 到 9.0.108, 8.5.6 到 8.5.100

**利用条件:** 需要存在RewriteValve组件且配置不当，允许URL重写。如果需要RCE，还需要开启PUT方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-55752 是 Apache Tomcat 中 RewriteValve 组件的一个路径遍历漏洞，由于 URL 规范化处理顺序不当导致，URL 规范化发生在 URL 解码之前。这使得攻击者能够使用 URL 编码的路径遍历序列（如 `..%2f`）绕过安全约束，访问受保护的目录（如 `/WEB-INF/`）。

**有效性：**

提供的POC代码是有效的，它提供了一个基于Docker的复现环境，并提供了一个简单的URL来验证漏洞的存在。访问`http://localhost:8080/rewrite/..%2fWEB-INF/web.xml` 如果能够访问`/WEB-INF/web.xml`文件，则漏洞存在。

**投毒风险：**

分析POC代码内容，该POC主要提供了Docker环境的搭建方式和一个验证漏洞的URL，用于复现漏洞。代码主要是一些docker-compose的配置和说明文档，**不存在作者隐藏的投毒代码**。
因此，投毒风险为0%。

**利用方式：**

1.  **前提条件：** Tomcat服务器启用了RewriteValve组件，并且存在不安全的URL重写规则。
2.  **构造恶意URL：** 攻击者构造包含URL编码的路径遍历序列的URL，例如`..%2f`。
3.  **绕过安全检查：** 由于URL规范化先于解码，服务器会先对`..%2f`进行规范化处理，而不会将其解码为`../`。这使得攻击者可以绕过通常的安全检查。
4.  **访问受保护资源：** 攻击者可以利用此漏洞访问位于`/WEB-INF/`或`/META-INF/`等受保护目录中的文件，例如`web.xml`。
5.  **远程代码执行（RCE）：** 如果服务器同时开启了PUT方法，攻击者可以通过上传恶意WAR文件等方式实现远程代码执行。但这需要PUT请求也被允许，且没有其他的安全限制。

**项目地址:** [AuroraSec-Pivot/CVE-2025-55752](https://github.com/AuroraSec-Pivot/CVE-2025-55752)

**漏洞详情:** [CVE-2025-55752](https://nvd.nist.gov/vuln/detail/CVE-2025-55752)