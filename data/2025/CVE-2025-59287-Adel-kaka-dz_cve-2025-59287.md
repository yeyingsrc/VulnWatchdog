## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows Server版本包括2012、2012 R2、2016、2019、2022和2025的特定版本范围，具体请参考漏洞库信息中的CPE匹配。

**利用条件:** 需要网络访问WSUS服务器，利用不受信任的数据反序列化漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS) 中的远程代码执行漏洞，由于对不可信数据进行反序列化操作而导致。攻击者可以通过网络发送特制的请求到WSUS服务器，利用此漏洞执行任意代码。提供的POC代码包含一个加密模块和一个利用模块。加密模块用于加密恶意payload，确保payload能够通过WSUS的通信机制。利用模块负责发送payload到目标WSUS服务器，触发反序列化漏洞，从而执行攻击者指定的命令。虽然该POC代码有免责声明，作者也声明仅用于教育目的和授权渗透测试。但是还是存在一定的投毒风险，例如，作者可能在payload生成或发送过程中植入后门代码，用于进一步控制受害者系统或窃取敏感数据。这种风险不能排除，因此评估为存在10%的投毒风险。

**利用方式：**

1.  **准备阶段：**
    *   安装依赖：`pip install -r requirements.txt`
    *   生成Payload： 使用`cve-2025-59287-encr.py`脚本生成经过AES加密的payload，可以自定义执行的命令，选择加密模式（legacy或secure），并指定输出文件。
    *   例如：`python cve-2025-59287-encr.py --command "whoami /all" --output custom_payload.txt`
2.  **攻击阶段：**
    *   使用`cve-2025-59287-exp.py`脚本发送payload到目标WSUS服务器。需要指定目标WSUS服务器的URL，可以选择使用自定义的payload文件，并设置超时时间和重试次数。
    *   例如：`python cve-2025-59287-exp.py http://wsus.internal.com:8530 --payload custom_payload.txt`

**有效性分析：**

根据漏洞库信息，该漏洞具有较高的CVSS评分（9.8），表明其严重性较高。同时，CISA ADP Vulnrichment的信息也表明该漏洞已存在可利用的POC。提供的POC代码结构完整，包含加密和利用模块，并提供了详细的使用说明。因此，可以判断提供的POC代码是有效的。


**项目地址:** [Adel-kaka-dz/cve-2025-59287](https://github.com/Adel-kaka-dz/cve-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)