## CVE-2025-59287-Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可能导致完全控制受影响的WSUS服务器

**影响版本:** 受影响的Windows Server版本包括2012、2012 R2、2016、2019、2022和2025，具体版本范围请参考CVE描述。

**利用条件:** 需要能够访问WSUS服务器的网络，并能够发送特制的请求。攻击者通常需要位于与WSUS服务器相同的网络中，或者能够通过开放的端口或代理服务器进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Services (WSUS) 中的远程代码执行漏洞。此漏洞源于WSUS服务中对不受信任数据反序列化处理不当，允许未经授权的攻击者通过网络执行任意代码。攻击者可以利用此漏洞完全控制受影响的WSUS服务器，从而可能影响整个网络的更新和安全。 

**漏洞利用方式：**

1.  **漏洞原理：** 漏洞的核心在于WSUS服务器在处理客户端请求时，存在反序列化漏洞。攻击者可以构造恶意的序列化数据，当WSUS服务器尝试反序列化这些数据时，就会执行攻击者预先设定的恶意代码。
2.  **攻击步骤：**
    *   攻击者需要确定目标WSUS服务器的URL。
    *   攻击者使用提供的`cve-2025-59287-encr.py`脚本生成加密的恶意payload。该脚本支持使用自定义密钥，也可以使用默认的WSUS密钥。Payload中包含要执行的命令，例如，执行系统命令或下载并执行恶意程序。
    *   攻击者使用`cve-2025-59287-exp.py`脚本，将生成的payload发送到目标WSUS服务器。这个脚本模拟合法的WSUS客户端，发送包含恶意payload的请求。
    *   WSUS服务器接收到请求后，尝试反序列化payload，触发漏洞，执行攻击者设定的恶意代码。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC已经可用，并且被CISA ADP标记为“可自动化”，表明该漏洞的利用相对简单，成功率较高。

**投毒风险评估：**

虽然提供的代码库包含一个免责声明，说明该工具仅用于教育目的和授权渗透测试，但仍存在一定的投毒风险。风险主要体现在以下几个方面：

*   **复杂性：** 攻击代码包含加密和漏洞利用两个模块，总代码量超过一定规模，潜在的恶意代码可能隐藏其中，难以通过简单的代码审计发现。
*   **依赖：**  `requirements.txt` 文件中可能包含恶意依赖项，虽然可能性较小，但仍需谨慎。
*   **文档误导：**  README.md 文件中的指令可能存在误导，诱导用户执行恶意操作，例如，使用不安全的参数配置。

综合考虑，投毒风险评估为10%。主要基于以下几点：

*   代码主要功能为漏洞利用，没有明显恶意代码。
*   存在免责声明，降低了作者故意投毒的可能性。
*   但由于代码复杂性，仍存在隐藏恶意代码的可能性。

**项目地址:** [Adel-kaka-dz/cve-2025-59287](https://github.com/Adel-kaka-dz/cve-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)