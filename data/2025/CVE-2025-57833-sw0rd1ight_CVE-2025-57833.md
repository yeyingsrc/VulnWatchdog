## CVE-2025-57833-Django-SQL注入

**漏洞编号:** CVE-2025-57833

**漏洞类型:** SQL注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露，数据篡改甚至远程代码执行

**影响版本:** Django 4.2 ( < 4.2.24), 5.1 ( < 5.1.12), 和 5.2 ( < 5.2.6)

**利用条件:** 需要能影响QuerySet.annotate() 或 QuerySet.alias()的**kwargs参数，并且数据库连接用户需要足够的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-57833是Django框架中FilteredRelation的一个SQL注入漏洞。攻击者可以利用精心构造的字典，通过字典扩展作为`QuerySet.annotate()`或`QuerySet.alias()`的`**kwargs`参数，注入恶意SQL代码到column aliases中，导致SQL注入。

**有效性：**
根据漏洞描述和提供的代码结构，此POC可能有效。代码仓库包含了一个基本的Django项目结构，表明它可能旨在复现和验证该漏洞。需要进一步的漏洞验证代码。

**投毒风险：**
代码仓库中的投毒风险较低，约为10%。主要考量因素如下：
*   `web/settings.py`：使用了环境变量来配置数据库连接。如果环境变量被恶意修改，可能会导致应用程序连接到攻击者控制的数据库，从而造成数据泄露或篡改。虽然这是一种潜在的风险，但更像是配置错误而不是代码层面的恶意行为。
*   其他文件：`manage.py`, `web/__init__.py`, `web/asgi.py`, `web/urls.py`，这些文件都是标准的Django项目文件，没有明显的恶意代码。

**利用方式：**
1.  攻击者需要找到或创建一个使用`FilteredRelation`的地方，并且能够影响传递给`QuerySet.annotate()`或`QuerySet.alias()`的`**kwargs`参数。
2.  构造包含恶意SQL代码的字典，例如：`{'alias': 'value); SQL_INJECTION_PAYLOAD --'}`。
3.  将此字典作为`**kwargs`传递给`QuerySet.annotate()`或`QuerySet.alias()`。
4.  Django会将恶意SQL代码注入到生成的SQL查询中，导致SQL注入。
5.  攻击者可以通过SQL注入执行任意SQL命令，从而获取敏感数据、篡改数据，甚至执行任意代码（如果数据库权限允许）。

**项目地址:** [sw0rd1ight/CVE-2025-57833](https://github.com/sw0rd1ight/CVE-2025-57833)

**漏洞详情:** [CVE-2025-57833](https://nvd.nist.gov/vuln/detail/CVE-2025-57833)