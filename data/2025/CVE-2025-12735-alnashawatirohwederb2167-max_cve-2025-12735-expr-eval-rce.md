## CVE-2025-12735 expr-eval 远程代码执行漏洞

**漏洞编号:** CVE-2025-12735

**漏洞类型:** 远程代码执行

**影响应用:** expr-eval, expr-eval-fork

**危害等级:** 高危，允许攻击者执行任意系统命令

**影响版本:** expr-eval <= 2.0.2, expr-eval-fork < 3.0.0

**利用条件:** 需要目标应用使用了受影响版本的 expr-eval 或 expr-eval-fork 库，并且允许用户控制传递给 `evaluate()` 函数的上下文对象或者`MEMBER`属性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-12735 是 `expr-eval` 库中的一个远程代码执行漏洞。由于输入验证不足，攻击者可以通过构造恶意上下文对象或使用 `MEMBER` 属性传递给 `evaluate()` 函数来执行任意代码。

**利用方式：**

1.  **构造恶意上下文：** 攻击者可以创建一个包含恶意函数定义的上下文对象，并将其传递给 `evaluate()` 函数。
2.  **原型污染：** 攻击者可能利用原型链污染来修改全局对象的属性，从而影响应用程序的行为。
3.  **`MEMBER`属性利用：**攻击者可能控制`MEMBER`的属性，调用`evaluate()`从而执行恶意代码。

**POC有效性：**

提供的POC代码看起来有效，因为它包含以下关键组件：

*   **自动化检测：** 扫描 JavaScript 文件以查找 `expr-eval` 库的使用情况。
*   **端点发现：** 自动查找可能使用 `expr-eval` 的评估端点。
*   **漏洞测试：** 测试 CVE-2025-12735 漏洞。
*   **命令执行：** 演示 RCE 功能。

**投毒风险：**

虽然POC代码的主要功能是漏洞利用，但仍然存在一定的投毒风险。具体分析如下：

*   **依赖项风险：** `requirements.txt` 文件中可能包含恶意或受感染的依赖项。尽管可能性较低，但需要仔细审查依赖项的来源和完整性。
*   **命令执行：** 该脚本能够执行用户指定的命令。如果攻击者诱使用户运行包含恶意命令的脚本，则可能导致系统受损。

因此，虽然该 POC 的主要目的是为了测试漏洞，但仍存在一定的投毒风险，建议在使用前进行代码审查和安全评估。

**总结：**

该漏洞利用方式是通过构造恶意的上下文对象或`MEMBER`属性，利用 `expr-eval` 库的 `evaluate()` 函数执行任意代码。提供的POC代码有效，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [alnashawatirohwederb2167-max/cve-2025-12735-expr-eval-rce](https://github.com/alnashawatirohwederb2167-max/cve-2025-12735-expr-eval-rce)

**漏洞详情:** [CVE-2025-12735](https://nvd.nist.gov/vuln/detail/CVE-2025-12735)