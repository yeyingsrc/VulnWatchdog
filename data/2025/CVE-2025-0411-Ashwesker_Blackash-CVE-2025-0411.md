## CVE-2025-0411-7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MoTW) Bypass

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要提取特制的恶意双层嵌套压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-0411 是一个 7-Zip 中的 Mark-of-the-Web (MoTW) 绕过漏洞。当 7-Zip 提取带有 MoTW 标记的恶意双层嵌套压缩包时，不会将 MoTW 标记传播到提取的文件。这允许攻击者绕过安全警告并执行任意代码。

**有效性：**
提供的C++代码 `CVE-2025-0411.cpp` 旨在执行 shellcode。虽然它本身不是漏洞利用代码，但它可以与精心制作的压缩包配合使用，从而绕过 MoTW 保护并执行恶意代码。`README.md` 文件描述了该漏洞利用的方式，包括创建双层嵌套压缩包，第一层压缩包包含 MoTW 标记，第二层压缩包包含恶意文件。用户提取压缩包后，恶意文件就会在没有安全提示的情况下执行。

**投毒风险：**
浏览了提供的代码，C++代码的主要功能是分配内存，将shellcode复制到分配的内存中，然后执行该shellcode。`README.md` 文件描述了漏洞利用的方式，包含如何利用以及防范措施，没有发现恶意代码。因此，此仓库中不存在作者隐藏的投毒代码的可能性极低。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者创建一个双层嵌套的压缩包。外层压缩包需要带有 Mark-of-the-Web (MoTW) 标记，内层压缩包包含要执行的恶意文件（例如，`CVE-2025-0411.cpp`编译出的程序）。
2.  **传播恶意压缩包：** 通过网络钓鱼或其他社会工程手段，诱使用户下载并提取恶意压缩包。
3.  **绕过 MoTW：** 当用户使用 7-Zip 24.08 (x64) 版本提取外层压缩包时，MoTW 标记不会传播到内层压缩包包含的文件。
4.  **执行恶意代码：** 用户提取内层压缩包中的恶意文件后，恶意代码（即`CVE-2025-0411.cpp`编译后的`exe`程序中的shellcode）将在没有安全警告的情况下执行，从而导致任意代码执行。`CVE-2025-0411.cpp`本身就是一个加载器，加载一段shellcode执行，达到恶意代码执行的目的。

**项目地址:** [Ashwesker/Blackash-CVE-2025-0411](https://github.com/Ashwesker/Blackash-CVE-2025-0411)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)