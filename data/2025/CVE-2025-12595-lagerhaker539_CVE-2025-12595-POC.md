## CVE-2025-12595 - Tenda AC23 SetVirtualServerCfg 缓冲区溢出

**漏洞编号:** CVE-2025-12595

**漏洞类型:** 缓冲区溢出

**影响应用:** Tenda AC23

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.03.07.52

**利用条件:** 需要网络访问路由器管理界面（通常为LAN或暴露的WAN端口），且需要较低权限例如lan的账号密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Tenda AC23路由器固件版本16.03.07.52中，具体位于`/goform/SetVirtualServerCfg`端点中的`formSetVirtualSer`函数。该函数在处理用户提供的虚拟服务器规则时，未对`arg_list`参数进行充分的长度验证。攻击者可以通过向`/goform/SetVirtualServerCfg`发送一个POST请求，并包含一个超过缓冲区大小的`arg_list`参数，造成栈溢出。提供的POC代码（`exploit.exe`）似乎是一个预编译的二进制文件，用于自动化溢出过程，并可能尝试执行任意代码。\n\n**有效性：** 根据漏洞描述和提供的POC代码，可以判断该漏洞的POC代码具有一定的有效性，因为漏洞描述中明确指出该漏洞的利用代码已公开。POC 通过发送特制的 HTTP POST 请求，溢出`formSetVirtualSer`函数中的缓冲区，达到远程代码执行的效果。\n\n**投毒风险：** 该漏洞的github仓库下载的是一个zip压缩包，压缩包内包含可执行文件。由于`exploit.exe`是一个预编译的二进制文件，在没有源代码的情况下，很难确定其中是否包含恶意代码。潜在的风险包括：\n1.  **后门植入：** 攻击者可能会在`exploit.exe`中植入后门，允许其在成功利用漏洞后远程访问受害者的路由器。\n2.  **恶意Payload：** 溢出可能被用于执行恶意payload，例如修改DNS设置、安装恶意软件或将路由器变成僵尸网络的一部分。\n3.  **信息收集：** 该exploit可能会在利用过程中收集敏感信息，如路由器配置、密码等，并将这些信息发送给攻击者。\n由于无法直接分析`exploit.exe`的内容，投毒风险评估为 10%。建议在隔离环境中运行该POC，并使用网络监控工具分析其行为。\n\n**利用方式：**\n1.  **环境准备：** 确保目标Tenda AC23路由器运行固件版本16.03.07.52，并具有可访问的管理界面。\n2.  **配置Exploit：** 修改`config.ini`文件，设置目标路由器的IP地址和端口。\n3.  **执行Exploit：** 运行`exploit.exe`，该程序将发送精心构造的HTTP POST请求到`/goform/SetVirtualServerCfg`端点。\n4.  **远程代码执行：** 成功利用漏洞后，`exploit.exe`会尝试建立一个反向shell连接到攻击者的机器，攻击者可以通过该shell执行任意命令。

**项目地址:** [lagerhaker539/CVE-2025-12595-POC](https://github.com/lagerhaker539/CVE-2025-12595-POC)

**漏洞详情:** [CVE-2025-12595](https://nvd.nist.gov/vuln/detail/CVE-2025-12595)