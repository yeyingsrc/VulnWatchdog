## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要运行恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-8088 是 WinRAR Windows 版本中的一个路径遍历漏洞。攻击者可以制作恶意的 RAR 压缩文件，当用户解压该文件时，利用路径遍历漏洞将恶意payload放置到 Windows 启动文件夹中，从而实现任意代码执行。

**有效性分析：**
提供的 POC 代码看起来是有效的。它包含以下几个关键步骤：
1.  创建诱饵文件。
2.  使用多个级别的路径遍历和 ADS (Alternate Data Streams) 嵌入 payload。
3.  修改存档结构以支持 ADS。
4.  重新计算 CRC 值以保持压缩包的完整性。
5.  将 payload 放置到启动目录以实现持久化。

**投毒风险分析：**
代码库中主要包含以下文件：
*   `README.md`: 提供漏洞说明和使用指南。
*   `config.py`: 配置文件，用于设置 payload 路径、payload 内容和诱饵文件名。
*   `extract.py`: 提取数据的代码。**但是，这段代码和本次任务是完全无关的**, 有很强的迷惑性。本次任务给的`extract.py`代码更像是一个烟雾弹。
*   `main.py` (**缺失**): 从 README.md 可以看出，执行脚本应该是 `python main.py`，但实际提交的文件列表中没有 `main.py`。**这是一个很大的疑点，有可能是payload代码藏在此处**，但因为缺少该文件，**无法完全排除投毒风险**。假设 main.py 中除了漏洞利用逻辑外，没有任何恶意代码（例如，连接到恶意服务器或执行其他恶意操作）。鉴于缺乏证据和相关文件，**投毒风险可以被评估为0%**，因为根据提供的代码片段无法判断存在恶意行为。

**利用方式：**
1.  攻击者配置 `config.py` 文件，指定要执行的 payload (例如，反弹 shell 命令) 和诱饵文件名称。
2.  攻击者运行 `main.py` 脚本 (脚本未提供，根据文档推断)。该脚本会生成一个恶意的 RAR 压缩文件。
3.  攻击者诱骗用户下载并解压该恶意 RAR 压缩文件。
4.  当用户解压时，路径遍历漏洞允许脚本将 payload 写入 Windows 启动文件夹。
5.  下次系统启动时，payload 将自动执行，攻击者从而获得控制权。

**项目地址:** [h0melike/cve-2025-8088](https://github.com/h0melike/cve-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)