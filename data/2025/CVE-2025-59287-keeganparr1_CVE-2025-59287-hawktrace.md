## CVE-2025-59287 - Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** Remote Code Execution

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致远程代码执行并完全控制受影响的服务器

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025 (受影响版本详见CVE信息)

**利用条件:** 攻击者需要能够通过网络访问WSUS服务器，并能发送特制的请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-59287 是一个 Windows Server Update Service (WSUS) 中的远程代码执行漏洞。该漏洞是由于 WSUS 在反序列化不可信数据时存在缺陷导致的。攻击者可以通过向 WSUS 服务器发送特制的请求，其中包含恶意序列化数据，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  **漏洞分析：** 根据CVE信息，漏洞类型为反序列化漏洞 (CWE-502)。
2.  **POC代码分析：**
    *   POC代码首先定义了一个AES加密密钥 (`877C14E433638145AD21BD0C17393071`)，这表明数据在传输过程中可能经过加密。
    *   POC 使用`ysooo`变量存储了一个经过Base64编码的序列化payload。 这个payload 使用了 `System.Collections.Generic.SortedSet` 结合`System.DelegateSerializationHolder` 达到RCE的效果， 常见的`ysoserial.net` 的 payload，目标是启动 `cmd /c calc`。
    *   POC代码定义了一个`EncryptPayload`函数。这个函数首先创建了一个AES加密服务, 然后使用提供的Key和Null IV对序列化的Payload进行CBC模式的加密. 随后将加密后的数据再次进行Base64编码.
    *   最终POC将处理后的数据输出到控制台。
3.  **漏洞利用流程：**
    *   攻击者首先需要生成一个恶意的 .NET 序列化 Payload，例如使用 `ysoserial.net`工具来生成。该工具能够生成包含恶意指令的序列化对象。
    *   使用该POC对生成的payload进行加密， 从而得到一个加密的Base64 payload.
    *   攻击者将加密后的Base64 编码的 Payload 发送到存在漏洞的 WSUS 服务器。
    *   WSUS 服务器接收到数据后，使用相同的AES密钥进行解密和反序列化。
    *   反序列化过程会触发 Payload 中的恶意指令，从而导致远程代码执行。

**有效性：**

该POC代码生成的是加密的payload，需要结合对WSUS服务器的分析, 确认WSUS对payload的处理流程，才能判断其有效性. 从目前代码来看，漏洞利用的整体思路是正确的。

**投毒风险：**

对提供的PoC代码进行了分析，没有发现作者隐藏的投毒代码。 投毒风险为0%。  此代码的主要功能是生成加密的payload，并没有其他恶意行为。

**项目地址:** [keeganparr1/CVE-2025-59287-hawktrace](https://github.com/keeganparr1/CVE-2025-59287-hawktrace)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)