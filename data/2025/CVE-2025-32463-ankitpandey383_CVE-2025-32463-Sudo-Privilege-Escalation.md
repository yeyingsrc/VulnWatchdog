## CVE-2025-32463-Sudo-权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户，sudo版本符合要求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，Sudo 1.9.17p1之前的版本存在一个漏洞，允许本地用户通过 `--chroot` 选项和用户控制的`/etc/nsswitch.conf`文件获取root权限。提供的POC代码 `sudo-chwoot.sh` 利用了这一点，它创建一个临时目录，并在该目录下创建 `woot/etc/nsswitch.conf` 文件，其中指定了自定义的共享库加载路径。`woot1337.c` 代码会被编译成共享库 `libnss_/woot1337.so.2`，并在库的构造函数中设置uid和gid为0，然后执行一个shell。通过 `sudo -R woot woot` 命令，sudo会使用chroot环境，并在该环境中加载恶意的nsswitch.conf。由于nsswitch.conf的配置，共享库 `libnss_/woot1337.so.2`会被加载, 恶意代码会在root权限下执行，从而提升到root权限。

**有效性评估：**
根据漏洞描述和POC代码，该利用是有效的。它通过劫持共享库加载过程，在chroot环境中以root权限执行任意代码，实现了本地权限提升。

**投毒风险评估：**
POC代码本身似乎没有明显的恶意投毒代码。但存在一定风险，编译后的共享库功能完全取决于`woot1337.c`中的代码。作者可能添加一些不易察觉的后门代码，例如反向shell等，所以判断为10%风险。

**利用方式：**
1.  创建一个临时目录作为chroot环境。
2.  在该目录下创建一个恶意的`/etc/nsswitch.conf`文件，指向一个伪造的共享库。
3.  编写一个C程序，编译成共享库，该共享库的构造函数中包含提权代码（例如设置uid和gid为0，然后执行一个shell）。
4.  使用 `sudo -R <chroot目录> <command>` 命令，让sudo在chroot环境下执行命令。由于chroot环境中的nsswitch.conf被篡改，因此会加载恶意的共享库，从而执行提权代码。
5.  删除临时目录。

**项目地址:** [ankitpandey383/CVE-2025-32463-Sudo-Privilege-Escalation](https://github.com/ankitpandey383/CVE-2025-32463-Sudo-Privilege-Escalation)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)