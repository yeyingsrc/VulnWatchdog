## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，需要目标机器存在sudo且版本符合漏洞版本范围

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞存在于Sudo 1.9.14到1.9.17p1版本。该漏洞允许本地用户通过 `--chroot` 选项绕过权限检查，从而获得root权限。

**利用方式：**

1.  攻击者首先创建一个恶意的 `nsswitch.conf` 文件和一个包含恶意代码的动态链接库 (`.so`)，放置在一个用户可控的目录下。
2.  `cwoot.sh` 脚本会创建临时目录，创建恶意的C代码，编译成动态链接库 `libnss_/woot1337.so.2`，并创建一个包含`/woot1337`的 `nsswitch.conf` 文件。
3.  然后，利用 `sudo -R <user_controlled_directory> /bin/true` 命令，`sudo` 会错误地使用攻击者提供的 `nsswitch.conf` 文件。`nsswitch.conf`的修改可以控制动态链接库的加载。
4.  恶意的动态链接库中的构造函数 `woot1337()` 会被执行，该函数通过 `setreuid(0, 0);` 和 `setregid(0, 0);` 将当前进程的有效用户ID和组ID设置为0，从而获得root权限，最后执行 `/bin/bash`，获得一个root shell。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞利用方法是有效的，可以直接提权。

**投毒风险：**

分析提供的POC代码，没有发现明显的恶意或隐藏代码，其目的是利用漏洞提权，脚本行为与漏洞描述一致。因此，投毒风险较低，可以认为是0%。

**项目地址:** [justjoeyking/CVE-2025-32463](https://github.com/justjoeyking/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)