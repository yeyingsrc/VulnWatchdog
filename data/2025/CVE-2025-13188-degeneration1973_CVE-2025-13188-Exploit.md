## CVE-2025-13188-D-Link DIR-816L 栈溢出

**漏洞编号:** CVE-2025-13188

**漏洞类型:** 栈溢出

**影响应用:** D-Link DIR-816L

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2_06_b09_beta

**利用条件:** 需要目标设备运行存在漏洞的固件版本，且攻击者能够通过网络访问设备的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-13188是D-Link DIR-816L路由器固件版本2_06_b09_beta中的一个严重的栈溢出漏洞。它影响`/authentication.cgi`中的`authenticationcgi_main`函数，允许远程攻击者操纵HTTP POST请求中的`Password`参数，从而导致缓冲区溢出和潜在的任意代码执行（ACE），而无需身份验证。

**利用方式：**

1.  **漏洞定位：** 该漏洞位于`/authentication.cgi`文件的`authenticationcgi_main`函数中，该函数负责处理用户身份验证。
2.  **参数构造：** 攻击者通过构造一个超长`Password`参数的HTTP POST请求来触发漏洞。由于`authenticationcgi_main`函数中对`Password`参数的长度没有进行充分的验证，导致过长的`Password`可以覆盖栈上的返回地址，从而控制程序执行流程。
3.  **ROP链和Shellcode：**  利用代码中提到了ROP链和Shellcode的利用方式。攻击者可以将Shellcode注入到内存中，然后利用ROP链来调用`system()`函数执行Shellcode，从而获得设备的控制权。
4.  **攻击流程：**
    *   攻击者发送一个包含超长`Password`参数的HTTP POST请求到`/authentication.cgi`。
    *   服务器端在处理请求时，`authenticationcgi_main`函数将`Password`参数复制到栈上的缓冲区中，由于没有进行长度验证，导致缓冲区溢出。
    *   缓冲区溢出覆盖了栈上的返回地址，攻击者可以控制程序执行流程。
    *   程序跳转到攻击者指定的地址，执行Shellcode，从而获得设备的控制权。

**投毒风险分析：**

漏洞利用代码中包含一个`exploit.exe`文件和一个`run_exploit.bat`文件。`exploit.exe`据描述是一个Go语言编写的程序，用于模糊`Password`字段，注入ROP，并处理MIPS小端序。`run_exploit.bat`文件用于启动`exploit.exe`程序。由于`exploit.exe`是预编译的二进制文件，因此存在潜在的投毒风险。攻击者可以在`exploit.exe`文件中嵌入恶意代码，例如后门程序，用于在攻击成功后执行恶意操作。虽然代码提供了描述，解释了其功能，但用户在没有进行充分审查的情况下运行预编译的二进制文件仍然存在风险。尤其是在windows下双击bat文件,更容易被用户所忽略.

综上所述，此仓库中存在一定的投毒风险，但通过readme的描述可以判断作者只是为了方便演示，因此投毒概率较低，给5%。

**项目地址:** [degeneration1973/CVE-2025-13188-Exploit](https://github.com/degeneration1973/CVE-2025-13188-Exploit)

**漏洞详情:** [CVE-2025-13188](https://nvd.nist.gov/vuln/detail/CVE-2025-13188)