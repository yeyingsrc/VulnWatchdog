## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务开启Lua脚本支持，攻击者需要有权限执行Lua脚本（例如，通过认证，或者Redis配置不当允许未授权访问）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844是一个Redis Lua引擎中的Use-After-Free漏洞，该漏洞允许经过身份验证的用户通过精心构造的Lua脚本操纵垃圾回收器，从而触发Use-After-Free，并可能导致远程代码执行。漏洞存在于所有启用Lua脚本的Redis版本中，直到8.2.2版本修复。该漏洞的利用方式是利用Redis的EVAL、EVALSHA或SCRIPT LOAD命令发送恶意的Lua脚本。提供的代码实际上是一个Redis蜜罐（RediTrap Honeypot），用于检测针对CVE-2025-49844的攻击尝试，而不是漏洞利用代码本身。它通过监听Redis端口，并记录所有命令，特别是Lua脚本相关的命令，并将其标记为可疑。该蜜罐旨在模仿旧版本的Redis行为，以诱使攻击者继续尝试利用该漏洞。这个仓库本身没有任何投毒代码，因为它的目的是监控和记录攻击行为，而非发起攻击。

**项目地址:** [srozb/reditrap](https://github.com/srozb/reditrap)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)