## CVE-2025-64459-Django-SQL注入

**漏洞编号:** CVE-2025-64459

**漏洞类型:** SQL注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露

**影响版本:** 5.1 < 5.1.14, 4.2 < 4.2.26, 5.2 < 5.2.8

**利用条件:** 需要受影响的Django版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64459是Django框架中存在的一个SQL注入漏洞。该漏洞存在于`QuerySet.filter()`、`QuerySet.exclude()`、`QuerySet.get()`方法和`Q()`类中，当使用精心构造的字典并进行字典展开作为`_connector`参数时，可能导致SQL注入。

**有效性：**
根据漏洞信息，该漏洞影响特定版本的Django。提供的脚本`docker-check-django-vuln.sh` 并非利用代码，而是用于检测在 Docker 容器中运行的 Django 版本是否容易受到 CVE-2025-64459 的影响。它通过检查 Django 版本并将其与已知易受攻击的版本进行比较来工作。虽然此脚本本身不是漏洞利用，但它有助于识别潜在的目标，因此其辅助验证是有效的。

**投毒风险：**
提供的`docker-check-django-vuln.sh`脚本的目的是检测Django版本，而不是执行恶意操作。它只包含用于检查容器内的Django版本，并将其版本与已知漏洞版本进行比较的代码。没有发现任何证据表明代码包含任何形式的投毒或者后门。因此，投毒风险评估为0%。

**利用方式：**
该漏洞的利用方式是，攻击者可以构造恶意的字典，并将其作为`_connector`参数传递给`QuerySet.filter()`、`QuerySet.exclude()`、`QuerySet.get()`方法或`Q()`类。通过字典展开，恶意SQL代码会被注入到生成的SQL查询中，从而导致SQL注入。 攻击者可以使用此漏洞来读取、修改或删除数据库中的数据。具体的利用方式需要根据实际情况进行调整，通常攻击者会注入SQL语句来绕过身份验证或执行任意SQL查询，从而泄露敏感数据。

**项目地址:** [nunpa/CVE-2025-64459](https://github.com/nunpa/CVE-2025-64459)

**漏洞详情:** [CVE-2025-64459](https://nvd.nist.gov/vuln/detail/CVE-2025-64459)