## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本功能，且攻击者具有执行EVAL或EVALSHA命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。攻击者可以通过精心构造的 Lua 脚本，操纵垃圾回收器，在对象释放后再次访问该对象，从而可能导致远程代码执行。

**有效性评估：**

提供的 POC 代码是一个漏洞检测脚本，而不是直接的漏洞利用代码。该脚本首先连接到 Redis 服务器，检查 Redis 版本，并验证 Lua 脚本是否已启用。然后它尝试通过执行一个测试性的 Lua 脚本来确认 Lua 脚本功能是否正常工作，并探测是否存在UAF模式。漏洞利用的有效性取决于目标 Redis 服务器的版本和配置。

**投毒风险评估：**

分析提供的 Redis 漏洞检测脚本，发现其中存在潜在的投毒风险的可能性较低。虽然脚本的目的是检测 Redis 服务器是否存在 CVE-2025-49844 漏洞，但漏洞本身利用了 Lua 脚本的 use-after-free 漏洞，存在通过构造恶意的Lua脚本进行RCE的可能性。 脚本自身主要用于检测，但最终目的是为了方便漏洞利用，因此，认为存在 10% 的投毒风险。

**利用方式分析：**

1.  **漏洞触发：** 攻击者需要向 Redis 服务器发送包含恶意 Lua 脚本的 EVAL 或 EVALSHA 命令。
2.  **UAF 触发：** 恶意 Lua 脚本通过操纵 Redis 的垃圾回收机制，触发 Use-After-Free 漏洞。
3.  **RCE：** 成功触发 UAF 后，攻击者可以进一步利用该漏洞，实现远程代码执行。具体步骤通常涉及内存布局的控制和代码注入等技术。

**缓解措施：**

*   升级到 Redis 8.2.2 或更高版本。
*   禁用 Lua 脚本功能 (如果不需要该功能)。
*   使用 ACL 限制 EVAL 和 EVALSHA 命令的执行权限。


**项目地址:** [Mufti22/CVE-2025-49844-RediShell-Vulnerability-Scanner](https://github.com/Mufti22/CVE-2025-49844-RediShell-Vulnerability-Scanner)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)