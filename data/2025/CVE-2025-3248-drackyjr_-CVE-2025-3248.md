## CVE-2025-3248 Langflow Unauthenticated RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入/远程代码执行

**影响应用:** Langflow

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 1.3.0

**利用条件:** 目标系统运行Langflow，且`/api/v1/validate/code`端口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248是Langflow中一个未经身份验证的远程代码执行漏洞，存在于`/api/v1/validate/code`端点。攻击者可以发送特制的HTTP请求，利用Python的`exec()`函数执行任意代码。漏洞的利用方式主要依赖于Langflow在验证代码时缺乏适当的输入验证和沙箱机制。POC代码通过发送包含恶意代码的POST请求到`/api/v1/validate/code`端点来触发漏洞。由于PoC包含了从github下载代码并执行的操作，且仓库地址和PoC作者相同，存在投毒的风险,但是概率较低，这里定为10%。

**漏洞利用方式：**

1.  **发送恶意请求：** 攻击者构造包含恶意Python代码的POST请求，发送到Langflow的`/api/v1/validate/code`端点。
2.  **代码执行：** Langflow使用`exec()`函数执行接收到的代码，由于缺乏适当的验证和沙箱机制，攻击者可以执行任意代码，包括执行系统命令、读取文件、修改配置等。
3.  **控制系统：** 通过执行恶意代码，攻击者可以完全控制受影响的Langflow实例，并可能进一步控制底层服务器。

**漏洞评估：**

*   **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞利用方法是有效的。漏洞库信息明确指出该漏洞允许未经身份验证的远程代码执行，并且POC代码提供了详细的利用步骤和验证方法。
*   **投毒风险：**  PoC 代码本身的功能是利用漏洞进行攻击，因此，大部分代码属于漏洞利用的正常组成部分，但是因为牵扯到脚本下载和执行，因此具有一定的投毒风险，但不确定性较高，这里评估为10%。

**项目地址:** [drackyjr/-CVE-2025-3248](https://github.com/drackyjr/-CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)