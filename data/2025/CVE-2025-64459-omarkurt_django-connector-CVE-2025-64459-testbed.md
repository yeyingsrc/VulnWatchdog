## CVE-2025-64459-Django-SQL注入

**漏洞编号:** CVE-2025-64459

**漏洞类型:** SQL注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露

**影响版本:** < 5.1.14, < 4.2.26, < 5.2.8

**利用条件:** 需要应用程序使用`QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()`或者`Q()`，且将用户输入通过字典展开的方式传递给`_connector`参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-64459 是 Django 框架中存在的一个 SQL 注入漏洞，受影响的版本包括 5.1.x (< 5.1.14)、4.2.x (< 4.2.26) 和 5.2.x (< 5.2.8)。该漏洞源于 Django 的 `QuerySet.filter()`, `QuerySet.exclude()`, `QuerySet.get()` 方法以及 `Q()` 类在处理 `_connector` 参数时，如果使用了精心构造的字典并通过字典展开传递用户输入，则可能导致 SQL 注入。

**有效性：** 提供的 POC 代码有效，可以利用 `_connector` 参数注入恶意 SQL 语句。

**投毒风险：** 该存储库主要提供了一个可自我包含的测试环境。虽然代码库本身看起来专注于漏洞演示，但仍存在一定投毒风险，例如：

*   **依赖项风险：** 虽然 Dockerfile 旨在隔离环境，但 Dockerfile 依赖的基础镜像可能包含恶意软件。
*   **配置风险：** 配置不当可能导致主机系统受到攻击。
*   **第三方集成：** 如果测试环境集成了其他第三方服务（例如数据库），这些服务可能存在漏洞。

总而言之，尽管该仓库主要目的是为了演示 CVE-2025-64459 漏洞，但仍然存在一些间接的投毒风险。根据代码量、测试目的以及漏洞本身的性质，可将投毒风险评估为10%。

**利用方式：** 攻击者通过构造包含恶意 SQL 代码的字典，并将其作为 `_connector` 参数传递给 `QuerySet.filter()` 等方法。例如，`/?_connector=OR 1=1 OR&title__icontains=Public` 将原本的 AND 连接符替换为 OR，可能导致绕过权限验证，从而访问未授权数据。

**项目地址:** [omarkurt/django-connector-CVE-2025-64459-testbed](https://github.com/omarkurt/django-connector-CVE-2025-64459-testbed)

**漏洞详情:** [CVE-2025-64459](https://nvd.nist.gov/vuln/detail/CVE-2025-64459)