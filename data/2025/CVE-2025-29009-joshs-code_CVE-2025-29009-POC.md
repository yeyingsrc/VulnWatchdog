## CVE-2025-29009-Medical Prescription Attachment Plugin for WooCommerce-任意文件上传

**漏洞编号:** CVE-2025-29009

**漏洞类型:** 任意文件上传

**影响应用:** Medical Prescription Attachment Plugin for WooCommerce

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.2.3

**利用条件:** 需要安装并启用Medical Prescription Attachment Plugin for WooCommerce插件，且目标站点允许未授权访问/wp-admin/admin-ajax.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29009 漏洞存在于 Medical Prescription Attachment Plugin for WooCommerce 插件中，允许未经身份验证的攻击者上传任意文件。攻击者可以通过构造包含恶意代码（例如 PHP webshell）的文件，并利用插件的上传功能将其上传到服务器，从而实现远程代码执行。利用方式如下：

1.  **获取Nonce:** 访问`/cart`页面获取`ajaxNonce`值。这是插件用于验证请求的nonce值。
2.  **构造POST请求:**  构造一个POST请求发送到`/wp-admin/admin-ajax.php`。请求体包含以下参数：
    *   `action`: `wkwcpa_handle_prescription_session`
    *   `type`: `upload`
    *   `nonce`: 上一步获取的nonce值
    *   `wkwc_pa_prescription_attachment[]`: 包含恶意代码的文件，文件名为`shell.php`，内容为`<?php system($_GET["cmd"]); ?>`，MIME类型为`image/jpeg`。  **注意:**  将MIME类型设置为 `image/jpeg` 可能是为了绕过简单的文件类型检查。
3.  **发送请求:** 发送构造好的POST请求。
4.  **访问上传的文件:**  如果上传成功，攻击者可以通过访问`/wp-content/uploads/prescriptions/shell.php?cmd=<command>`来执行任意命令。

**有效性:**  提供的POC代码看起来有效，因为它利用了插件中未授权的文件上传漏洞，并构造了包含PHP webshell的恶意文件。通过发送包含正确参数的POST请求，攻击者可以成功上传webshell并执行任意命令。

**投毒风险:**  从提供的代码来看，没有发现明显的投毒代码。该脚本的主要功能是利用漏洞上传webshell。`Referer`和`Origin`设置为`http://joshs-code`，这可能只是为了模仿正常请求，没有明显的恶意行为。因此，投毒风险较低。

**项目地址:** [joshs-code/CVE-2025-29009-POC](https://github.com/joshs-code/CVE-2025-29009-POC)

**漏洞详情:** [CVE-2025-29009](https://nvd.nist.gov/vuln/detail/CVE-2025-29009)