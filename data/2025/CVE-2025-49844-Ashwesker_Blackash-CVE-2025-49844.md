## CVE-2025-49844-Redis-RediShell-RCE

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free / RCE

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行和主机完全控制

**影响版本:** < 8.2.2

**利用条件:** 需要 Redis 实例开启 Lua 脚本功能，并具有执行 EVAL 或 EVALSHA 命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 use-after-free 漏洞，被称为 RediShell。攻击者可以利用该漏洞，通过构造特制的 Lua 脚本，操纵垃圾回收器，触发 use-after-free 错误，最终实现沙箱逃逸和远程代码执行，完全控制 Redis 主机。

**有效性：**

提供的 README.md 文件详细描述了漏洞信息、影响范围、利用方式和缓解措施，并给出了检测和验证的命令示例。虽然没有提供具体的 Lua 脚本PoC，但文档清晰地说明了该漏洞已公开，并且存在可利用的PoC，说明该漏洞是有效的，可以被利用。

**投毒风险：**

提供的漏洞利用代码（README.md）本身不包含恶意代码或后门，更多的是漏洞的描述、缓解措施和检测方法。虽然文档中也提到可能存在 active scanning，但并未直接提供任何可执行的漏洞利用程序，因此投毒的概率较低。但是不能完全排除作者在其他地方发布了包含投毒代码的PoC，或者攻击者修改该README.md后进行传播。所以，谨慎估计投毒风险为 10%。

**利用方式：**

1.  **攻击者需要具有 Redis 的认证访问权限。** 如果 Redis 没有设置密码或使用了弱密码，则攻击者可以直接连接到 Redis 实例。
2.  **攻击者使用 EVAL 或 EVALSHA 命令执行恶意的 Lua 脚本。** 该 Lua 脚本会精心构造，利用 Lua 垃圾回收机制中的缺陷，触发 use-after-free 漏洞。
3.  **成功触发 use-after-free 漏洞后，攻击者可以实现沙箱逃逸，执行任意本地代码。**
4.  **攻击者利用执行本地代码的能力，完全控制 Redis 主机，进行数据窃取、篡改或拒绝服务攻击。**


**项目地址:** [Ashwesker/Blackash-CVE-2025-49844](https://github.com/Ashwesker/Blackash-CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)