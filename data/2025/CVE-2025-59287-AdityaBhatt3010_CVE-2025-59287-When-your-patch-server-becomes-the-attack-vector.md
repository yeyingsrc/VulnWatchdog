## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 严重，可能导致完全系统控制和恶意更新分发

**影响版本:** 受影响的Windows Server版本，详见CVE描述

**利用条件:** 攻击者需要能够向WSUS服务器发送HTTP请求（通常在8530/8531端口）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS) 中的远程代码执行漏洞。漏洞原因是WSUS在反序列化不可信数据时存在缺陷。攻击者可以发送特制的序列化数据到WSUS服务器，从而在服务器上以SYSTEM权限执行任意代码。

**有效性：**
根据提供的漏洞库信息和README.md描述，该漏洞的PoC是有效的。README.md明确指出PoC已经公开，并且确认了漏洞的利用方式，即通过构造恶意的`AuthorizationCookie`，在WSUS服务器上进行不安全的反序列化操作，最终执行任意代码。

**投毒风险：**
虽然提供的代码包括用于检测漏洞利用的EQl和KQL规则，但README.md文件和许可证表明该代码库由Aditya Bhatt创建并遵循MIT许可证，允许自由使用和修改。主要风险在于，如果攻击者修改了PoC或利用脚本，可能会加入恶意代码。目前提供的代码本身风险较低，更像是漏洞利用的检测规则和说明，而不是直接可执行的exploit。因此，投毒风险评估为10%，主要是对未来可能修改的代码的潜在风险评估，而非当前代码本身。

**利用方式：**
1.  攻击者构造一个恶意的`AuthorizationCookie`，其中包含精心制作的序列化.NET对象。
2.  将该Cookie发送到WSUS服务器上的特定ASMX端点，例如`/SimpleAuthWebService/SimpleAuthWebService.asmx`或`/ReportingWebService/ReportingWebService.asmx`。
3.  WSUS服务器尝试解密并反序列化该对象，由于没有进行适当的验证，导致攻击者注入的.NET对象被执行。
4.  通过预先构造的“gadget chain”，攻击者可以执行任意代码，通常以SYSTEM权限运行`cmd.exe`或`powershell.exe`。

由于WSUS服务器通常位于受信任的网络区域，并且有权向客户端推送更新，因此成功利用此漏洞可能导致整个网络的受损，例如部署恶意更新、横向移动到域控制器或窃取凭据。

**项目地址:** [AdityaBhatt3010/CVE-2025-59287-When-your-patch-server-becomes-the-attack-vector](https://github.com/AdityaBhatt3010/CVE-2025-59287-When-your-patch-server-becomes-the-attack-vector)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)