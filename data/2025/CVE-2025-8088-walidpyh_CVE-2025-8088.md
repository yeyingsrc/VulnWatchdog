## CVE-2025-8088-WinRAR路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者通过恶意构造的压缩文件执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要使用WinRAR打开恶意的RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个WinRAR的路径遍历漏洞，存在于Windows版本中。攻击者可以构造恶意的RAR压缩文件，利用路径遍历漏洞将payload释放到任意目录，例如启动目录，从而实现代码执行。

**有效性：**
根据提供的PoC代码，该漏洞利用方式是有效的。PoC代码演示了如何创建包含ADS（Alternate Data Stream）payload的RAR5格式压缩文件。payload会被附加到第一个decoy文件上，然后通过路径遍历写入到目标目录。

**投毒风险：**
PoC代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **恶意Payload：** PoC允许用户指定payload文件，如果用户使用恶意payload，则可能对目标系统造成损害。但这是PoC本身的性质决定的，用于演示漏洞利用，所以不属于作者投毒。
2.  **目标目录：** PoC默认将payload释放到启动目录，这意味着如果用户运行了恶意的RAR文件，payload会在系统启动时自动执行，进一步扩大了攻击面。作者选择启动目录作为默认释放目录有放大的嫌疑
3.  **编码问题:** 代码中可能存在编码问题，例如路径编码处理不当可能导致无法成功利用，但也可能被恶意利用执行非预期命令。
4. **风险评估:** 代码本身功能明确，目的是演示漏洞利用。但从利用的默认配置和代码质量来看，可能存在一定的潜在风险，因此评估投毒风险为10%。

**利用方式：**
利用方式主要分为以下几个步骤：

1.  **创建Decoy文件：** 创建一个或多个诱饵文件（Decoy file），用于伪装RAR压缩文件，降低用户的警惕性。
2.  **附加ADS Payload：** 将Payload文件通过ADS附加到第一个Decoy文件上。ADS是NTFS文件系统的一个特性，允许将多个数据流附加到一个文件上，而用户通常只能看到主数据流。
3.  **创建Base RAR文件：** 使用WinRAR命令行工具（rar.exe）将Decoy文件压缩成一个RAR5格式的压缩文件。
4.  **路径遍历：** 通过构造恶意的文件名，包含路径遍历字符（例如`..\`），使得WinRAR在解压时将ADS Payload释放到指定的目录。PoC选择释放到启动目录，以便Payload在系统启动时自动执行。
5.  **重新计算CRC：** 修改RAR文件的头部信息后，需要重新计算CRC校验值，以确保RAR文件能够被正常解压。

**总结：**
总的来说，该PoC代码演示了CVE-2025-8088漏洞的利用过程，能够有效地在WinRAR <= 7.12版本上实现任意代码执行。虽然PoC本身是为了教育和研究目的，但如果被恶意利用，可能会对用户系统造成严重危害。同时，需要注意该PoC本身可能被修改，用于传播恶意软件，存在一定的投毒风险。

**项目地址:** [walidpyh/CVE-2025-8088](https://github.com/walidpyh/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)