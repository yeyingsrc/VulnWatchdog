## CVE-2025-12101-NetScaler ADC/Gateway 反射型XSS

**漏洞编号:** CVE-2025-12101

**漏洞类型:** 反射型跨站脚本 (RXSS)

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 中危，可能导致会话劫持、恶意重定向等

**影响版本:** ADC 14.1 (低于 56.73), 13.1 (低于 60.32), 13.1-FIPS and NDcPP (低于 37.250), 12.1-FIPS and NDcPP (低于 55.333); Gateway 同上

**利用条件:** NetScaler ADC/Gateway 配置为 Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) OR AAA virtual server

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-12101 是一个反射型跨站脚本漏洞，影响 NetScaler ADC 和 NetScaler Gateway。当设备配置为 Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) 或 AAA virtual server 时，`/cgi/logout` 端点处理 SAML 注销响应，并且可能在 `RelayState` 参数中反射攻击者控制的数据，而没有进行适当的编码，从而导致 XSS。  

**有效性:**  提供的 PoC 代码有效。它通过构造包含恶意 JavaScript 代码的 `RelayState` 参数的 SAMLResponse 发送到 `/cgi/logout` 端点来验证漏洞是否存在。如果服务器在响应中反射了此 JavaScript 代码，则表明存在漏洞。

**投毒风险:**  分析 PoC 代码后，没有发现任何明显的投毒代码。该脚本的功能是按照文档描述的方式工作的，目的是验证目标是否存在漏洞。脚本通过向目标发送精心构造的请求并检查响应中是否出现注入的 JavaScript 代码来完成此操作。没有证据表明作者试图通过该脚本安装后门或执行其他恶意操作。

**利用方式:**

1.  目标系统必须是受影响的 NetScaler ADC 或 NetScaler Gateway 版本，并且配置为 Gateway 或 AAA 虚拟服务器。
2.  攻击者构造一个包含恶意 JavaScript 代码（例如 `<script>alert(1)</script>`) 的 SAMLResponse，并将恶意代码放入 `RelayState` 参数中。
3.  攻击者将构造的 SAMLResponse 发送到 `/cgi/logout` 端点。
4.  如果服务器未正确编码 `RelayState` 参数中的数据，它将在响应中反射恶意 JavaScript 代码。
5.  当受害者（例如管理员）访问包含反射的 JavaScript 代码的页面时，代码将在受害者的浏览器中执行，从而允许攻击者执行恶意操作，例如会话劫持或重定向到恶意网站。

**项目地址:** [6h4ack/CVE-2025-12101-checker](https://github.com/6h4ack/CVE-2025-12101-checker)

**漏洞详情:** [CVE-2025-12101](https://nvd.nist.gov/vuln/detail/CVE-2025-12101)