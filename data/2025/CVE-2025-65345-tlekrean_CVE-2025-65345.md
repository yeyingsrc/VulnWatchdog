## CVE-2025-65345 – laravel-file-manager 文件系统披露漏洞

**漏洞编号:** CVE-2025-65345

**漏洞类型:** 目录遍历/文件系统披露

**影响应用:** laravel-file-manager

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** <= 3.3.1

**利用条件:** 需要有效的用户账户，能够访问laravel-file-manager的文件管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于laravel-file-manager v3.3.1及以下版本中。攻击者可以通过文件管理器的zip/压缩功能，利用目录遍历漏洞，创建包含超出预期范围的文件和目录的压缩包，从而导致文件系统披露。

**漏洞利用方式：**
1. 攻击者首先需要拥有一个可以访问laravel-file-manager的有效账户。
2. 在文件管理界面，选择一个文件或文件夹。
3. 使用zip功能创建压缩文件。
4. 在Burp Suite等HTTP代理工具中截获zip请求。
5. 在请求的`directories`参数中插入目录遍历payload，例如`../../../../../../../var/www`或`/etc/passwd`。
6. 触发ZIP创建，服务器端递归解析路径，导致允许存储目录之外的文件被包含在压缩包中。
7. 下载生成的zip文件，其中包含来自服务器任意位置的敏感文件，例如`.env`、SSH密钥、配置文件、日志文件等。

**投毒风险评估：**
此POC的投毒风险较低，约为5%。主要风险可能存在于提供的图片文件(images/step*.png,  รูปภาพ16.png)。但总体而言，POC主要通过描述步骤和展示请求，并非直接可执行的代码，因此被植入恶意代码的风险较低。 风险主要在于使用者是否会在未经仔细检查的情况下，盲目使用POC流程中涉及的任何可执行脚本或配置。

**项目地址:** [tlekrean/CVE-2025-65345](https://github.com/tlekrean/CVE-2025-65345)

**漏洞详情:** [CVE-2025-65345](https://nvd.nist.gov/vuln/detail/CVE-2025-65345)