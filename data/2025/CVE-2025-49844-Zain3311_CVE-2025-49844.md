## CVE-2025-49844-Redis-Lua-Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本功能，并且攻击者需要具备执行Lua脚本的权限（至少是经过身份验证的用户）。

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据CVE信息，CVE-2025-49844是Redis中由于Lua脚本处理不当造成的Use-After-Free漏洞，攻击者可以通过构造恶意的Lua脚本来操纵垃圾回收器，触发UAF漏洞，最终可能导致远程代码执行。

**有效性：**
漏洞库信息显示该漏洞存在于Redis 8.2.1及以下版本中，并且官方已经发布了修复版本8.2.2。由于提供的代码是C#项目，与漏洞本身利用方式无关，所以**无法直接通过该代码验证漏洞的有效性**。需要构造特定的Lua脚本，并通过Redis EVAL或EVALSHA命令执行，才能验证漏洞的存在。

**投毒风险：**
提供的代码是一个名为DesiShop的C# Web应用程序项目，它看起来是一个电商相关的项目，从代码结构来看，包含了身份验证(JWT)，swagger配置，以及常规的MVC结构。但是，这些代码**与Redis的Lua UAF漏洞（CVE-2025-49844）没有任何直接关系**。该项目的存在和漏洞利用行为并无任何关联。将一个C#电商项目放入Redis Lua UAF的分析场景下，是极有可能存在恶意投毒行为的。因此，该仓库中作者隐藏投毒代码的可能性很高，估计在95%以上。

**利用方式：**
1.  **权限获取：** 首先，攻击者需要具备连接到Redis服务器并执行Lua脚本的权限。这通常意味着攻击者需要是经过身份验证的用户，或者Redis服务器配置为允许未授权访问。
2.  **Lua脚本构造：** 攻击者需要构造一个恶意的Lua脚本，该脚本能够操纵Redis的垃圾回收器，并触发Use-After-Free漏洞。这通常涉及到复杂的Lua代码，需要对Redis内部的Lua环境和内存管理机制有深入的了解。
3.  **漏洞触发：** 将构造好的Lua脚本通过Redis的`EVAL`或`EVALSHA`命令发送到Redis服务器执行。如果脚本成功触发了UAF漏洞，可能会导致服务器崩溃或允许攻击者执行任意代码。
4.  **代码执行（RCE）：** 成功触发UAF后，攻击者可能会利用该漏洞来执行任意代码。这通常涉及到更高级的利用技术，例如利用内存布局、ROP链等。

**结论：**
CVE-2025-49844是一个高危的Redis漏洞，如果成功利用可能导致远程代码执行。由于提供的代码与漏洞利用无关，无法直接验证漏洞的有效性。该项目本身存在投毒的可能。

**项目地址:** [Zain3311/CVE-2025-49844](https://github.com/Zain3311/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)