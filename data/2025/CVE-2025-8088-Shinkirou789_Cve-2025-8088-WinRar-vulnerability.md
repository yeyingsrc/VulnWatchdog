## CVE-2025-8088-WinRAR路径遍历远程代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者通过构造恶意压缩文件执行任意代码

**影响版本:** <= 7.12

**利用条件:** 目标用户需要使用存在漏洞的WinRAR版本打开恶意构造的RAR压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是 WinRAR Windows 版本中的一个路径遍历漏洞。攻击者可以通过创建一个恶意的 RAR 压缩文件，利用此漏洞在目标系统上执行任意代码。此漏洞允许攻击者精心制作恶意压缩文件，当用户使用易受攻击的 WinRAR 版本提取该文件时，压缩文件中的文件将被写入到目标系统上的任意位置，包括启动文件夹，从而实现远程代码执行。\n\n**漏洞利用方式：**\n\n1.  攻击者构造一个恶意的 RAR 压缩文件。该压缩文件包含一个或多个文件，这些文件的文件名包含路径遍历序列（例如 `..\`）。\n2.  当用户使用易受攻击的 WinRAR 版本提取该恶意压缩文件时，WinRAR 没有正确地验证文件名中的路径遍历序列。\n3.  WinRAR 会将压缩文件中的文件写入到文件名指定的任意位置。\n4.  如果攻击者将一个可执行文件写入到启动文件夹（例如 `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`），那么该可执行文件会在系统启动时自动执行。\n\n**POC代码分析：**\n
提供的POC代码 `Cve_2025_8088.py` 实现了利用该漏洞生成恶意RAR文件的过程。\n\n*   `_find_winrar()`: 尝试查找系统上rar.exe的路径。
*   `_crear_archivo_malicioso()`: 主函数，调用其他函数创建恶意RAR文件。
*   `_crear_exploit_ads()`:  核心函数，利用ADS流创建恶意RAR。
*   `_crear_senuelo()`: 创建一个诱饵文件。
*   `_nombre_path_traversal()`: 创建包含路径遍历的字符串，用于指定Payload写入路径。
*   `_crear_flujo()`: 创建ADS流，将Payload写入诱饵文件中。
*   `_crear_archivo_rar_base()`:  创建一个基础的RAR文件。
*   `_cambiar_placeholder_base_rar()`: 修改基础RAR文件中的占位符，替换为实际payload路径，最终生成恶意RAR文件。
\n**有效性：**\n\n该POC代码的原理符合漏洞描述，如果目标系统安装了受影响的WinRAR版本，并且用户解压了恶意RAR文件，则攻击者可以成功执行代码。因此，该POC代码**有效**。\n\n**投毒风险：**
\n代码存在一定的潜在投毒风险，因为它可以将任意可执行文件写入目标系统的启动文件夹。虽然代码本身的功能是生成利用路径遍历漏洞的RAR文件，但如果攻击者修改了代码中的`ruta_payload`，例如将其指向一个恶意软件，那么生成的RAR文件就会携带恶意软件。此外，代码中使用的硬编码路径（例如rar.exe的默认安装路径）可能在某些情况下不适用，攻击者可以通过修改代码来适应不同的环境，这也会增加投毒的风险。但整体代码逻辑围绕漏洞复现，**投毒风险较低**。 代码中对`ruta_payload` 的可控性，使得投毒风险占比在10%。

**项目地址:** [Shinkirou789/Cve-2025-8088-WinRar-vulnerability](https://github.com/Shinkirou789/Cve-2025-8088-WinRar-vulnerability)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)