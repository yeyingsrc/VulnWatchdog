## CVE-2025-54236 - Adobe Commerce Session Takeover and Remote Code Execution

**漏洞编号:** CVE-2025-54236

**漏洞类型:** 不当输入验证导致会话劫持和远程代码执行

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** <= 2.4.4-p15

**利用条件:** 目标Magento实例可访问，且Web服务器对PAYLOAD_OUT指定的目录具有写入权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-54236是一个Adobe Commerce中的不当输入验证漏洞，存在于2.4.4-p15及更早版本中。攻击者可以利用此漏洞实现会话劫持，从而导致信息泄露和完整性破坏。利用不需要用户交互。

**利用方式：**

1.  **Payload生成：** 利用 `phpggc` 工具对payload_in（包含要执行的PHP代码）进行混淆，并将结果写入到目标服务器上的 `payload_out` 文件中。该脚本使用Guzzle/FW1链进行代码混淆。
2.  **文件上传:** 通过生成随机的FORMKEY和SESSID模拟文件上传。
3.  **订单创建（触发漏洞）：** 创建一个订单，该订单通过操纵 `savePath` 配置来触发漏洞。`savePath` 配置的目的是将文件保存在特定目录中，但是可以精心构造该配置以包含已上传的恶意文件。
4.  **代码执行：** 通过Web浏览器访问上传的恶意文件，攻击者可以在目标服务器上执行任意代码。

**有效性：**

提供的PoC代码看起来是有效的，因为它描述了利用Magento 2中潜在的远程代码执行漏洞的步骤。该代码使用 `phpggc` 工具进行代码混淆，并通过操纵 `savePath` 配置来触发漏洞。CVSS评分9.1，定级为严重，且CISA KEV已收录，说明危害等级较高，利用价值大。

**投毒风险：**

该PoC代码的投毒风险较低（1%）。
*   `phpggc`工具是用于生成gadget chain的，本身不包含恶意代码。如果`payload_in`可控，则可能包含恶意代码。但是此风险不在本次评估范围。
*   PoC本身的主要功能是利用漏洞，而不是植入后门或其他恶意功能。变量名称清晰，代码逻辑相对简单，易于审查。
*   该PoC代码明确声明了其用途仅限于研究和教育目的，并警告未经授权的访问是非法的。虽然不能完全排除作者恶意，但这种声明降低了其故意投毒的可能性。

**项目地址:** [crondenice/CVE-2025-54236](https://github.com/crondenice/CVE-2025-54236)

**漏洞详情:** [CVE-2025-54236](https://nvd.nist.gov/vuln/detail/CVE-2025-54236)