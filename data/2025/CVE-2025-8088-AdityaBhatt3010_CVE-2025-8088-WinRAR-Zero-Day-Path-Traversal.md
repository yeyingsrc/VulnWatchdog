## CVE-2025-8088 WinRAR Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** Path Traversal

**影响应用:** WinRAR

**危害等级:** 高危，可导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 需要用户解压恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 WinRAR 在处理压缩文件时存在的路径遍历漏洞。攻击者可以构造恶意的 RAR 压缩文件，该文件包含使用绝对或相对路径指向系统关键位置的文件。当用户使用存在漏洞的 WinRAR 版本解压该恶意压缩文件时，恶意文件会被解压到指定位置，可能覆盖或修改系统文件，或者添加到启动目录以实现持久化。漏洞利用方式如下：

1.  **生成恶意 DLL:** 使用 `msfvenom` 或类似工具生成恶意 DLL 文件，例如 `evil.dll`，用于执行恶意代码（如计算器）。
2.  **构造遍历 RAR 文件:** 使用 WinRAR 命令 `winrar a -ep -ap"\\..\\..\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\" payload.rar evil.dll` 创建一个包含 `evil.dll` 的 RAR 文件 `payload.rar`。 `-ep` 参数排除基本路径，`-ap` 参数设置解压路径为启动目录，利用路径遍历 `..` 将文件解压到启动目录下。
3.  **(可选) ADS 隐藏:** 可以使用 ADS（Alternate Data Streams）技术将 `evil.dll` 隐藏在 `legit.txt` 中，增加隐蔽性。`type evil.dll > legit.txt:evil.dll`
4.  **诱骗用户解压:** 将恶意的 `payload.rar` 文件发送给目标用户，诱骗其使用存在漏洞的 WinRAR 版本解压。
5.  **执行恶意代码:** 当用户解压后，`evil.dll` 被释放到启动目录下。下次系统启动时，`evil.dll` 会被执行，从而实现任意代码执行。

**投毒风险分析:**

该漏洞利用代码主要包含两部分：生成恶意 DLL 和构造 RAR 文件。风险主要存在于 `evil.dll` 的生成过程中。作者有可能在生成 DLL 的过程中植入恶意代码，例如将 DLL 指向一个远程服务器，从而窃取用户信息或执行其他恶意操作。虽然提供的 PoC 使用的是 `calc.exe` 示例，但实际使用中可以替换为任意恶意代码。因此，存在一定的投毒风险。

风险百分比评估为 10%，主要基于以下考虑：

*   PoC 代码本身只是提供了一种利用路径遍历漏洞的方法，恶意代码的来源由使用者决定。
*   实际攻击中，攻击者更有可能使用自定义的恶意代码，而不是依赖 PoC 代码作者提供的 DLL。
*   可以通过对生成的 DLL 文件进行安全分析，例如使用杀毒软件或沙箱环境，来降低投毒风险。

**项目地址:** [AdityaBhatt3010/CVE-2025-8088-WinRAR-Zero-Day-Path-Traversal](https://github.com/AdityaBhatt3010/CVE-2025-8088-WinRAR-Zero-Day-Path-Traversal)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)