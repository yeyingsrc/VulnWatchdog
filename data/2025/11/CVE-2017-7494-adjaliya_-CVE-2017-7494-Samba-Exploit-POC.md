## CVE-2017-7494-Samba-远程代码执行

**漏洞编号:** CVE-2017-7494

**漏洞类型:** 远程代码执行

**影响应用:** Samba

**危害等级:** 高危，允许恶意客户端上传共享库并导致服务器加载和执行，从而实现远程代码执行

**影响版本:** 3.5.0 <= version < 4.6.4, 4.5.0 <= version < 4.5.10, 4.4.0 <= version < 4.4.14

**利用条件:** 需要目标Samba服务器存在可写共享目录，且客户端能够访问该共享目录。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7494 (SambaCry) 漏洞允许经过身份验证的攻击者通过上传恶意共享库到可写共享目录，然后触发服务器加载并执行该库，从而实现远程代码执行。利用方式包括：

1.  **上传恶意共享库：** 攻击者首先需要找到一个具有写入权限的共享目录。
2.  **触发加载：**  攻击者通过修改共享目录的配置或者其他方式，使得Samba服务器加载上传的恶意共享库。
3.  **远程代码执行：** 一旦恶意共享库被加载，其中的代码将在Samba服务器的上下文中执行，攻击者可以借此执行任意命令。

**关于有效性：**
漏洞库信息和描述中已经明确指出漏洞的存在和影响范围。漏洞利用代码（尽管只有README.md文件）也描述了漏洞的影响和受影响的版本。综合来看，此漏洞真实有效。

**关于投毒风险：**
当前提供的文件内容（README.md）主要描述漏洞信息，并未包含可执行的漏洞利用代码。因此，投毒风险较低，但不能完全排除。在实际使用漏洞利用代码时，务必进行代码审计，以避免引入恶意代码。由于缺少实际的可执行漏洞利用代码，判断存在投毒代码的概率为10%。

**漏洞利用方式总结：**
攻击者利用此漏洞需要具备以下条件：

*   能够访问目标Samba服务器上的共享目录。
*   在共享目录上拥有写入权限。

利用步骤如下：

1.  **找到可写共享：** 确定目标Samba服务器上是否存在可写的共享目录。
2.  **上传恶意so文件：** 将包含恶意代码的共享库文件（例如：.so文件）上传到可写共享目录中。
3.  **触发加载恶意代码：** 通过特定的Samba命令或配置，触发服务器加载上传的恶意共享库，从而执行其中的恶意代码。

**项目地址:** [adjaliya/-CVE-2017-7494-Samba-Exploit-POC](https://github.com/adjaliya/-CVE-2017-7494-Samba-Exploit-POC)

**漏洞详情:** [CVE-2017-7494](https://nvd.nist.gov/vuln/detail/CVE-2017-7494)