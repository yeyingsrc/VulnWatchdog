## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据库信息泄露和管理员账户破解

**影响版本:** <= 2.2.9

**利用条件:** 目标服务器需要运行存在漏洞的CMS Made Simple版本，且News模块未禁用，攻击者需要能够访问到易受攻击的URL。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9053存在于CMS Made Simple的News模块中。攻击者可以通过构造恶意的URL，利用`m1_idlist`参数进行未经验证的盲注时间型SQL注入。漏洞利用代码`exploit_python3.py`通过发送包含恶意SQL语句的HTTP请求，并根据服务器响应时间来推断数据库中的信息，如salt、用户名、邮箱和管理员密码哈希值。该漏洞利用代码还包含一个可选的密码破解功能，可以使用字典攻击来破解管理员密码。尽管代码中没有明显的恶意植入，但任何未授权的漏洞利用都是非法的，并且存在潜在的风险。该风险评估的毒性比例评估较低，因为该漏洞利用代码主要集中在利用已知的漏洞，而不是引入新的恶意代码。代码的风险在于利用过程本身，而不在于代码本身被恶意修改以引入后门或恶意功能，考虑到代码来源是一个开源项目，且功能相对集中在SQL注入，毒性风险评估为5%。

**漏洞利用方式：**

1.  **定位漏洞URL：** 确定CMS Made Simple实例中存在漏洞的`moduleinterface.php` URL。
2.  **构造Payload：** 构造包含`sleep()`函数的SQL注入Payload，并将其作为`m1_idlist`参数的值传递。
3.  **发送请求：** 通过HTTP GET请求将Payload发送到目标URL。
4.  **时间推断：** 根据服务器响应时间判断SQL语句是否执行成功。
5.  **信息提取：** 通过多次注入和时间推断，逐步提取数据库中的敏感信息，如salt、用户名、邮箱和密码哈希。
6.  **密码破解：** （可选）使用提取的salt和密码哈希，通过字典攻击破解管理员密码。

**项目地址:** [JagdeepSinghCeh/cms-made-simple-python3](https://github.com/JagdeepSinghCeh/cms-made-simple-python3)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)