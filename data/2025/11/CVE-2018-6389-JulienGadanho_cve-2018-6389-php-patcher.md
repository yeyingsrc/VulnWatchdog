## CVE-2018-6389-WordPress-DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致网站瘫痪

**影响版本:** <= 4.9.2

**利用条件:** 无需认证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6389 是一个存在于 WordPress 4.9.2 及更早版本中的拒绝服务漏洞。未经身份验证的攻击者可以利用 `wp-includes/script-loader.php` 中注册的大量 .js 文件，通过构造一系列请求来多次加载每个文件，从而消耗服务器资源并导致拒绝服务。

**有效性：**
根据漏洞库信息和网络搜索结果，该漏洞是真实存在的，且存在公开可用的 PoC。 exploit-db 上也存在利用代码。

**投毒风险：**
提供的代码是一个 PHP 补丁，旨在修复 CVE-2018-6389 漏洞。该脚本检查 WordPress 的关键文件（wp-login.php, wp-admin/load-scripts.php, wp-admin/load-styles.php, wp-admin/includes/noop.php）是否存在，并修改它们以缓解漏洞。 具体操作包括：

*   在 wp-login.php 中定义 `CONCATENATE_SCRIPTS` 为 `false`，禁用脚本连接。
*   修改 `wp-admin/load-scripts.php` 和 `wp-admin/load-styles.php`，使其包含 `wp-admin/admin.php` 而不是 `wp-includes/script-loader.php`。
*   创建或替换 `wp-admin/includes/noop.php` 文件。目的是防御利用漏洞。

检查了代码，未发现任何可疑的恶意代码或后门。脚本的行为符合其声明的目的，即修补漏洞。因此，投毒风险为0%。

**利用方式：**
1.  攻击者获取 WordPress 网站中注册的 .js 文件列表（位于 `wp-includes/script-loader.php`）。
2.  攻击者构造包含大量 .js 文件 URL 的请求，并多次发送这些请求到目标服务器。
3.  服务器尝试加载和处理所有请求的文件，导致 CPU 和内存资源消耗增加。
4.  大量的请求最终可能导致服务器资源耗尽，无法响应正常的访问请求，从而造成拒绝服务。

**总结：**
该漏洞利用方式简单，影响范围广，容易造成拒绝服务。提供的代码是用于修补该漏洞的，不存在投毒风险。

**项目地址:** [JulienGadanho/cve-2018-6389-php-patcher](https://github.com/JulienGadanho/cve-2018-6389-php-patcher)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)