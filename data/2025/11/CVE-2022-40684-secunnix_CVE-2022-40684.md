## CVE-2022-40684-Fortinet认证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 认证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 严重，未授权的远程管理权限

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问目标设备的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-40684是一个Fortinet产品中的身份验证绕过漏洞，影响FortiOS，FortiProxy和FortiSwitchManager的特定版本。攻击者可以通过构造特制的HTTP或HTTPS请求，绕过身份验证，从而在管理界面上执行操作。根据CISA的已知被利用漏洞目录，此漏洞已被积极利用。

提供的漏洞利用代码（Cargo.lock文件）并非直接的expolit脚本，而是Rust项目的依赖项锁定文件。它列出了构建Rust项目所需的各种库及其版本。通过分析该文件本身,无法判断漏洞利用的直接有效性。但是，漏洞库信息中提到存在功能性POC代码。

由于Cargo.lock 文件本身只是依赖项信息，不包含可执行代码，因此不存在作者在此文件中隐藏投毒代码的风险。该文件是为了保证项目构建的可重复性，明确指定依赖包的版本。

利用方式：
1. 攻击者构造恶意的HTTP或HTTPS请求，目标是受影响的Fortinet设备的管理界面。
2. 请求经过精心设计，能够绕过身份验证检查。
3. 成功绕过身份验证后，攻击者可以执行任意管理操作，例如更改配置，添加用户或执行命令。

**项目地址:** [secunnix/CVE-2022-40684](https://github.com/secunnix/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)