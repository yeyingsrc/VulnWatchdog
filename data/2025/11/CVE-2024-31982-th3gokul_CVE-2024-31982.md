## CVE-2024-31982-XWiki Platform-远程代码执行

**漏洞编号:** CVE-2024-31982

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 2.4-milestone-1 < 14.10.20, 15.0-rc-1 < 15.5.4, 15.6-rc-1 < 15.10-rc-1

**利用条件:** 需要目标XWiki实例存在DatabaseSearch功能页面且未修补

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-31982是XWiki Platform中的一个远程代码执行漏洞，存在于DatabaseSearch功能中。未经身份验证的攻击者可以通过构造恶意的搜索字符串，利用Eval注入漏洞执行任意代码。漏洞利用方式为：

1.  访问目标XWiki实例的DatabaseSearch页面。
2.  在搜索框中输入精心构造的恶意代码，利用服务器端动态评估代码的漏洞。
3.  恶意代码在服务器上执行，攻击者可以获得服务器的控制权。

提供的POC代码是一个Python脚本，旨在检测和利用此漏洞。脚本通过发送包含恶意payload的HTTP请求来测试目标URL是否存在漏洞。 存在投毒风险的可能性较低，主要集中在以下几个方面：

1. `requirements.txt` 文件中可能包含恶意依赖库，在安装时引入恶意代码。
2.  `cvehunter.py` 可能存在后门代码。例如，在输出结果或请求过程中，将特定信息发送到攻击者的服务器。但结合代码内容来看，只是一个检测脚本，因此投毒的可能性较低。

综上所述，判断存在轻微投毒风险，建议在使用此POC代码时，仔细检查`requirements.txt`和`cvehunter.py`的内容，并在隔离环境中运行，监控网络流量。

利用此漏洞的根本原因在于XWiki Platform的DatabaseSearch功能对用户输入未进行充分的过滤和验证，导致恶意代码被执行。

**项目地址:** [th3gokul/CVE-2024-31982](https://github.com/th3gokul/CVE-2024-31982)

**漏洞详情:** [CVE-2024-31982](https://nvd.nist.gov/vuln/detail/CVE-2024-31982)