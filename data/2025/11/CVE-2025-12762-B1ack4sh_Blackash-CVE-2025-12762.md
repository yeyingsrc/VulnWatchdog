## CVE-2025-12762 - pgAdmin 4 远程代码执行

**漏洞编号:** CVE-2025-12762

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** pgAdmin 4

**危害等级:** 严重，可导致服务器被完全控制

**影响版本:** <= 9.9

**利用条件:** pgAdmin 4 运行在服务器模式，并且允许通过网络访问，需要有效的管理员凭据

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据提供的漏洞库信息，pgAdmin 4 直到 9.9 版本受到远程代码执行漏洞的影响。当 pgAdmin 在服务器模式下运行并从 PLAIN 格式的转储文件执行恢复时，会发生此漏洞。攻击者可以注入并在托管 pgAdmin 的服务器上执行任意命令，从而对数据库管理系统和基础数据的完整性和安全性构成严重风险。

**有效性分析：**
提供的 POC 代码针对 CVE-2025-12762，利用 pgAdmin 4 在服务器模式下恢复 PLAIN 格式 SQL 转储文件时存在的命令注入漏洞。POC 首先登录 pgAdmin，然后上传一个包含恶意 SQL 命令的 PLAIN 格式转储文件。该文件利用 `\!` 命令执行任意系统命令。POC 通过 restore 功能触发执行，从而在 pgAdmin 服务器上执行命令。根据代码注释和漏洞描述，该 POC 代码有效。

**投毒风险分析：**
*   代码功能分析：该脚本的主要功能是利用漏洞，没有发现主动删除或修改系统关键文件的代码。
*   隐蔽后门：代码结构清晰，虽然包含请求和登录，但没有发现任何尝试连接外部恶意服务器或执行未知操作的代码。
*   Payload 可控性：用户可以自定义要执行的命令，因此Payload相对可控，降低了被恶意利用的可能性。
*   文件上传限制：上传的文件会被服务器端处理，如果存在恶意代码，可能会被检测到。
*   依赖库风险：脚本依赖 `requests` 库，该库本身没有已知的重大安全漏洞。
综合以上分析，此POC的投毒风险较低，约为 5%。 主要是可能被篡改成执行更具破坏性的命令。

**利用方式：**
1.  **登录 pgAdmin:** 使用有效的管理员凭据登录到 pgAdmin 4 实例。
2.  **上传恶意转储文件:**  上传一个包含恶意 SQL 命令的 PLAIN 格式的 SQL 转储文件。该文件包含 `\! <command>` 语句，其中 `<command>` 是要在服务器上执行的命令。
3.  **触发恢复:** 使用 pgAdmin 4 的恢复功能，选择上传的恶意 SQL 转储文件进行恢复。确保选择 PLAIN 格式。
4.  **命令执行:**  恢复过程将执行嵌入在转储文件中的恶意命令，从而允许攻击者在 pgAdmin 4 服务器上执行任意代码。

**缓解措施：**
*   升级到 pgAdmin 4 v10.0 或更高版本。
*   限制对 pgAdmin 服务器的访问。
*   只允许受信任的管理员恢复转储文件。
*   在恢复之前验证转储文件。
*   监控日志中可疑的恢复活动。
*   使用防火墙规则/ VPN 限制暴露。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-12762](https://github.com/B1ack4sh/Blackash-CVE-2025-12762)

**漏洞详情:** [CVE-2025-12762](https://nvd.nist.gov/vuln/detail/CVE-2025-12762)