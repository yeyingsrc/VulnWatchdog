## CVE-2025-26624-Rufus-本地提权

**漏洞编号:** CVE-2025-26624

**漏洞类型:** DLL劫持

**影响应用:** Rufus

**危害等级:** 中危，本地权限提升

**影响版本:** < 4.7

**利用条件:** 需要低权限用户权限，以及在Rufus可执行文件相同目录下放置恶意DLL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26624 漏洞是Rufus 4.6及之前版本中的一个本地权限提升漏洞。攻击者可以通过在Rufus可执行文件所在的目录中放置一个恶意的 `cfgmgr32.dll` 文件来劫持DLL加载过程。当Rufus启动时，它会加载该恶意DLL，从而允许攻击者以Rufus进程的权限执行任意代码，实现权限提升。提供的C代码实际上并非直接劫持`cfgmgr32.dll`，而是提供了一个可以用来进行权限提升的框架。它利用Winlogon进程的Token来创建一个具有SYSTEM权限的shell。攻击者首先要使用此C代码编译生成`regsvr32.exe`,然后需要自己编写一个`cfgmgr32.dll`来调用`regsvr32.exe`。 

**漏洞利用方式:**

1.  攻击者需要将恶意 `cfgmgr32.dll` 放置在 Rufus.exe 所在的目录中。
2.  Rufus 启动时，会加载该恶意 DLL。
3.  恶意 DLL 执行攻击者的代码，利用提供的代码框架，创建拥有SYSTEM权限的shell,从而获得更高的权限。

**有效性评估:**

根据漏洞描述和提供的POC代码框架，该漏洞利用是有效的。攻击者可以利用 DLL 劫持漏洞和提供的代码创建高权限的 shell。

**投毒风险分析:**

提供的C代码本身并未发现明显的恶意后门代码，但存在一定的投毒风险。风险主要来自以下几个方面：

*   **依赖性风险：** 提供的代码依赖于特定的库和函数，攻击者可能在编译或修改代码的过程中引入额外的恶意代码。
*   **代码混淆风险：** 攻击者可能对代码进行混淆，使其难以分析，从而隐藏潜在的恶意行为。
*   **参数篡改风险：** 攻击者可能篡改代码中的参数，例如 LHOST 和 LPORT，将其指向恶意的服务器。
*   **代码本身：** 代码尝试获取 Winlogon 的Token，并创建SYSTEM权限的shell，这本身就是一个高危操作，如果被恶意利用，后果严重。

综合考虑，该代码存在一定的投毒风险，但可能性相对较低。代码主要作用是提供一个提权框架，是否被恶意利用取决于使用者的目的。

**总结：**

该漏洞是一个典型的 DLL 劫持漏洞，攻击者通过替换 Rufus 依赖的 DLL 文件来实现权限提升。提供的 C 代码提供了一个创建SYSTEM权限 shell 的框架，需要攻击者配合 DLL 劫持来实现完整的攻击过程。虽然代码本身没有明显的后门，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [havertz2110/CVE-2025-26624](https://github.com/havertz2110/CVE-2025-26624)

**漏洞详情:** [CVE-2025-26624](https://nvd.nist.gov/vuln/detail/CVE-2025-26624)