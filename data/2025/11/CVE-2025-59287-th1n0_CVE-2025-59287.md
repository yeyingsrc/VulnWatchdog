## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows Server版本包括2012, 2012 R2, 2016, 2019, 2022, 2025, 23H2，具体版本范围请参见漏洞库信息。

**利用条件:** 需要能够向WSUS服务器发送SOAP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)中的远程代码执行漏洞。该漏洞源于对不可信数据的反序列化。未经授权的攻击者可以通过网络执行代码。攻击者可以利用此漏洞通过发送特制的SOAP请求到WSUS服务器的web端点，诱使服务器反序列化恶意的.NET对象，从而以SYSTEM权限执行任意代码。

**利用方式：**

1.  准备一个恶意的.NET对象，并使用.NET BinaryFormatter序列化。
2.  将序列化后的数据进行Base64编码。
3.  使用`encrypt.py` 脚本伪装成WSUS期望的加密数据格式，该脚本模拟了WSUS的加密/打包数据流程。
4.  使用`exp.py`脚本构建包含恶意负载的SOAP请求，并将该请求发送到WSUS服务器。`exp.py`将伪装后的数据插入到WSUS服务端将要解密和反序列化的字段中。
5.  如果服务器存在漏洞，则反序列化对象将触发代码执行。

**投毒风险分析：**

虽然该POC声明仅用于教育目的，并且包含了免责声明，但仍存在一定的投毒风险。风险主要集中在以下几个方面：

*   `payload.txt`文件和exp.py文件允许用户自定义payload，如果用户使用了从不可信来源获取的payload，则可能引入恶意代码。
*   `encrypt.py`脚本中存在与加密相关的逻辑，虽然该脚本旨在模拟WSUS的加密过程，但恶意修改该脚本可能会导致生成的payload无法正常工作，从而使利用失败。不过，如果精心构造，也可能导致其他意想不到的问题。
*   虽然代码提供了计算器payload作为示例，但用户很可能替换成其他payload。存在通过论坛、社交媒体等渠道传播带有后门的恶意payload的风险。
*   该漏洞允许远程代码执行，攻击者可以利用此漏洞在目标系统上安装后门、窃取敏感数据或进行其他恶意活动。因此，即使POC代码本身没有恶意，也可能被用于进行恶意攻击。

综合评估，该POC代码本身存在少量（约5%）的投毒风险。主要风险在于用户可能使用不安全的payload或者被篡改的`encrypt.py`脚本。开发者明确声明工具仅用于教育目的，以及代码中存在一定的安全检查，降低了直接投毒的概率。但是，使用者需要对使用的payload和脚本的来源保持警惕，避免引入恶意代码。

**项目地址:** [th1n0/CVE-2025-59287](https://github.com/th1n0/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)