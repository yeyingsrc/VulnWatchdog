## CVE-2025-54782-@nestjs/devtools-integration-RCE

**漏洞编号:** CVE-2025-54782

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** @nestjs/devtools-integration

**危害等级:** 极高，可能导致完全控制受害者机器

**影响版本:** < 0.2.1

**利用条件:** 目标机器运行着启用了@nestjs/devtools-integration的NestJS开发服务器，且攻击者能通过CSRF或相邻网络访问到该开发服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于@nestjs/devtools-integration包中，当启用该包时，会暴露一个本地开发HTTP服务器，该服务器的API端点使用不安全的JavaScript沙箱。由于不正确的沙箱和缺少跨域保护，恶意网站可以利用CSRF对开发人员的本地机器执行任意代码。

**漏洞利用方式：**

1.  **攻击者诱导开发者访问恶意网站。**
2.  **恶意网站利用CSRF，向开发者本地运行的NestJS开发服务器的`/inspector/graph/interact`端点发送POST请求。**
3.  **POST请求中包含恶意的JavaScript代码，该代码通过`child_process.execSync`执行系统命令。**

**POC有效性：**

提供的PoC代码有效，它构造包含恶意JavaScript代码的POST请求，并发送到目标服务器。PoC代码还包含重试逻辑和多线程支持，提高了漏洞利用的成功率。

**投毒风险：**

PoC代码本身看起来没有明显的投毒代码。PoC的主要功能是利用已知的RCE漏洞，而不是在目标系统上植入后门或执行恶意操作。但是，使用任何未经审计的PoC代码都存在一定的风险，特别是当代码包含任意命令执行时，用户应仔细审查代码后再执行。

风险评估为1%，因为代码中执行的命令完全由用户控制，如果用户执行了恶意的命令，则会被用户自己投毒，代码本身的投毒风险极低。

**项目地址:** [DDestinys/CVE-2025-54782](https://github.com/DDestinys/CVE-2025-54782)

**漏洞详情:** [CVE-2025-54782](https://nvd.nist.gov/vuln/detail/CVE-2025-54782)