## CVE-2018-6389-WordPress-DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致网站瘫痪

**影响版本:** <= 4.9.2

**利用条件:** 无需身份验证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6389 漏洞允许未经身份验证的攻击者通过发送大量针对 WordPress 注册的 .js 文件的请求来执行拒绝服务攻击。攻击者利用 `wp-includes/script-loader.php` 文件中注册的大量 .js 文件列表，构造一系列请求，重复加载每个文件，从而耗尽服务器资源。

**漏洞利用有效性：**
根据漏洞库信息和Exploit-DB链接（https://www.exploit-db.com/exploits/43968/），该漏洞是有效的，存在可利用的PoC。

提供的`doser.py` 代码是一个通用的HTTP DoS攻击工具，可以用于发送大量的GET或POST请求。虽然它本身不是专门针对 CVE-2018-6389 的 PoC，但可以修改该脚本，构造针对 WordPress .js 文件的请求，从而实现利用。该工具通过多线程方式发送大量请求，达到资源耗尽的目的。

**投毒风险分析：**
`doser.py` 主要功能是发送大量HTTP请求，从代码分析来看，投毒风险较低。它通过随机生成User-Agent和Referer头部来尝试绕过一些简单的防御机制。 投毒风险主要集中在以下几个方面：

*   **恶意代码植入：**虽然未发现明显的恶意代码，但攻击者可能修改脚本，添加恶意代码，例如上传webshell或执行系统命令。
*   **依赖项风险：**`doser.py` 使用了 `requests` 库。如果攻击者控制了该库的来源，可能引入包含恶意代码的版本。

综合评估，投毒风险约为5%。主要是考虑到可能存在被修改的风险，但核心功能相对简单。

**漏洞利用方式：**
1.  **获取 .js 文件列表：** 从 WordPress 站点的 `wp-includes/script-loader.php` 文件中获取所有注册的 .js 文件列表。
2.  **构造请求：**  使用 `doser.py` 或其他 HTTP 请求工具，构造大量针对这些 .js 文件的 GET 请求。
3.  **发送请求：** 使用多线程或其他并发方式，向目标 WordPress 站点发送这些请求，消耗服务器资源。

例如，可以修改 `doser.py` 脚本，使其从文件中读取 .js 文件列表，并循环发送请求。
`python doser.py -t 999 -g 'https://targeted.site.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'` 针对单个js文件进行攻击，然后修改脚本可以针对多个js文件同时攻击。

**项目地址:** [ianxtianxt/CVE-2018-6389](https://github.com/ianxtianxt/CVE-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)