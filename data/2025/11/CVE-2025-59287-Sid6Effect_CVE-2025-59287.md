## CVE-2025-59287-Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，允许未授权的攻击者通过网络执行任意代码。

**影响版本:** 受影响的Windows Server版本包括2012, 2012 R2, 2016, 2019, 2022, 2025和23H2，具体版本范围见漏洞库信息。

**利用条件:** 需要能够访问目标WSUS服务器的网络，以及能够发送特制的SOAP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以利用此漏洞，通过发送特制的SOAP请求到WSUS服务器，从而在服务器上执行任意代码。 

**有效性：**

根据漏洞库信息和提供的PoC代码，此漏洞的PoC是可用的，并且CISA ADP给出了PoC可利用的标记。因此，该PoC被认为是有效的。

**投毒风险：**

该PoC代码存在一定的投毒风险。`README.md`声明该工具仅用于教育目的，禁止在未经授权的环境中使用，但PoC的存在本身就可能被恶意利用。`encrypt.py`中的`pseudo_random_nonzero`函数虽然目的是生成非零的伪随机数，但如果种子可控，则可能被用于生成可预测的“加密”结果，这可能被用于构造特定目的的payload。此外，`exp.py`允许用户自定义payload，这也增加了payload被替换为恶意代码的风险。虽然代码本身没有明显的后门，但存在被利用进行恶意活动的可能。综合评估，投毒风险为10%。

**利用方式：**

1.  **准备Payload:** 攻击者需要准备一个.NET BinaryFormatter序列化的payload，该payload能够在目标服务器上执行任意代码。可以使用诸如ysoserial.net的工具来生成payload。
2.  **Base64编码:** 将payload进行Base64编码。
3.  **替换payload:** 将Base64编码后的payload插入到`exp.py`的指定位置，或者将其放入`payload.txt`文件中。
4.  **运行PoC:** 运行`python exp.py http://example.local:8533`，将`http://example.local:8533`替换为目标WSUS服务器的URL。
5.  **`encrypt.py`作用:** `encrypt.py` 脚本用于模拟WSUS服务器对数据的加密过程，生成看起来像是经过加密的数据块，然后`exp.py`将这些数据块嵌入到SOAP请求中。

**漏洞原理:** WSUS服务器在处理SOAP请求时，会反序列化其中的数据。如果攻击者能够构造一个包含恶意.NET对象的SOAP请求，WSUS服务器在反序列化该对象时，就会执行攻击者预先设定的代码，从而导致远程代码执行。


**项目地址:** [Sid6Effect/CVE-2025-59287](https://github.com/Sid6Effect/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)