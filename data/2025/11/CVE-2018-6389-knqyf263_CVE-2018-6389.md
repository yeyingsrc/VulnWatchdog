## CVE-2018-6389 - WordPress DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致网站服务中断

**影响版本:** <= 4.9.2

**利用条件:** 无需认证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6389 存在于 WordPress 4.9.2 及更早版本中。未经验证的攻击者可以通过利用 `wp-includes/script-loader.php` 中注册的大量 .js 文件列表，构造一系列请求来多次加载每个文件，从而导致拒绝服务（资源消耗）。

**有效性：**

提供的 POC 代码使用 `doser.py` 脚本发送包含大量 JavaScript 文件列表的恶意请求，以此耗尽服务器资源，导致 DoS。该POC通过docker-compose启动一个存在漏洞的WordPress版本（4.9.3，虽然高于漏洞影响版本，但可能存在相似问题或配置差异导致漏洞仍然存在），然后执行python脚本发起攻击，验证了漏洞的有效性。

**投毒风险：**

提供的 `docker-compose.yml` 文件和 `README.md` 文件主要用于搭建漏洞环境和提供利用说明。其中并没有发现任何恶意代码或后门，因此投毒风险较低。`doser.py`脚本是另外下载的，需要单独分析其是否安全，本分析假设从可信来源下载。

**利用方式：**

1.  **获取 JavaScript 文件列表：** 攻击者首先需要获取 `wp-includes/script-loader.php` 中注册的 JavaScript 文件列表。
2.  **构造恶意 URL：**  攻击者使用获取的 JavaScript 文件列表构造包含大量 `load[]` 参数的 URL。 这些参数指定要加载的 JavaScript 文件。`doser.py`中的`-g`参数即用于指定包含恶意payload的URL。
3.  **发送请求：**  攻击者向 WordPress 站点发送构造的恶意 URL 请求。`doser.py`脚本通过`-t`参数指定请求的次数。
4.  **资源消耗：**  WordPress 站点尝试加载 URL 中指定的所有 JavaScript 文件。由于文件数量众多且可能重复加载，服务器会消耗大量资源（CPU、内存、带宽），最终导致拒绝服务。



**项目地址:** [knqyf263/CVE-2018-6389](https://github.com/knqyf263/CVE-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)