## CVE-2022-40684-Fortinet-Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** Fortinet FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可使未授权的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 需要网络访问，目标设备开启管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 存在于 Fortinet FortiOS, FortiProxy, 和 FortiSwitchManager 中。这是一个身份验证绕过漏洞，允许未经身份验证的攻击者通过精心制作的 HTTP 或 HTTPS 请求在管理界面上执行操作。根据漏洞库信息，该漏洞的CVSS 3.1评分为9.8，属于严重级别，且漏洞利用代码成熟度为FUNCTIONAL，表明存在可用的漏洞利用程序。CISA的已知被利用漏洞目录也收录了此漏洞，进一步表明该漏洞正在被积极利用。提供的代码片段是一个 `Cargo.lock` 文件，它定义了一个 Rust 项目 `fortipwn` 的依赖关系。`fortipwn` 依赖于 `futures`, `reqwest`, `serde`, `serde_json`, 和 `tokio` 等库，表明这个项目可能是一个用于利用 Fortinet 产品的工具。虽然 `Cargo.lock` 文件本身不包含实际的漏洞利用代码，但它揭示了项目的功能和潜在目标。考虑到漏洞描述和`fortipwn`这个项目名称，有理由相信它旨在利用 Fortinet 产品的漏洞。由于`Cargo.lock`只包含依赖信息，没有发现明显的投毒行为，但依赖项本身可能会被投毒，所以存在一定的投毒风险，评估为10%。利用方式是通过发送特制的HTTP/HTTPS请求绕过身份验证，从而在受影响的Fortinet设备上执行未经授权的操作，例如配置更改或执行命令。

**项目地址:** [xtwip/fortipwn](https://github.com/xtwip/fortipwn)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)