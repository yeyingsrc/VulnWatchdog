## CVE-2025-62168-Squid代理信息泄露

**漏洞编号:** CVE-2025-62168

**漏洞类型:** 信息泄露

**影响应用:** Squid

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 7.2

**利用条件:** 目标系统使用Squid代理，且版本低于7.2

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-62168 漏洞存在于 Squid 代理服务器的错误处理中，由于未能正确过滤 HTTP 认证凭据，导致敏感信息泄露。攻击者可以利用该漏洞绕过浏览器安全保护，获取受信任客户端的认证信息，进而威胁到后端 Web 应用的安全。

**有效性分析：**
提供的 PoC 代码（main.py）尝试通过构造特定请求，触发 Squid 代理服务器的错误处理机制，并检查返回的错误页面中是否包含 JWT_TOKEN 等敏感信息。代码逻辑上是可行的，能够验证漏洞的存在。

**投毒风险分析：**
虽然代码中包含了一些与版本检测无关的token(如JWT_TOKEN,X_AUTH_TOKEN)，但这些token是在漏洞触发后用来做对比验证是否泄露，可以理解为PoC验证的后门，不属于投毒。但是代码存在潜在的投毒风险：

1.  **依赖项风险：** `requirements.txt` 文件中可能包含恶意或被篡改的第三方库，这些库可能执行恶意代码，如信息窃取或远程控制。
2.  **作者邮箱：** 作者邮箱为 monzavi@protonmail.com，使用匿名邮箱增加了潜在的恶意风险。
3.  **捐赠地址：** 包含了比特币捐赠地址，可能暗示作者的动机，但也可能是障眼法。
4.  **硬编码URL：**`url = 'http://127.0.0.1'` 有可能替换为恶意的url。

综合分析，该仓库存在一定的投毒风险，但不确定性较高，预估风险为20%。

**利用方式：**
1.  攻击者首先需要确定目标系统正在使用 Squid 代理，且版本低于 7.2。
2.  攻击者可以发送一个构造好的恶意 HTTP 请求，该请求会导致 Squid 代理服务器产生错误。
3.  由于漏洞的存在，Squid 代理服务器在生成错误页面时，会将 HTTP 认证凭据（如Authorization、Proxy-Authorization头部信息）泄露在错误页面中。
4.  攻击者通过分析错误页面，可以获取到泄露的认证凭据，从而冒充合法用户访问受保护的资源。

**项目地址:** [shahroodcert/CVE-2025-62168](https://github.com/shahroodcert/CVE-2025-62168)

**漏洞详情:** [CVE-2025-62168](https://nvd.nist.gov/vuln/detail/CVE-2025-62168)