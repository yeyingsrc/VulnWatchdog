## CVE-2025-64446-FortiWeb-路径遍历导致管理员命令执行

**漏洞编号:** CVE-2025-64446

**漏洞类型:** 路径遍历

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致管理员权限获取和命令执行

**影响版本:** 8.0.0 <= FortiWeb <= 8.0.1, 7.6.0 <= FortiWeb <= 7.6.4, 7.4.0 <= FortiWeb <= 7.4.9, 7.2.0 <= FortiWeb <= 7.2.11, 7.0.0 <= FortiWeb <= 7.0.11

**利用条件:** 需要网络访问目标FortiWeb设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64446 是 Fortinet FortiWeb 中的一个路径遍历漏洞。根据漏洞描述，攻击者可以利用精心构造的 HTTP 或 HTTPS 请求，执行系统上的管理命令。该漏洞影响 FortiWeb 8.0.0 到 8.0.1、7.6.0 到 7.6.4、7.4.0 到 7.4.9、7.2.0 到 7.2.11 以及 7.0.0 到 7.0.11 版本。

**漏洞利用的有效性：**

提供的 PoC 代码看起来是有效的。它利用了路径遍历漏洞读取敏感文件或执行未授权操作。从代码逻辑看，通过构造包含相对路径的 URL，绕过身份验证，访问管理接口，从而执行管理员命令。

**投毒风险：**

分析提供的PoC代码后，没有发现明显的投毒代码。主要功能是验证漏洞是否存在和利用漏洞创建/修改用户账户。所有操作都集中于利用已知的漏洞，并没有发现尝试植入后门或进行其他恶意操作的迹象。 投毒风险评估为 0%。

**漏洞利用方式：**

该漏洞的利用方式是：

1.  **路径遍历：** 通过在 URL 中使用相对路径（例如，`../../../`），攻击者可以绕过 FortiWeb 的访问控制，访问受保护的 API 接口。
2.  **API 接口访问：** 成功绕过身份验证后，攻击者可以访问 FortiWeb 的管理 API 接口，例如，`/api/v2.0/system/admin`。
3.  **执行管理命令：** 通过 API 接口，攻击者可以执行各种管理命令，例如，创建或修改用户账户，从而完全控制 FortiWeb 设备。
4. **PoC脚本功能**: 该脚本提供检查漏洞是否存在、以及利用该漏洞创建一个新的管理员账户的功能. 脚本根据用户给定的目标ip, 端口等信息，通过发送构造好的恶意请求，检查特定的API端点是否可以被未授权访问。 如果API响应指示成功或可能存在漏洞，则脚本会标记该目标为易受攻击.更进一步，脚本也可以利用这个漏洞创建一个新的管理员账户，通过`--username`和`--password`参数指定用户名和密码.默认的用户名和密码是`sxy`和`sxyrxyadmin1!`

**总结：**

CVE-2025-64446 是一个严重的安全漏洞，利用它，未经身份验证的攻击者可以在受影响的 FortiWeb 设备上执行管理命令。提供的 PoC 代码是有效的，可用于验证和利用此漏洞。建议受影响的用户尽快升级到 FortiWeb 8.0.2 或更高版本，或者升级到其他受支持的修复版本。

**项目地址:** [sxyrxyy/CVE-2025-64446-FortiWeb-CGI-Bypass-PoC](https://github.com/sxyrxyy/CVE-2025-64446-FortiWeb-CGI-Bypass-PoC)

**漏洞详情:** [CVE-2025-64446](https://nvd.nist.gov/vuln/detail/CVE-2025-64446)