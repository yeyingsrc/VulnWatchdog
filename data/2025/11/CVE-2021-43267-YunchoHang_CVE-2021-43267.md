## CVE-2021-43267-Linux Kernel TIPC-栈溢出

**漏洞编号:** CVE-2021-43267

**漏洞类型:** 栈溢出

**影响应用:** Linux Kernel TIPC

**危害等级:** 高危，可能导致内核崩溃或任意代码执行

**影响版本:** < 5.14.16

**利用条件:** 需要加载TIPC模块，本地或远程访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43267 存在于 Linux kernel TIPC 模块的 net/tipc/crypto.c 中，5.14.16 之前版本受影响。该漏洞允许远程攻击者利用 MSG_CRYPTO 消息类型对用户提供的 size 进行验证不足的漏洞。PoC 代码 `poc.c` 演示了如何利用此漏洞进行本地提权。该 PoC 涉及构造特定的 TIPC 消息，覆盖栈上的数据。从提供的代码片段看，未发现明显的投毒代码。漏洞利用方式如下：

1.  **漏洞点：** net/tipc/crypto.c 中处理 `MSG_CRYPTO` 消息时，未充分验证用户提供的大小，导致栈溢出。
2.  **利用方式：** PoC 代码构造一个恶意的 `MSG_CRYPTO` 消息，其中包含精心设计的 payload，该 payload 旨在覆盖栈上的关键数据（例如返回地址），从而控制程序执行流程。
3.  **影响：** 成功利用此漏洞可能导致内核崩溃、权限提升或任意代码执行。
4.  **缓解措施：** 将内核升级到 5.14.16 或更高版本可以修复此漏洞。
5.  **投毒风险：** 经过分析，未发现作者在 PoC 代码中隐藏投毒代码。代码主要集中于漏洞触发和利用，没有发现恶意行为如文件修改、权限提升、网络连接等。

**项目地址:** [YunchoHang/CVE-2021-43267](https://github.com/YunchoHang/CVE-2021-43267)

**漏洞详情:** [CVE-2021-43267](https://nvd.nist.gov/vuln/detail/CVE-2021-43267)