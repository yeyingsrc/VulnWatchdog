## CVE-2020-5902 - F5 BIG-IP TMUI 远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP Traffic Management User Interface (TMUI)

**危害等级:** 严重，未经身份验证的攻击者可以执行任意系统命令，完全控制受影响的系统。

**影响版本:** 受影响版本：15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 目标系统运行受影响版本的F5 BIG-IP，且TMUI管理界面可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-5902 是 F5 BIG-IP TMUI 中的一个远程代码执行漏洞。该漏洞源于 Tomcat 解析 URL 与 request.getPathInfo() 存在差异，导致可绕过权限验证，未授权访问 TMUI 模块所有功能，进而可以读取/写入任意文件和执行命令。

**有效性:**

根据漏洞库信息和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息中包含多个指向包含漏洞利用代码和分析报告的链接，例如Critical Start的分析和 GitHub 上的POC代码库。提供的代码片段包括用于验证漏洞、读取文件、写入文件、列出用户、列出目录、执行远程命令以及绕过 hsqldb 身份验证的脚本。这些信息表明该漏洞可以被成功利用。

**投毒风险:**

根据提供的漏洞利用代码文件列表，主要文件是 `f5-bigip-rce-cve-2020-5902.py`，其中包含漏洞利用逻辑。`README.md` 文件提供了工具的使用说明，而 `LICENSE` 文件指定了 MIT 许可证，表明该代码是开源的。`/tmp/16cdc7597d2e7472fdfd06bc229167fb/1-2-f5.txt` 仅包含一些IP地址，可能是目标列表。快速浏览 `f5-bigip-rce-cve-2020-5902.py` 发现都是漏洞验证利用的相关代码,基本判定没有投毒代码。

综合分析，该仓库中存在作者隐藏的恶意投毒代码的可能性较低。该风险评估约为1%。

**利用方式:**

利用方式主要通过构造特定的 HTTP 请求绕过 TMUI 的身份验证，然后利用未授权访问的权限执行以下操作：

1.  **文件读取:**  读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **文件写入:**  在服务器上写入任意文件，例如上传 webshell。
3.  **命令执行:**  执行任意系统命令，例如 `id` 或 `whoami`。
4.  **HSQLDB 认证绕过:** 绕过 HSQLDB 数据库的身份验证。

攻击者可以通过构造恶意请求，利用TMUI组件中的漏洞，最终在目标系统上执行任意代码。

**项目地址:** [theLSA/f5-bigip-rce-cve-2020-5902](https://github.com/theLSA/f5-bigip-rce-cve-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)