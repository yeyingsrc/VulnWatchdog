## CVE-2020-5902-F5 BIG-IP TMUI-RCE

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP TMUI (Traffic Management User Interface)

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问 BIG-IP 设备的 TMUI 接口 (通常是 443 端口)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和提供的漏洞利用代码（CVE-2020-5902.py），该漏洞存在于 F5 BIG-IP 设备的 TMUI 组件中，允许未经授权的远程攻击者执行任意代码。利用方式是通过构造特殊的 URL 绕过身份验证，然后利用 `tmshCmd.jsp` 和 `fileSave.jsp` 等接口创建 CLI 别名，上传包含恶意代码的文件，并执行该文件。

**漏洞利用方式：**

1.  **绕过身份验证：** 攻击者利用未授权访问的路径，绕过 TMUI 的身份验证机制。
2.  **创建 CLI 别名：** 使用 `tmshCmd.jsp` 接口创建一个 CLI 别名，指向 bash 命令解释器。
3.  **上传恶意代码：** 利用 `fileSave.jsp` 接口，将包含恶意代码的文件上传到 `/tmp/` 目录。
4.  **执行恶意代码：** 使用 `tmshCmd.jsp` 接口执行上传的恶意代码。
5.  **清理痕迹：** 删除创建的 CLI 别名。

**投毒风险分析：**

提供的 Python 脚本看起来像是直接利用 CVE-2020-5902 漏洞的 PoC 代码，通过构造特定的 URL 触发漏洞。代码逻辑主要是创建别名，上传文件，执行命令，并清理别名。没有发现任何明显的恶意代码注入或后门植入行为。代码功能集中在漏洞利用上，没有额外的操作，因此判断投毒风险为0%。

**有效性：**

根据漏洞库信息和提供的漏洞利用代码，以及 CISA KEV 目录中包含此漏洞，该漏洞利用代码应该有效。但实际利用效果取决于目标环境和缓解措施。

**项目地址:** [jas502n/CVE-2020-5902](https://github.com/jas502n/CVE-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)