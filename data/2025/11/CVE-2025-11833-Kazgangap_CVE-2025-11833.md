## CVE-2025-11833 - Post SMTP插件未授权访问漏洞

**漏洞编号:** CVE-2025-11833

**漏洞类型:** 未授权信息泄露/账户接管

**影响应用:** Post SMTP – Complete SMTP Solution with Logs, Alerts, Backup SMTP & Mobile App WordPress插件

**危害等级:** 高危，可能导致敏感信息泄露和账户接管

**影响版本:** <= 3.6.0

**利用条件:** 需要目标WordPress站点安装了受影响的Post SMTP插件，且启用了邮件日志功能。无需身份验证，可以从网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-11833漏洞存在于Post SMTP WordPress插件的3.6.0及更早版本中。由于`__construct`函数中缺少权限检查，未经身份验证的攻击者可以读取通过Post SMTP插件发送的任意邮件日志，包括包含密码重置链接的邮件，从而导致账户接管。

**漏洞利用方式：**

提供的PoC代码通过发送包含`page=postman_email_log&view=log&log_id={log_id}`参数的`lostpassword`请求，尝试访问邮件日志。利用点在于，即使没有登录，只要构造合适的URL和POST数据，即可绕过权限检查，读取指定`log_id`的邮件内容。

`main.py`脚本的主要流程如下：

1.  接收目标URL、用户名、日志ID范围等参数。
2.  循环遍历指定的日志ID范围。
3.  构造包含目标用户名和日志ID的POST请求，发送到目标URL。
4.  检查响应状态码和内容长度，如果状态码为200且内容长度大于0，则认为找到了日志。
5.  如果启用了loot功能，则将找到的日志保存到`loot/`目录下。
6.  如果服务器返回指示用户名无效的消息，则停止扫描。

**有效性：**

提供的PoC代码有效。漏洞库信息和PoC代码都表明，该漏洞允许未经身份验证的攻击者访问邮件日志。

**投毒风险：**

该仓库存在轻微的投毒风险，评估为5%。主要基于以下分析：

*   `compose.yaml`文件：虽然使用了官方的wordpress和mariadb镜像，但是卷挂载方式存在风险。恶意作者可能事先在`./wordpress_data` 和 `./post-smtp`中放置恶意文件，当容器启动时，这些恶意文件会被挂载到wordpress容器中。当然，当前提供的compose.yaml文件挂载的是3.6.0版本的post-smtp插件，符合漏洞版本，可以被认为是搭建漏洞环境的一部分。
*   `main.py`：代码相对简单，主要功能是发送请求和保存响应。存在潜在的风险，例如可以修改代码，在发现包含特定关键词的邮件时，将邮件内容发送到攻击者的服务器。但代码中目前没有发现明显的恶意行为。
*   `README.md`：声明了免责声明，但也不能排除恶意作者隐藏后门的可能。

综合来看，虽然存在一定的风险，但整体可信度较高。风险主要集中在yaml配置文件，攻击者可以通过修改配置植入恶意wordpress插件。


**项目地址:** [Kazgangap/CVE-2025-11833](https://github.com/Kazgangap/CVE-2025-11833)

**漏洞详情:** [CVE-2025-11833](https://nvd.nist.gov/vuln/detail/CVE-2025-11833)