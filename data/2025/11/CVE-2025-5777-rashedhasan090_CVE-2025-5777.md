## CVE-2025-5777 NetScaler ADC 和 NetScaler Gateway 内存泄漏

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存泄漏 (Memory Overread)

**影响应用:** NetScaler ADC 和 NetScaler Gateway

**危害等级:** 高危，可能导致敏感信息泄露，包括会话令牌、身份验证数据和凭据

**影响版本:** 受影响版本：14.1 < 43.56, 13.1 < 58.32 (需配置为Gateway或AAA虚拟服务器)

**利用条件:** NetScaler 配置为 Gateway (VPN 虚拟服务器, ICA Proxy, CVPN, RDP Proxy) OR AAA 虚拟服务器，且存在可利用的POST请求入口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5777 是 NetScaler ADC 和 NetScaler Gateway 中的一个内存泄漏漏洞。由于不充分的输入验证，当 NetScaler 配置为 Gateway 或 AAA 虚拟服务器时，可能导致内存过度读取。攻击者可以通过发送特制的包含 login 参数且没有等号或值的 POST 请求，触发漏洞，泄露大约127字节的内存内容。这些内存可能包含敏感信息，如会话令牌（NSC_*, NSC_TASS, NSC_AAAC 模式）、凭据（username:password, Basic Auth）、IP 地址、电子邮件地址、URL、Base64 编码字符串、十六进制字符串和 JSON 数据。攻击者重复发送恶意请求，可以收集大量内存数据，最终可能导致会话劫持、绕过多因素身份验证等严重后果。

**漏洞利用方式：**

1.  目标 NetScaler 实例需要配置为 Gateway 或 AAA 虚拟服务器。
2.  攻击者向目标发送特制的 HTTP POST 请求，请求中包含 `login` 参数，但该参数缺少等号或值（例如，`login` 而不是 `login=value`）。
3.  服务器在处理该请求时，由于输入验证不足，从内存中读取未初始化的数据。
4.  未初始化的数据包含在 XML 响应的 `<InitialValue>` 标签中返回给攻击者。
5.  攻击者可以通过重复发送此类请求来收集内存中的敏感信息。

**有效性：**

提供的漏洞利用代码描述了此漏洞的POC，并且明确提到了利用方式（login参数不带等号和值）。该代码旨在帮助安全研究人员和系统管理员验证漏洞的存在。

**投毒风险：**

仓库中存在投毒代码的风险较低。根据 `DISCLAIMER.md` 文件，该代码旨在用于教育和研究目的，并且明确声明不引入或发现新的漏洞。但是，由于代码可以用于获取敏感信息，如果被恶意修改或用于未经授权的测试，仍然存在一定的风险。例如，exploit.py脚本本身可能被修改为在后台执行恶意操作，例如收集目标系统的更多信息或植入后门。

尽管如此，考虑到以下因素，投毒风险评估为10%：

*   免责声明： 仓库包含详细的法律免责声明，限制了代码的使用，并强调了未经授权使用的责任。
*   公开信息： POC 基于公开可用的技术细节。
*   代码目的： 主要目的是验证漏洞的存在，而不是进行攻击。

**项目地址:** [rashedhasan090/CVE-2025-5777](https://github.com/rashedhasan090/CVE-2025-5777)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)