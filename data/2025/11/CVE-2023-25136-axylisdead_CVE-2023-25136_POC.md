## CVE-2023-25136 OpenSSH 双重释放漏洞

**漏洞编号:** CVE-2023-25136

**漏洞类型:** 双重释放漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，理论上可远程代码执行

**影响版本:** 9.1

**利用条件:** 需要目标运行 OpenSSH 9.1，且允许未授权连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-25136 是 OpenSSH 9.1 中引入的一个双重释放漏洞，位于 options.kex_algorithms 的处理过程中。该漏洞允许未经身份验证的远程攻击者跳转到 sshd 地址空间的任意位置。虽然漏洞报告表明“理论上可以远程代码执行”，但实际利用的难度较高。提供的 POC 代码通过修改 SSH 客户端版本字符串，尝试触发漏洞，验证目标是否存在此漏洞。该POC的主要逻辑是建立ssh连接,并修改客户端版本,并非执行漏洞本身。

**有效性评估：**
提供的 POC 代码并非直接利用双重释放漏洞进行 RCE，而是用于检测目标是否存在受漏洞影响的 OpenSSH 9.1 版本。它通过构造特定的客户端版本信息，尝试与服务器建立连接，如果连接成功，则认为目标可能存在漏洞。实际的漏洞利用需要更复杂的步骤，例如操纵堆内存来执行任意代码。

**投毒风险评估：**
查看提供的POC和LICENSE文件，该库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式：**

1.  **确定目标版本：** 通过各种方式确定目标服务器正在运行 OpenSSH 9.1。
2.  **发送恶意 KEX 协商请求：** 攻击者需要构造恶意的密钥交换算法（KEX）协商请求，触发双重释放。
3.  **控制堆内存：** 成功触发双重释放后，攻击者需要精心控制堆内存布局，以便在释放后重新分配的内存中写入恶意数据。
4.  **跳转到任意地址：** 通过覆盖函数指针或其他关键数据，攻击者可以将程序执行流重定向到任意地址。
5.  **执行恶意代码：** 在控制执行流后，攻击者可以执行任意代码，例如提升权限、安装后门等。

**项目地址:** [axylisdead/CVE-2023-25136_POC](https://github.com/axylisdead/CVE-2023-25136_POC)

**漏洞详情:** [CVE-2023-25136](https://nvd.nist.gov/vuln/detail/CVE-2023-25136)