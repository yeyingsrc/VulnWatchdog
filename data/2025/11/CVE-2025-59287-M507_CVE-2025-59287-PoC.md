## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，未经授权的攻击者可以在网络上执行任意代码

**影响版本:** 受影响的Windows Server版本包括2012、2012 R2、2016、2019、2022和2025的特定版本范围

**利用条件:** 需要能够访问WSUS服务器的网络，并且WSUS服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Windows Server Update Service中存在反序列化不信任数据的问题。攻击者可以通过构造恶意的SOAP请求，将恶意序列化对象发送到WSUS服务器，导致服务器执行任意代码。利用方式如下：

1.  **获取认证Cookie：** 使用`GetAuthorizationCookie`方法从`SimpleAuthWebService`获取授权Cookie，需要提供clientId、targetGroupName和dnsName。
2.  **利用ysoserial.net生成payload:**使用ysoserial.net生成用于反序列化的恶意payload。
3.  **发送恶意SOAP请求：**  构造包含恶意payload的SOAP请求到WSUS服务器的某个易受攻击的端点（例如ReportingWebService）。该请求通常利用`ReportingWebService.asmx`或类似接口，发送包含恶意反序列化数据的XML。
4.  **远程代码执行：**  WSUS服务器反序列化恶意数据，执行payload，最终实现远程代码执行。

**有效性分析：**

提供的PoC代码尝试利用`SimpleAuthWebService`来获取认证cookie。它模拟了PowerShell的`Write-Host`输出，并包含了从SOAP响应中提取cookie的逻辑。漏洞库信息和搜索引擎结果(虽然这里没有提供实际搜索结果)均表明该漏洞是一个高危漏洞，且存在可利用的PoC。

**投毒风险分析：**

该代码段主要用于获取身份验证cookie，目的是为后续利用步骤做准备。代码中没有发现明显的投毒代码。代码目的是为了复现CVE-2025-59287漏洞，从代码结构和功能上看，此代码为漏洞验证代码，而不是后门或恶意代码。

通过代码审查未发现明显的恶意行为，因此投毒风险较低，大约0%。

**漏洞利用方式：**

该漏洞的核心是反序列化漏洞，攻击者利用WSUS服务反序列化不可信数据执行恶意代码。攻击者需要先获取有效的授权cookie，然后构造包含恶意序列化payload的SOAP请求，发送到WSUS服务器，成功利用后可以实现远程代码执行。

**项目地址:** [M507/CVE-2025-59287-PoC](https://github.com/M507/CVE-2025-59287-PoC)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)