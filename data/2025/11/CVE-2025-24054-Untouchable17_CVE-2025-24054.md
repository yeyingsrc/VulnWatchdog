## CVE-2025-24054 - Windows NTLM Hash Disclosure Spoofing Vulnerability

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM Hash Disclosure / Spoofing

**影响应用:** Windows

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要攻击者能够诱使用户访问特制的恶意文件或网络共享

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞利用了Windows处理特定文件类型（如searchConnector-ms和library-ms）时，不正确的文件名或路径处理方式。当用户访问攻击者构造的恶意文件，其中包含指向攻击者控制的服务器的UNC路径时，Windows会自动尝试使用NTLM身份验证连接到该服务器，导致用户的NTLMv2哈希值被泄露给攻击者。攻击者可以通过中间人攻击或者在自己控制的服务器上捕获哈希。

**有效性评估：**
根据漏洞库信息和提供的POC代码，该漏洞的POC是有效的。POC代码演示了如何创建searchConnector-ms文件，该文件包含指向恶意服务器的UNC路径，当用户打开该文件时，会导致NTLM哈希泄露。

**利用方式：**
1.  攻击者创建一个恶意的searchConnector-ms或library-ms文件。
2.  该文件包含一个指向攻击者控制的服务器的UNC路径（例如，`\\evil.com\share`）。
3.  攻击者诱使用户打开该恶意文件，例如通过电子邮件附件、网络共享等。
4.  当用户打开该文件时，Windows会自动尝试使用NTLM身份验证连接到攻击者的服务器。
5.  攻击者的服务器捕获用户的NTLMv2哈希值。
6.  攻击者可以使用捕获的哈希值进行进一步的攻击，例如Pass-the-Hash攻击。

**投毒风险评估：**
POC代码主要功能是生成漏洞利用所需的文件，用于触发NTLM哈希泄露。代码本身相对清晰，没有明显的恶意代码用于投毒。风险主要在于使用该POC进行攻击活动。虽然代码里有`SecurityContext` 类，但实际上并没有用到白名单服务器的功能。`_obfuscation_level`也没有实际效果， 因此代码没有明显的投毒后门。 但如果该代码被恶意修改，例如在捕获哈希值后执行其他恶意操作，就可能存在投毒风险。根据代码分析，投毒风险较低，约为5%。投毒的可能性主要集中于使用者在不理解代码的情况下，引入了额外的恶意代码。

**项目地址:** [Untouchable17/CVE-2025-24054](https://github.com/Untouchable17/CVE-2025-24054)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)