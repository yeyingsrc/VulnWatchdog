## CVE-2025-40629 - PNETLab 路径遍历漏洞

**漏洞编号:** CVE-2025-40629

**漏洞类型:** 路径遍历

**影响应用:** PNETLab

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 4.2.10

**利用条件:** 需要PNETLab 4.2.10版本，并且需要能够通过网络访问PNETLab服务，需要认证，需要找到有效的lab文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于PNETLab 4.2.10版本中，由于对用户输入的文件路径未进行充分的过滤和验证，攻击者可以通过构造包含目录遍历字符（如`../`）的HTTP请求，来访问系统上的任意文件。利用方式如下：

1.  **漏洞原理：**
    PNETLab的`/api/export`接口存在路径遍历漏洞。攻击者通过修改`path`参数中的文件名，可以访问到受限制目录之外的文件。

2.  **漏洞利用步骤：**
    *   **认证：** 首先，需要使用有效的用户名和密码（默认`admin:pnet`）进行认证，获取有效的`token`。
    *   **查找Lab文件:** 查找或指定一个有效的Lab文件，作为攻击的起始点。
    *   **构造恶意请求：** 使用获取的`token`，构造一个POST请求到`/api/export`接口，payload中`0`参数为lab文件，`1`参数为构造的包含目录遍历字符的路径，指向目标文件（例如：`/etc/passwd`）。
    *   **读取文件：** 服务器会将目标文件打包成zip文件并返回，攻击者可以从中提取目标文件内容。

3.  **有效性评估：**
    提供的POC代码实现了上述利用流程，包括认证、查找Lab文件、构造恶意请求和下载文件。因此，POC代码应该是有效的。

4.  **投毒风险分析：**
    该POC代码的主要功能是利用已知的路径遍历漏洞读取文件。代码中没有发现任何主动上传或修改系统文件的行为，也没有发现执行恶意代码的模块，主要功能还是实现漏洞验证，因此判定投毒风险为0%。

**项目地址:** [omr00t/CVE-2025-40629](https://github.com/omr00t/CVE-2025-40629)

**漏洞详情:** [CVE-2025-40629](https://nvd.nist.gov/vuln/detail/CVE-2025-40629)