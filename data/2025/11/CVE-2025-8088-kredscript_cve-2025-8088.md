## CVE-2025-8088 WinRAR路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要使用WinRAR打开恶意构造的压缩文件

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-8088 是一个影响WinRAR的路径遍历漏洞。攻击者可以通过制作恶意的压缩文件，利用路径遍历漏洞将可执行文件放置到Windows启动目录中，从而实现开机自启动和执行任意代码。提供的POC代码通过以下步骤利用此漏洞：

1.  **创建诱饵文件：** 创建一个看起来无害的文件，例如文档。
2.  **嵌入payload流：**  将payload（恶意代码）嵌入到构造的压缩文件中，利用多个级别的路径遍历，使用ADS（Alternate Data Streams）来隐藏payload。
3.  **修改压缩文件结构：** 修改压缩文件的结构以包含嵌入的payload和路径遍历信息。
4.  **CRC校验码重新计算：**  重新计算CRC校验码以确保压缩文件的完整性。
5.  **投放至启动目录：**  将payload投放到Windows启动目录，实现持久化。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞利用是有效的。漏洞库信息明确指出该漏洞已被野外利用，POC代码演示了如何构造恶意压缩文件并利用路径遍历将payload放置到启动目录。

**投毒风险：**
该仓库存在一定的投毒风险，约为20%。
虽然主要功能是利用已知的CVE-2025-8088漏洞，但`extract.py`文件存在潜在的风险：
*  `extract.py` 代码段与WinRAR漏洞利用无关，反而像是与C2服务器通信的后门程序，通过socket与目标主机通信，发送随机payload并接受响应。如果未经审查直接使用，攻击者可以在受害者不知情的情况下执行恶意操作。
* 即使使用者不运行`extract.py`, 此文件也为攻击者提供思路. 如果攻击者有能力修改`main.py`, 即可嵌入`extract.py`中的恶意socket代码。
*   该脚本中设置了TARGET_HOST 和 TARGET_PORT， 容易被植入木马，默认IP容易被篡改。

**利用方式：**
1.  攻击者制作一个特制的恶意RAR压缩文件。
2.  当受害者使用存在漏洞的WinRAR版本打开该压缩文件时，文件会被解压到指定位置。
3.  利用压缩文件中构造的路径遍历，恶意代码会被释放到Windows启动文件夹。
4.  当受害者重启计算机后，恶意代码会自动执行，从而允许攻击者执行任意代码。

**项目地址:** [kredscript/cve-2025-8088](https://github.com/kredscript/cve-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)