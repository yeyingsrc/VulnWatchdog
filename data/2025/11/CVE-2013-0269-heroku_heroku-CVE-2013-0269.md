## CVE-2013-0269-Ruby JSON gem-Unsafe Object Creation Vulnerability

**漏洞编号:** CVE-2013-0269

**漏洞类型:** 不安全对象创建漏洞

**影响应用:** Ruby JSON gem

**危害等级:** 高危，可能导致拒绝服务 (DoS)、绕过大规模赋值保护机制，甚至可能导致 SQL 注入

**影响版本:** JSON gem < 1.5.5, 1.6.x < 1.6.8, and 1.7.x < 1.7.7

**利用条件:** 需要应用程序使用受影响版本的 JSON gem，并且允许通过 JSON 解析用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0269 漏洞存在于 Ruby JSON gem 中，允许远程攻击者通过构造恶意的 JSON 文档触发资源消耗型的操作，导致拒绝服务。更严重的是，此漏洞可被利用绕过批量赋值保护机制，可能导致 SQL 注入。提供的漏洞利用代码是一个 Heroku 应用程序检查器脚本 (heroku-CVE-2013-0269.rb)。该脚本旨在扫描 Heroku 应用程序，确定它们是否使用了易受攻击的 JSON gem 版本。它通过执行 `heroku apps` 命令列出所有 Heroku 应用，然后针对每个应用，执行 `heroku run` 命令来获取该应用使用的 JSON gem 的版本。如果检测到易受攻击的版本，该脚本会报告该应用程序存在安全风险。提供的代码本身并*没有*包含任何投毒代码。脚本的功能是检测漏洞而不是利用它。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者需要找到一个使用易受攻击的 JSON gem 版本的 Ruby on Rails 应用程序。
2.  攻击者构造一个恶意的 JSON 文档，该文档包含可以触发不安全对象创建的特殊符号或内部对象。
3.  将此 JSON 文档发送到应用程序。例如，如果应用程序使用 JSON 来处理用户提交的数据，则可以在 POST 请求中包含恶意 JSON payload。
4.  当应用程序解析此 JSON 文档时，不安全的对象会被创建，这可能导致拒绝服务、绕过 mass assignment 保护，或在某些情况下导致 SQL 注入。

本代码仓库提供的脚本是为了帮助开发者检查其Heroku应用是否存在该漏洞，而非利用该漏洞。提供的代码没有发现任何恶意逻辑。

**项目地址:** [heroku/heroku-CVE-2013-0269](https://github.com/heroku/heroku-CVE-2013-0269)

**漏洞详情:** [CVE-2013-0269](https://nvd.nist.gov/vuln/detail/CVE-2013-0269)