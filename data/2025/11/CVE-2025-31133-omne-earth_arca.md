## CVE-2025-31133-runc容器逃逸

**漏洞编号:** CVE-2025-31133

**漏洞类型:** 容器逃逸

**影响应用:** runc

**危害等级:** 高危，可能导致主机信息泄露、主机拒绝服务、容器逃逸或绕过maskedPaths

**影响版本:** < 1.2.8, >= 1.3.0-rc.1 < 1.3.3, >= 1.4.0-rc.1 <= 1.4.0-rc.3

**利用条件:** 需要低权限用户，存在竞争条件，用户交互（ACTIVE）

**POC 可用性:** 否 (提供的代码不是直接的POC，而是一个用于构建容器镜像的Dockerfile)

**投毒风险:** 30%

## 详情

根据CVE-2025-31133的描述，该漏洞是由于runc在处理masked path时，没有充分验证bind-mount的来源是否是真正的/dev/null inode，从而导致任意挂载，进而造成容器逃逸等风险。提供的Dockerfile用于构建一个容器镜像，其中包含一些安全配置，例如禁用某些systemd服务，修改journald配置等。这些配置是为了提高容器的安全性，而非直接利用CVE-2025-31133漏洞。虽然Dockerfile本身不是漏洞利用代码，但它暴露了潜在的投毒风险：

1.  **依赖外部镜像风险:** Dockerfile 依赖`arca-app:${OPENHANDS_RELEASE}`镜像，如果该镜像被篡改，则构建出来的容器也会受到影响。
2.  **get-docker.sh脚本:** Dockerfile 下载并执行`get-docker.sh`脚本，该脚本的sha3sum值被验证，但仍然存在脚本源被劫持的风险。
3.  **Caddy安装:** Dockerfile 通过Cloudsmith安装Caddy，存在依赖源被篡改的风险。
4. **潜在后门：**Dockerfile中包含多个从外部源拉取并安装的软件包，例如docker、caddy。尽管对get-docker.sh 进行了sha3sum校验，但仍有可能存在隐藏的后门或恶意配置。特别是对arca-app基础镜像，如果构建者无法完全控制该镜像的构建过程，则存在潜在的供应链攻击风险。

利用方式：

CVE-2025-31133 漏洞利用需要利用竞争条件，在runc执行挂载操作时，替换/dev/null，从而将任意文件挂载到容器内部，实现容器逃逸。由于缺乏直接的漏洞利用代码，无法准确评估漏洞利用的有效性。提供的Dockerfile 并没有直接展示如何利用该漏洞，而是专注于构建一个具有特定配置的容器镜像。该镜像本身可能存在上述投毒风险。

**项目地址:** [omne-earth/arca](https://github.com/omne-earth/arca)

**漏洞详情:** [CVE-2025-31133](https://nvd.nist.gov/vuln/detail/CVE-2025-31133)