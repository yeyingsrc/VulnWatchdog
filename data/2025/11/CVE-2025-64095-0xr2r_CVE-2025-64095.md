## CVE-2025-64095 - DNN Insufficient Access Control - Image Upload allows for Site Content Overwrite

**漏洞编号:** CVE-2025-64095

**漏洞类型:** 文件上传

**影响应用:** DNN.Platform

**危害等级:** 高危，允许未授权的文件上传和覆盖，可能导致网站内容篡改和XSS攻击

**影响版本:** < 10.1.1

**利用条件:** 需要网络访问，目标DNN平台版本低于10.1.1

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于DNN平台10.1.1之前的版本中，由于默认HTML编辑器提供程序允许未经身份验证的文件上传，攻击者可以上传恶意文件（如PNG或SVG），并且可以覆盖已存在的文件。PoC代码首先通过向`/Providers/HtmlEditorProviders/DNNConnect.CKE/Browser/FileUploader.ashx`发送包含`storageFolderID=1`、`portalID=0`、`overrideFiles=1`和`mode=Default`的POST请求来检测漏洞是否存在。如果服务器返回`[]`，则表示存在漏洞。之后，PoC创建PNG图片或SVG XSS payload，并尝试上传到目标服务器。上传成功后，PoC会尝试访问上传的文件，验证文件是否成功上传。利用方式包括上传恶意SVG文件进行XSS攻击和上传恶意图片文件覆盖网站现有内容。

**投毒风险分析：** PoC代码本身主要用于验证漏洞是否存在和上传文件。虽然存在创建PNG图片和SVG XSS payload的功能，但这些功能是漏洞利用的一部分，而非隐藏的恶意代码。PoC中使用了requests库，理论上存在被替换为恶意版本的风险，但是从代码逻辑来看，直接投毒的可能性较小。主要风险在于使用者在不理解代码的情况下直接使用，可能导致安全风险。综合考虑，投毒风险较低，估计在5%左右。

**项目地址:** [0xr2r/CVE-2025-64095](https://github.com/0xr2r/CVE-2025-64095)

**漏洞详情:** [CVE-2025-64095](https://nvd.nist.gov/vuln/detail/CVE-2025-64095)