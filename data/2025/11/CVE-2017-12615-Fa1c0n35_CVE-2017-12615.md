## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)