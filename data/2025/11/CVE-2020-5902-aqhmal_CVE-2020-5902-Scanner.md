## CVE-2020-5902-F5 BIG-IP-TMUI远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP TMUI (Configuration Utility)

**危害等级:** 高危，可能导致完全控制受影响的F5 BIG-IP设备

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问到F5 BIG-IP设备的TMUI (通常是443端口，但可能不同)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-5902 是 F5 BIG-IP Traffic Management User Interface (TMUI) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求到易受攻击的URL，利用此漏洞在底层操作系统上执行任意命令。

**有效性分析：**

提供的POC代码（scanner.py）尝试利用该漏洞。它首先创建一个CLI别名，然后创建一个文件 `/tmp/cmd`，并写入 `id` 命令，然后执行该文件并检查输出是否包含 `uid=0(root)`。如果存在，则认为目标易受攻击。最后，它会删除之前创建的CLI别名。

**投毒风险分析：**

查看提供的代码，主要功能是扫描并验证漏洞的存在。代码中使用了 `requests.get` 向目标发送请求，没有发现任何明显的恶意或隐藏代码，例如反向shell或其他恶意命令执行。该脚本的主要目的是检测漏洞，而不是进行恶意利用。`scanner.py` 中通过修改 `/tmp/cmd` 文件来执行 `id` 命令，验证是否存在漏洞。总体上，该存储库的投毒风险较低，为 0%。

**利用方式：**

利用方式包括以下步骤：

1.  发送包含目录遍历序列的特制HTTP请求到TMUI接口（通常是`/tmui/login.jsp`），绕过身份验证。
2.  利用`tmshCmd.jsp` 接口，执行任意命令。
3.  通过创建CLI别名或者写入文件等方式执行命令。
4.  通过访问特定的URL执行写入的命令，并获取结果。
5.  通过命令执行的结果来判断是否存在漏洞。

该漏洞允许攻击者以root权限执行任意命令，从而完全控制受影响的F5 BIG-IP设备。

**项目地址:** [aqhmal/CVE-2020-5902-Scanner](https://github.com/aqhmal/CVE-2020-5902-Scanner)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)