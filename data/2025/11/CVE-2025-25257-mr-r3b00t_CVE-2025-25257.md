## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** Fortinet FortiWeb

**危害等级:** 严重，未经身份验证的攻击者可以执行未经授权的SQL代码或命令

**影响版本:** 7.6.0 <= version <= 7.6.3
7.4.0 <= version <= 7.4.7
7.2.0 <= version <= 7.2.10
version <= 7.0.10

**利用条件:** 需要网络访问，目标设备运行受影响的FortiWeb版本，且/api/fabric/device/status接口开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25257是Fortinet FortiWeb中的一个SQL注入漏洞，位于/api/fabric/device/status端点。未经身份验证的攻击者可以通过构造恶意的HTTP/HTTPS请求，在Authorization header中注入SQL代码来执行未授权的数据库操作。

**有效性：**
POC代码通过发送带有SQL注入payload的GET请求到目标URL，如果返回200 OK，则可能存在漏洞。该代码还检查目标端口是否可访问，并忽略TLS证书错误，使得测试更加方便。因此，提供的POC代码是有效的，可以用于检测漏洞。

**投毒风险：**
查看POC代码，主要功能为发送特定Payload用于检测是否存在SQL注入，没有发现明显的恶意代码，例如反弹shell或者上传webshell。但仍然存在一定风险，例如测试代码中忽略了TLS证书验证，可能被中间人攻击；或者该脚本被修改，加入恶意代码。评估风险，投毒风险为10%。

**利用方式：**
1.  攻击者发送特制的HTTP/HTTPS请求到受影响的FortiWeb设备的/api/fabric/device/status端点。
2.  攻击者在Authorization header中注入恶意的SQL代码，例如 `'or'1'='1`。
3.  FortiWeb服务器未正确过滤或转义该SQL代码，导致其被执行。
4.  攻击者可以执行未授权的SQL查询，从而读取、修改或删除数据库中的数据，甚至可能执行系统命令。

**项目地址:** [mr-r3b00t/CVE-2025-25257](https://github.com/mr-r3b00t/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)