## CVE-2023-51444-GeoServer-任意文件上传

**漏洞编号:** CVE-2023-51444

**漏洞类型:** 任意文件上传

**影响应用:** GeoServer

**危害等级:** 高危，可导致远程代码执行和权限提升

**影响版本:** < 2.23.4, = 2.24.0

**利用条件:** 需要高权限（管理员）账号，且coverage store使用绝对路径配置

**POC 可用性:** 未直接提供完整的PoC，但漏洞信息描述明确

**投毒风险:** 5%

## 详情

CVE-2023-51444 是 GeoServer 中 REST Coverage Store API 存在的一个任意文件上传漏洞。攻击者利用该漏洞，在拥有足够权限（高权限管理员）的前提下，可以通过 REST API 上传恶意文件到服务器的任意位置，最终导致远程代码执行。

**有效性：**
从漏洞描述来看，如果 GeoServer 配置的 coverage store 使用的是绝对路径，攻击者就能利用路径穿越漏洞上传恶意文件，从而实现远程代码执行。 提供的代码只有README，pom.xml以及CHANGELOG，缺少漏洞代码，不能确定是否可用。如果存在使用绝对路径配置，则漏洞存在。如果不存在，漏洞则不存在。

**投毒风险：**
提供的文件包括 `CHANGELOG.md`、`README.txt` 和 `pom.xml`。这些文件属于项目文档和构建文件，本身不太可能包含直接的恶意代码，通常投毒攻击会修改源程序，或者修改maven的配置信息，进行依赖污染。但是，理论上，在 `pom.xml` 文件中，攻击者可能尝试引入恶意依赖，从而在构建过程中植入后门。风险较低，仅为5%。

**利用方式：**
1.  攻击者需要具有 GeoServer 的管理员权限。
2.  确定目标 GeoServer 实例是否使用绝对路径配置 Coverage Store。
3.  构造恶意的 REST 请求，上传包含恶意代码的文件，并利用路径穿越，将文件写入到服务器上的任意位置，例如 web 目录。
4.  访问上传的恶意文件，触发其中的恶意代码，从而控制服务器。

**项目地址:** [iPlayForSG/CVE-2023-51444](https://github.com/iPlayForSG/CVE-2023-51444)

**漏洞详情:** [CVE-2023-51444](https://nvd.nist.gov/vuln/detail/CVE-2023-51444)