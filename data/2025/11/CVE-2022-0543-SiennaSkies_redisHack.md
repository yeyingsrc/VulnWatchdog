## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Debian特供版本 (具体版本未知)

**利用条件:** 目标Redis服务器运行在存在此漏洞的Debian系统上，且允许未授权访问或者存在弱口令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Debian特定的Redis打包问题导致的Lua沙箱逃逸，允许攻击者执行任意代码。

**有效性：**
根据漏洞库信息和提供的POC代码，此漏洞是真实存在的，且POC是可用的。POC脚本 `redisHack.py` 首先检测是否存在未授权访问漏洞，如果存在，则尝试使用 `pass.txt` 中的密码进行弱口令爆破。

**投毒风险：**
虽然这个脚本主要目的是利用已知的漏洞，但是存在潜在的投毒风险。`pass.txt` 包含大量常见弱密码，这可能会误导用户，鼓励用户设置弱密码，从而更容易受到攻击。此外，脚本中可能存在隐藏的后门代码，或者利用漏洞安装后门。由于缺乏完整的脚本内容，难以准确判断是否存在恶意代码。因此，存在10%的投毒风险。

**利用方式：**
1.  **未授权访问检测：** 脚本首先尝试连接目标Redis服务器，发送 `INFO` 命令，如果返回包含 `redis_version` 的信息，则表明存在未授权访问漏洞。
2.  **弱口令爆破：** 如果Redis配置了密码认证，脚本会读取 `pass.txt` 文件中的密码列表，逐一尝试进行认证。如果认证成功，则说明存在弱口令漏洞。
3.  **漏洞利用：**  根据CVE描述和已公开的资料，攻击者可以通过精心构造的Lua脚本逃逸沙箱，最终执行任意系统命令。但是，由于提供的代码片段不完整，无法得知具体如何利用 Lua 沙箱逃逸。

总结：该漏洞允许攻击者在Debian Redis服务器上执行任意代码。POC脚本可以帮助检测未授权访问和弱口令，但存在一定的投毒风险，需要谨慎使用。

**项目地址:** [SiennaSkies/redisHack](https://github.com/SiennaSkies/redisHack)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)