## CVE-2022-40684 Fortinet身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，允许未经身份验证的攻击者在管理界面上执行操作

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统运行受影响的Fortinet产品版本，且可通过HTTP/HTTPS访问管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-40684是一个Fortinet FortiOS、FortiProxy和FortiSwitchManager中的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。

**有效性：**
根据漏洞信息，存在公开可用的漏洞利用代码（POC）。多个参考链接指向了Packet Storm Security上发布的漏洞利用信息，表明漏洞利用方法已经公开。CISA的已知被利用漏洞目录中也包含了此漏洞，表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码是关于Fortigate Belsen泄漏研究的信息，包含受影响的IP地址列表，用于帮助组织识别是否受到影响。代码的目的是共享信息用于安全研究和防御目的，以帮助组织确定他们是否受到影响，并采取必要的补救措施。文件包括受影响IP列表，用于核查和联系信息。因此，该仓库本身直接包含的恶意代码的可能性较低。但是，考虑到泄漏的IP列表可能被用于攻击，以及文档鼓励联系作者获取帮助，存在一定风险。作者可能提供包含恶意代码的工具或服务。投毒风险评估为5%。

**利用方式：**
1.  **身份验证绕过：**  攻击者利用漏洞绕过身份验证机制，无需提供有效的用户名和密码即可访问管理界面。
2.  **发送恶意请求：**  攻击者构造特制的HTTP或HTTPS请求，利用漏洞执行未经授权的操作。
3.  **管理界面操作：**  成功绕过身份验证后，攻击者可以在管理界面上执行各种操作，例如配置更改、用户信息管理等，甚至可能导致远程代码执行。

**优先级：**
根据搜索引擎结果未给出额外信息，参考优先级为：漏洞利用代码 > 漏洞库信息

**项目地址:** [arsolutioner/fortigate-belsen-leak](https://github.com/arsolutioner/fortigate-belsen-leak)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)