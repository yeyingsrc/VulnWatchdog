## CVE-2024-0044-Android本地提权

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 本地提权

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可导致本地权限提升，访问任意应用私有数据

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要ADB shell访问权限，开发者模式已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 允许攻击者通过不正确的输入验证绕过权限检查，从而以其他应用的身份运行代码。利用方式为，攻击者构造包含恶意参数的PackageInstaller会话，欺骗系统，使其认为攻击者拥有目标应用的权限。POC代码通过 adb shell 推送一个 APK 文件到设备，然后尝试利用漏洞提升权限，访问目标应用的私有文件。风险在于，虽然 POC 代码本身主要用于利用漏洞，但也存在潜在的投毒风险。例如，如果提供的 'any-app.apk' 文件被替换为恶意应用，或者脚本在推送 APK 时执行了额外的恶意操作，则可能存在投毒。经过分析，`cve_2024_0044.py`脚本本身的行为较为直接，主要是调用adb命令，风险主要在于用户提供的`apk_file_path`是否可信，以及是否存在通过adb在设备上执行其他恶意命令的可能性。因此将投毒概率定为10%。

**项目地址:** [MrW0l05zyn/cve-2024-0044](https://github.com/MrW0l05zyn/cve-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)