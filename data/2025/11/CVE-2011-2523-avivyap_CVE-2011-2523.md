## CVE-2011-2523 - vsftpd 2.3.4 Backdoor Command Execution

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，远程代码执行

**影响版本:** 2.3.4 (特定日期下载：20110630 and 20110703)

**利用条件:** 目标系统运行存在后门的vsftpd 2.3.4版本，并且21端口开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于特定日期下载的vsftpd 2.3.4版本中，包含一个硬编码的后门。利用方式是向目标服务器的21端口（FTP服务端口）发送包含“:)”的用户名进行登录，触发后门，在目标服务器上开启6200端口的监听，并通过nc连接该端口即可获得shell。POC代码首先检查目标IP的21端口是否开放，然后通过nmap获取vsftpd的版本信息。如果版本为2.3.4，则发送特制的用户名，然后尝试连接6200端口。代码中不存在明显的投毒代码。利用命令 `ftp -n "$target" <<EOF >/dev/null 2>&1 user anything:) f EOF` 触发后门。

**有效性:** POC代码有效，因为它直接利用了CVE-2011-2523中vsftpd 2.3.4版本中已知的后门。

**投毒风险:** 分析提供的脚本，未发现存在主动植入恶意代码的行为，脚本的行为均围绕利用该后门展开，因此投毒风险为0%。脚本代码比较简单，功能明确，主要是检测目标主机是否开启21端口，并且运行的是存在后门的vsftpd 2.3.4版本，如果满足条件就利用ftp命令触发后门，并尝试连接6200端口获取shell。

**利用方式:**
1.  检查目标主机21端口是否开放。
2.  使用nmap检查目标主机运行的vsftpd版本是否为2.3.4。
3.  如果以上条件满足，则通过FTP协议发送包含`:)`的用户名，触发后门。
4.  使用netcat (nc) 连接目标主机的6200端口，获取shell。

**项目地址:** [avivyap/CVE-2011-2523](https://github.com/avivyap/CVE-2011-2523)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)