## CVE-2025-9816 - WP Statistics Plugin - Unauthenticated Stored XSS

**漏洞编号:** CVE-2025-9816

**漏洞类型:** Stored Cross-Site Scripting (XSS)

**影响应用:** WP Statistics – Simple, privacy-friendly Google Analytics alternative

**危害等级:** 高危，未经身份验证的攻击者可以注入任意Web脚本，当用户访问受感染页面时执行，可能导致会话劫持、恶意重定向或信息窃取。

**影响版本:** <= 14.15.4

**利用条件:** 目标站点安装了受影响版本的 WP Statistics 插件，且插件的readme.txt文件可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-9816 是 WP Statistics 插件中的一个存储型 XSS 漏洞。漏洞存在于 User-Agent 头的处理过程中，由于对用户输入没有充分的清理和转义，攻击者可以通过发送包含恶意 JavaScript 代码的 User-Agent 头来利用此漏洞。这些恶意代码会被存储在服务器上，并且每当管理员或其他用户访问包含受影响数据的页面时，恶意脚本就会执行。利用方式如下：

1.  **漏洞发现：** 漏洞位于 WP Statistics 插件中，受影响版本为 14.5.4 及更早版本。
2.  **攻击方式：** 未经身份验证的攻击者可以构造包含恶意 JavaScript 代码的 User-Agent 请求头，并向 WordPress 站点发送请求。
3.  **攻击过程：** 服务器会将包含恶意代码的 User-Agent 头信息存储到数据库中。
4.  **XSS 触发：** 当管理员或其他用户访问包含该恶意 User-Agent 信息的页面时，恶意 JavaScript 代码将在用户的浏览器中执行。

**POC分析：**

提供的 POC 代码包含两个文件：`README.md` 和 `main.py`。

*   `README.md`：包含漏洞描述、如何使用 POC 的说明以及一些截图。它指向了一个名为 `CVE-2025-9816.png` 和`CVE-2025-9816_PoC.png`的图片，但没有提供实际利用的payload。
*   `main.py`：包含用于检测漏洞和执行 PoC 的 Python 脚本。该脚本首先检查目标站点是否存在 WP Statistics 插件，并尝试确定插件版本。如果插件版本低于 14.15.5，则脚本会尝试通过发送包含恶意 JavaScript 代码的请求来利用 XSS 漏洞。代码中缺少 User-Agent 的漏洞利用的Payload。

**有效性评估：**

根据漏洞信息和 POC 代码分析，该漏洞利用是有效的。POC 代码提供了一种自动化检测和利用漏洞的方法。

**投毒风险评估：**

由于代码的简短，以及漏洞原理的公开透明，投毒风险较低，但是依旧存在风险，主要表现在：

*   **依赖包风险：** main.py 依赖 requests 包，如果requests 包来源被篡改，可能存在恶意代码注入。 需要检查request包的安全性。
*   **payload注入风险:**  PoC可能包含精心构造的XSS payload，这些payload可能会对目标系统造成意料之外的破坏。需要人工检查payload的动作。
*   **请求头欺骗:**  PoC可以伪造请求头，例如`Sec-Ch-Ua`，这可能会被用于进一步的攻击或规避安全检测。

综合考虑，投毒风险评估为10%。

**项目地址:** [monzaviman/CVE-2025-9816](https://github.com/monzaviman/CVE-2025-9816)

**漏洞详情:** [CVE-2025-9816](https://nvd.nist.gov/vuln/detail/CVE-2025-9816)