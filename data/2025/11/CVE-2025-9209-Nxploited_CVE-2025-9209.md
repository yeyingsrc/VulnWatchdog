## CVE-2025-9209 - RestroPress Authentication Bypass via Forged JWT

**漏洞编号:** CVE-2025-9209

**漏洞类型:** Authentication Bypass

**影响应用:** RestroPress – Online Food Ordering System

**危害等级:** Critical，未经身份验证的攻击者可以伪造其他用户（包括管理员）的JWT令牌并进行身份验证，从而完全控制受影响的WordPress站点。

**影响版本:** <= 3.1.9.2

**利用条件:** 目标网站必须安装并启用 RestroPress 插件，并且版本在3.0.0到3.1.9.2之间。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-9209 存在于 RestroPress 插件中，该插件会通过 /wp-json/wp/v2/users REST API 端点暴露用户的私有令牌和API数据。攻击者可以利用这些暴露的信息来伪造 JWT 令牌，从而冒充其他用户（包括管理员）进行身份验证。提供的 POC 代码通过以下步骤利用此漏洞：

1.  **查找用户信息：** 使用 REST API (/wp-json/wp/v2/users) 获取用户数据，包括用户名、ID、slug等。
2.  **提取敏感信息：** 从用户元数据中提取 `_rp_api_user_private_key` (private key), `_rp_api_user_public_key` (public key), and `_rp_api_user_token_key` (token key)。
3.  **JWT 伪造：** 使用提取到的信息伪造 JWT 令牌。
4.  **身份验证绕过：** 使用伪造的 JWT 令牌进行身份验证，从而绕过身份验证机制。

**利用方式总结：**

攻击者首先利用 REST API 获取用户数据，然后从用户元数据中提取敏感信息（密钥和令牌），最后使用这些信息伪造 JWT 令牌并冒充其他用户。由于 REST API 未正确保护，攻击者无需身份验证即可获取这些信息，从而实现身份验证绕过。

**投毒风险分析：**

仔细审查了提供的 Python 脚本，没有发现明显的投毒代码。脚本的功能主要是利用漏洞，提取信息并生成 JWT 令牌。脚本逻辑相对清晰，没有发现任何会危害用户系统或窃取用户信息的恶意代码。虽然脚本本身不包含投毒代码，但使用者在使用脚本时仍需谨慎，确保从可信来源下载脚本，并仔细审查脚本内容，避免被恶意修改。

**关于搜索引擎结果:**

搜索引擎结果为空，没有影响到本次的分析和评估，仍然以漏洞库信息和提供的漏洞利用代码为依据。

**项目地址:** [Nxploited/CVE-2025-9209](https://github.com/Nxploited/CVE-2025-9209)

**漏洞详情:** [CVE-2025-9209](https://nvd.nist.gov/vuln/detail/CVE-2025-9209)