## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，即会将参数中以`@`字符开头的路径替换为该文件的内容。在受影响的版本中，该特性没有被禁用，导致未经身份验证的攻击者可以利用此特性读取Jenkins控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者利用Jenkins CLI接口，发送一个包含以`@`字符开头的路径的命令。
2.  Jenkins CLI解析器会将`@`字符后面的文件路径的内容读取出来。
3.  攻击者可以通过构造包含敏感文件路径的命令，例如`@/etc/passwd`或`@/var/jenkins_home/secrets/initialAdminPassword`，来读取敏感信息。

**POC有效性：**

提供的POC代码`/tmp/5eea9854944c8c5ba8537ae8d6585ad8/README.md`内容过于简单，仅包含一个标题，并没有体现出漏洞利用的完整过程。需要构造恶意的CLI请求才能完成漏洞的验证

**投毒风险分析：**

根据提供的POC代码，该代码仅包含一个README.md文件，文件内容仅是标题。没有发现任何恶意代码或潜在的后门。因此，可以认为该POC代码不存在投毒风险。投毒风险的可能性为0%。

**总结：**

CVE-2024-23897是一个严重的安全漏洞，攻击者可以利用它来读取Jenkins服务器上的任意文件，获取敏感信息，甚至可能导致更严重的攻击。强烈建议受影响的用户尽快升级到安全版本，或者采取其他缓解措施，例如禁用CLI接口或限制CLI访问权限。

**项目地址:** [harekrishnarai/CVE-2024-23897-test-windows](https://github.com/harekrishnarai/CVE-2024-23897-test-windows)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)