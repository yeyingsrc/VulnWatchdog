## CVE-2022-40684 - FortiOS/FortiProxy/FortiSwitchManager 身份验证绕过

**漏洞编号:** CVE-2022-40684

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** 目标系统开启了管理界面，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-40684 允许未经身份验证的攻击者通过特制的HTTP或HTTPS请求在管理界面上执行操作。攻击者通过在请求头中设置 `Forwarded` 字段来绕过身份验证。提供的 `UserEnum.py` 脚本利用此漏洞枚举有效的管理员用户名。 `fortinet_version.yaml` 和 `vuln_checker.yaml` 用于检测是否存在漏洞，并获取 Fortinet 设备的版本信息。投毒风险评估为10%，主要考虑的是 YAML 文件可能被篡改，执行恶意代码，虽然目前提供的文件只进行检测和版本获取，并不直接执行命令,但yaml文件可以进行修改，存在潜在的风险。

**项目地址:** [und3sc0n0c1d0/CVE-2022-40684](https://github.com/und3sc0n0c1d0/CVE-2022-40684)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)