## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)