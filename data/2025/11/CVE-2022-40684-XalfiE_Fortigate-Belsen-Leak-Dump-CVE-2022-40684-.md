## CVE-2022-40684 - Fortinet Authentication Bypass

**漏洞编号:** CVE-2022-40684

**漏洞类型:** Authentication Bypass

**影响应用:** FortiOS, FortiProxy, FortiSwitchManager

**危害等级:** Critical - Unauthenticated attacker can perform operations on the administrative interface

**影响版本:** FortiOS 7.2.0-7.2.1, 7.0.0-7.0.6; FortiProxy 7.2.0, 7.0.0-7.0.6; FortiSwitchManager 7.2.0, 7.0.0

**利用条件:** Network access to the administrative interface (HTTP or HTTPS)

**POC 可用性:** Yes

**投毒风险:** 0%

## 详情

CVE-2022-40684 is an authentication bypass vulnerability in Fortinet products that allows an unauthenticated attacker to perform administrative actions. The provided code extracts usernames and passwords from 'vpn-passwords.txt' files, which might be part of a configuration backup. While this code itself doesn't directly exploit the authentication bypass, it could be used in conjunction with the bypass to extract credentials if the attacker successfully gains access to the file system through the authentication bypass vulnerability. There is no apparent malicious code in the provided scripts and it just extracts credentials. So there is no poison risk.

**Exploitation Summary:**

1.  An unauthenticated attacker sends a specially crafted HTTP or HTTPS request to the administrative interface.
2.  Due to the authentication bypass (CWE-288), the attacker is granted unauthorized access.
3.  The attacker can then perform administrative operations.
4.  The attacker could leverage the provided python scripts (or similar) after gaining initial access via the bypass to search for and extract sensitive information such as credentials from backup files if accessible.

The python scripts given is not vulnerable, but can use the extracted credentials in a vulnerable manner if the attacker gains access to files.

**项目地址:** [XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-](https://github.com/XalfiE/Fortigate-Belsen-Leak-Dump-CVE-2022-40684-)

**漏洞详情:** [CVE-2022-40684](https://nvd.nist.gov/vuln/detail/CVE-2022-40684)