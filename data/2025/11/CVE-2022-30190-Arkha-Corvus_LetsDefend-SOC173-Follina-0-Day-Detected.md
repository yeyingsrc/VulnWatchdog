## CVE-2022-30190 - Microsoft MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过特制的Office文档，利用`ms-msdt:`协议调用MSDT执行任意命令。攻击者可以通过嵌入恶意URL到Word文档中，诱导用户点击或者预览，从而触发漏洞。漏洞利用流程如下：

1.  攻击者创建一个包含恶意链接的Word文档。
2.  用户打开该文档。
3.  文档利用`ms-msdt:`协议调用MSDT。
4.  MSDT执行攻击者指定的命令。

根据提供的漏洞利用代码分析，这是一个对 Follina 漏洞的案例研究，通过分析恶意Word文档触发 `msdt.exe` 的执行，从而实现远程代码执行。

**有效性：** 提供的Github仓库包含对漏洞的分析和利用过程，可以有效帮助理解漏洞原理。

**投毒风险：** 该存储库是一个案例分析，主要包含漏洞分析和利用过程的记录，包括文件哈希、网络流量分析和电子邮件分析。代码中没有发现明显的恶意后门代码，投毒的可能性较低（约5%），主要是考虑到作者可能在分析过程中引入了一些未知的或者不安全的操作，但从整体上看，这是一个漏洞分析的记录，投毒的可能性不大。

**利用方式：**

1.  **构造恶意Word文档：** 攻击者构造包含恶意`ms-msdt:` URL的Word文档。
2.  **传播恶意文档：** 攻击者通过钓鱼邮件等方式将恶意文档发送给目标用户。
3.  **触发漏洞：** 用户打开恶意文档，触发MSDT执行恶意代码。
4.  **执行恶意命令：** 攻击者利用MSDT执行任意命令，例如安装恶意软件，窃取数据等。

**建议：**

*   及时安装微软发布的补丁。
*   禁用`ms-msdt:`协议，作为缓解措施。
*   加强用户安全意识培训，避免打开来源不明的文档。
*   使用杀毒软件和入侵检测系统，及时发现和阻止恶意攻击。

**项目地址:** [Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected](https://github.com/Arkha-Corvus/LetsDefend-SOC173-Follina-0-Day-Detected)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)