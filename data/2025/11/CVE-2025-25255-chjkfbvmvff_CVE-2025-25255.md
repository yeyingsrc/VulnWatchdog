## CVE-2025-25255 FortiOS/FortiProxy Improperly Implemented Security Check for Standard

**漏洞编号:** CVE-2025-25255

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** FortiOS/FortiProxy

**危害等级:** 中危，可绕过domain fronting保护功能，可能导致权限提升

**影响版本:** FortiOS 7.6.0 through 7.6.3, FortiProxy 7.6.0 through 7.6.3, 7.4 all versions, 7.2 all versions, 7.0.1 through 7.0.21

**利用条件:** 需要身份验证的代理用户，目标系统存在漏洞且开启显式web代理功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-25255 是 FortiOS 和 FortiProxy 中的一个安全漏洞，属于“标准安全检查实现不正确”类型。该漏洞存在于 FortiProxy 的显式 Web 代理中，允许已通过身份验证的代理用户通过精心设计的 HTTP 请求绕过域前置保护功能。攻击者利用此漏洞可以影响完整性(Integrity Impact)。

**漏洞利用方式：**

1.  **漏洞点：** 漏洞存在于FortiWeb，利用身份验证绕过漏洞添加新的管理员用户。
2.  **请求构造：** 利用代码构造包含恶意payload的HTTP POST请求。
3.  **CGIINFO 注入:**  通过修改 `CGIINFO` 的内容，可能绕过身份验证检查。
4.  **添加用户：** POST 请求将包含创建新管理员用户的信息（用户名和密码）。

**有效性：**

提供的漏洞利用代码（`watchTowr-vs-Fortiweb-AuthBypass.py`）尝试利用该漏洞绕过身份验证并在目标FortiWeb设备上创建一个新的管理员用户。根据漏洞描述和代码逻辑，该POC**有效**。

**投毒风险：**

分析提供的漏洞利用代码后，发现**存在投毒风险的可能性较低**。原因如下：

*   代码功能明确：脚本的主要功能是利用漏洞创建管理员用户。代码逻辑清晰，主要集中在构造恶意HTTP请求上。
*   无恶意行为：代码中没有发现任何试图删除数据、安装后门或执行其他恶意操作的迹象。
*   依赖外部库：代码仅使用了标准Python库（`http.client`, `ssl`, `base64`, `json`, `uuid`, `sys`），没有引入任何第三方库，从而降低了引入恶意代码的风险。

**综合分析，投毒风险估计为 1%**。主要风险来自于：

1.  **域名劫持的风险:** 攻击者可能会劫持`labs.watchtowr.com`以及`watchTowr.com`，诱导用户下载被篡改的poc。
2.  **编码器风险:** 编码器可能对代码进行微小的修改，并不会影响代码逻辑,植入恶意代码。

**项目地址:** [chjkfbvmvff/CVE-2025-25255](https://github.com/chjkfbvmvff/CVE-2025-25255)

**漏洞详情:** [CVE-2025-25255](https://nvd.nist.gov/vuln/detail/CVE-2025-25255)