## CVE-2025-63888 ThinkPHP 5.0.24 文件包含远程代码执行漏洞

**漏洞编号:** CVE-2025-63888

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ThinkPHP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 5.0.24

**利用条件:** 目标服务器运行ThinkPHP 5.0.24，且存在可被外部访问的入口点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-63888 是 ThinkPHP 5.0.24 中的一个文件包含漏洞，存在于 `thinkphp/library/think/template/driver/File.php` 文件的 `read` 函数中。攻击者可以通过操纵 `view()` 函数中的模板路径，实现任意文件包含，进而执行任意代码。

**利用方式：**

1.  **确定目标是否使用ThinkPHP 5.0.24：** 通过HTTP请求的响应头或特定文件来确定。
2.  **寻找可利用的入口点：** 寻找调用 `view()` 函数的地方，该函数允许传入模板路径。
3.  **构造恶意模板路径：** 构造包含恶意代码的模板路径，例如，指向一个包含PHP代码的日志文件，或者直接写入Web目录。
4.  **利用文件包含执行代码：** 通过文件包含漏洞执行恶意代码，例如，写入webshell或执行系统命令。
5.  **日志文件投毒：** 如果无法直接上传包含恶意代码的文件，可以尝试向日志文件写入恶意PHP代码，然后利用文件包含漏洞执行。

**有效性评估：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的利用代码是有效的。它提供了一个PoC，包含自动化检测、漏洞测试、利用等功能，能够帮助研究人员验证和利用此漏洞。

**投毒风险：**

提供的代码中存在一定的投毒风险。 虽然`README.md`中声明了免责声明，并强调仅用于授权的安全测试和教育目的。但是攻击者仍然可以利用该工具非法入侵，恶意攻击。仓库的作者可能在代码中添加隐蔽的后门或恶意功能，例如：

*   **信息收集：** 收集目标系统的敏感信息并发送给攻击者。
*   **持久化后门：** 在目标系统上安装后门，以便长期控制。
*   **拒绝服务攻击：** 利用漏洞发起拒绝服务攻击。

由于代码中存在多种命令执行和文件操作，因此具有潜在的风险。

**风险百分比评估：**

*   **低风险 (0-30%):**  仅包含基本漏洞利用代码，没有明显的恶意功能。
*   **中风险 (31-70%):**  包含一些潜在的风险，例如信息收集或简单的后门。
*   **高风险 (71-100%):**  包含明显的恶意功能，例如持久化后门、远程控制或拒绝服务攻击。

综合考虑代码的复杂性和潜在的风险，我评估其投毒风险为 **10%**。这主要是基于该代码的目的是漏洞利用，并非设计为恶意软件。 但是，使用前需要仔细审计代码。

**项目地址:** [AN5I/cve-2025-63888-exploit](https://github.com/AN5I/cve-2025-63888-exploit)

**漏洞详情:** [CVE-2025-63888](https://nvd.nist.gov/vuln/detail/CVE-2025-63888)