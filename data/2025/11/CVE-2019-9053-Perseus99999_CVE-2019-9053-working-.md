## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 2.2.9

**利用条件:** 需要目标CMS存在News模块且允许未授权访问moduleinterface.php

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中存在的一个未经身份验证的盲注型SQL注入漏洞。该漏洞位于News模块的`moduleinterface.php`文件中，攻击者可以通过构造恶意的URL，利用`m1_idlist`参数进行时间盲注。

**有效性：**

提供的PoC代码针对此漏洞，包含以下关键步骤：

1.  **参数解析：** 使用`optparse`模块解析命令行参数，包括目标URL、字典文件和破解选项。
2.  **会话建立：** 使用`requests.Session()`建立会话，保持连接。
3.  **时间盲注：** 通过构造包含`sleep()`函数的SQL查询，根据响应时间判断条件是否成立。
4.  **数据提取：** 逐步提取数据库名、salt和管理员密码的哈希值。
5.  **密码破解：** 如果指定了字典文件，则使用字典文件和提取到的salt进行密码破解。

该PoC代码逻辑清晰，实现了漏洞利用的关键步骤，因此判断为有效。

**投毒风险：**

代码存在少量的投毒风险，可能性极低，只有1%。主要考虑如下:

*   **依赖风险：** 代码依赖`requests`和`termcolor`库，虽然这些库本身被广泛使用，但仍存在被恶意替换或包含后门的风险。
*   **时间依赖：** 时间盲注对网络延迟非常敏感，`TIME`变量和`time.sleep()`函数需要根据目标环境进行调整，如果设置不当可能导致利用失败或耗费大量时间。某些恶意攻击者可能利用这一点，使攻击在特定条件下失败，从而掩盖攻击行为。
*   **License Year：** License声明的年份为2025，这是一个未来时间，可能暗示作者并非原创作者，而是一个修改者。但这种可能性极低，可能是笔误。

总体来说，该代码的投毒风险较低。PoC代码主要侧重于漏洞利用，并未发现明显的恶意行为，如反弹shell、植入后门或窃取敏感信息等。

**利用方式：**

1.  **确定目标：** 找到存在漏洞的CMS Made Simple网站，且News模块启用。
2.  **构造恶意URL：** 使用PoC代码生成包含SQL注入payload的URL，payload利用`sleep()`函数进行时间盲注。
3.  **提取信息：** 运行PoC代码，通过分析响应时间逐步提取数据库名、salt和管理员密码的哈希值。
4.  **密码破解：** 如果提取到salt和密码哈希值，可以使用字典文件进行离线破解。
5.  **权限获取：** 使用破解后的管理员密码登录后台，获取系统控制权。

**项目地址:** [Perseus99999/CVE-2019-9053-working-](https://github.com/Perseus99999/CVE-2019-9053-working-)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)