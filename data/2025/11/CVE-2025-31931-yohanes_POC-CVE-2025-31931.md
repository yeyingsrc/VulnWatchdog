## CVE-2025-31931-Instrumentation and Tracing Technology API (ITT API)软件权限提升漏洞

**漏洞编号:** CVE-2025-31931

**漏洞类型:** 权限提升/Uncontrolled Search Path Element (CWE-427)

**影响应用:** Instrumentation and Tracing Technology API (ITT API)软件

**危害等级:** 中危，通过劫持ITT API搜索路径，可能导致本地权限提升

**影响版本:** 3.25.4之前版本

**利用条件:** 需要低权限用户账户，需要用户交互，攻击复杂度高

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31931是Instrumentation and Tracing Technology API (ITT API)软件中的一个权限提升漏洞。攻击者可以通过控制ITT API的搜索路径，加载恶意的共享库，从而提升权限。该漏洞是由于程序在搜索共享库时，使用了不受控制的搜索路径导致的。攻击者可以在该路径下放置恶意库文件，当程序加载这些恶意库文件时，攻击者就可以执行任意代码，进而提升权限。

**漏洞利用方式：**
1. 攻击者需要一个低权限的本地用户账户。
2. 攻击者需要在不受控制的搜索路径下放置恶意的共享库。
3. 诱导受害者运行使用ITT API的应用程序，该程序在加载恶意共享库时执行攻击者的代码。
4. 攻击者通过执行恶意代码提升权限。

**漏洞利用有效性：**
根据tinyhack.com上的writeup，漏洞利用似乎在Android上的OpenCV 4.10中进行了验证，因此提供的gradle项目可能是为了构建一个可以触发该漏洞的Android应用。

**投毒风险：**
提供的代码片段看起来只是一个简单的Android项目结构，包括gradle配置和一个readme文件。`build.gradle.kts`定义了Android应用和库的构建配置，`gradle.properties`定义了Gradle的全局设置，`gradlew`是一个Gradle的包装脚本，用于在没有预先安装Gradle的环境中运行Gradle构建。`README.md`引用了包含完整利用细节的外部链接。

虽然这些代码片段本身没有明显的恶意代码，但仍然存在一些投毒风险：
*   **依赖项投毒：** `build.gradle.kts` 文件中可能包含对恶意或受损的第三方库的依赖，这些库可能包含恶意代码。评估每个依赖项的来源和安全性非常重要，但是，这个文件本身没有依赖项声明，只是一个占位符。
*   **构建脚本注入：** 攻击者可能会修改 `build.gradle.kts` 文件，以在构建过程中执行恶意代码。例如，攻击者可以添加一个任务，该任务在构建过程中下载并执行任意脚本。不过，只查看这个文件是无法确定的。
*   **readme.md重定向钓鱼: ** 攻击者通过readme.md重定向用户到一个被篡改的链接地址，诱导用户下载或浏览带有恶意内容的信息。

总体来说，根据目前的信息，投毒风险较低，大约为 10%。这主要是因为提供的代码片段相对简单，并没有明显的恶意代码。但是，为了确保安全性，仍然需要仔细检查项目的完整代码，包括所有依赖项、构建脚本和任何其他可能包含恶意代码的文件。特别是需要检查 `README.md` 中链接的安全性。

**项目地址:** [yohanes/POC-CVE-2025-31931](https://github.com/yohanes/POC-CVE-2025-31931)

**漏洞详情:** [CVE-2025-31931](https://nvd.nist.gov/vuln/detail/CVE-2025-31931)