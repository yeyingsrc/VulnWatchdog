## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15 (受影响)

**利用条件:** 需要ADB连接，无额外执行权限需求，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE信息，CVE-2024-0044是Android PackageInstallerService.java中createSessionInternal函数由于输入验证不当导致的权限提升漏洞。攻击者可以通过构造恶意输入，冒充任何应用身份运行。提供的Python脚本尝试利用该漏洞。

**有效性：**
根据提供的漏洞利用代码，该脚本首先检查ADB连接，然后将APK文件推送到目标设备上的/data/local/tmp/目录。接着，它获取目标应用程序的UID，并使用该UID生成一个特殊的Payload，写入到payload.txt文件中。该Payload包含一个“pm install”命令，该命令利用“run-as”漏洞尝试以目标应用程序的身份安装APK。通过tar打包com.whatsapp应用目录，疑似是为了提取其数据。

**投毒风险：**
仔细检查提供的Python脚本后，未发现明显的投毒代码。脚本的功能主要是为了自动化漏洞利用过程。恶意代码可能会隐藏在payload的构造逻辑中，但从目前的脚本来看，其目的是为了模拟利用漏洞而不是植入后门。

**利用方式：**
1.  **ADB连接：** 首先需要通过ADB连接到目标Android设备。
2.  **推送APK：** 将恶意APK推送到设备的/data/local/tmp/目录。
3.  **获取UID：** 查找目标应用程序（例如WhatsApp）的UID。
4.  **生成Payload：** 根据目标应用的UID，构造特定的payload。这个payload欺骗PackageInstallerService，使其相信正在以目标应用的身份安装APK。
5.  **安装APK：** 使用“pm install”命令和构造的payload来安装恶意APK。由于漏洞，APK将以目标应用程序的权限运行。
6.  **提取数据：** 尝试提取 WhatsApp 数据。

总而言之，该漏洞利用代码试图通过伪造安装会话来提升权限。其有效性取决于目标设备是否受到CVE-2024-0044漏洞的影响。


**项目地址:** [Athexhacker/EXPLOITER](https://github.com/Athexhacker/EXPLOITER)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)