## CVE-2025-50168-Win32k Elevation of Privilege

**漏洞编号:** CVE-2025-50168

**漏洞类型:** 权限提升

**影响应用:** Windows Win32k - ICOMP

**危害等级:** 高危，本地权限提升

**影响版本:** Windows 11 22H2 (<= 10.0.22621.5768), Windows Server 2025 (<= 10.0.26100.4946), Windows 11 23H2 (<= 10.0.22631.5768), Windows Server 23H2 (<= 10.0.25398.1791), Windows 11 24H2 (<= 10.0.26100.4946)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-50168 是一个 Windows Win32k 组件中的权限提升漏洞，具体位于 ICOMP 部分，属于 'type confusion' 类型的问题，可能导致堆溢出。攻击者可以利用此漏洞从低权限账户提升到系统权限。利用方式主要集中在DirectComposition相关API上，通过类型混淆漏洞触发堆溢出最终获取system权限。

**有效性：**
提供的POC代码基于Visual Studio项目，且提交于Pwn2Own Berlin 2025 LPE比赛，表明具备一定的有效性，但需要编译才能使用，依赖相应的开发环境。

**投毒风险：**
提供的代码主要为Visual Studio项目文件（.sln, .vcxproj, .vcxproj.filters），以及一个README.md文件。这些文件本身很难直接包含恶意代码，但存在以下潜在风险：

1.  **依赖项投毒：** 项目可能依赖外部库或组件，而这些依赖项可能被篡改以包含恶意代码。但是从提供的文件来看,没有涉及到第三方的引用,所以此概率比较低
2.  **编译时投毒：** 构建脚本或编译器设置可能被修改以在编译过程中引入恶意代码。但是此概率非常低.
3.  **代码逻辑欺骗：** 漏洞利用代码本身可能包含后门或恶意功能，但隐藏在复杂的逻辑中，难以被发现。
4.  **利用预编译头投毒:** 预编译头文件可能被植入恶意代码,但是从给出的项目文件来看,没有使用预编译头,所以此概率非常低.
鉴于以上风险，虽然可能性较低，但仍需对POC代码进行详细审查，尤其是生成的二进制文件，以确保其安全性。因为提供的代码量较少，而且是已经提交到比赛，投毒概率较低，估计投毒风险为10%。

**利用方式：**
1.  **确定目标系统版本：**  漏洞影响特定版本的Windows 11和Windows Server，需要确认目标系统是否在受影响范围内。
2.  **编译POC代码：** 使用Visual Studio编译提供的POC代码。
3.  **运行POC代码：**  在目标系统上运行编译后的POC代码。POC利用的是`Win32kbase!DirectComposition`的type confusion漏洞。
4.  **权限提升：**  如果漏洞利用成功，攻击者将获得系统权限，可以执行任意代码。
5.  **kASLR绕过：** 该漏洞利用代码还引用了一个kASLR绕过技术，prefetch-tool来绕过内核地址空间布局随机化。

**项目地址:** [D4m0n/CVE-2025-50168-pwn2own-berlin-2025](https://github.com/D4m0n/CVE-2025-50168-pwn2own-berlin-2025)

**漏洞详情:** [CVE-2025-50168](https://nvd.nist.gov/vuln/detail/CVE-2025-50168)