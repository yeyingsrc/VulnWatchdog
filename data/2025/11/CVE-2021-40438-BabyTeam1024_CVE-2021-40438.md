## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露、攻击内网服务、甚至远程代码执行（取决于内网服务）。

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用了 mod_proxy 模块，并且存在不当的配置允许通过URI进行代理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438 是一个存在于 Apache HTTP Server 2.4.48 及更早版本的 mod_proxy 模块中的 SSRF 漏洞。攻击者可以通过构造特定的 URI 路径，使受害服务器将请求转发到攻击者控制的服务器。提供的 Dockerfile 文件旨在构建一个易受攻击的 Apache HTTP Server 环境进行漏洞验证。 Dockerfile 下载并编译了 httpd-2.4.49，但漏洞描述中指明影响版本为 <=2.4.48，因此构建的环境实际应当是存在漏洞的环境。docker-compose.yml 文件用于启动该容器，并将其 80 端口映射到主机的 8787 端口。利用方式是构造恶意的请求 URI，利用 `mod_proxy` 将请求代理到任意外部或内部服务器。投毒风险评估：虽然Dockerfile文件本身包含了从apache.org下载源码并编译的过程，相对来说比较安全，但是考虑到攻击者完全可能替换其中的源码为恶意版本，或者在编译过程中加入恶意代码。考虑到这种可能性，判定存在一定的投毒风险，但因为需要替换源码，相对比较复杂，且dockerfile本身不包含恶意后门，因此投毒风险定为10%。主要风险在于构建环境依赖的外部资源可能被篡改，但是直接在Dockerfile中包含恶意代码的可能性较低。

**项目地址:** [BabyTeam1024/CVE-2021-40438](https://github.com/BabyTeam1024/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)