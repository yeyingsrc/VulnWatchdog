## CVE-2025-59253 - Windows Search Service Denial of Service

**漏洞编号:** CVE-2025-59253

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Microsoft Windows Search Component

**危害等级:** 中危，导致服务不可用，影响用户体验

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59253 漏洞存在于 Microsoft Windows Search 组件中，由于不正确的访问控制，允许本地攻击者通过发送畸形查询来造成拒绝服务。

**漏洞利用方式：**

1.  **利用点：** Windows Search 组件在处理查询时，对访问控制列表 (ACL) 的验证不充分。
2.  **攻击方式：** 本地攻击者可以利用 `ISearchProtocol` 接口，绕过速率限制，通过构造畸形的、过大的或递归的查询字符串（例如，嵌入无效的 SID 引用）并发送给索引服务 `searchprotocolhost.exe` (及相关 DLL，如 `MSSrch.dll`)，从而触发拒绝服务。
3.  **PoC 实现：** PoC 代码通过 COM 接口连接到搜索服务，构造恶意查询，诱发 `SearchIndexer.exe` 进程进入高 CPU 循环或崩溃，最终导致系统响应变慢或搜索功能不可用。
4.  **触发条件：** 需要 Windows Search 服务启用并运行。

**投毒风险评估：**

该 PoC 的主要目的是演示 DoS 漏洞。投毒风险较低，但仍需注意以下几点：

*   **资源消耗：** PoC 本身可能会消耗大量 CPU 或内存资源，导致系统不稳定。虽然作者声明 PoC 是非破坏性的，但仍应在隔离环境中运行。
*   **服务中断：** PoC 会导致 Windows Search 服务崩溃或停止响应，影响系统的搜索功能。
*   **潜在的后门代码：** PoC 中可能隐藏着作者植入的恶意代码，例如收集系统信息或执行其他恶意操作。尽管作者提供了免责声明，但仍需要仔细检查 PoC 代码，以确保其安全性。

综合评估，由于该 PoC 是本地 DoS 攻击，影响范围有限，且作者提供了免责声明，因此投毒风险相对较低，约为10%。但是仍然需要在使用前仔细审查代码，并在隔离环境中运行。

**项目地址:** [zigzagymym1986/CVE-2025-59253](https://github.com/zigzagymym1986/CVE-2025-59253)

**漏洞详情:** [CVE-2025-59253](https://nvd.nist.gov/vuln/detail/CVE-2025-59253)