## CVE-2025-8088 WinRAR Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 需要用户交互（打开恶意RAR文件）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个WinRAR中的路径遍历漏洞。攻击者可以构造恶意的RAR压缩文件，利用其中的路径遍历机制，将Payload写入到任意位置。根据漏洞库信息，该漏洞已经在野外被利用。提供的漏洞利用代码是一个Python脚本，它可以生成包含恶意Payload的RAR文件，Payload会被放置到Windows启动文件夹中，从而实现持久化。攻击流程大致如下：

1.  脚本创建诱饵文件（decoy files）。
2.  脚本通过构造特殊的RAR文件结构，利用`..\`进行路径回溯，将恶意Payload（Payload.bat）写入`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`目录，从而实现开机启动。
3.  脚本修改RAR文件头，进行CRC校验码重计算，确保压缩文件完整性。
4.  脚本生成最终的RAR文件。

**有效性：**
提供的POC代码，基于路径遍历原理，并且根据漏洞信息显示该漏洞已经在野外被利用，因此可以认为POC代码有效。

**投毒风险：**
对提供的POC代码进行分析，发现`extract.py`代码是干扰分析人员的无用代码，利用价值低。主要关注点在于`main.py`，`config.py`和`README.md`。`config.py`中定义了payload，默认payload会将 `C:\Users\Public\file.exe` 设置为启动项。虽然存在自定义payload的可能性，但从代码本身来看，没有发现明显的恶意或隐藏后门的逻辑。`README.md`仅为说明文档，不具备投毒能力。因此，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者创建一个恶意的RAR压缩文件，其中包含一个Payload，例如`payload.bat`。
2.  该压缩文件利用路径遍历漏洞，将`payload.bat`写入`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`目录。
3.  当用户解压该RAR文件时，`payload.bat`被释放到启动目录。
4.  当用户下次启动计算机时，`payload.bat`会自动执行，从而执行恶意代码。
5. 为了增加隐蔽性，payload可能写入ADS(NTFS数据流)，文件正常显示，但会执行注入的恶意程序。

**项目地址:** [WezRyan/CVE-2025-8088](https://github.com/WezRyan/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)