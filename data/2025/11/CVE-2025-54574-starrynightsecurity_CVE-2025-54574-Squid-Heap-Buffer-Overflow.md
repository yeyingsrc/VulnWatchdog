## CVE-2025-54574-Squid-Heap-Buffer-Overflow

**漏洞编号:** CVE-2025-54574

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Squid

**危害等级:** 高危，可能导致内存损坏、信息泄露和远程代码执行

**影响版本:** < 6.4

**利用条件:** 需要Squid代理服务器启用URN处理，攻击者可以通过发送特制的HTTP请求触发

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54574是Squid代理服务器中一个严重的堆缓冲区溢出漏洞，影响版本低于6.4。该漏洞源于Squid在处理URN时，对缓冲区管理不当，导致可以写入超出缓冲区范围的数据。攻击者可以通过控制的服务器，发送包含恶意URN的HTTP响应，触发堆缓冲区溢出。漏洞利用可能导致内存损坏，敏感信息泄露（高达4KB堆内存），甚至远程代码执行。

**有效性评估：**
从漏洞库信息和提供的POC代码（README.md）来看，该漏洞的POC是可用的。README.md描述了漏洞的发现、分析和修复过程，并指出了`/poc/`目录包含安全的复现步骤。这表明漏洞可以被有效利用。

**投毒风险分析：**
根据提供的信息，投毒风险较低，但不能完全排除。理由如下：
*   **POC代码可能包含恶意代码：** 攻击者可能将恶意代码伪装成漏洞利用的一部分，例如在`/poc/`或`/analysis/`中包含一些后门程序或恶意脚本。
*   **依赖项风险：** 如果POC需要安装特定的依赖项，这些依赖项可能被篡改，包含恶意代码。

但根据目前信息来看，风险不高，因为漏洞报告是由安全研究员Guadalupe Colantonio提交的，并且已经分配了CVE编号。一般情况下，公开披露的漏洞POC被投毒的可能性较低。但是为了安全起见，仍然需要仔细审查POC代码，例如通过阅读代码、使用静态分析工具等。所以此处判定的投毒风险为10%。

**利用方式：**
1.  攻击者搭建一个恶意服务器，该服务器能够响应Squid代理服务器的请求。
2.  攻击者构造一个包含恶意URN的HTTP响应，该响应的大小超过Squid分配的缓冲区的大小。
3.  Squid代理服务器向恶意服务器发起请求，并接收包含恶意URN的HTTP响应。
4.  Squid在处理恶意URN时，由于缓冲区管理不当，发生堆缓冲区溢出，导致内存损坏或信息泄露。
5.  攻击者可以利用堆缓冲区溢出进一步执行任意代码。

**缓解措施：**
1.  升级到Squid 6.4或更高版本。
2.  禁用URN访问权限。

**总结：**
CVE-2025-54574是一个严重的安全漏洞，需要及时修复。在利用POC时，需要仔细审查代码，避免被投毒。

**项目地址:** [starrynightsecurity/CVE-2025-54574-Squid-Heap-Buffer-Overflow](https://github.com/starrynightsecurity/CVE-2025-54574-Squid-Heap-Buffer-Overflow)

**漏洞详情:** [CVE-2025-54574](https://nvd.nist.gov/vuln/detail/CVE-2025-54574)