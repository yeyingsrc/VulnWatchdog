## CVE-2022-0543-Redis-Lua沙箱逃逸

**漏洞编号:** CVE-2022-0543

**漏洞类型:** Lua沙箱逃逸

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Debian打包版本存在问题

**利用条件:** 需要网络访问Redis服务，redis未授权或存在弱口令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0543是Redis的一个Lua沙箱逃逸漏洞，存在于Debian的Redis打包版本中。攻击者可以利用此漏洞执行任意命令。漏洞利用方式：攻击者通过发送恶意的Lua脚本到Redis服务器，利用`package.loadlib`函数加载动态链接库（/usr/lib/x86_64-linux-gnu/liblua5.1.so.0），绕过Lua沙箱限制，然后使用`io.popen`函数执行系统命令。提供的exploit.py脚本实现了自动化利用，可以执行单个命令或获取反向shell。代码中没有发现明显的投毒行为。

**有效性评估：** 提供的POC代码是有效的，它可以利用Lua沙箱逃逸漏洞在受影响的Redis实例上执行任意命令。

**投毒风险评估：** 代码本身没有明显的投毒风险。但是，使用任何未经充分审查的漏洞利用代码都存在潜在风险。用户应当仔细阅读和理解代码，并在测试环境中使用，以避免意外损害。

**利用方式总结：**

1.  连接到目标Redis实例。
2.  构造包含恶意代码的Lua脚本，利用`package.loadlib`和`io.popen`函数逃逸沙箱并执行命令。
3.  将Lua脚本发送到Redis服务器执行。
4.  获取命令执行结果或反向shell。

**项目地址:** [JacobEbben/CVE-2022-0543](https://github.com/JacobEbben/CVE-2022-0543)

**漏洞详情:** [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)