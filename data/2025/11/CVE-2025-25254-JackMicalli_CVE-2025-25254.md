## CVE-2025-25257-FortiWeb-SQL注入RCE

**漏洞编号:** CVE-2025-25254

**漏洞类型:** SQL注入导致远程代码执行

**影响应用:** FortiWeb

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 7.6.0 <= 7.6.3, 7.4.0 <= 7.4.7, 7.2.0 <= 7.2.10, 7.0.0 <= 7.0.10

**利用条件:** 目标存在漏洞版本，攻击者可以访问目标网络，需要目标开启web服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞为 FortiWeb 多个版本中存在的未授权SQL注入漏洞，通过构造恶意的SQL语句，可以执行任意代码。  

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC已经存在，且可以执行远程代码，有效性较高。Fortinet官方也发布了安全公告确认了此漏洞，并提供了修复方案。

**投毒风险评估：**

代码本身没有明显的投毒行为。 代码将bash反弹shell命令拆分成多个hex编码的块，然后使用SQL注入将其拼接起来并执行。虽然代码比较复杂，但是逻辑清晰，主要目的是利用SQL注入执行系统命令，创建反弹shell。未发现任何其他恶意行为。

**利用方式：**

1.  **SQL注入：**  利用未经授权的SQL注入点，修改数据库中的数据或执行SQL命令。
2.  **代码注入：**  通过SQL注入，将恶意代码（本例中为反弹shell的命令）注入到服务器中。
3.  **远程代码执行：**  利用注入的恶意代码，在服务器上执行任意命令，实现远程控制。
4.  **反弹Shell:** 利用bash反弹shell到攻击者的服务器上。

该POC脚本通过将shell命令进行十六进制编码并分块，然后通过SQL注入的`CONCAT`函数将这些块拼接成完整的shell命令，从而绕过一些过滤机制。然后利用`os.system`函数来执行拼接好的shell命令，最终实现反弹shell。


**项目地址:** [JackMicalli/CVE-2025-25254](https://github.com/JackMicalli/CVE-2025-25254)

**漏洞详情:** [CVE-2025-25254](https://nvd.nist.gov/vuln/detail/CVE-2025-25254)