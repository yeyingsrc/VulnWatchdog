## CVE-2022-21587 - Oracle E-Business Suite Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2022-21587

**漏洞类型:** 任意文件上传

**影响应用:** Oracle Web Applications Desktop Integrator (E-Business Suite)

**危害等级:** 高危，可能导致远程代码执行和系统接管

**影响版本:** 12.2.3-12.2.11

**利用条件:** 需要网络访问Oracle Web Applications Desktop Integrator的HTTP端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2022-21587是Oracle E-Business Suite的Oracle Web Applications Desktop Integrator组件中的一个漏洞。受影响的版本是12.2.3到12.2.11。该漏洞允许未经身份验证的攻击者通过HTTP网络访问来利用，成功利用可能导致Oracle Web Applications Desktop Integrator被完全控制。CVSS 3.1基本评分为9.8，属于严重级别。

**有效性分析：**
提供的POC代码是一个maven项目，用于生成利用CVE-2022-21587的payload。README.md文件中提供了利用说明和截图，说明该POC可以生成恶意的ZIP文件，上传到存在漏洞的E-Business Suite实例上，从而实现未授权的文件上传。

**投毒风险分析：**
虽然POC代码描述为expolit代码，用于利用漏洞，但仍存在一定的投毒风险。
1.  **依赖项风险：** `pom.xml` 文件中包含多个依赖项，如果这些依赖项本身存在恶意代码或漏洞，则可能引入安全风险。
2.  **代码混淆/隐藏：** 虽然提供的代码看似正常，但攻击者可能通过代码混淆、字符串加密等方式隐藏恶意代码。
3.  **CGI脚本内容:**  `src/main/java/me/gv7/woodpecker/plugin/CommonUtils.java`中包含一个perl CGI脚本，用于处理命令执行。虽然看似正常的cgi脚本，但如果使用不当，或者被替换成恶意代码，也可能造成安全问题。例如，如果HTTP_CMD的输入没有经过充分的过滤，可能会导致命令注入。

综上所述，存在一定的投毒风险，大约为10%。

**利用方式：**
1.  攻击者使用POC生成恶意的ZIP文件。ZIP文件包含恶意文件，比如webshell，或者其他恶意脚本
2.  攻击者通过HTTP请求将恶意的ZIP文件上传到Oracle E-Business Suite服务器。
3.  由于漏洞存在于文件上传功能中，服务器会处理该ZIP文件，将恶意文件写入到服务器的任意目录。
4.  攻击者通过访问上传的恶意文件（例如webshell）来执行任意代码，从而控制服务器。

**项目地址:** [rockmelodies/Oracle-E-BS-CVE-2022-21587-Exploit](https://github.com/rockmelodies/Oracle-E-BS-CVE-2022-21587-Exploit)

**漏洞详情:** [CVE-2022-21587](https://nvd.nist.gov/vuln/detail/CVE-2022-21587)