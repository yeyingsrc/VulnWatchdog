## CVE-2025-12480-Triofox-不当访问控制

**漏洞编号:** CVE-2025-12480

**漏洞类型:** 不当访问控制

**影响应用:** Triofox

**危害等级:** 高危，可能导致完全系统破坏，部署远程访问工具，权限提升，并建立持久的C2通道

**影响版本:** < 16.7.10368.56560

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-12480是一个Triofox版本低于16.7.10368.56560的不当访问控制漏洞，它允许攻击者通过操纵HTTP Host头为"localhost"来绕过身份验证控制，从而访问关键配置页面，例如AdminDatabase.aspx和AdminAccount.aspx。这使得能够创建未经授权的管理员帐户，从而可以通过滥用该平台的防病毒功能来执行潜在的代码。漏洞利用方式：

1.  **信息收集：** 通过Shodan等工具识别暴露的Triofox实例（查询："Triofox" port:443）。通过HTTP头或错误页面确认版本。
2.  **绕过身份验证：** 发送带有Host头设置为"localhost"的GET请求到/management/AdminDatabase.aspx。攻击者利用`GladPageUILib.GladBasePage`中的`CanRunCriticalPage()`函数中不充分的验证。此函数检查`Request.Url.Host`是否等于"localhost"（不区分大小写），如果为true，则绕过其他控件（如受信任的IP验证）。由于ASP.NET从客户端提供的Host头派生`Request.Url`，因此攻击者可以欺骗它以获取访问权限。
3.  **创建管理员帐户：** 通过访问AdminAccount.aspx页面创建新的管理员帐户。
4.  **滥用防病毒功能进行代码执行：** 利用新创建的管理员帐户，滥用Triofox的防病毒功能来执行任意代码，从而完全控制系统。

**投毒风险分析：**

该漏洞利用代码主要是一个演示环境，用于重现和测试CVE-2025-12480漏洞。其中batch脚本和可执行文件可能存在风险，但考虑到其目的是为了演示漏洞利用，风险较低。

*   `start-exploit.bat`：一个简单的批处理文件，用于启动`triofox-exploit.exe`。其风险在于，如果该批处理文件被修改，可能会执行恶意命令。但由于其内容较为简单，被篡改的可能性较低。
*   `triofox-exploit.exe`：这是一个模拟攻击链的工具。它的风险在于，如果该程序被恶意修改，可能会包含后门或其他恶意功能。但是，该程序旨在演示漏洞利用，因此默认情况下不会执行任何恶意操作。

总体来说，此代码库的投毒风险较低，主要集中在批处理文件和可执行文件被篡改的可能性上。需要注意的是，所有下载的第三方工具，即使是用于安全研究目的，都应进行适当的审查和分析，以确保其安全性。 此处的投毒风险主要指作者在代码仓库中隐藏恶意代码的可能性，而非利用该漏洞进行攻击。

**项目地址:** [velmetrac/CVE-2025-12480](https://github.com/velmetrac/CVE-2025-12480)

**漏洞详情:** [CVE-2025-12480](https://nvd.nist.gov/vuln/detail/CVE-2025-12480)