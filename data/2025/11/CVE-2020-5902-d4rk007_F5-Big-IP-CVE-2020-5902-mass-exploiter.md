## CVE-2020-5902-F5 Big-IP TMUI 远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 Big-IP TMUI (Traffic Management User Interface)

**危害等级:** 高危，未经身份验证的攻击者可以远程执行任意代码，完全控制受影响的系统。

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问，目标系统运行存在漏洞的BIG-IP TMUI，且未进行安全加固。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-5902 存在于F5 BIG-IP 设备的 TMUI (Traffic Management User Interface) 中。未经身份验证的攻击者可以通过发送特制的HTTP请求，利用目录遍历漏洞读取敏感文件或执行任意代码。提供的Python脚本 `CVE-2020-5902-mass-exploiter.py` 旨在批量检测目标是否存在此漏洞。

**有效性：**
该POC代码通过构造包含目录遍历的URL，尝试读取 `/etc/passwd` 文件来判断目标是否存在漏洞。如果返回的响应包含 `root:x:0:0:root`，则认为目标易受攻击。这种检测方法是有效的，因为成功读取 `/etc/passwd` 表明攻击者可以进行目录遍历。

**投毒风险：**
分析提供的 `CVE-2020-5902-mass-exploiter.py` 脚本，发现其主要功能是发送HTTP请求并检查响应。虽然脚本会写入 `result.txt` 文件，但这只是记录漏洞检测结果，不构成直接的投毒行为。脚本使用了 `aiohttp` 库进行异步HTTP请求，这本身没有问题。风险点在于目标如果被成功利用，则可以被植入恶意代码。由于脚本只是漏洞检测工具，不是漏洞利用工具。投毒风险主要来自于该脚本本身被篡改，例如被加入恶意代码后传播。但是，从代码本身来看，存在投毒的可能性较低，估计为 5%。

**利用方式：**
1.  攻击者发送包含目录遍历的恶意HTTP请求到BIG-IP的TMUI接口。
2.  目录遍历漏洞允许攻击者访问受限目录之外的文件。
3.  攻击者可以利用该漏洞读取敏感文件，例如配置文件、密码文件等。
4.  攻击者还可以利用该漏洞上传恶意文件并执行，从而获得系统控制权。

提供的PoC利用方式是通过构造包含 `../` 的URL来进行目录遍历，读取 `/etc/passwd` 文件。实际攻击中，可以利用该漏洞执行更危险的操作，例如上传webshell或执行任意命令。

**项目地址:** [d4rk007/F5-Big-IP-CVE-2020-5902-mass-exploiter](https://github.com/d4rk007/F5-Big-IP-CVE-2020-5902-mass-exploiter)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)