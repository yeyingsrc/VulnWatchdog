## CVE-2019-8451-Jira-SSRF

**漏洞编号:** CVE-2019-8451

**漏洞类型:** 服务器端请求伪造(SSRF)

**影响应用:** Jira

**危害等级:** 高危，可能允许攻击者访问内部网络资源

**影响版本:** < 8.4.0

**利用条件:** 需要目标Jira实例存在/plugins/servlet/gadgets/makeRequest接口且版本低于8.4.0

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Jira 8.4.0之前的版本中。攻击者可以利用/plugins/servlet/gadgets/makeRequest接口，通过构造包含目标URL的特殊请求，绕过JiraWhitelist类的逻辑缺陷，从而发起SSRF攻击，访问内部网络资源。POC代码通过发送带有恶意构造的URL的GET请求到/plugins/servlet/gadgets/makeRequest接口，验证漏洞是否存在。该POC利用了Jira允许在URL中使用'@'字符的特性，将Jira服务器的URL放在'@'之前，将攻击者想要访问的内部URL放在'@'之后。如果Jira服务器成功返回攻击者指定URL的内容，则说明漏洞存在。

**利用方式:**

1.  确定目标Jira实例的版本低于8.4.0。
2.  使用POC脚本，提供目标Jira实例的URL和要访问的内部网络资源的URL。
3.  POC脚本将构造一个包含恶意URL的GET请求，并发送到/plugins/servlet/gadgets/makeRequest接口。
4.  如果成功返回内部网络资源的内容，则说明漏洞存在。

**投毒风险评估:**

仔细检查了提供的POC代码，没有发现任何明显的恶意代码或后门。所有代码都集中于利用SSRF漏洞。没有发现任何试图修改系统、安装恶意软件或执行其他未经授权的操作的迹象。因此，可以认为该POC代码的投毒风险很低，接近0%。

**有效性评估:**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。POC代码已经验证可以成功利用该漏洞访问内部网络资源。搜索引擎结果虽然为空，但是漏洞库信息和漏洞利用代码已经足够证明漏洞的存在和利用方法。

**项目地址:** [jas502n/CVE-2019-8451](https://github.com/jas502n/CVE-2019-8451)

**漏洞详情:** [CVE-2019-8451](https://nvd.nist.gov/vuln/detail/CVE-2019-8451)