## CVE-2025-20337 - Cisco ISE Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2025-20337

**漏洞类型:** 远程代码执行

**影响应用:** Cisco ISE 和 Cisco ISE-PIC

**危害等级:** 严重，未经身份验证的攻击者可以以root权限执行任意代码

**影响版本:** Cisco ISE: 3.1 到 3.3 Patch 6, 3.4 Patch 0-1; Cisco ISE-PIC: 所有受影响版本直至修复版本

**利用条件:** 需要网络访问到Cisco ISE/ISE-PIC设备的API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-20337 存在于 Cisco ISE 和 Cisco ISE-PIC 的特定 API 中，允许未经身份验证的远程攻击者以 root 身份在底层操作系统上执行任意代码。攻击者无需任何有效凭据即可利用此漏洞。

**利用方式：**
1.  **漏洞触发点：** 漏洞位于 StrongSwan tunnel API 端点，由于对用户提供的输入验证不足导致。
2.  **攻击过程：** 攻击者可以通过向 `/api/v1/strongswan/tunnel` 发送特制的 API 请求，包含恶意的序列化数据，触发反序列化漏洞。
3.  **漏洞影响：** 成功利用该漏洞可使攻击者获得受影响设备上的 root 权限，完全控制系统。

**POC分析：**
*   **有效性：** 提供的nuclei模板 `CVE-2025-20337.yaml` 旨在检测目标是否存在该漏洞。它首先尝试发送包含恶意序列化数据的请求到 `/api/v1/strongswan/tunnel` 端点，如果服务器返回错误信息（例如包含“deserialization”），则表明可能存在漏洞。同时，它还会检查返回状态码（200或401表示未授权访问，说明该端点可访问），并进行版本检测，如果版本在受影响范围内，则确认漏洞存在。该POC是有效的检测手段。
*   **投毒风险：** README中给出的修复方案较为明确，即升级到指定版本，没有发现明显的诱导用户执行恶意操作的部分。但是`CVE-2025-20337.yaml`中的 `tunnel_config` 字段包含`{{base64('{"malformed":"deserialization-probe-for-detection-only"}')}}`， 这部分payload有可能会被替换为恶意反序列化后门，所以存在一定的投毒风险。但是整体来看，这个仓库的目的是为了快速验证漏洞，虽然存在被投毒的可能性，但是通过检查流量包内容能够发现可疑的payload，所以风险较低。`interactions` 部分被注释，属于检测用途，不包含恶意代码。
*   **总结：** 攻击者利用未经身份验证的API接口，发送包含恶意序列化数据的POST请求，触发反序列化漏洞，最终实现远程代码执行。提供的POC是有效的漏洞检测工具， 但存在一定的投毒风险，需要谨慎使用。



**项目地址:** [B1ack4sh/Blackash-CVE-2025-20337](https://github.com/B1ack4sh/Blackash-CVE-2025-20337)

**漏洞详情:** [CVE-2025-20337](https://nvd.nist.gov/vuln/detail/CVE-2025-20337)