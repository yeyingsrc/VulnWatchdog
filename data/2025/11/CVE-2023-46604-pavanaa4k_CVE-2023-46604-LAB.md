## CVE-2023-46604 - Apache ActiveMQ RCE (OpenWire Protocol)

**漏洞编号:** CVE-2023-46604

**漏洞类型:** 远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.15.16, < 5.16.7, < 5.17.6, < 5.18.3

**利用条件:** 需要网络访问 ActiveMQ 开放的 OpenWire 端口 (默认 61616)

**POC 可用性:** 是，但提供的代码仅用于检测和防御目的

**投毒风险:** 0%

## 详情

CVE-2023-46604 存在于 Apache ActiveMQ 的 OpenWire 协议中，允许未经身份验证的远程攻击者通过操纵序列化的类类型来执行任意代码。漏洞的利用方式是攻击者向 ActiveMQ 的 OpenWire 端口发送特制的恶意序列化数据，导致broker或client实例化classpath上的任意类，从而执行任意shell命令。

提供的漏洞利用代码实际上并非可直接利用的 PoC，而是一个用于理解、检测和防御该漏洞的实验室环境和工具。它包括：

*   **Lab Setup:**  ActiveMQ 的安装配置说明，重点在于确保 OpenWire 连接器可用。
*   **Detection (Wireshark):**  使用 Wireshark 抓包分析 OpenWire 协议流量的方法。
*   **Suricata Mitigation:**  使用 Suricata IDS 创建规则来检测恶意 OpenWire 流量，并提供了一个示例规则。

因此，提供的代码本身不包含任何可直接利用的后门或恶意代码，目的是帮助安全研究人员了解和防御该漏洞。

由于该代码专注于漏洞的检测和防御，而不是漏洞利用，因此不存在投毒风险。

**项目地址:** [pavanaa4k/CVE-2023-46604-LAB](https://github.com/pavanaa4k/CVE-2023-46604-LAB)

**漏洞详情:** [CVE-2023-46604](https://nvd.nist.gov/vuln/detail/CVE-2023-46604)