## CVE-2023-45612-JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XXE

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 需要Ktor应用启用了ContentNegotiation插件并使用默认的xml()序列化器，且目标服务器存在可读取的文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45612是JetBrains Ktor框架中存在的一个XML外部实体注入（XXE）漏洞。该漏洞影响Ktor 2.3.5之前的版本，当ContentNegotiation插件与默认的xml()序列化器一起使用时，默认XML解析器未配置为阻止外部实体的解析，导致攻击者可以读取服务器上的任意文件。

**有效性评估：**
提供的POC代码有效。README.md文件详细描述了漏洞原理、复现步骤和利用方法，并提供了可执行的示例代码和curl命令。

**投毒风险评估：**
仓库中存在作者隐藏的投毒代码的可能性较低。虽然存在一些潜在风险，例如Gradle脚本中的依赖项可能指向恶意仓库或包含恶意代码，但从提供的代码片段来看，没有明显的恶意行为。gradle.kts定义了kotlin和ktor的依赖，其中风险较高的是版本控制，但是指定版本也是为了复现漏洞，可以判定风险较低。因此，投毒风险评估为5%。

**利用方式：**
1.  攻击者向启用了ContentNegotiation插件的Ktor服务器的某个接收XML数据的端点发送包含恶意XML的请求。
2.  恶意XML中定义了外部实体，指向服务器上的敏感文件，例如/etc/passwd或应用程序的配置文件。
3.  Ktor服务器使用存在漏洞的XML解析器解析XML数据，并解析外部实体，导致服务器读取指定文件内容。
4.  服务器将读取到的文件内容返回给攻击者，造成敏感信息泄露。

**项目地址:** [razvanclaudiu/Ktor-XXE-PoC](https://github.com/razvanclaudiu/Ktor-XXE-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)