## CVE-2025-48060 - jq - Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-48060

**漏洞类型:** 栈缓冲区溢出

**影响应用:** jq

**危害等级:** 高危，可能导致拒绝服务或代码执行

**影响版本:** <= 1.7.1

**利用条件:** 需要能够向jq程序传递恶意构造的输入

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48060是jq命令行JSON处理器中的一个栈缓冲区溢出漏洞，存在于`jv_string_vfmt`函数中，由oss-fuzz的jq_fuzz_execute工具发现。漏洞位于 jv.c文件的第1456行 `void* p = malloc(sz);`。根据漏洞描述，攻击者可以利用此漏洞造成拒绝服务。给定的代码仓库像是对CVE-2025-48060 (堆缓冲区溢出，`jv_string_empty`) 的修复进行了反向移植。虽然仓库的目标是修复，但如果反向移植不正确，本身可能会引入新的漏洞，或者隐藏恶意代码。仔细检查该仓库中是否存在故意引入的漏洞非常重要。考虑到仓库描述，存在少量投毒的风险。利用方式是通过提供特制的JSON输入，触发`jv_string_vfmt`函数中的缓冲区溢出，导致程序崩溃或潜在的远程代码执行。

**项目地址:** [leorivass/jq-els-backport-cve-2025-48060](https://github.com/leorivass/jq-els-backport-cve-2025-48060)

**漏洞详情:** [CVE-2025-48060](https://nvd.nist.gov/vuln/detail/CVE-2025-48060)