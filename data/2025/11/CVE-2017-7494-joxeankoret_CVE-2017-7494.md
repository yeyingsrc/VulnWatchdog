## CVE-2017-7494-Samba-远程代码执行

**漏洞编号:** CVE-2017-7494

**漏洞类型:** 远程代码执行

**影响应用:** Samba

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.5.0 <= Samba < 4.6.4, 4.5.10, 4.4.14

**利用条件:** 可写共享目录

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7494 允许恶意客户端通过上传共享库到可写共享目录，然后导致服务器加载和执行该库，从而实现远程代码执行。漏洞存在于 Samba 3.5.0 及之后版本，直到 4.6.4, 4.5.10 和 4.4.14 之前。

**有效性：**
根据漏洞库信息，此漏洞存在有效的利用方式。存在公开的Exploit-DB链接（42084 和 42060），表明该漏洞已经被成功利用。

**投毒风险：**
提供的代码段是GNU通用公共许可证，不是漏洞利用代码本身，所以不能直接判断是否有投毒风险，但LICENSE的存在不代表没有投毒可能。真正的利用代码是否被植入恶意代码无法判断。因此，从提供的有限信息来看，投毒风险较低，大约为10%。

**利用方式：**
1.  **找到可写的共享目录：** 攻击者首先需要找到 Samba 服务器上配置为可写的共享目录。
2.  **上传恶意共享库：** 攻击者将包含恶意代码的共享库（例如，`.so`文件）上传到该可写共享目录。
3.  **触发加载恶意库：** 攻击者通过构造特定的路径，利用 Samba 的某些特性（可能是一个bug），诱使 Samba 服务器加载并执行该共享库。

总而言之，攻击的关键在于找到可写共享目录以及触发服务器加载恶意共享库。


**项目地址:** [joxeankoret/CVE-2017-7494](https://github.com/joxeankoret/CVE-2017-7494)

**漏洞详情:** [CVE-2017-7494](https://nvd.nist.gov/vuln/detail/CVE-2017-7494)