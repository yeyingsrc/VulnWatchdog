## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)