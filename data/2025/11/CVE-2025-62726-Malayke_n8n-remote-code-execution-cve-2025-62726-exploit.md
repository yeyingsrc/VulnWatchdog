## CVE-2025-62726-n8n-远程代码执行

**漏洞编号:** CVE-2025-62726

**漏洞类型:** 远程代码执行

**影响应用:** n8n

**危害等级:** 高危，可能导致系统完全控制和数据泄露

**影响版本:** < 1.113.0

**利用条件:** 需要能够创建和运行n8n workflow，并访问Git Node

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于n8n的Git Node中。攻击者可以通过创建一个包含恶意Git pre-commit hook的仓库，然后利用n8n的Git Node克隆该仓库，并执行Git commit操作，从而触发恶意hook，导致远程代码执行。

**有效性：**
提供的POC代码有效。它展示了如何通过n8n的Git Node，克隆一个包含恶意pre-commit hook的Git仓库，并通过修改Git配置来触发该hook的执行，最终实现远程代码执行。

**投毒风险：**
该仓库的投毒风险较低，约为10%。风险主要来源于以下几个方面：
1.  攻击者需要fork POC的payload repo仓库并更改`githooks/pre-commit` 文件。这意味着，若原payload repo的拥有者事先在 `githooks/pre-commit` 文件中埋藏恶意代码，后续所有fork此payload repo的攻击者，在没有检查的情况下直接使用，则可能造成安全事件。

**利用方式：**
1.  攻击者fork包含恶意pre-commit hook的Git仓库。
2.  攻击者创建一个新的n8n workflow，导入提供的JSON文件。
3.  攻击者修改workflow JSON文件中的仓库地址为fork后的恶意仓库地址。
4.  攻击者运行该workflow，Git Node会克隆恶意仓库，并通过设置`core.hooksPath`来指定hook的路径。
5.  当workflow执行Git commit操作时，恶意pre-commit hook会被触发，执行攻击者预设的任意代码。
6. 攻击者可以通过Burp Suite Collaborator或任何其他OAST工具捕获命令执行输出，验证漏洞。

**搜索引擎结果：**
没有提供有效的搜索引擎结果，因此依赖漏洞库信息和POC代码进行分析。

**项目地址:** [Malayke/n8n-remote-code-execution-cve-2025-62726-exploit](https://github.com/Malayke/n8n-remote-code-execution-cve-2025-62726-exploit)

**漏洞详情:** [CVE-2025-62726](https://nvd.nist.gov/vuln/detail/CVE-2025-62726)