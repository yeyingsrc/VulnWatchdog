## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到目标设备。 需安装adb工具。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0044 是 Android PackageInstallerService.java 中的 createSessionInternal 函数中的一个权限提升漏洞。该漏洞允许攻击者执行“run-as any app”攻击，从而导致本地权限提升，而无需用户交互。漏洞原因是由于 createSessionInternal 函数中存在不正确的输入验证。 

**有效性：**
提供的POC代码似乎是有效的，因为它引用了 Meta security 的研究文章和 Tiny hack 的 PoC 摘要。它提供了一个利用该漏洞的步骤和示例。

**投毒风险：**
该仓库中可能存在作者隐藏的投毒代码的风险较低。 代码中主要为利用脚本和说明文档，风险评估为5%。

**利用方式：**
1.  启用 USB 调试或无线调试。
2.  使用给定的参数运行提供的 Python 脚本（`cve_2024_0044.py -P <package_name> -A <apk_file_path>`）。
3.  该脚本会生成一个 `payload.txt` 文件。
4.  使用 `adb shell` 连接到目标设备。
5.  将 `payload.txt` 中的内容粘贴到 `adb shell` 中执行。
6.  如果所有命令都成功执行，将会收到“Success”消息。

**项目地址:** [0xbinder/CVE-2024-0044](https://github.com/0xbinder/CVE-2024-0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)