## CVE-2025-20260 ClamAV PDF Scanning Buffer Overflow

**漏洞编号:** CVE-2025-20260

**漏洞类型:** 堆缓冲区溢出

**影响应用:** ClamAV

**危害等级:** 严重，可能导致拒绝服务或远程代码执行

**影响版本:** 1.4.2, 1.4.1, 1.4.0, 1.3.2, 1.3.1, 1.3.0, 1.2.3, 1.2.2, 1.2.1, 1.2.0

**利用条件:** 需要ClamAV扫描恶意PDF文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-20260是ClamAV PDF扫描处理中的一个堆缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的PDF文件触发此漏洞，导致拒绝服务或潜在的任意代码执行。提供的Python POC代码 `clamshank.py` 旨在生成触发此漏洞的恶意PDF文件。该脚本通过创建一个包含超长 ASCII85 编码数据流的 PDF 文件来实现溢出，`Length` 字段被设置为很大的值（1073741824），数据流使用 `hS?8M` 重复填充，其目的是创建远大于预期缓冲区的大小的数据。由于没有发现额外的后门代码，可以判断投毒风险为0%。利用方式是：攻击者制作恶意PDF文件，受害者使用存在漏洞的ClamAV版本扫描该文件，ClamAV处理该PDF时，由于缓冲区溢出，程序崩溃或者被攻击者利用执行恶意代码。

**项目地址:** [keyuraghao/CVE-2025-20260](https://github.com/keyuraghao/CVE-2025-20260)

**漏洞详情:** [CVE-2025-20260](https://nvd.nist.gov/vuln/detail/CVE-2025-20260)