## CVE-2025-54110 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-54110

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本范围广泛，详见CVE描述

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54110 是一个Windows Kernel中的整数溢出漏洞，存在于`NtQueryDirectoryObject`函数中。当用户调用此函数时，如果精心构造`BufferLength`参数，可能导致整数溢出，进而导致内存损坏，最终实现本地权限提升。

**有效性：**
根据提供的POC代码，它尝试通过`NtQueryDirectoryObject`函数触发整数溢出。代码首先初始化必要的NTDLL函数，然后打开一个Directory Object。关键在于`PreciseOverflowExploit`函数和`PrecisionBsodThread`函数，它们都尝试使用不同的`BufferLength`值（`precise_thresholds`和`thread_thresholds`）调用`NtQueryDirectoryObject`，期望导致内存损坏并最终触发访问冲突（`STATUS_ACCESS_VIOLATION`），从而验证漏洞的存在。如果确实触发了访问冲突，则认为漏洞存在。

**投毒风险：**
代码本身具有潜在的风险，但没有明显的投毒后门。不过，存在一些可疑点，因此给出10%的投毒可能性：
*   **硬编码的内存地址：** 代码中存在硬编码的内存地址，如`0x5050505000000000`，这可能导致程序在某些系统上崩溃，或者被用于绕过某些安全机制。这种行为不是标准的漏洞利用方式，存在恶意利用的可能。
*   **精度尝试阈值：** 设置不同的阈值进行多次尝试，本身就是测试系统是否存在的某些特征，有可能被利用来做一些不好的事情
*   **BsodThread 蓝屏线程:** 存在一个单独的线程函数，虽然目的是触发蓝屏，但同样增加了代码复杂性，且蓝屏可能被恶意利用，例如用于拒绝服务。

总体来说，POC代码的主要目的是演示漏洞，但是代码中存在一些不确定的因素，在实际使用时需要谨慎评估。

**利用方式：**
1.  **查找目标函数：** 攻击者需要找到易受攻击的`NtQueryDirectoryObject`函数。
2.  **构造恶意参数：** 攻击者需要构造一个会导致整数溢出的`BufferLength`参数。`precise_thresholds`和`thread_thresholds`提供了几个可能的溢出阈值。
3.  **触发溢出：** 调用`NtQueryDirectoryObject`，并传入精心构造的参数，触发整数溢出。
4.  **内存损坏：** 整数溢出会导致内存损坏，攻击者可以利用此损坏来覆盖关键的内核数据结构。
5.  **权限提升：** 通过覆盖内核数据结构，攻击者可以提升自己的权限。

**项目地址:** [canomer/CVE-2025-54110-Kernel-EoP-PoC](https://github.com/canomer/CVE-2025-54110-Kernel-EoP-PoC)

**漏洞详情:** [CVE-2025-54110](https://nvd.nist.gov/vuln/detail/CVE-2025-54110)