## CVE-2025-64484-oauth2-proxy-header-smuggling

**漏洞编号:** CVE-2025-64484

**漏洞类型:** HTTP Header Smuggling

**影响应用:** oauth2-proxy

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 7.13.0

**利用条件:** OAuth2-Proxy部署在应用程序前端，应用程序将HTTP Header中的下划线转换为破折号。需要经过身份验证的用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-64484 描述了 OAuth2-Proxy 中的一个 HTTP 头部走私漏洞。该漏洞允许经过身份验证的用户通过注入带有下划线的 `X-Forwarded-*` 头部来绕过代理的过滤逻辑，从而可能提升在上游应用程序中的权限。具体来说，如果上游应用将 HTTP 头部中的下划线转换为破折号（例如，使用 WSGI 的 Django, Flask, FastAPI 和 PHP 应用），那么攻击者可以利用这一点。例如，注入 `X_Forwarded-For` 头部，因为 OAuth2-Proxy 默认可能只过滤 `X-Forwarded-For`。由于提供的漏洞利用代码仅包含一个 README.md 文件，且内容仅仅是 CVE编号，因此，它本身不包含任何利用代码或恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **前提条件：** 目标系统使用 OAuth2-Proxy 作为反向代理，且后端应用会将 HTTP 头部字段中的下划线转换为短横线。
2.  **攻击步骤：** 经过身份验证的攻击者构造包含 `X_Forwarded-*` 形式的 HTTP 请求头（例如 `X_Forwarded_For`）。
3.  **绕过代理：** OAuth2-Proxy 未能正确过滤带有下划线的头部字段。
4.  **权限提升：** 后端应用将 `X_Forwarded_For` 和 `X_Forwarded-For` 视为相同，导致攻击者可以伪造客户端 IP 地址，或者利用其他 `X-Forwarded-*` 头部进行权限提升。

**有效性：** 提供的 POC 代码（README.md文件）本身不包含任何实际的利用代码，因此无法直接验证漏洞的有效性。 但是，根据漏洞描述和CVSS评分，以及其包含CWE-644，可以判断此漏洞的真实存在性。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-64484](https://github.com/B1ack4sh/Blackash-CVE-2025-64484)

**漏洞详情:** [CVE-2025-64484](https://nvd.nist.gov/vuln/detail/CVE-2025-64484)