## CVE-2023-25136-OpenSSH-Double-Free

**漏洞编号:** CVE-2023-25136

**漏洞类型:** Double-Free

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 9.1

**利用条件:** 目标服务器运行OpenSSH 9.1，且允许未授权的SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-25136 是 OpenSSH 9.1 中存在的一个 double-free 漏洞。根据漏洞描述，该漏洞存在于options.kex_algorithms处理过程中。未授权的远程攻击者可以利用此漏洞跳转到sshd地址空间的任何位置，理论上可能导致远程代码执行。

**有效性评估：**

提供的PoC代码 `cve-2023-25136.py` 本身并不能直接利用 double-free 漏洞进行代码执行。它仅仅是一个版本检测工具，用于判断目标服务器是否运行着受漏洞影响的 OpenSSH 9.0 或 9.1 版本。该脚本使用 `paramiko` 库连接到目标服务器，执行 `ssh -V` 命令来获取 OpenSSH 版本信息，然后将获取的版本与已知的易受攻击的版本进行比较，如果版本匹配，则会发出警告。

虽然 PoC 本身没有直接利用漏洞，但是确定目标服务器是否受到影响是利用漏洞的前提步骤，因此 PoC 是有一定价值的。

**投毒风险分析：**

阅读 `cve-2023-25136.py` 的代码，该脚本主要功能是进行 SSH 连接并获取版本信息，没有发现任何恶意的、与漏洞利用无关的代码。该脚本没有执行任何系统命令或文件操作，因此几乎不存在作者隐藏的投毒代码的风险。

**利用方式分析：**

根据漏洞信息，CVE-2023-25136 是一个 double-free 漏洞，发生在 OpenSSH 9.1 的密钥交换算法处理过程中。理论上，利用此漏洞可以跳转到 `sshd` 进程地址空间中的任意位置。但是，成功实现远程代码执行并非易事，需要精巧的内存布局控制和ROP链构建。

**总结：**

提供的PoC代码仅用于检测目标服务器的 OpenSSH 版本，不能直接利用 CVE-2023-25136 漏洞。 投毒风险极低。 漏洞的利用方式是利用double-free漏洞进行内存操作，从而跳转到sshd地址空间的任何位置，理论上可实现远程代码执行。

**项目地址:** [mrmtwoj/CVE-2023-25136](https://github.com/mrmtwoj/CVE-2023-25136)

**漏洞详情:** [CVE-2023-25136](https://nvd.nist.gov/vuln/detail/CVE-2023-25136)