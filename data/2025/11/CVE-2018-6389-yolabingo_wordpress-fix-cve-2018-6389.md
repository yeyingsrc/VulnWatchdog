## CVE-2018-6389-WordPress-拒绝服务

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 中危，可能导致网站无法访问

**影响版本:** <= 4.9.2

**利用条件:** 无需认证，可以通过构造恶意请求触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6389 漏洞允许未经验证的攻击者通过发送大量请求来加载 `wp-admin/load-scripts.php` 文件中注册的 JavaScript 文件，从而导致服务器资源耗尽，最终造成拒绝服务攻击。

**有效性:**
根据漏洞信息，该漏洞存在于 WordPress 4.9.2 及更早版本中。攻击者利用 `wp-includes/script-loader.php` 文件中注册的 JavaScript 文件列表构造大量请求，导致服务器资源消耗殆尽，从而造成拒绝服务攻击。漏洞利用代码中包含缓解此漏洞的 Apache RewriteRule，其目的是阻止未经身份验证的用户访问 `wp-admin/load-scripts.php`，从而减轻 DoS 攻击。

**投毒风险:**
提供的代码仓库包含一个 Apache RewriteRule，旨在缓解 CVE-2018-6389 漏洞。该规则通过 `.htaccess` 或 Apache 配置文件阻止未经身份验证的用户访问 `wp-admin/load-scripts.php`。审查代码后，没有发现任何恶意或隐藏的代码，因此投毒风险较低。代码的主要目的是提供一种缓解措施，而不是利用漏洞。

**利用方式:**
1.  攻击者首先获取 WordPress 站点使用的 JavaScript 文件列表 (`wp-includes/script-loader.php`)。
2.  构造包含大量 JavaScript 文件的请求，并发送到 `wp-admin/load-scripts.php`。
3.  由于 WordPress 默认加载所有请求的 JavaScript 文件，服务器需要消耗大量资源来处理这些请求。
4.  通过发送大量此类请求，攻击者可以耗尽服务器资源，导致网站无法访问。该漏洞利用方式的缓解措施是使用提供的 `apache-rewrite` 规则，该规则会阻止未经身份验证的用户访问 `wp-admin/load-scripts.php`。

**项目地址:** [yolabingo/wordpress-fix-cve-2018-6389](https://github.com/yolabingo/wordpress-fix-cve-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)