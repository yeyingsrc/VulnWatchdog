## CVE-2020-0192

**漏洞编号:** CVE-2020-0192

**漏洞类型:** 信息泄露

**影响应用:** Android

**危害等级:** 中危，可能导致远程信息泄露

**影响版本:** Android-10

**利用条件:** 需要用户交互，例如播放特制的H.264视频

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0192 漏洞存在于 Android 10 的 ih264d_decode_slice_thread 函数中（ih264d_thread_parse_decode.c）。由于输入验证不充分，导致可能存在越界读取。攻击者需要诱使用户播放特制的 H.264 视频文件才能触发该漏洞，从而导致信息泄露。

**漏洞利用分析：**
漏洞利用代码展示了 `ih264d_process_pslice.c` 文件的一部分，其中包含 `ih264d_mv_pred_ref_tfr_nby2_pmb` 函数。虽然提供的代码片段本身没有明显的恶意代码，但该函数涉及到宏块的MV预测和参考帧的转移，如果攻击者可以控制输入数据，就有可能导致读取超出缓冲区边界的数据。`ih264d_decode_slice_thread` 函数没有提供，因此不能确定完整的利用链。 但是，CVE描述中提及`ih264d_decode_slice_thread`在 `ih264d_thread_parse_decode.c`文件内。 `ih264d_mv_pred_ref_tfr_nby2_pmb`函数很可能是被`ih264d_decode_slice_thread`调用。

**有效性评估：**
漏洞库信息明确指出漏洞存在于Android 10，且需要用户交互。提供的代码片段虽然不能直接证明漏洞的可利用性，但它展示了可能存在越界读取的函数。漏洞利用的有效性取决于攻击者构造恶意H.264视频的能力，以及对输入数据的控制程度。通过提供特制的slice数据，控制mv参数，导致内存越界读取从而泄露信息

**投毒风险分析：**
代码片段中未发现明显的恶意代码，但是由于H.264解码器的复杂性，很难完全排除潜在的投毒风险。例如，攻击者可能通过巧妙地构造输入数据，触发未知的代码路径，从而执行恶意操作。此外，由于只提供了部分代码，无法对整个代码库进行全面的安全审计。

**利用方式总结：**
攻击者需要构造一个特制的H.264视频文件，该视频文件包含精心设计的slice数据，特别是涉及宏块MV预测和参考帧转移的部分。当Android设备解码该视频时，`ih264d_decode_slice_thread` 函数会调用相关函数，由于输入验证不足，导致越界读取，从而泄露敏感信息。用户交互是触发该漏洞的必要条件。

**项目地址:** [himanshu67111/CVE-2020-0192](https://github.com/himanshu67111/CVE-2020-0192)

**漏洞详情:** [CVE-2020-0192](https://nvd.nist.gov/vuln/detail/CVE-2020-0192)