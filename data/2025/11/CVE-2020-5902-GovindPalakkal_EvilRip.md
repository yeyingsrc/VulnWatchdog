## CVE-2020-5902-F5 BIG-IP TMUI RCE

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP Traffic Management User Interface (TMUI)

**危害等级:** 高危，可能导致完全控制受影响的BIG-IP系统

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要能够访问BIG-IP TMUI的管理端口（通常是443或8443），且目标系统未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5902是一个存在于F5 BIG-IP TMUI中的远程代码执行漏洞。攻击者可以通过构造特殊的HTTP请求，利用未公开的页面进行目录遍历和文件读取，最终执行任意代码。提供的POC代码`cve-checker.sh`通过发送带有目录遍历的请求到`/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp`并尝试读取`/etc/passwd`文件来验证漏洞是否存在。如果成功读取到包含"root"字符串的内容，则判断目标系统为易受攻击状态。

**有效性：**根据漏洞库信息和提供的POC代码，该漏洞是有效的，并且存在公开的利用代码。

**投毒风险：** 代码主体功能为漏洞检测，核心逻辑是发送HTTP请求并检查响应，没有明显的恶意操作。但`cve-checker.sh`脚本使用`curl`命令，存在一定的投毒风险。例如，如果攻击者控制了DNS，可能会导致curl解析到恶意的IP地址。尽管如此，直接在代码中发现后门的可能性较低，投毒风险估计为10%。

**利用方式：** 漏洞利用方式主要包括以下步骤：

1.  **确定目标：** 确定运行易受攻击的F5 BIG-IP版本的系统。
2.  **发送恶意请求：** 构造包含目录遍历的HTTP请求，例如：
    ```
    GET /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd HTTP/1.1
    ```
3.  **验证漏洞：** 检查响应，如果成功读取到`/etc/passwd`的内容，则表明系统存在漏洞。
4.  **执行任意代码：** 利用目录遍历漏洞，上传恶意文件（例如Webshell）或者执行其他命令，从而获取系统控制权。

**项目地址:** [GovindPalakkal/EvilRip](https://github.com/GovindPalakkal/EvilRip)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)