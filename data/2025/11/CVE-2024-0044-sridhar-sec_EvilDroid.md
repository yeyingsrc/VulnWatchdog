## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要已安装的恶意APK，无需用户交互

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-0044 是 Android PackageInstallerService 中的一个权限提升漏洞。由于输入验证不当，攻击者可以通过创建恶意的安装会话，以任何应用程序的身份运行代码，从而导致本地权限提升。根据漏洞库信息，该漏洞利用不需要额外的执行权限，且不需要用户交互。漏洞影响Android 12, 12L, 13, 14 和 15。

提供的漏洞利用代码 `evildroid.py` 旨在自动化利用此漏洞的过程。该脚本通过以下步骤工作：

1.  **连接ADB设备检测：** 检查连接的 ADB 设备并验证连接。
2.  **APK 安装：**将恶意的 APK 文件推送到目标设备并安装。
3.  **Payload执行：** 根据应用程序的 UID 生成并执行有效负载。

**有效性：**

根据漏洞库信息和提供的利用代码，此漏洞利用是有效的。漏洞描述明确指出由于不正确的输入验证，攻击者可以模拟任何应用程序。

**投毒风险：**

分析提供的 `evildroid.py` 脚本，发现以下潜在的投毒风险：

*   **隐蔽的恶意代码：** 虽然脚本的主要功能是利用 CVE-2024-0044，但攻击者可能会在代码中插入额外的恶意代码，例如：
    *   **后门：** 在受感染的设备上安装后门，允许攻击者远程访问。
    *   **数据窃取：** 秘密窃取设备上的敏感数据，例如联系人、短信、照片等。
    *   **DDoS攻击：** 将设备用作僵尸网络的一部分，参与分布式拒绝服务攻击。
*   **依赖项投毒：** 虽然`requirements.txt` 文件不存在，假设存在，攻击者可以篡改该文件，引入包含恶意代码的依赖项。

投毒风险评估：20%。此评估基于以下因素：

*   **代码的可读性：** 提供的代码相对简单，易于审查，降低了隐藏恶意代码的难度。
*   **攻击者的动机：** 攻击者可能会为了扩大攻击范围或窃取更多数据而选择投毒。
*   **利用的复杂性：** 利用本身相对复杂，需要一定的技术水平，这可能会降低攻击者投毒的意愿，因为他们更倾向于专注于漏洞利用本身。

**利用方式：**

1.  **准备恶意APK：** 攻击者创建一个包含恶意 Payload 的 APK 文件。Payload 旨在利用 CVE-2024-0044 漏洞，提升权限并执行恶意操作。
2.  **连接目标设备：** 攻击者通过 ADB 连接到目标 Android 设备。这可能需要设备启用 USB 调试。
3.  **运行漏洞利用代码：** 攻击者运行 `evildroid.py` 脚本，并提供目标包名和恶意 APK 的路径。
4.  **利用漏洞：** 该脚本利用 CVE-2024-0044 漏洞，将恶意 APK 安装到设备上，并以目标应用程序的权限运行 Payload。这允许攻击者执行各种恶意操作，例如安装后门、窃取数据或执行任意代码。

**项目地址:** [sridhar-sec/EvilDroid](https://github.com/sridhar-sec/EvilDroid)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)