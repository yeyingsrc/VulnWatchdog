## CVE-2025-53772-Web Deploy-反序列化RCE

**漏洞编号:** CVE-2025-53772

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Web Deploy

**危害等级:** 高危，允许未授权的攻击者通过网络执行任意代码

**影响版本:** 10.0.2000 (不包含 10.0.2001)

**利用条件:** 需要网络访问Web Deploy服务，且攻击者需要具备一定的权限(Authenticated attacker)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-53772是一个Web Deploy中的反序列化漏洞，攻击者可以利用该漏洞通过发送特制的序列化数据，在目标系统上执行任意代码。根据提供的漏洞库信息，漏洞影响Web Deploy 4.0版本 10.0.2000 (不包含 10.0.2001)。

提供的POC代码是一个C#程序，它利用.NET的反序列化漏洞生成payload。

**利用方式：**
1.  **构造恶意对象：** POC代码首先创建一个`SortedSet<string>`对象，并使用一个自定义的`IComparer<string>`实例。这个`IComparer<string>`实例基于一个委托`Comparison<string>`，该委托初始指向`String.Compare`方法，并被多次组合。
2.  **替换委托目标：** POC代码使用反射修改委托的调用列表(`_invocationList`)，将其中一个委托的目标替换为`Process.Start`方法。这使得在反序列化时，`SortedSet<string>`进行比较操作时会调用`Process.Start`。
3.  **设置命令参数：** `SortedSet<string>`中添加了两个字符串，第一个是"cmd.exe"，第二个是执行curl命令的payload, 用于发送攻击者构造的包含hostname,user,ip, exploit信息的POST请求。
4.  **序列化恶意对象：** POC代码使用`BinaryFormatter`将构造好的`SortedSet<string>`对象序列化成二进制数据。
5.  **压缩和编码：** 将序列化的数据使用GZip压缩，然后进行Base64编码。
6.  **输出Payload:** 最后，POC代码输出Base64编码后的字符串，这个字符串就是最终的漏洞利用payload，攻击者需要将此payload发送给存在漏洞的Web Deploy服务器。

**有效性：**
POC代码似乎有效，因为它创建了一个能够执行任意命令的序列化对象，并将其压缩编码为可传输的格式。攻击者只需要将此payload发送到存在漏洞的Web Deploy服务器，Web Deploy反序列化该对象时，将执行攻击者预设的命令。

**投毒风险：**
经过分析，该POC代码主要是利用反序列化漏洞执行命令，命令内容是收集部分系统信息，然后发送到攻击者的服务器。虽然这个行为本身有一定风险，但没有发现明显的投毒代码。因此，投毒风险较低，可以评估为0%。虽然POC本身会将数据发送到外部webhook，但这属于漏洞验证的范畴，不是投毒。代码逻辑清晰，没有发现其他隐藏的恶意行为。

**项目地址:** [SleepNotF0und/CVE-2025-53772-IIS-WebDeploy-RCE-POC](https://github.com/SleepNotF0und/CVE-2025-53772-IIS-WebDeploy-RCE-POC)

**漏洞详情:** [CVE-2025-53772](https://nvd.nist.gov/vuln/detail/CVE-2025-53772)