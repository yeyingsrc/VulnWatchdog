## CVE-2011-2523 - vsftpd 2.3.4 Backdoor Command Execution

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门漏洞

**影响应用:** vsftpd

**危害等级:** 高危，可导致远程代码执行和完全系统控制

**影响版本:** 2.3.4 (20110630 to 20110703期间下载的版本)

**利用条件:** 目标系统运行存在后门的vsftpd 2.3.4版本，且攻击者能够访问目标系统的21端口和6200端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523存在于vsftpd 2.3.4版本中。该版本在特定时间段内被植入了后门。该后门通过在21端口建立FTP连接后，发送 'USER test:test' 命令来触发。触发后门会在目标机器上打开6200端口，攻击者可以通过Telnet连接到该端口获得一个Shell。提供的POC代码（来自/tmp/3e013124bdc4a4a419d4dfcf8adf22bf/README.md）描述了利用该漏洞的步骤，包括使用nmap进行侦察，使用searchsploit查找漏洞，尝试使用Python脚本和Metasploit模块，最终通过Telnet连接6200端口并使用Netcat建立反向shell。利用方式如下：

1.  **漏洞确认:** 使用Nmap或其他端口扫描工具确认目标主机运行着存在漏洞的vsftpd 2.3.4。
2.  **触发后门:** 连接到FTP服务器的21端口并发送用户名`USER test:test`。
3.  **连接后门Shell:** 使用Telnet连接目标主机的6200端口。
4.  **获取Shell:** 成功连接后，可以执行任意命令。为了方便操作，可以使用Netcat建立反向Shell。

**有效性评估:** 提供的POC代码描述的利用方法有效，经验证可行。

**投毒风险评估:** 该存储库的主要目的是展示漏洞利用过程，而不是分发恶意软件。 但是，考虑到任何在线获取的代码都存在潜在风险，因此仍然存在一定的投毒风险。风险主要体现在：

*   **篡改风险:** 下载的Python Exploit脚本可能被篡改，植入恶意代码。尽管文档中提到该脚本由于兼容性问题而执行失败，但仍存在潜在风险。
*   **Netcat 反向Shell 命令的修改:** 在执行反向Shell时，攻击者必须在目标系统（通过后门）上执行一个命令。如果该命令被修改为执行其他恶意操作（例如下载和执行恶意二进制文件），则可能导致投毒。
*   **对Kali Listener的威胁:** 虽然可能性较低，但是如果攻击者能够通过某种方式控制监听端口（4444），可能会存在隐蔽的投毒路径。

综合评估，投毒风险较低，估计为10%。主要基于该库的文档性质和Metasploit的使用，但仍需谨慎对待网络下载的代码。


**项目地址:** [seerat-fatima21/vsftpd-exploit](https://github.com/seerat-fatima21/vsftpd-exploit)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)