## CVE-2020-5902-F5 BIG-IP-TMUI 远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP TMUI (Traffic Management User Interface)

**危害等级:** 高危，可导致完全控制受影响的 F5 BIG-IP 设备

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 目标设备运行受影响版本的 F5 BIG-IP，且 TMUI 界面可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-5902 是 F5 BIG-IP TMUI 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的 HTTP 请求到易受攻击的 TMUI 页面来执行任意系统命令。漏洞存在于多个版本的 BIG-IP 中，影响很大。提供的 exploit.sh 脚本包含两个主要的利用方式：

1.  **读取文件：**  脚本尝试读取 `/etc/passwd` 文件。这是为了证明目录遍历和文件读取的能力。攻击者可以修改 `fileName` 参数来读取其他敏感文件。
2.  **命令执行：**  脚本通过 `tmshCmd.jsp` 执行 `list auth user admin` 命令。这允许攻击者枚举管理员用户，但更重要的是，它演示了远程命令执行的能力。可以修改 `command` 参数来执行其他任意命令。脚本通过目录遍历 `../` 绕过身份验证。

**有效性：** 提供的 PoC 代码是有效的，因为它利用了目录遍历漏洞来访问未经授权的 JSP 页面，并执行任意命令和读取文件。

**投毒风险：** 该仓库中的投毒风险较低。从提供的代码来看，脚本功能明确，没有发现明显的恶意代码或后门。但是，永远不能完全排除作者添加隐藏的恶意代码的可能性，但从代码本身来看，风险较低，可以初步评估为5%。风险主要来自于运行未经充分审查的第三方脚本。

**利用方式：** 攻击者首先需要确定目标 F5 BIG-IP 设备的 TMUI 界面是否可访问，并且运行着受影响的版本。然后，攻击者可以使用类似 PoC 脚本中所示的 HTTP 请求，利用目录遍历漏洞访问 `tmshCmd.jsp` 或 `fileRead.jsp` 页面，执行任意命令或读取文件。 成功利用此漏洞可以使攻击者完全控制受影响的 BIG-IP 设备，从而导致数据泄露、服务中断或进一步的网络渗透。

**项目地址:** [haisenberg/CVE-2020-5902](https://github.com/haisenberg/CVE-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)