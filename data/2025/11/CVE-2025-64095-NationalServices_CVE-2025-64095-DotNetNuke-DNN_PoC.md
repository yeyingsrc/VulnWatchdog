## CVE-2025-64095-DNN-文件上传导致站点内容覆盖

**漏洞编号:** CVE-2025-64095

**漏洞类型:** 文件上传

**影响应用:** DNN.Platform

**危害等级:** 高危，可能导致网站被篡改、XSS攻击、甚至远程代码执行

**影响版本:** < 10.1.1

**利用条件:** 无需认证，需要能够访问DNN站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的用户上传文件，并覆盖站点上现有的文件。POC代码首先检测目标站点是否存在此漏洞，然后创建恶意PNG图片或者svg的XSS payload文件，上传这些文件到目标站点的指定目录，覆盖现有文件。一旦文件被成功覆盖，攻击者可以篡改网站的内容或者执行XSS攻击。由于`overrideFiles`参数设置为1，因此可以覆盖现有的文件。POC代码包含检测漏洞、上传文件和验证文件是否成功上传的功能。

**有效性评估：**

根据提供的漏洞信息和POC代码，该POC代码可以有效利用此漏洞，在未经身份验证的情况下上传文件并覆盖现有文件。

**投毒风险评估：**

分析POC代码，未发现明显的投毒代码。POC代码主要用于检测漏洞、生成恶意文件和上传文件。所有操作都是为了利用漏洞，没有额外的恶意行为。

**利用方式：**

1.  **漏洞检测：** 使用`detect_vulnerability`函数检测目标站点是否存在CVE-2025-64095漏洞。该函数通过向`FileUploader.ashx`发送POST请求，检查响应状态码和内容，来判断是否存在未经授权的文件上传。
2.  **恶意文件创建：** 使用`create_png_file`函数创建包含特定内容的PNG文件，或者使用`create_svg_xss`函数创建包含XSS payload的SVG文件。这些文件将被用于覆盖目标站点上的现有文件。
3.  **文件上传：** 使用`upload_file`函数将创建的恶意文件上传到目标站点的`FileUploader.ashx`。该函数发送POST请求，其中包含要上传的文件和一些参数，例如`storageFolderID`、`portalID`和`overrideFiles`。
4.  **文件验证：** 使用`verify_file`函数验证上传的文件是否成功覆盖目标站点上的现有文件。该函数尝试访问多个可能的URL路径，检查响应状态码和内容长度，以确认文件是否已成功上传。

总而言之，该漏洞允许攻击者上传任意文件，覆盖现有站点文件，从而导致网站被篡改，或者通过上传包含XSS payload的SVG文件来执行跨站脚本攻击。

**项目地址:** [NationalServices/CVE-2025-64095-DotNetNuke-DNN_PoC](https://github.com/NationalServices/CVE-2025-64095-DotNetNuke-DNN_PoC)

**漏洞详情:** [CVE-2025-64095](https://nvd.nist.gov/vuln/detail/CVE-2025-64095)