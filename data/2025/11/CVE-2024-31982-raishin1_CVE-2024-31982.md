## CVE-2024-31982-XWiki-远程代码执行

**漏洞编号:** CVE-2024-31982

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** XWiki Platform

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.4-milestone-1 < 14.10.20, 15.0-rc-1 < 15.5.4, 15.6-rc-1 < 15.10-rc-1

**利用条件:** 需要XWiki平台运行在受影响的版本，且数据库搜索功能未被禁用或修补

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-31982 存在于 XWiki 平台的 DatabaseSearch 功能中。攻击者可以利用该漏洞通过构造恶意的搜索文本，在服务器上执行任意代码。根据漏洞库信息，此漏洞影响未经身份验证的访客用户，使得攻击者可以远程执行代码，严重威胁服务器的机密性、完整性和可用性。

漏洞利用方式：
1.  攻击者发送包含恶意 Groovy 脚本的特殊构造的 HTTP GET 请求到 `/bin/get/Main/DatabaseSearch` 接口。
2.  恶意脚本被 XWiki 服务器执行，导致远程代码执行。
3.  `exploit.py` 脚本首先尝试自动登录 XWiki，然后循环提示用户输入要执行的命令，并将该命令嵌入到恶意 URL 中发送到服务器，最终获得命令执行结果。

有效性评估：
提供的 POC 代码 `exploit.py` 看起来有效。它自动化了登录过程，并允许用户通过命令行界面执行任意命令。该脚本使用 `requests` 库发送 HTTP 请求，并且正确地 URL 编码了命令，这对于成功利用该漏洞至关重要。

投毒风险评估：
分析 `exploit.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是利用漏洞执行命令。它没有尝试修改系统文件、安装恶意软件或者执行任何与 RCE 相关的其他恶意行为，风险系数为 0%。文件 `README.md` 只是描述该漏洞。

**项目地址:** [raishin1/CVE-2024-31982](https://github.com/raishin1/CVE-2024-31982)

**漏洞详情:** [CVE-2024-31982](https://nvd.nist.gov/vuln/detail/CVE-2024-31982)