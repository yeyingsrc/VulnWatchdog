## CVE-2025-6440 - WooCommerce Designer Pro 未授权任意文件上传

**漏洞编号:** CVE-2025-6440

**漏洞类型:** 任意文件上传

**影响应用:** WooCommerce Designer Pro

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.26

**利用条件:** 目标安装了 WooCommerce Designer Pro 插件，且版本不高于 1.9.26

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息，WooCommerce Designer Pro 插件存在未授权任意文件上传漏洞。POC代码通过模拟HTTP请求，绕过文件类型验证，上传恶意PHP文件。由于'wcdp_save_canvas_design_ajax'函数缺少文件类型验证，未经身份验证的攻击者可以上传任意文件到服务器，从而可能执行远程代码。 

**有效性分析：**
提供的POC代码是基于Python编写的，旨在利用 CVE-2025-6440 漏洞，通过向易受攻击的 WooCommerce Designer Pro 插件发送恶意请求来上传任意文件，例如PHP webshell。利用代码结构完整，包括 banner 输出，参数解析，文件读取，payload生成，请求发送以及结果保存等环节，具备漏洞利用的完整流程。

**投毒风险分析：**
POC代码存在一定的投毒风险，主要体现在以下几个方面：
1.  **Shell 文件来源：** 代码中指定了本地shell文件名为`shell.php`。如果用户使用了攻击者提供的`shell.php`文件，该文件可能包含恶意代码。
2.  **代码混淆与隐藏：** 虽然代码整体结构清晰，但部分函数名称较长，存在一定的迷惑性，可能隐藏恶意行为。代码中虽然使用了`urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)`禁用警告，但是并没有使用任何混淆代码，故判断有10%的概率包含投毒。
3.  **结果文件：**  攻击成功后会将结果保存至 `success_results.txt` 和 `uploaded_shells.txt`。这些文件可能被攻击者利用进行进一步攻击或信息收集。

**利用方式：**
1.  **目标确定：**  攻击者需要找到安装了 WooCommerce Designer Pro 插件且版本不高于 1.9.26 的 WordPress 站点。
2.  **准备恶意文件：**  准备包含恶意代码的 PHP 文件，例如 webshell，并将其命名为 shell.php。
3.  **运行 POC：**  运行提供的 Python 脚本，指定目标 URL 和线程数。
4.  **上传利用：**  脚本将利用漏洞上传 shell.php 文件到目标服务器。
5.  **远程控制：**  攻击者可以通过访问上传的 shell.php 文件，执行任意命令，控制目标服务器。

**防范建议：**
1.  **更新插件：**  将 WooCommerce Designer Pro 插件更新到最新版本，修复漏洞。
2.  **文件上传限制：**  限制上传文件类型，仅允许上传安全的文件类型。
3.  **安全扫描：**  定期对 WordPress 站点进行安全扫描，及时发现并修复漏洞。
4.  **使用安全可靠的 Shell 文件：** 如果必须使用 Shell 文件，请确保其来源可靠，并仔细检查其内容，避免引入恶意代码。

**项目地址:** [Nxploited/CVE-2025-6440](https://github.com/Nxploited/CVE-2025-6440)

**漏洞详情:** [CVE-2025-6440](https://nvd.nist.gov/vuln/detail/CVE-2025-6440)