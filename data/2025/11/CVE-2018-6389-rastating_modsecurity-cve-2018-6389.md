## CVE-2018-6389-WordPress-DoS

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致网站无法访问

**影响版本:** <= 4.9.2

**利用条件:** 无需身份验证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6389 是 WordPress 4.9.2 及之前版本中的一个拒绝服务漏洞。未经身份验证的攻击者可以利用 wp-includes/script-loader.php 中注册的大量 .js 文件列表，构造一系列请求来多次加载每个文件，从而消耗服务器资源并导致拒绝服务。

**有效性：**
提供的 POC 代码是一个 ModSecurity 规则，用于检测潜在的 CVE-2018-6389 攻击。它通过检测请求 URI 中是否包含 `/wp-admin/load-scripts.php` 并且 `load[]` 参数重复超过20次来进行判断，从而拦截恶意请求。这个规则是有效的，因为它可以帮助防御针对该漏洞的攻击。

**投毒风险：**
此存储库中的代码不太可能包含投毒代码。只有两个文件：一个README.md（提供漏洞信息和链接）和一个ModSecurity规则配置文件。ModSecurity规则本身是防御性的，用于阻止攻击，而不是执行恶意操作。因此，投毒风险极低。

**利用方式：**
1.  攻击者构造包含大量重复 `load[]` 参数的请求，例如：`/wp-admin/load-scripts.php?load[]=jquery&load[]=jquery-migrate&load[]=underscore&load[]=backbone&load[]=jquery&load[]=jquery-migrate&load[]=underscore&load[]=backbone&load[]=jquery&load[]=jquery-migrate&load[]=underscore&load[]=backbone&load[]=jquery&load[]=jquery-migrate&load[]=underscore&load[]=backbone&load[]=jquery&load[]=jquery-migrate&load[]=underscore&load[]=backbone&load[]=jquery&load[]=jquery-migrate&load[]=underscore&load[]=backbone`。请求中的 javascript 文件可以是任意 `wp-includes/script-loader.php` 中注册的文件。
2.  WordPress 会尝试加载所有请求的文件，这会消耗大量的服务器资源（CPU 和内存）。
3.  攻击者重复发送此请求，最终导致服务器资源耗尽，网站无法访问。

ModSecurity 规则通过限制包含大量重复 `load[]` 参数的请求来缓解此漏洞。如果请求包含超过20个由逗号分隔的 `load[]` 参数，则 ModSecurity 将阻止该请求。

**项目地址:** [rastating/modsecurity-cve-2018-6389](https://github.com/rastating/modsecurity-cve-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)