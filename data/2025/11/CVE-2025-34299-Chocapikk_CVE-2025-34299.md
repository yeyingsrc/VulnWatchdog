## CVE-2025-34299 - Monsta FTP Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-34299

**漏洞类型:** 任意文件上传

**影响应用:** Monsta FTP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 2.11

**利用条件:** 目标Monsta FTP实例可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Monsta FTP 2.11及更早版本中，允许未经身份验证的攻击者上传任意文件。攻击者可以通过上传恶意构造的文件（例如，包含PHP代码的文件）到Monsta FTP服务器，然后通过访问该文件来执行任意代码。漏洞利用方式：

1.  攻击者搭建一个恶意的FTP服务器，该服务器会提供包含恶意代码的文件。
2.  攻击者利用Monsta FTP的`downloadFile`功能，从恶意FTP服务器下载文件到Monsta FTP服务器。
3.  Monsta FTP服务器没有对下载的文件类型进行充分验证，导致恶意文件被保存。
4.  攻击者通过Web访问上传的恶意文件，触发恶意代码执行，从而获得服务器的控制权。

根据提供的漏洞利用代码，该代码尝试利用此漏洞，并提供了一个 Docker 环境来方便测试。该漏洞利用代码通过启动一个恶意的 FTP 服务器，然后诱导 Monsta FTP 下载包含反弹 shell 代码的文件来执行任意代码。在评估投毒风险时，发现此漏洞利用程序相对直接。通过分析代码，恶意行为如篡改系统文件或未经授权访问其他资源的可能性较低。但是，由于漏洞利用程序涉及到下载和执行文件，存在一定的风险，攻击者可能会修改漏洞利用程序以包含额外的恶意功能。因此，我们估计投毒风险为5%。

**项目地址:** [Chocapikk/CVE-2025-34299](https://github.com/Chocapikk/CVE-2025-34299)

**漏洞详情:** [CVE-2025-34299](https://nvd.nist.gov/vuln/detail/CVE-2025-34299)