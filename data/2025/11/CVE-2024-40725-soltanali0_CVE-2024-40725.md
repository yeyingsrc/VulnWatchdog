## CVE-2024-40725-Apache HTTP Server-源码泄露

**漏洞编号:** CVE-2024-40725

**漏洞类型:** 源码泄露

**影响应用:** Apache HTTP Server

**危害等级:** 中危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.4.61

**利用条件:** 需要目标服务器开启了受影响版本的Apache HTTP Server，且存在使用AddType等配置不当的情况。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-40725是Apache HTTP Server 2.4.61中CVE-2024-39884的部分修复绕过漏洞，允许攻击者在特定条件下通过AddType配置不当导致源码泄露。提供的漏洞利用代码`detect_smuggling.py`实际上是尝试利用HTTP请求走私技术来绕过某些安全限制，虽然其目的并不是直接利用CVE-2024-40725本身，但HTTP请求走私可能导致类似源码泄露的结果。漏洞利用方式为：

1.  **发送畸形请求**：利用代码构造一个包含`Transfer-Encoding: chunked`和`Content-Length: 0`的HTTP请求，试图走私一个额外的GET请求。
2.  **目标路径Fuzzing**：代码针对指定URL的多个路径进行测试，使用wordlist爆破的方式进行探测。
3.  **状态码比对**：通过比对正常请求和走私请求的状态码，来判断是否存在漏洞，如果状态码发生改变（例如从403变为200），则认为存在潜在的漏洞。

**有效性评估：** 虽然漏洞利用代码并不是直接复现CVE-2024-40725，但通过尝试HTTP请求走私来绕过权限验证，间接可能导致源码泄露，在特定配置下是有效的。

**投毒风险评估：** 代码本身主要功能是进行HTTP请求走私检测，但存在潜在的投毒风险。比如，该代码可以轻易被修改，加入恶意代码，例如：

*   **修改请求内容**：篡改走私的GET请求，例如发送包含恶意JavaScript的请求，如果服务器允许上传文件，则可能上传恶意文件。
*   **记录敏感信息**：将探测到的URL、状态码等信息发送到攻击者控制的服务器。
*   **资源消耗**：通过大量发送请求消耗目标服务器资源，造成拒绝服务攻击。

因此，在没有仔细审查的情况下，直接使用该代码存在一定的投毒风险，可能性约为10%。


**项目地址:** [soltanali0/CVE-2024-40725](https://github.com/soltanali0/CVE-2024-40725)

**漏洞详情:** [CVE-2024-40725](https://nvd.nist.gov/vuln/detail/CVE-2024-40725)