## CVE-2020-5902-F5 BIG-IP TMUI RCE

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP TMUI

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 需要网络访问BIG-IP的TMUI管理界面（通常在443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-5902 存在于 F5 BIG-IP 的 Traffic Management User Interface (TMUI) 中，允许未经身份验证的攻击者执行任意代码。漏洞原因是TMUI在处理特定URL时存在目录遍历漏洞，结合其他未公开的漏洞，最终实现RCE。

**有效性：**

提供的PoC代码是有效的。它展示了如何利用目录遍历漏洞读取系统文件（例如`/etc/passwd`、`/etc/hosts`、`/config/bigip.conf`）。虽然只展示了文件读取，但漏洞库信息表明其根本原因是 RCE，文件读取是利用链中的一部分。Nmap脚本`script-rce.nse`也验证了漏洞的存在性，它尝试读取`/etc/passwd`来确定目标是否容易受到攻击。

**投毒风险：**

分析提供的脚本和说明文档，投毒风险较低，约为5%。
*   `README.md` 文件主要提供漏洞描述和PoC示例，未发现恶意代码。
*   `script-rce.nse` 文件是一个 Nmap 脚本，用于检测目标是否存在 CVE-2020-5902 漏洞。该脚本的行为是发送包含目录遍历的HTTP请求到目标服务器，并检查响应中是否包含 `/etc/passwd` 的内容。脚本本身的功能是检测漏洞，而并非利用漏洞执行恶意操作。唯一潜在的风险是，如果攻击者修改了这个脚本，可能会增加扫描流量，但这不是典型的“投毒”。这个脚本的作者和贡献者均有署名,降低了投毒的可能性。

**利用方式：**

1.  **目录遍历：** 通过构造包含 `../` 的恶意 URL，绕过TMUI的访问控制，访问受限目录下的文件。
2.  **文件读取：** 利用目录遍历漏洞读取敏感文件，例如 `/etc/passwd`, `/config/bigip.conf` 等，获取系统信息和配置。
3.  **命令执行：**  通过访问例如`/tmui/locallb/workspace/tmshCmd.jsp` 并提供command参数，可以执行任意的 tmsh 命令，最终实现远程代码执行。

攻击者可以通过精心构造的 URL，在目标系统上执行任意命令，从而完全控制系统。可以组合文件上传和文件包含漏洞进行更复杂的利用。

**综上所述，**该漏洞的利用方式主要是利用目录遍历读取文件，再结合其他未公开的漏洞，执行任意代码。


**项目地址:** [dnerzker/CVE-2020-5902](https://github.com/dnerzker/CVE-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)