## CVE-2023-38831-WinRAR-RCE

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开特制的ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞允许攻击者通过特制的ZIP压缩文件在目标系统上执行任意代码。该漏洞的根源在于WinRAR在处理包含与文件同名文件夹的ZIP文件时存在缺陷。攻击者可以构造一个 ZIP 文件，其中包含一个良性文件（例如.JPG）和一个与其同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的恶意代码。此PoC脚本生成一个ZIP文件，其中包含诱饵文件(bait file)和恶意脚本(script file)，并修改ZIP文件的文件头，以利用此漏洞。脚本创建与诱饵文件同名的文件夹，并将恶意脚本放入其中。然后，将诱饵文件的副本也放入ZIP文件中。通过替换文件名字段中的某些字符，WinRAR会将文件夹中的恶意文件误认为是要执行的文件，最终导致代码执行。由于代码仅仅是构造payload，不存在主动执行恶意代码，因此不存在投毒风险。

**项目地址:** [anelya0333/Exploiting-CVE-2023-38831](https://github.com/anelya0333/Exploiting-CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)