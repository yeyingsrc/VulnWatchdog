## CVE-2022-31199-Netwrix Auditor-远程代码执行

**漏洞编号:** CVE-2022-31199

**漏洞类型:** 反序列化漏洞

**影响应用:** Netwrix Auditor

**危害等级:** 高危，未经身份验证的远程攻击者可以以 NT AUTHORITY\SYSTEM 权限执行任意代码，完全控制系统。

**影响版本:** < 10.5

**利用条件:** 目标系统运行Netwrix Auditor，并且 TCP 端口 9004 开放。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-31199 是 Netwrix Auditor 10.5 之前版本中存在的一个严重的反序列化漏洞。该漏洞存在于 TCP 端口 9004 上未受保护的 .NET Remoting 服务中。未经身份验证的远程攻击者可以向 UAVRServer 端点提交任意对象，从而以 NT AUTHORITY\SYSTEM 权限执行远程代码。此漏洞已被 Truebot 恶意软件活动等威胁行为者积极利用。提供的漏洞利用代码包含 Nuclei 模板，用于检测漏洞的存在。README.md 文件描述了漏洞的详细信息，并提供了利用该漏洞的 Python 和 PowerShell 脚本的链接。这些脚本需要 ysoserial.net 和 ExploitRemotingService 等工具来生成和发送恶意 .NET 对象。Payload执行之后,获取服务器的system权限。存在投毒风险,但是主要是利用工具链的下载安装过程,被替换成恶意软件,该仓库本身的代码风险较低。

**项目地址:** [developerfred/CVE-2022-31199](https://github.com/developerfred/CVE-2022-31199)

**漏洞详情:** [CVE-2022-31199](https://nvd.nist.gov/vuln/detail/CVE-2022-31199)