## CVE-2025-60715 Windows RRAS 堆缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2025-60715

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Windows Routing and Remote Access Service (RRAS)

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括Windows 10, 11, Server 2012/R2, 2016, 2019, 2022, 和 2025的特定版本

**利用条件:** 需要网络访问RRAS服务端口(例如，L2TP的1701端口)，以及有效的身份验证凭据。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-60715 是一个 Windows RRAS（路由和远程访问服务）中的堆缓冲区溢出漏洞，允许经过身份验证的攻击者通过网络远程执行代码。该漏洞的利用方式如下：

1.  **身份验证:** 攻击者需要首先使用有效的用户名和密码对 RRAS 服务进行身份验证。PoC代码中使用了 impacket 库处理 SMB/RPC 身份验证。
2.  **缓冲区构造:** 攻击者构造一个特制的网络数据包，该数据包在 RRAS 服务处理时会触发堆缓冲区溢出。PoC代码使用 scapy 库来构造这个恶意数据包。溢出目标是 RRAS 中的特定堆结构，通过覆盖指针来获得控制权。
3.  **触发漏洞:** 攻击者将构造的恶意数据包发送到目标 RRAS 服务，触发堆缓冲区溢出漏洞，实现远程代码执行。PoC代码中默认配置为建立反向shell，从而控制受害者系统。

**有效性：** 提供的PoC代码表明该漏洞是可利用的，可以在受影响的系统上实现远程代码执行。然而，该PoC强调某些缓解措施（如DEP或ASLR）可能会阻止利用，并且需要针对特定环境进行测试。

**投毒风险：** 考虑到PoC代码需要使用者设置监听IP和端口来接收反向shell，本身不包含明显的恶意代码，但是，从[Download POC From Here](https://tinyurl.com/mctnfhmx)下载的PoC可能存在投毒风险，例如捆绑其他恶意软件或后门，故风险评估为20%。因为从未知来源下载可执行代码总是存在潜在风险。详细分析需要审查实际下载的代码内容。如果PoC代码仅仅是`README.md`中描述的那些，那么投毒风险较低，因为主要的攻击逻辑都在Python脚本中体现，易于审计。

**项目地址:** [velmetrac/CVE-2025-60715](https://github.com/velmetrac/CVE-2025-60715)

**漏洞详情:** [CVE-2025-60715](https://nvd.nist.gov/vuln/detail/CVE-2025-60715)