## CVE-2014-9219 phpMyAdmin XSS漏洞

**漏洞编号:** CVE-2014-9219

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** phpMyAdmin

**危害等级:** 中危，可能导致用户信息泄露、会话劫持、恶意代码执行等

**影响版本:** 4.2.x before 4.2.13.1

**利用条件:** 用户需要访问包含恶意URL的链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-9219是phpMyAdmin 4.2.13.1之前版本中的一个XSS漏洞，存在于url.php文件的重定向功能中。攻击者可以通过`url`参数注入恶意JavaScript代码。漏洞原因是`url.php`使用`htmlspecialchars()`函数来过滤URL参数，但该函数主要用于HTML上下文，不能有效防止JavaScript字符串上下文中的XSS。提供的PoC通过构造包含`eval(atob('YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='))`的URL，绕过过滤，在受害者浏览器中执行`alert(document.domain)`。这说明攻击者可以获取受害者当前域名的信息，进一步可以进行会话劫持等攻击。该漏洞利用代码本身的功能较为清晰， 主要的功能是弹出当前document.domain,并没有发现恶意的后门代码，但依旧存在投毒风险，例如可能仓库所有者权限被盗用，然后仓库被植入恶意代码。根据经验判断，此类简单的XSS漏洞POC投毒可能性较低, 考虑到作者可能会利用一些代码混淆或隐藏的技术手段来掩盖恶意行为，因此判断投毒风险为10%。利用方式是诱导用户点击包含恶意构造的url参数的链接，从而在用户浏览器中执行恶意JavaScript代码。

**项目地址:** [MohmadHafiz/CVE-2014-9219](https://github.com/MohmadHafiz/CVE-2014-9219)

**漏洞详情:** [CVE-2014-9219](https://nvd.nist.gov/vuln/detail/CVE-2014-9219)