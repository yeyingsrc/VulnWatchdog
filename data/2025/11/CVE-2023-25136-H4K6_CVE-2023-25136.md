## CVE-2023-25136-OpenSSH-Double-Free

**漏洞编号:** CVE-2023-25136

**漏洞类型:** Double-Free

**影响应用:** OpenSSH

**危害等级:** 高危，理论上可导致远程代码执行

**影响版本:** 9.1

**利用条件:** 目标服务器运行 OpenSSH 9.1 且允许未授权连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-25136是OpenSSH 9.1中的一个双重释放漏洞，位于`options.kex_algorithms`处理过程中。未经验证的远程攻击者可以利用此漏洞跳转到`sshd`地址空间的任何位置，理论上可以实现远程代码执行。根据提供的利用代码分析如下:

1.  **有效性：**
提供的PoC代码的功能比较基础，`openssh-9_1.py`用于扫描指定IP列表，检查目标是否存在漏洞，原理是通过设置畸形的`SSH-2.0`版本信息来触发漏洞。`openssh-9_1-single_exploit.py`针对单个IP进行利用尝试，同样也是通过设置畸形的`SSH-2.0`版本信息来进行漏洞触发。从代码实现角度来看，这些PoC能够发送特制的请求，但**并不能直接实现远程代码执行**，可能只是用于验证漏洞存在。根据漏洞库信息，远程代码执行是“理论上可能”。真实的远程代码执行需要更复杂的利用手段。

2.  **投毒风险：**
仔细检查了提供的Python脚本，未发现明显的恶意代码，例如反向shell、文件上传等。主要的风险点在于，如果攻击者替换了脚本中的`client_id`变量，可能会导致目标拒绝服务或记录攻击者的IP地址。`openssh-9_1.py`脚本遍历IP列表，可能被滥用于大规模扫描，存在一定的风险。总体上来看，代码比较简洁，植入恶意代码的概率较低，但是仍然存在一定的风险，因此投毒风险评估为5%。

3.  **利用方式：**

   *   **漏洞触发：** PoC通过设置`transport.local_version`为一个特定的字符串，来触发OpenSSH服务器在处理密钥交换算法时发生的双重释放。
   *   **内存破坏：** 双重释放漏洞会导致内存损坏，允许攻击者控制一部分内存。
   *   **代码执行（理论）：** 攻击者可以利用内存控制能力，通过ROP（面向返回编程）等技术来执行任意代码。但是需要说明的是，提供的PoC并没有实现这一步，而只是验证漏洞的存在。

   利用的总体流程大致为：发送特制的SSH请求 -> 触发双重释放 -> 内存破坏 -> (理论上)控制程序流程 -> 执行恶意代码。

**项目地址:** [H4K6/CVE-2023-25136](https://github.com/H4K6/CVE-2023-25136)

**漏洞详情:** [CVE-2023-25136](https://nvd.nist.gov/vuln/detail/CVE-2023-25136)