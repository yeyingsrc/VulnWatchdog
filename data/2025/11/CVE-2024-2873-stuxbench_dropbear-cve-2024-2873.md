## CVE-2024-2873 - wolfSSH 用户认证绕过

**漏洞编号:** CVE-2024-2873

**漏洞类型:** 认证绕过

**影响应用:** wolfSSH

**危害等级:** 严重，可能导致未经授权的访问，完全控制受影响的系统

**影响版本:** <= v1.4.16

**利用条件:** 需要网络访问 wolfSSH 服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2873 漏洞存在于 wolfSSH 服务器端的有限状态机中，攻击者可以在用户认证之前创建 channel，绕过身份验证。提供的 Dockerfile 和 Python 脚本 `cve_2024_2873_pentest.py` 用于验证此漏洞。

**有效性分析：**

*   该 Python 脚本使用 `paramiko` 库建立 SSH 连接，并完成密钥交换。关键在于，在身份验证完成*之前*，脚本尝试使用 `transport._send_message` 发送 `SSH_MSG_CHANNEL_OPEN` 消息。如果服务器接受此消息，则表明存在漏洞，可以绕过身份验证。
*   `paramiko` 库的使用确保了 SSH 协议的正确处理，因此该 PoC 代码的有效性较高。

**投毒风险分析：**

*   `Dockerfile` 用于构建包含易受攻击的 wolfSSH 实例以及 PoC 代码的环境。它从 `stuxbench/dropbear-copy` 克隆 dropbear，这可能存在投毒风险。但是，该漏洞的 PoC 针对 wolfSSH，不是 dropbear。 *   `cve_2024_2873_pentest.py` 脚本的主要目的是验证 CVE-2024-2873 漏洞。审查显示，它专注于利用身份验证绕过漏洞，没有发现恶意或后门代码。该脚本的目的是验证目标系统是否存在漏洞，而不是引入新的安全风险。 *   检查 `pyproject.toml` 文件以及 `src/` 目录（虽然未提供内容），如果它们包含构建或运行阶段执行的恶意代码，也可能构成投毒。但仅凭现有信息，无法充分评估这些文件。
*  `rebuild-dropbear.sh`脚本可能隐藏恶意代码，但是此脚本主要针对dropbear进行重编译，与wolfSSH漏洞无关。

由于缺乏对 `src/` 目录和 `pyproject.toml` 文件的完整审查，无法完全排除投毒风险，但根据目前的信息，直接在 PoC 代码中发现投毒的概率为 0%。该仓库有可能被投毒的几率偏低。

**利用方式：**

1.  攻击者通过网络连接到目标 wolfSSH 服务器。
2.  攻击者使用 paramiko 库（或其他 SSH 客户端库）建立 SSH 连接，并完成密钥交换。
3.  *在完成身份验证之前*，攻击者构造并发送 `SSH_MSG_CHANNEL_OPEN` 消息。
4.  如果服务器接受此消息，则攻击者可以创建 channel，并执行未经授权的操作，而无需提供有效的用户名和密码。
5.  这可能允许攻击者执行任意命令，读取敏感数据，或完全控制受影响的系统。

**项目地址:** [stuxbench/dropbear-cve-2024-2873](https://github.com/stuxbench/dropbear-cve-2024-2873)

**漏洞详情:** [CVE-2024-2873](https://nvd.nist.gov/vuln/detail/CVE-2024-2873)