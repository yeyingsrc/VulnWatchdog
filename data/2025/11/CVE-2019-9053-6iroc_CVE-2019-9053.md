## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和控制服务器

**影响版本:** <= 2.2.9

**利用条件:** 需要网络访问目标CMS Made Simple网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中的一个未经验证的基于时间的盲SQL注入漏洞。攻击者可以通过构造恶意的URL，特别是通过News模块的`m1_idlist`参数，来利用此漏洞。由于是盲注，攻击者无法直接看到数据库返回的数据，而是通过观察服务器响应时间来推断信息。提供的漏洞利用代码（sqli.py）通过不断修改`m1_idlist`参数，构造包含`sleep()`函数的SQL语句，以此来探测数据库中的信息。脚本尝试提取数据库名、用户名、密码哈希（以及salt），并且可以选择使用字典进行密码破解。 

**有效性：**根据漏洞库信息和利用代码，该POC代码有效。漏洞库明确指出可以通过`m1_idlist`参数实现未经验证的基于时间的SQL注入。利用代码通过延时函数`sleep()`来判断SQL注入是否成功，从而逐步提取信息。 

**投毒风险：**代码主要功能是SQL注入利用，未发现明显恶意行为，例如文件上传、webshell写入等。但需要注意，该脚本会尝试破解管理员密码，这本身具有一定的攻击性。虽然代码中没有直接植入后门，但攻击者可能修改代码以添加恶意功能。 投毒风险评估为10%，主要考虑到攻击者可能修改此脚本以达到进一步的恶意目的，例如添加webshell上传等功能。由于该漏洞是SQL注入，理论上攻击者可以通过SQL注入执行任意操作，风险较高。

**利用方式：**

1.  **确定目标:**  确定运行着易受攻击的CMS Made Simple版本的网站。
2.  **构造恶意URL:**  构造包含恶意SQL语句的URL，利用`m1_idlist`参数。例如，`http://target/moduleinterface.php?mact=News,m1_,default,0&m1_idlist=...恶意SQL...`
3.  **利用时间延迟:**  利用`sleep()`函数，通过观察服务器响应时间来判断SQL注入是否成功。
4.  **信息提取:**  逐步提取数据库名、用户名、密码哈希（和salt）。
5.  **密码破解 (可选):**  使用字典破解密码哈希。

总而言之，该漏洞利用方式是通过构造包含时间延迟函数的恶意SQL语句，盲注获取敏感信息，并可能进一步破解密码，从而控制整个CMS系统。

**项目地址:** [6iroc/CVE-2019-9053](https://github.com/6iroc/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)