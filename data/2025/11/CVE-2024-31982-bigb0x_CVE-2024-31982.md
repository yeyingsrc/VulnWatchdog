## CVE-2024-31982-XWiki Platform-远程代码执行

**漏洞编号:** CVE-2024-31982

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 高危，可导致完全控制受影响的XWiki平台

**影响版本:** >= 2.4-milestone-1, < 14.10.20; >= 15.0-rc-1, < 15.5.4; >= 15.6-rc-1, < 15.10-rc-1

**利用条件:** 需要XWiki平台存在DatabaseSearch页面且未打补丁，默认情况下对所有用户开放。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-31982 存在于 XWiki Platform 的 DatabaseSearch 功能中。攻击者可以通过在搜索文本中注入恶意的 Groovy 脚本，从而执行任意代码。由于 DatabaseSearch 默认对所有用户开放（包括访客），攻击者无需认证即可利用此漏洞。提供的 POC 代码通过发送包含恶意 Groovy 代码的 GET 请求到 `/xwiki/bin/get/Main/DatabaseSearch` 路径来验证漏洞。POC代码首先尝试连接目标URL并检查响应状态码。如果状态码为200，它会检查响应体是否包含'Hello, World!'字符串，如果包含则确认存在漏洞。POC代码的投毒风险较低，主要集中在用户是否会未经审查直接使用该脚本进行自动化测试或攻击。`urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 禁用了SSL警告，这在某些情况下可能降低安全性，但不是直接的投毒行为。 漏洞利用方式是发送特制的HTTP GET请求，其中包含经过URL编码的恶意Groovy脚本，利用DatabaseSearch功能中未正确过滤的输入，最终执行注入的代码。

**项目地址:** [bigb0x/CVE-2024-31982](https://github.com/bigb0x/CVE-2024-31982)

**漏洞详情:** [CVE-2024-31982](https://nvd.nist.gov/vuln/detail/CVE-2024-31982)