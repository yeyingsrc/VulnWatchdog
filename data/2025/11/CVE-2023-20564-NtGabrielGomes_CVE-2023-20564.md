## CVE-2023-20564 - AMD Ryzen Master 驱动物理内存访问漏洞

**漏洞编号:** CVE-2023-20564

**漏洞类型:** 物理内存读写

**影响应用:** AMD Ryzen Master Driver

**危害等级:** 高危，可导致权限提升和系统崩溃

**影响版本:** < 2.11.2.2659

**利用条件:** 需要管理员权限安装驱动，并在Windows 10/11 (x64)环境下运行

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20564 漏洞存在于 AMD Ryzen Master 驱动中，由于驱动程序在处理 IOCTL (Input Output Control) 输入缓冲区时缺乏足够的验证，导致具有特权的攻击者可以执行任意物理内存读取/写入操作，从而可能导致机密性泄露或任意内核执行。

**漏洞利用方式：**

1.  安装受影响版本的 AMD Ryzen Master。
2.  利用提供的 PoC 代码，通过特定的 IOCTL (0x81112F08 读取物理内存，0x81112F0C 写入物理内存) 与驱动程序进行交互。
3.  PoC 代码允许指定物理地址和要读取/写入的数据大小。
4.  由于驱动程序没有充分验证物理地址和大小，攻击者可以读取或写入任意物理内存地址。
5.  成功利用此漏洞可能导致权限提升，允许攻击者执行内核级别的代码。

**有效性：**

根据提供的漏洞信息和 PoC 代码，该漏洞利用是有效的。PoC 代码明确展示了如何读取和写入任意物理内存地址，并且提供了验证读写操作的机制。

**投毒风险：**

虽然 PoC 代码主要用于演示漏洞利用，但仍然存在一些投毒风险：

*   **恶意修改：** 攻击者可能会修改 PoC 代码以包含恶意功能，例如安装后门或植入恶意软件。由于 PoC 代码需要管理员权限才能安装驱动，恶意代码也可能以系统权限运行，从而对系统造成严重损害。
*   **依赖项：**  如果 PoC 依赖于其他库或组件，这些依赖项可能包含恶意代码。
*   **免责声明：**  PoC 代码的免责声明表明作者不承担任何滥用责任。尽管这不是直接的投毒行为，但暗示了使用风险。

考虑到以上因素，投毒风险估计为 5%。主要风险在于用户在不了解代码的情况下直接使用或修改 PoC 代码。

**项目地址:** [NtGabrielGomes/CVE-2023-20564](https://github.com/NtGabrielGomes/CVE-2023-20564)

**漏洞详情:** [CVE-2023-20564](https://nvd.nist.gov/vuln/detail/CVE-2023-20564)