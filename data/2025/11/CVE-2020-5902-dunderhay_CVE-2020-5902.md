## CVE-2020-5902-F5 Big-IP-TMUI远程代码执行

**漏洞编号:** CVE-2020-5902

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** F5 Big-IP Traffic Management User Interface (TMUI)

**危害等级:** 高危，未经授权的攻击者可以通过发送特制的HTTP请求执行任意系统命令，导致系统完全被控制。

**影响版本:** 15.0.0-15.1.0.3, 14.1.0-14.1.2.5, 13.1.0-13.1.3.3, 12.1.0-12.1.5.1, 11.6.1-11.6.5.1

**利用条件:** 目标系统必须运行存在漏洞的F5 Big-IP版本，并且TMUI管理界面可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-5902漏洞存在于F5 Big-IP的TMUI组件中，允许未经身份验证的远程攻击者执行任意代码。该漏洞是由于TMUI处理用户输入时存在缺陷，攻击者可以通过构造特殊的URL，利用目录遍历和文件读取功能，最终执行系统命令。

**利用方式：**

1.  **目录遍历：** 攻击者通过`../`进行目录遍历，绕过访问限制。
2.  **文件读取：**  利用`fileRead.jsp`读取系统敏感文件，例如`/config/bigip.conf`，获取系统配置信息。
3.  **命令执行：**  利用`tmshCmd.jsp`执行任意的TMSH (Traffic Management Shell) 命令，从而控制整个系统。

**POC分析：**
提供的POC代码包含两个主要功能：LFR（本地文件读取）和RCE（远程代码执行）。
*   **LFR:**  POC脚本利用`fileRead.jsp`来读取目标服务器上的文件。攻击者可以指定任意文件路径，例如`/etc/passwd`或`/config/bigip.conf`。
*   **RCE:**  POC脚本利用`tmshCmd.jsp`来执行TMSH命令。攻击者可以执行诸如`list auth user admin`之类的命令来获取管理员用户信息，或者执行更危险的命令来控制系统。

**投毒风险评估：**
经过对POC代码的分析，未发现明显的投毒代码。脚本的主要功能是利用漏洞进行信息泄露和命令执行。脚本本身依赖`requests`和`urllib3`库，这些库是常见的Python库，未发现被篡改或包含恶意代码的迹象。因此，可以认为该POC代码的投毒风险较低。

**有效性：**
根据漏洞信息和提供的POC代码，可以判断该POC代码是有效的。漏洞库信息表明CVE-2020-5902是一个已知的且被积极利用的漏洞，而POC代码演示了如何利用该漏洞执行LFR和RCE攻击。CISA的KEV目录也收录了此漏洞，进一步验证了其有效性。

**项目地址:** [dunderhay/CVE-2020-5902](https://github.com/dunderhay/CVE-2020-5902)

**漏洞详情:** [CVE-2020-5902](https://nvd.nist.gov/vuln/detail/CVE-2020-5902)