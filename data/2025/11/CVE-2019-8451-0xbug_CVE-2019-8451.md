## CVE-2019-8451-Jira-SSRF

**漏洞编号:** CVE-2019-8451

**漏洞类型:** SSRF

**影响应用:** Jira

**危害等级:** 高危，允许远程攻击者访问内部网络资源

**影响版本:** < 8.4.0

**利用条件:** 需要Jira实例运行在受影响的版本上，并且攻击者能够访问`/plugins/servlet/gadgets/makeRequest`端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-8451是Atlassian Jira中的一个服务器端请求伪造（SSRF）漏洞，影响版本低于8.4.0。

**漏洞描述：**

该漏洞存在于`/plugins/servlet/gadgets/makeRequest`资源中。由于`JiraWhitelist`类中的逻辑错误，远程攻击者可以利用该漏洞访问内部网络资源的内容。

**利用方式：**

攻击者可以通过构造恶意的URL参数，例如`url=http://{}:{}@{}'.format(host, port, target)`，向`/plugins/servlet/gadgets/makeRequest`端点发送请求，从而使Jira服务器代表攻击者向指定的`target`地址发起请求。`host`和`port` 可以用来绕过某些类型的过滤。这允许攻击者读取内部服务（例如，元数据API或数据库）的内容，否则这些服务将无法从外部访问。

**有效性：**

提供的PoC代码是有效的。它演示了如何构造一个包含恶意URL的请求，该URL利用了SSRF漏洞。

**投毒风险：**

该存储库中提供的代码仅包含PoC，没有发现恶意代码或隐藏功能。因此，投毒风险评估为0%。 README.md文件仅包含CVE编号和指向Jira问题的链接。Python 代码片段展示了如何格式化 SSRF payload。没有发现注入恶意代码的迹象。

**漏洞利用方式总结：**

1.  确定目标Jira实例的版本低于8.4.0。
2.  构造一个包含恶意URL的请求，该URL指定要访问的内部资源，并将其发送到`/plugins/servlet/gadgets/makeRequest`端点。
3.  服务器将代表攻击者发起请求，并将响应返回给攻击者。例如，可以读取内部网络服务的 banner 信息。

**项目地址:** [0xbug/CVE-2019-8451](https://github.com/0xbug/CVE-2019-8451)

**漏洞详情:** [CVE-2019-8451](https://nvd.nist.gov/vuln/detail/CVE-2019-8451)