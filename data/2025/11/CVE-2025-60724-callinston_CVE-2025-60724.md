## CVE-2025-60724-GDI+ Remote Code Execution

**漏洞编号:** CVE-2025-60724

**漏洞类型:** Heap-based Buffer Overflow

**影响应用:** Microsoft GDI+

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的 Windows 和 Office 版本 (详见漏洞库信息)

**利用条件:** 需要目标系统解析恶意构造的图像文件 (如 EMF)。可能通过 SMB, RDP clipboard, web-based image delivery等途径利用。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-60724 是 Microsoft Graphics Component (GDI+) 中的一个堆缓冲区溢出漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码。 

**利用方式：**

1.  **漏洞原理：**  GDI+ 在处理特定图像格式时存在缺陷，攻击者可以构造一个包含恶意数据的图像文件，导致堆缓冲区溢出。
2.  **攻击步骤：**
    *   攻击者创建一个特制的图像文件 (如 EMF)。
    *   攻击者将该图像文件传递给目标系统，例如通过 SMB 共享，RDP 剪贴板，或者嵌入到网页中。
    *   目标系统尝试解析该图像文件时，GDI+ 组件会触发堆缓冲区溢出。
    *   溢出允许攻击者覆盖内存中的数据，包括函数指针或对象，从而控制程序的执行流程。
    *   攻击者可以注入恶意代码（shellcode）并执行，从而获得对目标系统的控制权。
3.  **利用代码分析：** 提供的POC代码使用Python编写，利用堆喷射技术来控制堆内存的布局，然后触发溢出，通过ROP链执行shellcode，建立反向TCP shell。

**投毒风险评估：**

虽然自述文件包含免责声明，但存储库中提供的`tinyurl.com`链接存在潜在风险。 该链接指向一个外部资源，这使得检查实际的漏洞利用文件非常困难，该链接可能包含恶意软件或其他与POC描述不符的有害代码。 

 由于缺乏对压缩包内容的直接审查，存在代码中包含后门的风险。 此外，作者使用 Protonmail 邮箱，且存储库没有其他贡献者，这增加了不确定性。 

**总结：**
该漏洞利用 PoC 具有很高的有效性潜力，因为漏洞信息明确指出是远程代码执行漏洞，且给出了详尽的受影响范围，利用代码也实现了反向 shell 功能。 但是，由于利用代码存储库托管在不受信任的来源上并缺少代码审查，因此存在中等程度的投毒风险。**建议在隔离环境中谨慎使用 PoC。**

**项目地址:** [callinston/CVE-2025-60724](https://github.com/callinston/CVE-2025-60724)

**漏洞详情:** [CVE-2025-60724](https://nvd.nist.gov/vuln/detail/CVE-2025-60724)