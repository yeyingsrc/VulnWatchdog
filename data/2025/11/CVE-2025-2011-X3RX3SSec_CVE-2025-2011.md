## CVE-2025-2011-Slider & Popup Builder by Depicter-SQL注入

**漏洞编号:** CVE-2025-2011

**漏洞类型:** SQL注入

**影响应用:** Slider & Popup Builder by Depicter

**危害等级:** 高危，可能导致敏感数据泄露

**影响版本:** <= 3.6.1

**利用条件:** 目标WordPress站点安装了受影响版本的Slider & Popup Builder插件，且允许未授权访问admin-ajax.php。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Slider & Popup Builder by Depicter插件中，允许未经过身份验证的攻击者利用`s`参数进行SQL注入。攻击者可以通过构造恶意的SQL查询，例如使用UNION SELECT语句，来提取数据库中的敏感信息，如用户密码哈希。

**有效性：**

根据提供的漏洞库信息和漏洞利用代码，此PoC代码是有效的。漏洞库信息明确指出该插件存在未经身份验证的SQL注入漏洞，而提供的Python脚本利用了这一漏洞，通过构造包含恶意SQL语句的URL来尝试提取用户密码哈希。

**投毒风险：**

PoC代码本身主要功能是利用SQL注入漏洞提取信息。以下是一些潜在的投毒风险分析：

*   `run_hashcat`函数调用了hashcat，如果hashcat未安装，PoC会提示，不会执行恶意操作。虽然hashcat本身是一个安全工具，但攻击者可能会利用用户对工具的不熟悉，诱导用户安装恶意版本的hashcat。
*   `extract_hashes`函数只是提取可能的哈希值，没有恶意操作。
*   脚本会将结果保存到本地文件，这本身不是恶意行为，但如果攻击者替换`results_{hostname}.txt` 内容为恶意内容，并诱导用户打开，可能存在社工风险。
*   **依赖风险**: PoC 依赖requests, colorama 等常见python库，但依赖的安装可能被篡改为恶意版本。

总体来说，直接嵌入恶意代码的风险较低（估计为10%）。更可能的风险在于利用社工手段，诱导用户执行恶意操作，例如安装恶意软件或泄露信息。

**利用方式：**

1.  **确定目标：** 找到安装了受影响版本Slider & Popup Builder插件的WordPress站点。
2.  **构造恶意URL：** 使用提供的Python脚本，通过`-u`参数指定目标URL，`-p`参数选择payload（PAYLOADS变量中的payload 1 或 payload 2）。脚本会生成包含恶意SQL注入语句的URL。
3.  **发送请求：** 脚本通过requests库向目标URL发送GET请求。
4.  **提取数据：** 如果漏洞存在，服务器会返回包含数据库信息的响应。脚本会提取可能的bcrypt哈希值。
5.  **破解哈希（可选）：** 脚本会提示是否使用Hashcat破解哈希。如果选择破解，脚本会自动调用Hashcat，并使用常用的rockyou.txt密码字典。
6.  **分析结果：** 脚本会将URL、状态码和响应片段保存到本地文件中，方便分析。

**注意事项：**

*   请勿在未经授权的系统上运行此PoC。
*   使用Hashcat破解哈希需要大量的计算资源和时间。
*   此PoC仅用于验证漏洞的存在，并提取用户密码哈希。攻击者可能利用此漏洞进行更严重的操作，例如修改数据库内容或执行任意代码。

**项目地址:** [X3RX3SSec/CVE-2025-2011](https://github.com/X3RX3SSec/CVE-2025-2011)

**漏洞详情:** [CVE-2025-2011](https://nvd.nist.gov/vuln/detail/CVE-2025-2011)