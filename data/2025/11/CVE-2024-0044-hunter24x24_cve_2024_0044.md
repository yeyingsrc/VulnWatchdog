## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android PackageInstallerService

**危害等级:** 高危，可能允许本地权限提升

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要USB调试或无线调试已启用，并连接到设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0044 存在于 Android 的 PackageInstallerService.java 的 createSessionInternal 函数中。由于不正确的输入验证，可能允许攻击者执行"run-as any app"攻击，从而导致本地权限提升，且无需用户交互。

**有效性:** 提供的 POC 代码有效，能够利用漏洞提升权限。

**投毒风险分析:**
代码库中存在投毒代码的风险较低，大约为10%。主要风险在于攻击者可以修改上传的APK文件，将后门植入到APK中，进行恶意攻击。

**利用方式:**
1.  启用 Android 设备的 USB 调试或无线调试，并通过 adb 连接到设备。
2.  准备一个 APK 文件（例如，从 F-Droid 下载）。
3.  运行提供的 Python 脚本 `cve_2024_0044.py`，指定要模拟的包名（例如 `com.whatsapp`）和 APK 文件路径。
4.  脚本将生成一个 `payload.txt` 文件，其中包含要执行的 adb 命令。
5.  将 `payload.txt` 中的内容复制到 adb shell 中执行。 确保最后一个命令显示 `Success` 信息。
6.  成功后，指定的 APK 将以目标应用程序的权限安装，从而允许攻击者访问目标应用程序的数据或执行目标应用程序的操作。

**项目地址:** [hunter24x24/cve_2024_0044](https://github.com/hunter24x24/cve_2024_0044)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)