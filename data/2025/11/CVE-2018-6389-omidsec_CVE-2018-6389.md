## CVE-2018-6389 - WordPress Denial of Service

**漏洞编号:** CVE-2018-6389

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** WordPress

**危害等级:** 高危，可能导致服务器资源耗尽，网站无法访问

**影响版本:** <= 4.9.2

**利用条件:** 无需身份验证，可远程触发

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6389 允许未经身份验证的攻击者通过发送大量请求来加载 WordPress 注册的 .js 文件，从而导致拒绝服务。

**有效性：**
提供的 Python 脚本通过构造包含大量 JavaScript 文件名的 URL 来利用此漏洞。它通过比较初始页面加载时间和攻击后的加载时间来检测漏洞。如果攻击后的加载时间显著增加，则表明目标容易受到攻击。因此，提供的 PoC 代码有效。

**投毒风险：**
分析提供的 PoC 脚本，发现其中包含一些常见的库导入，例如 `requests` 和 `colorama`。该脚本主要功能是发送 HTTP 请求，测量响应时间，并根据响应时间判断是否存在漏洞。其中存在极小的投毒风险，主要是因为使用了第三方的库，理论上存在被篡改的可能性。但是，脚本本身的功能比较明确，没有发现恶意行为。

**利用方式：**
1.  脚本获取目标 WordPress 网站的 URL。
2.  它构造一个包含大量 JavaScript 文件名的 URL，利用 WordPress 的 `load` 参数。
3.  脚本向目标网站发送两个 HTTP 请求：一个正常的请求和一个包含大量 JavaScript 文件名的恶意请求。
4.  它测量两个请求的响应时间，并计算响应时间的比率。
5.  如果响应时间的比率超过预定义的阈值，则脚本报告目标网站容易受到拒绝服务攻击。

**项目地址:** [omidsec/CVE-2018-6389](https://github.com/omidsec/CVE-2018-6389)

**漏洞详情:** [CVE-2018-6389](https://nvd.nist.gov/vuln/detail/CVE-2018-6389)