## CVE-2024-0044

**漏洞编号:** CVE-2024-0044

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可使攻击者以任意应用身份运行

**影响版本:** Android 12, 12L, 13, 14, 15

**利用条件:** 需要ADB调试权限和USB调试开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-0044 漏洞允许攻击者以任意应用身份运行，导致权限提升。该漏洞存在于 PackageInstallerService.java 的 createSessionInternal 函数中，由于未对输入进行适当的验证，攻击者可以绕过权限检查。提供的POC脚本利用 ADB 工具，首先构造包含恶意 payload 的 'pm install' 命令，该 payload 包含目标应用的UID信息，然后将一个APK文件推送到设备上，并执行该命令。该命令会尝试以目标应用的身份安装APK。成功后，脚本会创建一个临时目录，并使用 'run-as' 命令归档目标应用程序的数据目录。最后，脚本将归档的数据拉取到本地。通过这种方式，攻击者可以获取目标应用的数据，从而实现权限提升。

**有效性：** 根据漏洞信息和提供的POC代码，该POC代码是有效的，可以用来重现该漏洞。

**投毒风险：** 代码中没有明显的投毒代码。脚本主要利用了Android系统的漏洞进行权限提升，没有添加任何额外的恶意功能。主要行为是构造payload，推送文件，归档，拉取数据，所有行为均与漏洞利用相关。因此投毒风险为 0%。

**利用方式：**
1.  攻击者需要连接到目标Android设备并启用USB调试。
2.  攻击者构造包含目标应用UID信息的payload，并使用'pm install'命令进行安装。
3.  攻击者创建一个临时目录，并使用'run-as'命令以目标应用身份归档应用数据。
4.  攻击者将归档的应用数据拉取到本地进行分析或利用。

**项目地址:** [Dit-Developers/CVE-2024-0044-](https://github.com/Dit-Developers/CVE-2024-0044-)

**漏洞详情:** [CVE-2024-0044](https://nvd.nist.gov/vuln/detail/CVE-2024-0044)