## CVE-2025-25257-FortiWeb-SQL注入-RCE

**漏洞编号:** CVE-2025-25253

**漏洞类型:** SQL注入到远程代码执行

**影响应用:** FortiWeb

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** FortiWeb 7.6 (7.6.0 through 7.6.3), 7.4 (7.4.0 through 7.4.7), 7.2 (7.2.0 through 7.2.10), 7.0 (7.0.0 through 7.0.10)

**利用条件:** 需要能够访问 FortiWeb 实例的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 FortiWeb 中，源于一个未经身份验证的SQL注入漏洞（CVE-2025-25257）。该漏洞允许远程攻击者在目标系统上执行任意代码。提供的 PoC 代码首先通过 SQL 注入修改 token，然后利用修改后的 token 执行系统命令，反弹shell。PoC 代码通过将命令分块编码为十六进制字符串，并通过 SQL 注入的 `CONCAT` 函数将其连接起来。 该漏洞利用的有效性较高，因为PoC已经给出了详细的利用过程,利用过程比较清晰。

**投毒风险分析：**

虽然该代码的主要功能是利用 SQL 注入漏洞反弹 shell，但仍然存在一定的投毒风险。作者可能在以下几个方面隐藏恶意代码：

1.  **编码混淆：** 虽然PoC代码使用了hex编码,但是仍然存在通过更复杂的编码方式来隐藏恶意指令的可能性。
2.  **时间延迟：**  代码中可能包含 sleep 函数，可以在特定时间执行恶意操作，从而逃避检测。
3.  **条件触发：** 代码可能只在特定条件下触发恶意行为，例如，在特定IP地址或特定日期才执行恶意代码。

尽管存在上述风险，考虑到脚本的主要目的是反弹shell，因此投毒风险评为10%。大部分代码都是为了验证漏洞而编写。

**利用方式：**

1.  **目标确认：** 确定目标 FortiWeb 实例的版本是否在受影响的范围内。
2.  **参数配置：**  配置 PoC 脚本中的目标 URL (`--target`)、攻击者监听 IP 地址 (`--lhost`) 和端口 (`--lport`)。
3.  **命令执行：**  PoC 脚本会利用 SQL 注入漏洞执行预定义的命令，反弹 shell 到攻击者控制的机器上。
4.  **漏洞修复建议：**将 FortiWeb 版本升级到不受影响的版本（如 FortiWeb 7.6.4 或更高版本，7.4.8 或更高版本，7.2.11 或更高版本，7.0.11 或更高版本）。

**项目地址:** [onelittlectfer/CVE-2025-25253](https://github.com/onelittlectfer/CVE-2025-25253)

**漏洞详情:** [CVE-2025-25253](https://nvd.nist.gov/vuln/detail/CVE-2025-25253)