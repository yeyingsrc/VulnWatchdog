## CVE-2025-41244-VMware权限提升

**漏洞编号:** CVE-2025-41244

**漏洞类型:** 本地权限提升

**影响应用:** VMware Aria Operations, VMware Tools

**危害等级:** 高危，可能导致root权限获取

**影响版本:** VCF operations 9.0.x (< 9.0.1.0), VMware tools 13.x.x.x (< 13.0.5.0), 12.5.x (< 12.5.4), VMware Aria Operations, VMware Cloud Foundation, VMware Telco Cloud Platform 5.x, 4.x (< 8.18.5), VMware Telco Cloud Infrastructure 3.x, 2.x (< 8.18.5)

**利用条件:** 需要非管理员权限的本地账户，且安装了受影响版本的VMware Tools，Aria Operations启用了SDMP

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-41244是一个VMware Aria Operations和VMware Tools中的本地权限提升漏洞。攻击者需要首先拥有一个本地的非管理员账户，并且VM上安装了VMware Tools，同时Aria Operations启用了SDMP。漏洞利用通过编译并执行提供的C代码实现。该C代码模拟了一个HTTP服务器，当以'-v'或'-V'参数运行时，会打印版本信息并退出。如果没有参数，则直接将进程的UID和GID设置为0（root用户），然后执行/bin/sh，从而获得root shell。因此，该漏洞利用的有效性较高，如果满足前提条件，就可以成功提权。README.md 文件提供了编译、测试和利用该漏洞的步骤。该利用方式依赖于一个名为 `/tmp/httpd` 的可执行文件，该文件在没有参数的情况下运行会尝试提权。并没有发现明显的投毒代码。所有代码执行路径都在控制之中，并且执行的操作都与漏洞描述相符。因此，判断投毒风险为0%。

**漏洞利用方式：**
1.  **编译C代码：** 使用gcc将C代码编译成可执行文件`/tmp/httpd`。
2.  **赋予执行权限：** 使用chmod命令赋予`/tmp/httpd`可执行权限。
3.  **测试版本信息：** 运行`/tmp/httpd -v`或`/tmp/httpd -V`，确认程序可以正确打印版本信息。
4.  **执行提权操作：** 在满足漏洞前提条件的环境下，运行`/tmp/httpd &`，该程序会将进程的UID和GID设置为0，然后执行/bin/sh，从而获得root shell。


**项目地址:** [IBO-ATTACKS/CVE-2025-41244](https://github.com/IBO-ATTACKS/CVE-2025-41244)

**漏洞详情:** [CVE-2025-41244](https://nvd.nist.gov/vuln/detail/CVE-2025-41244)