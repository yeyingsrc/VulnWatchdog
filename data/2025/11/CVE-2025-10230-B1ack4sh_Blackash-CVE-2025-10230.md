## CVE-2025-10230 - Samba WINS Hook Command Injection

**漏洞编号:** CVE-2025-10230

**漏洞类型:** 命令注入

**影响应用:** Samba

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** < 4.21.9, 4.22.0 < 4.22.5, 4.23.0 < 4.23.2

**利用条件:** 需要目标系统运行受影响版本的Samba，并且启用了WINS服务器功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-10230是一个Samba的命令注入漏洞，位于WINS服务器的hook脚本处理中。漏洞原因是由于NetBIOS名称在传递给shell之前没有经过适当的验证或转义。攻击者可以通过发送特制的WINS注册数据包，将恶意命令注入到由Samba进程执行的shell命令中，从而实现远程代码执行。攻击者无需身份验证即可利用此漏洞。提供的POC代码`/tmp/3dfb58991396dc8e70e0e3ceeac7d5f0/README.md`本身只包含一个简单的README文件，说明存在可用的PoC，但PoC具体实现未提供。投毒风险较低，仅为5%，因为提供的代码仅仅是描述文件，不包含任何实际的利用代码。利用方式：

1.  攻击者构建一个包含恶意NetBIOS名称的WINS注册数据包。
2.  攻击者将此数据包发送到Samba服务器。
3.  Samba服务器的WINS hook脚本接收到数据包并提取NetBIOS名称。
4.  由于缺乏适当的验证或转义，恶意NetBIOS名称被直接插入到shell命令中。
5.  Samba服务器执行包含恶意命令的shell命令，导致远程代码执行。

由于PoC代码仅仅为README，并未提供具体的利用代码，所以实际的利用效果依赖于攻击者实现的具体PoC。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-10230](https://github.com/B1ack4sh/Blackash-CVE-2025-10230)

**漏洞详情:** [CVE-2025-10230](https://nvd.nist.gov/vuln/detail/CVE-2025-10230)