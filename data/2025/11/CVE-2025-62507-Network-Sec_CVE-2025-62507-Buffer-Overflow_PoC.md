## CVE-2025-62507-Redis-栈溢出

**漏洞编号:** CVE-2025-62507

**漏洞类型:** 栈溢出

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** >= 8.2.0, < 8.2.3

**利用条件:** 需要Redis服务开启，且攻击者能执行 XACKDEL 命令（默认需要低权限用户）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Redis的XACKDEL命令处理中。当使用XACKDEL命令删除消息流组中的消息时，如果提供大量的ID，由于缺乏充分的输入验证，可能导致栈缓冲区溢出。攻击者可以通过发送特制的XACKDEL命令，包含大量精心构造的ID，覆盖栈上的数据，从而可能导致Redis服务崩溃，甚至执行恶意代码。

**有效性：**
提供的POC代码有效。POC代码通过发送包含大量ID的XACKDEL命令，触发栈溢出，导致Redis服务崩溃。从提供的GDB调试信息可以看出，栈上的数据被攻击者控制的'a'字符覆盖，确认了溢出发生。

**投毒风险：**
POC代码的投毒风险较低，约为1%。代码比较简单，主要功能是构造并发送恶意XACKDEL命令。 代码通过循环生成特定模式的字符串，然后将这些字符串转换成64位的整数，用于构造stream ID，不存在明显的恶意行为。README.md中提到了“go get some RCE :)”，暗示了该漏洞可能被利用于远程代码执行，但这本身不是投毒行为。

**利用方式：**
1.  攻击者需要能够连接到Redis服务并拥有执行XACKDEL命令的权限（可以通过ACL限制）。
2.  攻击者通过XGROUP CREATE命令创建一个流和消费组，为后续的XACKDEL命令做准备。
3.  攻击者构造包含大量ID的XACKDEL命令。每个ID包含一个大整数，这些整数用于覆盖栈缓冲区。通过pwnlib库的cyclic模块生成特定的字符串模式，并将其转换成整数。
4.  将构造的命令发送到Redis服务器。由于XACKDEL命令在处理大量ID时存在栈溢出漏洞，服务器将崩溃，或者被攻击者利用执行任意代码。

**项目地址:** [Network-Sec/CVE-2025-62507-Buffer-Overflow_PoC](https://github.com/Network-Sec/CVE-2025-62507-Buffer-Overflow_PoC)

**漏洞详情:** [CVE-2025-62507](https://nvd.nist.gov/vuln/detail/CVE-2025-62507)