## CVE-2019-8451-Jira-SSRF

**漏洞编号:** CVE-2019-8451

**漏洞类型:** SSRF

**影响应用:** Jira

**危害等级:** 高危，可能允许远程攻击者访问内部网络资源

**影响版本:** < 8.4.0

**利用条件:** 目标Jira实例版本低于8.4.0，且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-8451 是 Jira 中一个预身份验证的服务器端请求伪造 (SSRF) 漏洞，存在于 /plugins/servlet/gadgets/makeRequest 资源中。该漏洞影响7.6.0及更高版本，并在7.13.9和8.4.0版本中修复。利用方式如下：

1.  **漏洞原理：** 由于 JiraWhitelist 类中的逻辑错误，远程攻击者可以通过构造恶意的 URL 参数，使 Jira 服务器向其控制的服务器发起请求，从而获取内部网络资源的内容。
2.  **POC 代码分析：**
    *   脚本 `jira-2019-8451.py` 使用 Python 编写，依赖 `requests` 库。
    *   它首先检查目标 Jira 实例的版本，如果版本低于 8.4.0，则认为可能存在漏洞。
    *   然后，它构造一个包含目标 URL 的恶意请求，并发送到 `/plugins/servlet/gadgets/makeRequest` 端点。
    *   如果响应包含 `"rc":200` 和 `Example Domain`，则表示目标主机存在漏洞。该测试会向 `url` 参数指定的目标URL的 `@example.com` 发起请求，通过返回值判断漏洞是否存在
3.  **利用方式：** 攻击者可以使用该漏洞扫描内部网络，获取敏感信息，例如数据库凭据、配置文件等。或者，攻击者可以利用该漏洞作为跳板，攻击内部网络的其他服务。
4.  **投毒风险分析：** 提供的代码中没有发现任何可疑的或恶意的代码。该脚本只是利用已知的漏洞进行验证。LICENSE文件也是标准的MIT开源协议，没有修改记录。因此，投毒风险极低 (0%)。

**项目地址:** [h0ffayyy/Jira-CVE-2019-8451](https://github.com/h0ffayyy/Jira-CVE-2019-8451)

**漏洞详情:** [CVE-2019-8451](https://nvd.nist.gov/vuln/detail/CVE-2019-8451)