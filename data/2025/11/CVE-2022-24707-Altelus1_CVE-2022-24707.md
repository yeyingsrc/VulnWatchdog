## CVE-2022-24707-Anuko Time Tracker-SQL注入

**漏洞编号:** CVE-2022-24707

**漏洞类型:** SQL注入

**影响应用:** Anuko Time Tracker

**危害等级:** 高危，可能导致数据泄露，数据篡改，甚至服务器控制

**影响版本:** < 1.20.0.5642

**利用条件:** 需要有效的Anuko Time Tracker账户登录权限，且Puncher插件启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

漏洞存在于Anuko Time Tracker的Puncher插件中，由于未对POST请求中的date参数进行充分过滤，导致攻击者可以注入恶意的SQL代码。

**有效性分析：**
根据漏洞库信息和提供的PoC代码，该漏洞的利用是有效的。PoC代码针对特定版本的Anuko Time Tracker (1.20.0.5640) 进行了测试，并提供了利用该漏洞的完整脚本。

**利用方式：**
1.  攻击者首先需要一个有效的Anuko Time Tracker用户账户，并确保Puncher插件已启用。
2.  通过POST请求向/puncher.php发送包含恶意SQL代码的date参数。
3.  攻击者可以使用UNION SQL注入来提取数据库中的敏感信息，或使用time-based blind injection来获取无法直接显示的数据。
4.  PoC代码演示了如何使用SQL注入来获取所有表名，并将结果写入time_edit.php页面的note区域，攻击者可以访问该页面查看泄露的信息。
5.  PoC首先登录系统, 找到project ID, 启动一个puncher,然后通过修改date参数构造SQL注入语句, 停止puncher, 最后读取time_edit.php页面获取注入结果。

**投毒风险分析：**
PoC代码主要功能是利用SQL注入漏洞，没有明显的恶意行为。但是存在一定的投毒风险：
*   **依赖风险：** PoC代码依赖于requests、beautifulsoup4等第三方库。如果这些库的安装源被篡改，可能会引入恶意代码。
*   **误用风险：** 如果不理解PoC代码的原理，直接在生产环境中使用，可能会对目标系统造成损害或留下后门。
*   **隐蔽后门：** 虽然PoC代码本身没有明显的后门，但攻击者可能会在修改后的代码中添加一些隐蔽的恶意代码，例如植入webshell，或篡改数据库数据。例如，SQL注入的目的是dump数据库，攻击者可以修改为写入恶意数据。
考虑到以上风险，估计投毒风险在10%左右。


**项目地址:** [Altelus1/CVE-2022-24707](https://github.com/Altelus1/CVE-2022-24707)

**漏洞详情:** [CVE-2022-24707](https://nvd.nist.gov/vuln/detail/CVE-2022-24707)