## CVE-2022-21587 Oracle Web Applications Desktop Integrator 未授权任意文件上传

**漏洞编号:** CVE-2022-21587

**漏洞类型:** 任意文件上传

**影响应用:** Oracle Web Applications Desktop Integrator

**危害等级:** 高危，可能导致远程代码执行，控制服务器

**影响版本:** 12.2.3-12.2.11

**利用条件:** 需要网络访问，目标系统运行受影响的Oracle E-Business Suite版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Oracle Web Applications Desktop Integrator的`BneUploaderService`组件中，允许未经身份验证的攻击者通过HTTP上传任意文件。提供的POC包含两个利用脚本：`exploit.py`尝试覆盖服务器上的现有`.pl`文件，`EBS_N_Overwrite.py`则创建新的`.jsp`文件。利用脚本首先生成一个包含恶意代码（Web Shell）的文件，然后使用`slipit`工具将其打包成zip格式，再使用`uuencode`进行编码。最后，通过`BneUploaderService`接口上传编码后的文件。成功上传后，攻击者可以通过Web Shell执行任意命令。`exploit.py`文件直接覆盖现有文件有破坏性，不推荐使用。`EBS_N_Overwrite.py`相对安全。`README.md`中提到`exploit.py`会覆盖.pl文件, 并且说明了不推荐使用, 该仓库主要风险来自于`exploit.py`文件存在破坏性操作。

**漏洞利用方式：**
1.  **确定目标系统：** 确认目标系统运行Oracle E-Business Suite且Web Applications Desktop Integrator版本在12.2.3到12.2.11之间。
2.  **准备环境：** 安装`slipit`和`sharutils`（包含`uuencode`工具）。
3.  **生成Web Shell：** POC脚本会自动生成一个简单的Web Shell，允许执行系统命令。
4.  **打包和编码：** 使用`slipit`将Web Shell打包成zip文件，并使用`uuencode`进行编码。
5.  **上传文件：** 通过`BneUploaderService`接口上传编码后的zip文件。
6.  **远程代码执行：** 成功上传后，通过访问上传的Web Shell（例如`/OA_CGI/FNDWRR.exe`或`/forms/shell.jsp`）并传递命令参数来执行任意系统命令。

**关于投毒风险的分析：**
脚本本身的功能是利用漏洞，但`exploit.py`脚本会覆盖服务器上的文件，可能导致服务中断或数据丢失。从恶意代码的角度来看，Web Shell本身就是一种后门，但这是利用漏洞的必要组成部分，并非作者额外添加的恶意功能。

`README.md`已经提示`exploit.py`文件会覆盖系统文件，存在一定的风险。

因此，投毒风险主要来自于`exploit.py`的破坏性操作，而非作者故意添加恶意代码。风险等级较低，推测为10%。

**项目地址:** [hieuminhnv/CVE-2022-21587-POC](https://github.com/hieuminhnv/CVE-2022-21587-POC)

**漏洞详情:** [CVE-2022-21587](https://nvd.nist.gov/vuln/detail/CVE-2022-21587)