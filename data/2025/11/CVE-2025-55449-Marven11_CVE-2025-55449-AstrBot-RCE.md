## AstrBot <= 3.5.17 JWT 密钥硬编码导致 RCE

**漏洞编号:** CVE-2025-55449

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** AstrBot

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 3.5.17

**利用条件:** 需要能够访问 AstrBot 服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

AstrBot 3.5.17 及更早版本在源代码中硬编码了 JWT 密钥。攻击者可以利用此密钥生成有效的 JWT 令牌，然后利用该令牌上传恶意插件，从而实现远程代码执行。利用方式如下：

1.  **获取硬编码的 JWT 密钥：** 从 AstrBot 3.5.17 源码中的 `astrbot/core/__init__.py` 文件中获取硬编码的 JWT 密钥。
2.  **生成 JWT 令牌：** 使用获取的密钥，生成一个包含允许上传插件权限的 JWT 令牌。
3.  **上传恶意插件：** 使用生成的 JWT 令牌，向 AstrBot 服务器上传包含恶意代码的插件。
4.  **RCE：** 一旦插件被上传并加载，恶意代码就会被执行，从而实现远程代码执行。

**投毒风险分析：**

`/tmp/6b2fa282c9de224a5cceb915215a5bdb/flake.nix` 和 `/tmp/6b2fa282c9de224a5cceb915215a5bdb/flake.lock` 文件看起来是 Nix 包管理器的配置文件，用于构建开发环境。这里引入了旧版本的 python38 和一些看起来不必要的依赖, 存在一定的投毒风险，例如使用了不安全的依赖项或在构建过程中引入恶意代码。`/tmp/6b2fa282c9de224a5cceb915215a5bdb/main.py` 部分代码被截断，不能完整分析。但总体而言，风险在于开发环境可能被污染，但直接影响到目标系统的可能性较小,投毒风险估计为10%。

**项目地址:** [Marven11/CVE-2025-55449-AstrBot-RCE](https://github.com/Marven11/CVE-2025-55449-AstrBot-RCE)

**漏洞详情:** [CVE-2025-55449](https://nvd.nist.gov/vuln/detail/CVE-2025-55449)