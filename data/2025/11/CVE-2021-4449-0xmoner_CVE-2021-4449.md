## CVE-2021-4449 - ZoomSounds WordPress插件未授权任意文件上传漏洞

**漏洞编号:** CVE-2021-4449

**漏洞类型:** 任意文件上传

**影响应用:** ZoomSounds - WordPress Wave Audio Player with Playlist

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.96

**利用条件:** 目标WordPress站点安装了ZoomSounds插件，且版本小于等于5.96，并且存在可写目录。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ZoomSounds插件的`savepng.php`文件中，由于缺少文件类型验证，未授权的攻击者可以通过POST请求上传任意文件。利用步骤如下：

1.  **环境搭建：** 使用提供的`setup-test-environment.sh`脚本创建一个包含漏洞ZoomSounds插件的WordPress测试环境。该脚本创建一个名为`zoomsounds-plugin`的目录，并在其中创建一个名为`zoomsounds.php`的文件，该文件包含模拟的易受攻击的ZoomSounds插件代码，特别是`savepng.php`文件，它允许未经身份验证的文件上传。
2.  **漏洞利用：** 使用`nuclei`扫描器执行提供的`CVE-2021-4449.yaml`模板。这个模板会发送一个POST请求到`/savepng.php` 或者`/wp-content/plugins/zoomsounds/savepng.php`或者`/zoomsounds-savepng`端点，上传一个包含PHP代码的文件。`nuclei`模板使用随机字符串生成文件名和内容，以避免缓存或重复。
3.  **验证：** 成功上传后，`nuclei`模板会提取上传文件的URL，并通过GET请求访问该URL，验证文件是否成功上传并执行。如果返回包含`VULN_TEST_{{randstr}}`的页面，则表示漏洞利用成功。

**漏洞利用代码分析：**

*   `setup-test-environment.sh`: 该脚本用于设置一个易受攻击的测试环境。它创建必要的目录和文件，包括模拟存在漏洞的`savepng.php`文件。
*   `docker-compose.yaml`: 不相关,是一个yaml文件
*   `CVE-2021-4449.yaml` (nuclei模板): 该文件包含用于检测和利用漏洞的`nuclei`扫描器的模板。它定义了HTTP请求，匹配器和提取器，以验证漏洞的存在。

**投毒风险分析：**

代码分析未发现明显的恶意代码或后门。该代码的主要目的是为了验证和利用文件上传漏洞。`setup-test-environment.sh` 脚本创建的 `savepng.php` 文件模拟了存在漏洞的场景，本身就是为了RCE而设计的，不是投毒代码。`nuclei` 模板也只是用于测试漏洞是否存在，没有发现注入恶意代码的行为。

因此，投毒风险较低，判断为0%。

**搜索引擎结果：**

由于未提供搜索引擎结果，故本分析未参考。

**优先级：** 漏洞利用代码 > 漏洞库信息 > 搜索引擎结果

**项目地址:** [0xmoner/CVE-2021-4449](https://github.com/0xmoner/CVE-2021-4449)

**漏洞详情:** [CVE-2021-4449](https://nvd.nist.gov/vuln/detail/CVE-2021-4449)