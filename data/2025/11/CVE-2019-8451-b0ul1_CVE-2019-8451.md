## CVE-2019-8451-Jira-SSRF

**漏洞编号:** CVE-2019-8451

**漏洞类型:** SSRF

**影响应用:** Jira

**危害等级:** 高危，可能导致内部信息泄露，访问内部服务。

**影响版本:** < 8.4.0

**利用条件:** 需要Jira实例的URL和目标内部服务的URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-8451是一个存在于Atlassian Jira 8.4.0之前版本中的服务器端请求伪造（SSRF）漏洞。该漏洞位于`/plugins/servlet/gadgets/makeRequest`资源处，由于`JiraWhitelist`类中的逻辑错误，允许远程攻击者通过SSRF漏洞访问内部网络资源的内容。

**有效性：**

提供的POC代码是一个bash脚本，用于利用此漏洞。脚本接受两个参数：Jira实例的基URL和要进行SSRF的目标URL。该脚本构造一个恶意的URL，该URL使用Jira实例作为代理来访问目标URL。如果Jira实例易受攻击，则脚本将能够访问目标URL的内容，并可能泄露敏感信息。

该POC代码通过发送一个精心构造的请求到`/plugins/servlet/gadgets/makeRequest`端点，利用了Jira的SSRF漏洞。该请求包含一个`url`参数，该参数指向攻击者控制的服务器，或者内部资源。通过`@`符号绕过白名单检查，从而发起SSRF请求。

**投毒风险：**

该POC代码本身看起来没有明显的投毒风险。它是一个相对简单的bash脚本，它执行SSRF攻击，没有包含任何后门或者恶意行为。代码的主要功能是构造和发送HTTP请求，分析响应，并报告结果。因此，投毒风险评估为0%。

**利用方式：**

1.  确定目标Jira实例的版本是否低于8.4.0。
2.  使用POC代码，指定Jira实例的基URL和要访问的内部目标URL。
3.  运行POC代码。脚本将构造并发送一个恶意的HTTP请求到Jira实例。
4.  检查响应。如果Jira实例易受攻击，则响应将包含目标URL的内容。

成功利用此漏洞可能允许攻击者：

*   扫描内部网络。
*   读取内部服务（例如，数据库，缓存服务器）的数据。
*   执行内部服务上的操作。
*   绕过身份验证机制。

**总结：**

该漏洞是一个严重的安全问题，可能导致敏感信息泄露和未经授权的访问。提供的POC代码可以有效地利用此漏洞，但没有发现投毒的迹象。建议尽快将Jira实例升级到8.4.0或更高版本，以修复此漏洞。

**项目地址:** [b0ul1/CVE-2019-8451](https://github.com/b0ul1/CVE-2019-8451)

**漏洞详情:** [CVE-2019-8451](https://nvd.nist.gov/vuln/detail/CVE-2019-8451)