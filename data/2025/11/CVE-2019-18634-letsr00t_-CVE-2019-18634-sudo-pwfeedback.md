## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)