## CVE-2023-36845-Juniper-J-Web-RCE

**漏洞编号:** CVE-2023-36845

**漏洞类型:** PHP 外部变量修改导致RCE

**影响应用:** Junos OS J-Web

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 20.4R3-S9 之前的所有版本, 21.1R1 及之后, 21.2R3-S7 之前, 21.3R3-S5 之前, 21.4R3-S5 之前, 22.1R3-S4 之前, 22.2R3-S2 之前, 22.3R2-S2 和 22.3R3-S1 之前, 22.4R2-S1 和 22.4R3 之前, 以及 23.2R1-S1 和 23.2R2 之前。

**利用条件:** 需要启用 J-Web，且可以通过 HTTP 或 HTTPS 访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36845 是 Juniper Junos OS 中 J-Web 接口的一个 PHP 外部变量修改漏洞。未经身份验证的远程攻击者可以通过构造特殊的请求，设置 PHPRC 变量，从而修改 PHP 的执行环境，最终实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意 PHPRC 变量的 HTTP 请求，发送到目标设备的 J-Web 接口。
2.  目标设备上的 PHP 解释器会读取攻击者设置的 PHPRC 变量，并将其用于配置 PHP 运行环境。
3.  攻击者可以通过 PHPRC 变量指定一个包含恶意 PHP 代码的文件。
4.  当 J-Web 执行 PHP 代码时，会加载并执行攻击者提供的恶意代码，从而实现远程代码执行。

**POC 代码分析：**

POC 代码是一个 Bash 脚本，它的主要功能是：

1.  从 Shodan 搜索指定域名下的 Juniper Web Device Manager 的 IP 地址。
2.  使用 httpx 工具扫描找到的 IP 地址，获取可访问的 URL。
3.  使用 Nuclei 工具，根据 CVE-2023-36845 的 Nuclei 模板对获取的 URL 进行漏洞扫描。

该脚本本身没有投毒代码，只是自动化了漏洞发现和利用的过程。它依赖于 Shodan API key 和 Nuclei 工具。

**投毒风险评估：**

经过分析，提供的 POC 代码本身不包含任何恶意或投毒代码。该脚本只是一个自动化扫描和漏洞利用的工具，其行为取决于使用者以及所使用的 Nuclei 模板。如果使用者使用恶意的 Nuclei 模板，则可能导致非预期的行为，但这并非 POC 代码本身的投毒行为。

因此，投毒风险为 0%。

**项目地址:** [e11i0t4lders0n/CVE-2023-36845](https://github.com/e11i0t4lders0n/CVE-2023-36845)

**漏洞详情:** [CVE-2023-36845](https://nvd.nist.gov/vuln/detail/CVE-2023-36845)