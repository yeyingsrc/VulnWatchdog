## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)