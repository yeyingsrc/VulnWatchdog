## CVE-2024-40725/CVE-2024-40898 - Apache HTTP Server

**漏洞编号:** CVE-2024-40725

**漏洞类型:** 代码泄露/HTTP请求走私/SSL验证绕过

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露、权限提升和远程代码执行

**影响版本:** 2.4.0 to 2.4.61

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且配置满足漏洞触发条件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2024-40725是一个关于Apache HTTP Server核心组件中，对CVE-2024-39884的部分修复存在缺陷，允许在特定配置下，通过“AddType”等配置导致源码泄露，例如PHP脚本被作为静态文件提供而非执行。

CVE-2024-40898信息缺失，但根据提供的README，可能与mod_ssl模块相关，涉及SSL验证绕过。

提供的PoC代码包含两个Python脚本，分别用于检测CVE-2024-40725和CVE-2024-40898漏洞。

CVE-2024-40725的PoC尝试利用HTTP请求走私来访问/admin路径。它构造了一个包含Content-Length和Transfer-Encoding的请求，试图欺骗服务器，从而走私后续的GET /admin请求。

CVE-2024-40898的PoC尝试绕过SSL验证。它创建一个允许可选证书验证的SSL上下文，然后发送一个HTTP HEAD请求，并检查响应中是否包含“200 OK”，以此判断是否存在SSL验证绕过漏洞。

README.md中给出了两个漏洞的描述，CVE-2024-40725是由于mod_proxy模块在启用ProxyPass指令和配置URL重写规则时可能发生HTTP请求走私攻击。攻击者可以通过构造恶意请求，利用代理服务器和后端服务器对HTTP请求解析的差异，导致信息泄露或未经授权的数据访问。

综合来看，利用方式如下：

*   **CVE-2024-40725 (源码泄露):** 利用'AddType'等配置不当，间接请求文件，导致服务器将脚本源码而非执行结果返回给客户端。
*   **CVE-2024-40725 (HTTP Request Smuggling):** 利用代理服务器和后端服务器对HTTP请求解析的差异，构造恶意请求，绕过安全策略，访问受限资源。
*   **CVE-2024-40898 (SSL验证绕过):** 攻击者可以绕过SSL证书验证，可能导致中间人攻击或其他安全问题。

根据对PoC代码的分析，没有发现明显的恶意代码或投毒行为。所有代码都是为了检测漏洞的存在。但需要注意的是，任何漏洞利用代码都存在被滥用的风险。

**项目地址:** [TAM-K592/CVE-2024-40725-CVE-2024-40898](https://github.com/TAM-K592/CVE-2024-40725-CVE-2024-40898)

**漏洞详情:** [CVE-2024-40725](https://nvd.nist.gov/vuln/detail/CVE-2024-40725)