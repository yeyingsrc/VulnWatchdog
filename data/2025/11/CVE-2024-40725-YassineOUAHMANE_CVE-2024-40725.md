## CVE-2024-40725 - Apache HTTP Server 源码泄露

**漏洞编号:** CVE-2024-40725

**漏洞类型:** 源码泄露

**影响应用:** Apache HTTP Server

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** <= 2.4.61

**利用条件:** 需要服务器开启AddType等配置，并且可以通过间接方式请求文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-40725是Apache HTTP Server 2.4.61中CVE-2024-39884的部分修复未完全生效导致的问题。当服务器配置了`AddType`等指令来处理特定类型文件时，在某些情况下，通过间接请求这些文件，会导致服务器返回文件的源代码而不是执行它，从而造成源码泄露。

**有效性评估：**
提供的POC代码(detect_http_smuggling.py)看起来是有效的，它尝试通过发送特制的HTTP请求来检测服务器是否存在HTTP请求走私漏洞，而这个漏洞本身就可以用来触发CVE-2024-40725。

**投毒风险评估：**
代码本身是一个检测HTTP请求走私的工具，目标是判断status code 是否发生改变，例如从403到200，利用的也是request走私。参考的github链接也指向一个验证该漏洞的poc。因此,该代码的主要功能符合其描述。代码中加入恶意payload的可能性较小。投毒风险较低，约为5%。

**漏洞利用方式：**
1.  配置`AddType`等指令来处理特定文件类型，例如将`.php`文件关联到PHP解释器。
2.  构造恶意的HTTP请求，利用HTTP请求走私技术来绕过服务器的正常处理流程。
3.  间接请求目标文件，例如通过重定向或者其他方式。
4.  服务器未能正确处理请求，直接返回了目标文件的源代码。

**项目地址:** [YassineOUAHMANE/CVE-2024-40725](https://github.com/YassineOUAHMANE/CVE-2024-40725)

**漏洞详情:** [CVE-2024-40725](https://nvd.nist.gov/vuln/detail/CVE-2024-40725)