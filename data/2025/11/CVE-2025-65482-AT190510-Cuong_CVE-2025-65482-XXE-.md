## CVE-2025-65482 (XXE) - XDocReport

**漏洞编号:** CVE-2025-65482

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** XDocReport

**危害等级:** 高危，可能导致敏感信息泄露、远程文件读取、服务器端请求伪造 (SSRF)

**影响版本:** <= 2.0.3

**利用条件:** 需要上传.docx文件的功能，并且服务器使用受影响版本的XDocReport库进行处理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于XDocReport的docx文件解析过程中。由于XDocReport使用了Apache POI来读取.docx文件，而POI又使用了Java的默认SAXParser，并且没有禁用DTD处理和外部实体，导致攻击者可以通过构造恶意的.docx文件，在XML中注入外部实体，从而实现XXE攻击。

**利用方式：**
1.  攻击者创建一个包含恶意XML的.docx文件。该XML包含一个指向外部资源的DOCTYPE，例如一个外部DTD文件或者一个HTTP URL。
2.  攻击者将该.docx文件上传到服务器。
3.  服务器使用XDocReport处理该文件，SAXParser会解析XML，并尝试加载外部实体。
4.  如果外部实体是一个DTD文件，服务器会解析该DTD文件，并执行其中定义的实体。这可以用来读取服务器上的任意文件，或者发起SSRF攻击。
5.  如果外部实体是一个HTTP URL，服务器会向该URL发起请求，这可以用来探测服务器的内部网络，或者向外部服务器发送请求，泄露敏感信息。

**有效性：**
提供的PoC代码是有效的。它详细描述了如何创建一个包含恶意XML的.docx文件，并演示了如何使用该文件读取服务器上的任意文件，或者发起SSRF攻击。

**投毒风险：**
代码本身主要用于演示XXE漏洞的利用，直接的恶意投毒代码风险较低。但是存在一种间接的风险，即攻击者可能将此PoC进行修改，在DTD文件中加入额外的恶意代码，例如webshell，上传到目标服务器后进行利用。因此，考虑到DTD可以包含恶意代码，将投毒风险评估为10%。

**项目地址:** [AT190510-Cuong/CVE-2025-65482-XXE-](https://github.com/AT190510-Cuong/CVE-2025-65482-XXE-)

**漏洞详情:** [CVE-2025-65482](https://nvd.nist.gov/vuln/detail/CVE-2025-65482)