## CVE-2025-49144-Notepad++-权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** < 8.8.2

**利用条件:** 需要用户运行恶意构造的Notepad++安装程序，且恶意regsvr32.exe与安装程序位于同一目录

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49144是Notepad++安装程序中的一个权限提升漏洞。该漏洞源于安装程序在搜索regsvr32.exe时使用了不安全的搜索路径。攻击者可以将恶意的regsvr32.exe（或其他安装程序会调用的可执行文件）放置在与Notepad++安装程序相同的目录中（通常是用户的Downloads目录）。当用户运行Notepad++安装程序时，安装程序会首先在该目录下找到恶意的regsvr32.exe并执行它，从而以SYSTEM权限执行攻击者提供的代码。 

**有效性：**
根据提供的PoC代码，该漏洞利用是有效的。PoC通过模拟regsvr32.exe，加载shellcode来演示权限提升。Shellcode的功能是创建一个文件，表明代码以SYSTEM权限运行。 因为安装程序会首先在工作目录查找 regsvr32.exe，所以可以通过构造一个恶意的regsvr32.exe来实现漏洞利用。

**投毒风险：**
该仓库存在一定的投毒风险。PoC代码本身旨在演示漏洞利用，但恶意攻击者可能会修改PoC代码，例如在shellcode中添加额外的恶意功能（例如，安装后门、窃取凭据等），然后传播修改后的PoC，从而达到攻击目的。Payload.h 文件是否被替换，是个潜在风险点。这里给出的10%风险评估主要考虑的是用户可能下载到修改后的恶意PoC。

**利用方式：**
1.  攻击者构造一个恶意的`regsvr32.exe`，该程序包含攻击者的payload（在本例中，PoC会在`C:\Windows\Temp`目录下创建一个文件）。
2.  攻击者诱骗用户下载Notepad++的官方安装程序以及该恶意的`regsvr32.exe`到同一个目录（例如，用户的Downloads目录）。这可以通过社会工程学或点击劫持等方式实现。
3.  用户运行Notepad++安装程序。
4.  安装程序在当前目录下找到恶意的`regsvr32.exe`并以SYSTEM权限执行它。
5.  攻击者的payload得以执行，从而实现权限提升。

**项目地址:** [0xCZR1/cve-2025-49144](https://github.com/0xCZR1/cve-2025-49144)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)