## CVE-2025-50165-Windows Graphics Component-远程代码执行

**漏洞编号:** CVE-2025-50165

**漏洞类型:** 远程代码执行

**影响应用:** Windows Graphics Component

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2025 (Server Core installation), Windows 11 Version 24H2, Windows Server 2025，版本范围：10.0.26100.0 <= version < 10.0.26100.4946

**利用条件:** 目标系统处理恶意JPEG图像文件。攻击向量包括Web浏览器、电子邮件客户端以及任何使用Windows API渲染JPEG图像的应用程序。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-50165是Windows Graphics Component中的一个远程代码执行漏洞，源于对不可信指针的解引用。该漏洞存在于JPEG解码过程中，攻击者通过构造包含恶意元数据段的JPEG文件，触发不可信指针解引用，从而实现远程代码执行。利用方式包括：

1.  **生成恶意JPEG文件：** 使用提供的`generate_payload.py`脚本，指定攻击者监听的IP地址和端口，生成包含恶意shellcode的JPEG文件。
2.  **投递Payload：** 将生成的`exploit.jpg`文件发送到目标机器。当目标机器处理该图像文件时，例如在文件浏览器中显示缩略图、在图像查看器中打开或嵌入在网页中，漏洞将被触发。
3.  **获取Shell：** 攻击者监听的端口将会收到来自目标机器的反向Shell连接，从而实现远程代码执行。

**有效性：** 根据提供的POC代码，该漏洞利用是有效的。代码提供了详细的技术分析和使用说明，并通过Demo视频展示了漏洞利用过程。POC脚本能够生成恶意JPEG文件，并成功在目标系统上执行shellcode，从而获得远程控制权限。

**投毒风险：** 虽然POC代码的README.md中声明仅用于安全研究和教育目的，并禁止恶意使用。但仍然存在一定的投毒风险。可能性分析如下：

*   `generate_payload.py` 脚本本身可能包含后门代码，例如，在生成shellcode的过程中植入恶意指令，或者将受害者信息回传给攻击者。但查看脚本后，发现此风险较低，主要功能集中在生成JPEG文件和嵌入shellcode。
*   生成的`exploit.jpg` 文件在特定的环境中会触发额外的操作，例如，连接到特定的恶意服务器，或者在受害者机器上安装恶意软件。此风险相对较低，因为主要依赖于shellcode的执行。
*   作者的联系邮箱 `anthonmullins@op.pl` 可能会被用于收集漏洞利用信息或进行进一步的攻击。
*   `tinyurl.com/3cyha48t` 链接存在潜在风险，可能指向恶意网站或包含病毒的文件。

综合评估，投毒风险约为10%。主要是作者信息未知，以及对生成shellcode行为的潜在风险考虑。

**漏洞利用方式：**

1.  利用Windows Graphics Component处理图像时存在的缺陷。
2.  通过构造恶意的JPEG图像，触发内存错误。
3.  利用堆喷射技术将shellcode放置在可预测的内存地址。
4.  劫持程序执行流程，使其跳转到shellcode执行，最终实现远程代码执行。

**项目地址:** [callinston/CVE-2025-50165](https://github.com/callinston/CVE-2025-50165)

**漏洞详情:** [CVE-2025-50165](https://nvd.nist.gov/vuln/detail/CVE-2025-50165)