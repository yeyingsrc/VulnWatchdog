## CVE-2025-64495-Open WebUI-Stored DOM XSS

**漏洞编号:** CVE-2025-64495

**漏洞类型:** Stored DOM XSS

**影响应用:** Open WebUI

**危害等级:** 高危，可能导致账户接管 (ATO) 和远程代码执行 (RCE)

**影响版本:** < 0.6.35

**利用条件:** 需要用户具有创建prompt的权限，并启用 'Insert Prompt as Rich Text' 选项

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Open WebUI的prompt插入功能中。当 'Insert Prompt as Rich Text' 选项启用时，prompt的内容会被直接插入到DOM中，而没有进行充分的过滤。攻击者可以通过创建包含恶意JavaScript代码的prompt，当其他用户执行该prompt对应的命令时，恶意代码会在用户的浏览器中执行，从而实现XSS攻击。POC中展示了如何利用此漏洞执行 alert(1) 和通过注入JavaScript代码的方式来创建一个可以执行任意Python代码的函数，从而实现RCE。

**有效性分析：**
根据提供的漏洞信息和POC代码，该漏洞利用是有效的。POC 提供了详细的步骤，包括创建恶意prompt、启用 'Insert Prompt as Rich Text' 选项，以及通过命令触发XSS。通过插入 img 标签和 onerror 事件，或者动态构造 fetch 请求，可以执行任意 JavaScript 代码。

**投毒风险分析：**
该仓库中存在一定投毒风险。虽然主要代码是漏洞利用的演示，但攻击者可能在其他地方加入恶意代码，例如：

*   **修改后的利用脚本：** 攻击者可以修改提供的Python脚本，使其在创建函数时执行其他恶意操作，例如上传敏感信息或安装后门。
*   **README.md中的隐藏链接：** README 文件中可能包含指向恶意网站的链接，诱导用户下载恶意软件。
*   **细微的代码更改：** 对POC代码进行细微更改，使其在特定情况下执行恶意代码，而不易被发现。
虽然目前展示的代码是可信的，但潜在的风险仍然存在，大约10%的概率。

**利用方式总结：**
1.  攻击者利用具有创建prompt权限的账号登录Open WebUI。
2.  在Open WebUI中创建一个包含恶意JavaScript代码的prompt。例如，使用 `<img src=x onerror=alert(1)>` 或构建 fetch 请求创建函数。
3.  确保目标用户启用了 'Insert Prompt as Rich Text' 选项。
4.  诱导目标用户在聊天窗口中执行该prompt对应的命令 (例如 /poc)。
5.  当目标用户执行该命令时，恶意JavaScript代码将在目标用户的浏览器中执行，从而实现XSS攻击。根据payload的不同，可以实现账号接管 (窃取 cookie 或 token) 或远程代码执行 (通过创建并执行恶意 Python 函数)。

**项目地址:** [AlphabugX/CVE-2025-64495-POC](https://github.com/AlphabugX/CVE-2025-64495-POC)

**漏洞详情:** [CVE-2025-64495](https://nvd.nist.gov/vuln/detail/CVE-2025-64495)