## CVE-2025-8088-WinRAR-路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要主动打开恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是WinRAR Windows版本中的一个路径遍历漏洞。攻击者可以构造恶意的RAR文件，当用户解压该文件时，通过路径遍历将恶意LNK文件写入到启动目录或注册表项，实现开机自启动恶意代码，从而执行任意代码。

**有效性分析：**
提供的PowerShell脚本（Exploit_cve_2025_8088.ps1）是一个概念验证（PoC）代码，旨在模拟利用该漏洞。该脚本不直接利用RAR的路径遍历漏洞，而是模拟RAR解压后将恶意文件放置在特定位置的行为。它通过以下步骤模拟了攻击过程：

1.  **模拟RAR解压：** 脚本监视指定目录（PathToWatch）中是否存在一个标记文件（MarkerFile），该文件可以模拟RAR解压操作的结果。
2.  **反分析检查：** 脚本包含一些基本的反分析检查，以避免在虚拟机或沙箱环境中执行。
3.  **创建恶意LNK文件：** 脚本创建一个指向calc.exe（或其他目标文件）的LNK文件，并将其放置在启动目录中，实现开机自启动。
4.  **添加注册表持久性：** 脚本还将恶意LNK文件的路径添加到注册表中的Run键，以确保即使LNK文件被删除，恶意代码仍然可以执行。
5.  **字符串混淆：** 脚本使用了简单的XOR和Base64编码来混淆字符串，例如启动目录的路径和注册表项的名称。

虽然此PoC并未展示真实的路径遍历利用，但它成功演示了利用路径遍历漏洞后的攻击流程。因此，可以认为该POC在概念上是有效的。

**投毒风险分析：**
该PoC代码包含一些潜在的投毒风险，但是风险比较小。风险分析如下：

*   **恶意Payload：**  脚本中包含的`calc.exe`仅仅是一个用于演示目的的Payload，如果脚本被恶意修改，`calc.exe` 可以被替换为更具破坏性的Payload，例如勒索软件或恶意软件。
*   **反分析绕过：** 该脚本实现了简单的反分析检测。攻击者有可能通过绕过这些检测手段，使得恶意代码在目标环境中执行。
*   **隐蔽性：** 虽然脚本尝试使用混淆和内存日志记录来避免被检测，但这些技术相对简单，很容易被安全软件发现。但是，如果攻击者使用更高级的隐蔽技术，例如代码注入或进程隐藏，可以大大提高攻击的成功率。

综合以上因素，该PoC代码存在一定的投毒风险，大约为10%。

**利用方式：**

1.  **构造恶意RAR文件：** 攻击者首先需要构造一个恶意的RAR文件，该文件包含一个可以触发路径遍历漏洞的文件。此文件包含一个LNK文件，这个LNK文件的目标路径被设置为启动目录或注册表键值。
2.  **诱骗用户解压：** 攻击者将恶意RAR文件发送给目标用户，并诱骗其解压该文件。
3.  **触发漏洞：** 当用户使用存在漏洞的WinRAR版本解压该文件时，路径遍历漏洞被触发，恶意LNK文件被写入到启动目录或注册表项。
4.  **执行恶意代码：** 当用户下次启动计算机时，恶意LNK文件会自动执行，从而执行攻击者预先设定的恶意代码。攻击者可以利用该漏洞执行任意代码，例如安装恶意软件、窃取敏感数据或控制受害者计算机。

**项目地址:** [ghostn4444/CVE-2025-8088](https://github.com/ghostn4444/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)