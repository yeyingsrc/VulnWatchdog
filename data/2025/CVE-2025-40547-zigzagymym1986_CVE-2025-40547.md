## CVE-2025-40547 - SolarWinds Serv-U Administrative Pre-Authenticated Remote Code Execution

**漏洞编号:** CVE-2025-40547

**漏洞类型:** 远程代码执行

**影响应用:** SolarWinds Serv-U

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** <= 15.5.2

**利用条件:** 需要管理员权限访问Serv-U Web界面，目标系统安装SolarWinds Serv-U FTP Server ≤ 15.5.2。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-40547 是 SolarWinds Serv-U FTP Server 15.5.2 及之前版本中的一个严重逻辑错误，允许经过身份验证的管理员在底层 Windows 操作系统上实现任意代码执行。漏洞存在于管理 Web 界面的文件管理模块中，其中对上传的配置指令的验证不足，加上内部对象的不安全反序列化，导致使用 Serv-U 服务（通常是 NT SERVICE\Serv-U 或 SYSTEM）的权限直接执行操作系统命令。

**利用方式：**

1.  攻击者需要拥有 Serv-U 管理员权限。
2.  攻击者通过 `/Admin/ConfigUpload.aspx` 接口上传恶意构造的 XML 配置文件片段。
3.  通过在 XML 中注入包含 `System.Diagnostics.ProcessStartInfo` 序列化 .NET 对象的恶意 `<ObjectData>` 节点，服务器在配置重新加载期间反序列化并执行任意命令。
4.  Payload 被编码为 XML 中的 Base64 以绕过基本的 WAF 规则。
5.  默认的回调是一个简单的 x64 反向 TCP shell（端口 4444）。可以在配置中更改它。

**有效性：**

根据漏洞信息和提供的 POC 代码，该漏洞利用应该是有效的。POC 代码提供了一个完整的利用链，包括指纹识别、身份验证、payload 上传和执行。

**投毒风险：**

虽然 POC 代码本身旨在演示漏洞利用，但存在作者在代码中添加后门的风险。 检查了 `ServU-AdminRCE.exe` 是否存在其他行为，例如连接到外部服务器或安装其他软件。`payload-config.ini` 的存在允许自定义 Payload 的行为，这降低了投毒风险，但需要仔细审查。综合评估投毒风险约为 10%。这个百分比代表了考虑到文件可用性，代码结构清晰以及提供配置选项等因素后，仍然存在的微小风险，即作者可能植入了难以察觉的恶意代码。


**项目地址:** [zigzagymym1986/CVE-2025-40547](https://github.com/zigzagymym1986/CVE-2025-40547)

**漏洞详情:** [CVE-2025-40547](https://nvd.nist.gov/vuln/detail/CVE-2025-40547)