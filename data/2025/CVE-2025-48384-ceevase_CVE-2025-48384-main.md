## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器被控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互（克隆恶意仓库或初始化包含恶意配置的子模块），且Git版本在受影响范围内

**POC 可用性:** 是，但提供的POC不完整

**投毒风险:** 10%

## 详情

该漏洞源于Git处理配置中的引号不当，特别是在子模块初始化时。攻击者可以构造包含恶意配置的Git仓库，该配置在子模块路径中包含尾随的回车符（CR）。当Git读取这个配置时，会错误地解析子模块路径，导致子模块被检出到错误的位置。如果存在一个指向子模块钩子目录的符号链接，并且该子模块包含一个可执行的 post-checkout 钩子，那么该钩子可能会在检出后被意外执行，从而导致任意代码执行。

**有效性分析：**
提供的POC代码 `/tmp/bf064e338662304d3b4aa41ca61a0b1a/README.md`  只包含一个简单的markdown文件，无法直接证明漏洞的有效性。 它只是一个 README 文件，用来描述或者记录一些信息,不能用来验证漏洞的有效性。缺少必要的利用步骤，例如：构造恶意仓库，包含特殊字符的子模块路径，和可执行的 post-checkout 钩子。

**投毒风险分析：**
提供的POC代码只包含一个README文件，投毒风险较低，但也不能完全排除作者在其他文件或分支中隐藏恶意代码的可能性。假设该作者还有其他的commit/branch，有投毒的可能性，所以投毒风险评估为10%。

**利用方式：**
1.  攻击者创建一个包含恶意配置的Git仓库。
2.  恶意配置的核心是子模块路径，其中包含一个尾随的回车符（CR）。
3.  攻击者创建一个符号链接，将错误的子模块路径指向子模块的钩子目录（.git/hooks）。
4.  恶意仓库包含一个子模块，其中包含一个可执行的 post-checkout 钩子脚本。
5.  受害者克隆恶意仓库或初始化包含恶意配置的子模块。
6.  Git解析错误路径，将子模块检出到错误位置，并触发符号链接。
7.  post-checkout 钩子脚本被执行，导致任意代码执行。

**项目地址:** [ceevase/CVE-2025-48384-main](https://github.com/ceevase/CVE-2025-48384-main)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)