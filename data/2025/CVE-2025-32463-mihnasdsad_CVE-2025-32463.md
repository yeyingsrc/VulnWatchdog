## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 需要本地用户权限，并能够创建/修改文件

**POC 可用性:** 是，虽然未提供直接的exp, 但漏洞描述清晰，容易构造

**投毒风险:** 1%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之前的版本中。该漏洞允许本地用户通过 `--chroot` 选项利用用户控制的目录中的 `/etc/nsswitch.conf` 文件获取 root 权限。利用方式如下：

1.  **创建恶意的`/etc/nsswitch.conf`：**  攻击者创建一个恶意的 `/etc/nsswitch.conf` 文件，该文件指向攻击者控制的库文件，以便在 sudo 加载时执行恶意代码。
2.  **利用`--chroot`选项：**  攻击者使用 `sudo` 命令的 `--chroot` 选项，将根目录切换到攻击者创建的包含恶意 `/etc/nsswitch.conf` 的目录。
3.  **Sudo加载恶意库：**  当 `sudo` 在 chroot 环境中运行时，它会加载攻击者提供的 `/etc/nsswitch.conf` 文件，从而加载攻击者控制的恶意库。
4.  **执行恶意代码：**  恶意库中的代码在 root 权限下执行，导致本地提权。

**有效性：** 漏洞利用是有效的，因为攻击者可以控制 `/etc/nsswitch.conf` 的内容，从而劫持 sudo 的库加载过程。

**投毒风险：** 提供的代码片段是CC0协议的license文件，不包含任何恶意代码。因此，投毒风险极低，仅为1%。

**项目地址:** [mihnasdsad/CVE-2025-32463](https://github.com/mihnasdsad/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)