## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)