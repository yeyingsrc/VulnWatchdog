## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)