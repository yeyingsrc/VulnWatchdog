## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许数据库用户执行操作系统命令

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库访问权限，并且是superuser或者具有'pg_execute_server_program'角色

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有 superuser 权限或 `pg_execute_server_program` 角色的用户，通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。 

**利用方式：**

1.  攻击者需要能够连接到 PostgreSQL 数据库，并具有相应的权限（superuser 或 `pg_execute_server_program` 角色）。
2.  攻击者创建一个用于存储命令输出的表。
3.  攻击者使用 `COPY table FROM PROGRAM 'command'` 语句执行操作系统命令。命令的输出将被写入到创建的表中。
4.  攻击者查询该表以获取命令执行的结果。

提供的 Dockerfile 和 docker-compose.yml 文件用于快速搭建存在漏洞的 PostgreSQL 环境，方便漏洞验证。

**有效性：**

提供的 POC 代码有效，可以成功利用该漏洞在 PostgreSQL 数据库服务器上执行任意操作系统命令。

**投毒风险：**

Dockerfile 文件用于构建存在漏洞的 PostgreSQL 环境，没有发现任何可疑的恶意代码。README.md 文件提供漏洞利用的步骤，也没有投毒行为。docker-compose.yml 文件用于编排 Docker 容器，也没有发现任何问题。

因此，该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)