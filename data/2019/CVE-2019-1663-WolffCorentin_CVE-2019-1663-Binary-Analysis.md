## CVE-2019-1663 - Cisco RV110W/RV130W/RV215W 路由器管理接口远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 缓冲区溢出导致的远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W

**危害等级:** 高危，允许未授权的远程攻击者以高权限执行任意代码

**影响版本:** RV110W < 1.2.2.1, RV130W < 1.0.3.45, RV215W < 1.3.1.1

**利用条件:** 目标设备开放Web管理界面，攻击者能够访问该界面（可能需要位于同一局域网或Web管理界面暴露在公网）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-1663 漏洞存在于Cisco RV110W, RV130W 和 RV215W系列路由器的Web管理界面中。由于Web管理界面对用户提供的数据验证不当，导致存在缓冲区溢出漏洞。未经身份验证的远程攻击者可以通过发送恶意的HTTP请求到目标设备，利用该漏洞在底层操作系统上以高权限用户身份执行任意代码。

**有效性：**
根据提供的漏洞信息和利用代码，可以判断该漏洞是有效的。漏洞库信息中已经明确指出该漏洞的存在，并给出了受影响的设备和版本。利用代码 `exploit.py` 尝试利用缓冲区溢出漏洞，通过覆盖返回地址执行任意代码。代码中通过`strcpy`函数的栈溢出覆盖返回地址，结合libc的gadget实现利用。

**投毒风险：**
提供的代码片段主要功能是创建payload，用于利用缓冲区溢出漏洞。代码本身没有明显的后门或者恶意行为，例如反弹shell、植入持久化后门等。但是，攻击者可以修改`cmd`变量来执行任意命令，如果攻击者控制了该仓库，有可能修改`cmd`或其他部分的代码，植入恶意代码。因此，存在一定的投毒风险，但从现有信息看，风险较低（10%）。`README.md` 内容分析描述的是漏洞原理和利用步骤，查找gadget的方法，没有发现任何恶意代码。

**利用方式：**
1.  **确定目标：** 找到运行受影响版本Cisco RV110W, RV130W 或 RV215W 路由器的设备。
2.  **访问Web管理界面：** 确保可以访问目标路由器的Web管理界面，通常通过HTTP或HTTPS协议。
3.  **构造恶意请求：** 使用 `exploit.py` 中的代码，构造包含恶意payload的HTTP请求。Payload 包括溢出用户名或密码字段，覆盖返回地址到libc中预先找到的gadget地址，最终调用`system`函数来执行指令。
4.  **发送请求：** 将构造的HTTP请求发送到目标路由器的Web管理界面。
5.  **执行任意代码：** 如果利用成功，路由器将执行Payload中的任意代码，例如，添加一个具有管理权限的用户，或者执行其他恶意操作。

**项目地址:** [WolffCorentin/CVE-2019-1663-Binary-Analysis](https://github.com/WolffCorentin/CVE-2019-1663-Binary-Analysis)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)