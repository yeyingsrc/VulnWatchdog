## CVE-2012-2122-MySQL/MariaDB身份验证绕过

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份验证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未授权访问数据库

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, and 5.6.x before 5.6.6; MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 目标MySQL/MariaDB服务器运行在受影响的版本，并且使用了存在缺陷的memcmp实现

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞源于MySQL/MariaDB在`sql/password.c`中对密码比较的实现。在某些环境下，当`memcmp`函数的实现存在缺陷时，攻击者可以通过重复使用错误的密码进行身份验证，最终导致token比较成功，从而绕过身份验证。

**有效性分析：**
提供的Go代码旨在利用CVE-2012-2122漏洞。它通过循环尝试使用错误的密码（"root:wrong"）连接到目标MySQL服务器。如果漏洞存在且条件满足，多次尝试后应能成功登录。

**投毒风险分析：**
分析提供的Go代码，没有发现明显的恶意代码。代码的功能是尝试利用已知的漏洞，而不是植入后门或其他恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者确定目标MySQL/MariaDB服务器的版本在受影响范围内。
2.  攻击者针对目标服务器，使用错误的密码进行大量的身份验证尝试。
3.  如果服务器环境满足漏洞触发的条件（即`memcmp`函数的实现存在缺陷），经过多次尝试后，身份验证可能会意外成功。
4.  攻击者成功绕过身份验证，获得对数据库的未授权访问。

**搜索引擎结果：**
 由于未提供搜索引擎的结果，本分析主要依据漏洞库信息和提供的利用代码。

**项目地址:** [zhangkaibin0921/CVE-2012-2122](https://github.com/zhangkaibin0921/CVE-2012-2122)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)