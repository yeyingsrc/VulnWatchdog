## CVE-2012-2122-MySQL/MariaDB身份认证绕过漏洞

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份认证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问和数据泄露

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, and 5.6.x before 5.6.6, MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 需要目标服务器存在受影响版本的MySQL/MariaDB，并且服务器运行环境的memcmp实现可能存在问题。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2122 漏洞存在于 MySQL/MariaDB 的 `sql/password.c` 文件中。当服务器运行在特定的环境，并且使用了特定的 `memcmp` 函数实现时，攻击者可以通过重复使用错误的密码进行身份验证，最终绕过身份验证。这是因为代码中对 `memcmp` 的返回值处理不当，即使 `memcmp` 返回非零值，也可能被错误地认为密码匹配。

**有效性评估：**

提供的 Dockerfile 和 docker-compose.yml 文件用于快速搭建包含受影响版本的 MySQL 服务器的环境。README.md 提供了漏洞验证步骤，通过循环执行 `mysql -uroot -pwrong -h your-ip -P3306` 命令，不断尝试使用错误的密码连接数据库，最终可以成功登录。因此，提供的POC代码是有效的，可以用于复现和验证该漏洞。

**投毒风险评估：**

查看Dockerfile, docker-compose.yml, 和 README.md文件。这些文件没有发现任何潜在的恶意代码。Dockerfile 基于 `vulhub/mysql:5.5.23` 镜像，该镜像本身可能存在风险，但是本次只评估当前仓库中的文件。综上，认为当前仓库不存在投毒风险。

**利用方式：**

1.  **环境搭建：** 使用提供的 Dockerfile 和 docker-compose.yml 文件搭建包含受影响版本的 MySQL/MariaDB 服务器的环境。
2.  **身份验证绕过：** 针对目标 MySQL/MariaDB 服务器，使用错误的密码重复进行身份验证。
3.  **重复尝试：** 由于漏洞的特殊性，需要多次尝试才能成功绕过身份验证。
4.  **成功登录：** 在经过一定次数的尝试后，攻击者可以使用错误的密码成功登录数据库。

**项目地址:** [cyberharsh/Oracle-mysql-CVE-2012-2122](https://github.com/cyberharsh/Oracle-mysql-CVE-2012-2122)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)