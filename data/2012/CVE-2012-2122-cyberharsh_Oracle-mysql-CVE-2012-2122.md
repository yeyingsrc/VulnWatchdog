## CVE-2012-2122 - MySQL/MariaDB Authentication Bypass

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份认证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, 5.6.x before 5.6.6; MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 目标系统运行受影响的MySQL/MariaDB版本，且宿主机环境满足特定条件(可能与memcmp实现相关)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2122 漏洞存在于 MySQL/MariaDB 的 `sql/password.c` 文件中。当服务器运行在特定环境，且使用了特定的 `memcmp` 实现时，攻击者可以通过重复使用错误的密码进行身份验证来绕过身份验证。这是因为 `memcmp` 函数的返回值没有被正确检查，导致在多次尝试后，密码比较可能会错误地返回成功。提供的 Dockerfile 和 docker-compose.yml 文件用于搭建存在漏洞的环境，利用代码（README.md中的bash脚本）通过循环尝试使用错误的密码来利用此漏洞。  

**有效性：**  根据漏洞描述和提供的POC代码，可以判断该POC代码是有效的。它提供了一个可复现漏洞的Docker环境，并提供了一个简单的脚本来验证漏洞。

**投毒风险：**  分析提供的 Dockerfile, docker-compose.yml 和 bash 脚本，没有发现任何恶意代码或后门。Dockerfile 只是拉取了一个已知的存在漏洞的MySQL版本镜像。docker-compose.yml 文件定义了如何启动这个镜像，bash 脚本只是尝试使用错误的密码连接到 MySQL 服务器。因此，投毒风险为 0%。

**利用方式：**
1.  搭建漏洞环境：使用 Dockerfile 和 docker-compose.yml 文件搭建一个存在漏洞的 MySQL/MariaDB 环境。
2.  暴力破解：通过循环发送带有错误密码的身份验证请求，直到服务器错误地接受连接。
3.  成功登录：一旦成功绕过身份验证，攻击者就可以获得对数据库的未经授权的访问权限。

**项目地址:** [cyberharsh/Oracle-mysql-CVE-2012-2122](https://github.com/cyberharsh/Oracle-mysql-CVE-2012-2122)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)