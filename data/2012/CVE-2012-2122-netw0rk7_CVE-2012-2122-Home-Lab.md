## CVE-2012-2122 MySQL Authentication Bypass

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份验证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, and 5.6.x before 5.6.6, and MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 需要在特定环境下运行，且memcmp函数存在特定的实现缺陷。需要能够连接到MySQL服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2122 漏洞存在于 MySQL 和 MariaDB 的 sql/password.c 文件中。由于 `memcmp` 函数的实现问题，当重复使用错误的密码进行身份验证时，可能会因为对 `memcmp` 返回值的不正确检查而导致身份验证绕过。提供的 Dockerfile 和 docker-compose.yml 文件可以快速搭建一个存在漏洞的 MySQL 5.5.23 环境进行测试。利用方式是重复使用错误密码尝试登录，直到成功绕过身份验证。

**分析:**

*   **有效性：** POC 代码有效。该 POC 提供了一个可重现漏洞的环境。通过提供的链接 (exploit-db.com/exploits/19092) 可以找到利用该漏洞的脚本或方法。
*   **投毒风险：** 在提供的 Dockerfile、docker-compose.yml 和 entrypoint.sh 文件中，没有发现明显的恶意代码或后门。`entrypoint.sh` 脚本的作用是生成一个 flag 文件，这主要用于测试和演示，而非恶意行为。 因此，投毒风险评估为 0%。
*   **利用方式：** 利用该漏洞的典型方法是重复使用错误的密码尝试连接 MySQL 服务器。由于 `memcmp` 函数的错误处理，经过多次尝试后，身份验证可能会意外成功。成功登录后，攻击者就可以执行任意 SQL 命令，例如读取 flag 文件或者进行其他恶意操作。

**项目地址:** [netw0rk7/CVE-2012-2122-Home-Lab](https://github.com/netw0rk7/CVE-2012-2122-Home-Lab)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)