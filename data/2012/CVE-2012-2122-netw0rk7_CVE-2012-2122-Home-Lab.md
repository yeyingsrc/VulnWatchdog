## CVE-2012-2122-MySQL身份验证绕过

**漏洞编号:** CVE-2012-2122

**漏洞类型:** 身份验证绕过

**影响应用:** MySQL/MariaDB

**危害等级:** 高危，可能导致未经授权的数据库访问

**影响版本:** MySQL 5.1.x before 5.1.63, 5.5.x before 5.5.24, 5.6.x before 5.6.6; MariaDB 5.1.x before 5.1.62, 5.2.x before 5.2.12, 5.3.x before 5.3.6, and 5.5.x before 5.5.23

**利用条件:** 在某些环境下运行，memcmp函数的实现存在问题。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2122 漏洞存在于 MySQL 和 MariaDB 的 sql/password.c 文件中。当在特定环境中使用特定的 memcmp 函数实现时，远程攻击者可以通过重复使用相同的错误密码进行身份验证来绕过身份验证。这是因为当 memcmp 的返回值未得到正确检查时，可能会导致令牌比较成功。

提供的 Dockerfile 和相关文件构成了一个漏洞复现环境。Dockerfile 基于 vulhub/mysql:5.5.23 镜像，创建了一个易受攻击的 MySQL 实例。entrypoint.sh 脚本用于生成一个 flag 文件，该文件可用于验证漏洞是否已成功利用。docker-compose.yml 用于方便地构建和启动容器。

漏洞利用方式是多次使用错误的密码进行身份验证。如果漏洞存在，MySQL 最终可能会允许未经授权的访问。

代码中没有明显的投毒行为。`entrypoint.sh`脚本的功能是生成flag，而不是恶意行为。Dockerfile基于官方镜像，降低了投毒的风险。docker-compose文件也是常规配置.

**项目地址:** [netw0rk7/CVE-2012-2122-Home-Lab](https://github.com/netw0rk7/CVE-2012-2122-Home-Lab)

**漏洞详情:** [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122)