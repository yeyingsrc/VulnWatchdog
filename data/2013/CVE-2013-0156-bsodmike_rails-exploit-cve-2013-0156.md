## CVE-2013-0156 - Ruby on Rails 对象注入/远程代码执行

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/远程代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序必须解析用户提供的YAML或Symbol类型数据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156 漏洞存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中，由于不正确地限制了字符串值的转换，导致远程攻击者可以通过利用 Action Pack 对 YAML 或 Symbol 类型转换的支持，进行对象注入攻击并执行任意代码，或导致拒绝服务（内存和 CPU 消耗）。

**有效性：**
根据提供的漏洞信息和POC代码描述，此POC旨在利用 CVE-2013-0156 和 CVE-2013-0155 漏洞。 `README.rdoc` 文件指示这是一个 Rails 3.2.10 应用程序，并且包含远程代码执行漏洞利用。 提供的`Gemfile` 和 `Gemfile.lock` 文件也佐证了这一点，确认使用了存在漏洞的 Rails 版本。

**投毒风险：**
分析提供的代码，主要包括 Gemfile、Gemfile.lock 和 README.rdoc。Gemfile 定义了项目依赖，Gemfile.lock 锁定了依赖版本，README.rdoc 提供了项目说明和运行方式。并没有发现明显的恶意代码或后门。风险主要在于利用漏洞本身执行恶意操作，而不是代码库被植入恶意代码。虽然代码本身未发现明显的投毒行为，但仍然存在一定的风险，例如作者在代码中插入隐蔽的后门，或者在后续版本中引入恶意代码。因此将投毒风险评估为 10%。

**利用方式：**
利用方式是向 Rails 应用程序发送特制的请求，其中包含恶意的 YAML 或 Symbol 数据。Rails 在解析这些数据时，由于存在对象注入漏洞，攻击者可以控制对象的创建和属性赋值，从而执行任意 Ruby 代码。例如，攻击者可以创建一个 `system` 对象的实例，并将其参数设置为要执行的恶意命令。

简而言之，攻击者构造包含恶意 payload 的请求，服务端解析 payload 时触发对象注入，从而执行任意代码。

**项目地址:** [bsodmike/rails-exploit-cve-2013-0156](https://github.com/bsodmike/rails-exploit-cve-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)