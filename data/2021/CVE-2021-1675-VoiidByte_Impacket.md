## CVE-2021-1675 - PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要网络访问，且目标系统开启Print Spooler服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-1675（PrintNightmare）是一个Windows Print Spooler服务的远程代码执行漏洞。攻击者可以通过精心构造的打印任务，欺骗系统加载并执行恶意DLL文件，从而获得系统权限。漏洞利用通常涉及以下步骤：

1.  **利用方式：** 攻击者首先需要通过网络访问目标系统的Print Spooler服务。这通常意味着目标系统的445端口和139端口是开放的。
2.  攻击者需要向Print Spooler服务发送一个特制的打印请求，该请求会指示Print Spooler服务加载一个由攻击者控制的DLL文件。
3.  当Print Spooler服务尝试加载该DLL文件时，恶意代码会被执行，从而允许攻击者在目标系统上执行任意代码。

**有效性：** 该漏洞在公开后，有大量的PoC代码被公开，说明漏洞是切实存在的且容易被利用。漏洞库信息和CISA KEV目录也确认了其真实性和被利用的事实。

**投毒风险：** 提供的代码是一个Swift的podspec文件，用于描述一个名为GiFHUD-Swift的iOS库，该库用于在应用中显示GIF动画的HUD。这个文件本身不包含任何可执行的代码，因此直接投毒的可能性很低。 风险主要在于：

*   **仓库被劫持：** 如果该GitHub仓库被恶意用户劫持，攻击者可能会修改podspec文件指向包含恶意代码的仓库。由于podspec文件本身不包含代码，即使被修改指向恶意仓库也需要开发者引入使用了GiFHUD-Swift的app。
*   **依赖库投毒：** 该库依赖Swift环境，如果Swift环境存在漏洞，可能被利用。但是此风险与此漏洞无关。

因此，综合分析，该podspec文件本身的投毒风险极低，只有1%的可能性。

**项目地址:** [VoiidByte/Impacket](https://github.com/VoiidByte/Impacket)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)