## CVE-2021-40438-Apache HTTP Server-SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** SSRF

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内网信息泄露和任意请求伪造

**影响版本:** <= 2.4.48

**利用条件:** mod_proxy模块启用，且存在不安全的配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-40438是一个存在于Apache HTTP Server 2.4.48及更早版本中的服务器端请求伪造(SSRF)漏洞。攻击者可以通过精心构造的URI路径，使mod_proxy模块将请求转发到由远程用户选择的源服务器，从而实现SSRF攻击。

**有效性：** 根据提供的漏洞库信息和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出，攻击者可以控制请求转发的目标服务器。提供的Dockerfile和README.md描述了如何使用Docker搭建一个存在漏洞的环境，并使用curl命令发送包含恶意URI的请求，从而触发SSRF。

**投毒风险：** 提供的POC代码主要包含Dockerfile和README.md，以及一个配置文件`exploit.conf.txt`（未提供内容）。Dockerfile用于构建一个包含漏洞的Apache HTTP Server镜像，README.md提供漏洞利用的说明。目前无法得知`exploit.conf.txt`的具体内容，因此不能排除其中包含恶意配置的可能，但是从提供的代码来看投毒的可能性相对较低。考虑到未提供的配置文件的存在，投毒风险评估为10%。

**利用方式：** 该漏洞的利用方式如下：

1.  攻击者构建一个包含恶意URI的HTTP请求。该URI的目标服务器由攻击者控制。例如，`http://localhost:4444/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...`
2.  攻击者将该请求发送到存在漏洞的Apache HTTP Server。
3.  Apache HTTP Server的mod_proxy模块解析该URI，由于漏洞的存在，它会将请求转发到攻击者指定的服务器。
4.  攻击者可以利用该SSRF漏洞访问内部网络资源，或者发起其他恶意请求。

提供的POC中使用`unix:` 协议，目的是访问Unix域套接字。这表明该漏洞可能被用于攻击本地服务，例如Docker守护程序或其他监听Unix套接字的服务。

**项目地址:** [sixpacksecurity/CVE-2021-40438](https://github.com/sixpacksecurity/CVE-2021-40438)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)