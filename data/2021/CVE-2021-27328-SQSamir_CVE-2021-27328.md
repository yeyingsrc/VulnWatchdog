## CVE-2021-27328-Yeastar NeoGate TG400-目录遍历

**漏洞编号:** CVE-2021-27328

**漏洞类型:** 目录遍历

**影响应用:** Yeastar NeoGate TG400

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 91.3.0.3

**利用条件:** 需要已认证用户权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27328 存在于 Yeastar NeoGate TG400 91.3.0.3 设备中，是一个目录遍历漏洞。经过身份验证的用户可以通过构造特定的 URL，利用 `WebCGI` 接口的 `1404` 参数进行目录遍历，读取服务器上的任意文件。例如，可以通过 `http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../bin/firmware_detect` 获取固件解密密码，或者通过 `http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../etc/passwd` 获取 `/etc/passwd` 文件。根据漏洞信息和提供的POC，该漏洞利用的有效性较高。投毒风险较低，因为提供的代码仅为POC，用于演示漏洞利用方式，没有发现明显的后门代码或恶意行为。但是不排除作者故意添加一些混淆代码，加大分析难度。

**利用方式：**
1.  用户首先需要通过某种方式获得对 Yeastar NeoGate TG400 设备的认证权限。
2.  构造包含目录遍历 payload 的 URL，该 URL 访问 `WebCGI` 接口，并使用 `1404` 参数指定要读取的文件路径。例如，使用 `../../` 序列来跳出当前目录，访问系统中的其他文件。
3.  发送构造好的 URL 到目标设备。
4.  如果漏洞存在且利用成功，目标设备会将指定文件的内容返回给攻击者。攻击者可以利用此漏洞读取敏感文件，例如配置文件、密码文件等，从而获取设备的控制权。

**项目地址:** [SQSamir/CVE-2021-27328](https://github.com/SQSamir/CVE-2021-27328)

**漏洞详情:** [CVE-2021-27328](https://nvd.nist.gov/vuln/detail/CVE-2021-27328)