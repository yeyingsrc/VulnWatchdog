## CVE-2021-1675 Windows Print Spooler Remote Code Execution Vulnerability (PrintNightmare)

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，导致系统完全控制

**影响版本:** 受影响的Windows版本包括Windows 7到Windows 10的多个版本，以及Windows Server 2008到2019的多个版本。

**利用条件:** 攻击者需要能够访问Print Spooler服务，通常是通过网络共享打印机或通过RDP等方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过向Print Spooler服务发送特制的打印任务，从而在系统上执行任意代码。

**有效性：**
漏洞库信息和公开资料表明此漏洞存在公开的POC代码。由于没有直接的POC代码，无法验证有效性。但是，考虑到CISA已将其添加到已知被利用漏洞目录(KEV)，可以认为该漏洞存在可利用的POC，并且在野利用已经发生。

**投毒风险：**
提供的代码片段是django-registration-templates，这与PrintNightmare漏洞无关。django-registration-templates是一个Django项目的模板集合，用于用户注册和身份验证。  因此，从提供的代码判断，投毒风险较低。虽然从技术上讲，任何开源代码库都可能包含恶意代码，但这个特定的库旨在提供现成的身份验证模板，风险主要在于安全性较差的模板可能被用于存在其他安全漏洞的应用程序中。
根据现有代码，判断投毒风险为10%，主要来源于依赖库的潜在风险，以及代码维护者被渗透的风险。

**利用方式：**
PrintNightmare漏洞的利用方式是利用Print Spooler服务中的不安全操作，允许未经授权的用户安装驱动程序。攻击者可以上传包含恶意代码的特制驱动程序，Print Spooler服务会以SYSTEM权限加载并执行该驱动程序，从而实现远程代码执行。

1.  **攻击者连接到目标系统的Print Spooler服务。**
2.  **攻击者利用`RpcAddPrinterDriverEx`函数安装恶意的打印机驱动程序。**
3.  **Print Spooler服务尝试加载该恶意驱动程序。**
4.  **由于权限不足或其他原因导致加载失败，但驱动程序文件已经被复制到系统目录中。**
5.  **攻击者可以触发驱动程序的加载，执行其中的恶意代码。**

**项目地址:** [GlacierGossip/PrintNightmare](https://github.com/GlacierGossip/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)