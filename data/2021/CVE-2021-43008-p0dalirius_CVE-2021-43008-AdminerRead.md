## CVE-2021-43008-Adminer-任意文件读取

**漏洞编号:** CVE-2021-43008

**漏洞类型:** 任意文件读取

**影响应用:** Adminer

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.12.0 to 4.6.2

**利用条件:** 需要Adminer服务可访问，并且能够连接到攻击者控制的MySQL数据库服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43008 存在于Adminer 1.12.0 到 4.6.2 版本中，允许攻击者通过让 Adminer 连接到恶意的 MySQL 数据库服务器来实现任意文件读取。攻击者可以配置恶意的 MySQL 服务器，当 Adminer 尝试连接时，利用 LOAD DATA LOCAL INFILE 语句读取服务器上的任意文件。

**漏洞利用有效性：**
根据提供的漏洞信息和漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出该漏洞允许任意文件读取，而提供的 Python 脚本 (AdminerRead.py) 旨在利用此漏洞。

**投毒风险：**
分析提供的 Python 脚本 (AdminerRead.py) 后，没有发现明显的投毒代码。脚本的功能主要是自动化连接到 Adminer 实例，模拟用户登录，然后执行 SQL 查询。虽然脚本可以被用于恶意目的，但其本身并没有包含任何故意隐藏的恶意功能。因此，投毒风险较低。

**漏洞利用方式：**
1.  攻击者需要找到一个运行着存在漏洞版本的Adminer实例。
2.  攻击者搭建一个恶意的 MySQL 服务器。
3.  攻击者使用 Adminer 提供的连接功能，指定连接到攻击者搭建的恶意 MySQL 服务器。
4.  当 Adminer 尝试连接到恶意 MySQL 服务器时，该服务器返回包含 `LOAD DATA LOCAL INFILE` 命令的响应。
5.  Adminer 执行该命令，读取攻击者指定的文件，并将文件内容返回给攻击者。
6.  攻击者从 Adminer 的响应中获取读取的文件内容。

AdminerRead.py 脚本可以通过控制服务器、用户名、密码和数据库信息来达到攻击效果。脚本首先尝试连接到 Adminer，然后使用SQL注入(或其他方式,取决于Adminer的具体配置)读取服务器文件。

**项目地址:** [p0dalirius/CVE-2021-43008-AdminerRead](https://github.com/p0dalirius/CVE-2021-43008-AdminerRead)

**漏洞详情:** [CVE-2021-43008](https://nvd.nist.gov/vuln/detail/CVE-2021-43008)