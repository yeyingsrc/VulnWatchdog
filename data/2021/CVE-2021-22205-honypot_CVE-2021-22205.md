## CVE-2021-22205-GitLab-RCE

**漏洞编号:** CVE-2021-22205

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** GitLab

**危害等级:** 高危，可导致完全控制受影响的GitLab实例

**影响版本:** >=11.9, <13.8.8; >=13.9, <13.9.6; >=13.10, <13.10.3

**利用条件:** 未经身份验证的网络访问，以及目标GitLab实例存在漏洞。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-22205是GitLab CE/EE中的一个远程代码执行漏洞。由于GitLab没有正确验证传递给文件解析器的图像文件，导致了命令注入。攻击者可以上传特制的图像文件，利用ExifTool的漏洞执行任意代码。

**有效性：**
提供的POC代码利用Docker Compose部署了一个包含漏洞的GitLab EE 13.9.5实例，表明该POC是有效的，可以复现该漏洞。

**投毒风险：**
尽管大部分代码看起来是为了复现漏洞，但仍然存在一些潜在的投毒风险。
*   `gitlab/entry.sh`脚本添加了一个名为`eth1`的虚拟网络接口，并分配了一个公网IP地址。这本身并没有恶意，但如果攻击者控制了GitLab实例，则可能利用此接口进行隐蔽通信或数据泄露。可能性为10%。
* `gitlab/dummy/backup.txt`包含了一个默认的用户名密码,如果被利用,存在安全风险。可能性为10%.

总体的投毒风险评估为20%。

**利用方式：**
1.  攻击者需要构建一个恶意图像文件，其中包含嵌入的ExifTool命令注入Payload。
2.  攻击者将恶意图像上传到易受攻击的GitLab实例（例如，通过头像上传、项目附件等）。
3.  GitLab尝试处理图像，调用ExifTool。
4.  ExifTool执行注入的命令，从而导致远程代码执行。

**项目地址:** [honypot/CVE-2021-22205](https://github.com/honypot/CVE-2021-22205)

**漏洞详情:** [CVE-2021-22205](https://nvd.nist.gov/vuln/detail/CVE-2021-22205)