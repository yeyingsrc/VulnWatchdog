## CVE-2021-40438 - Apache HTTP Server mod_proxy SSRF

**漏洞编号:** CVE-2021-40438

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致内部服务信息泄露、内网扫描甚至远程代码执行 (取决于内部服务的配置)

**影响版本:** <= 2.4.48

**利用条件:** 目标服务器启用 `mod_proxy` 模块，且配置不当。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-40438 是一个 Apache HTTP Server 2.4.48 及之前版本中 `mod_proxy` 模块的服务器端请求伪造 (SSRF) 漏洞。精心构造的 URI 路径可能导致 `mod_proxy` 将请求转发到由远程用户选择的源服务器。此漏洞允许攻击者强制服务器代表他们向任意内部或外部主机发出请求。  

**漏洞利用方式:**  

提供的 exploit.py 脚本通过构造包含 `unix:{'A'*7000}|{ssrf}` 的恶意 URI 路径来利用该漏洞。  `{'A'*7000}` 可能是为了绕过某些长度检查或缓冲区限制。`{ssrf}` 部分是攻击者想要请求的内部服务的 URL。当 Apache HTTP Server 收到包含此恶意路径的请求时，如果 `mod_proxy` 配置不当，它会将请求转发到攻击者指定的 URL (`ssrf`)，从而导致 SSRF。

**有效性评估:**  

根据漏洞描述和提供的PoC代码，利用的有效性较高，因为CVE已经被CISA收录在Known Exploited Vulnerabilities catalog中。如果目标服务器运行的是受影响的 Apache HTTP Server 版本，并且 `mod_proxy` 模块已启用但配置不当，则此 PoC 可能会成功利用该漏洞。

**投毒风险评估:**  

阅读了提供的exploit.py和README.md文件后,PoC代码本身看起来是直接的 SSRF 漏洞利用，没有发现明显的恶意代码或后门。 该脚本构造一个 HTTP 请求，该请求尝试利用 `mod_proxy` 中的 SSRF 漏洞。没有明显的尝试来安装后门、泄露凭据或执行任何其他恶意活动。

投毒风险评估：0%。

**项目地址:** [n0m-d/CVE-2021-40438-POC](https://github.com/n0m-d/CVE-2021-40438-POC)

**漏洞详情:** [CVE-2021-40438](https://nvd.nist.gov/vuln/detail/CVE-2021-40438)