## CVE-2021-43267-Linux Kernel TIPC MSG_CRYPTO Stack Overflow

**漏洞编号:** CVE-2021-43267

**漏洞类型:** 栈溢出

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致系统崩溃或远程代码执行

**影响版本:** < 5.14.16

**利用条件:** 需要启用TIPC模块，并能够发送MSG_CRYPTO类型的消息

**POC 可用性:** 是，但提供的POC需要进一步分析

**投毒风险:** 10%

## 详情

CVE-2021-43267 是 Linux Kernel 中 TIPC (Transparent Inter-Process Communication) 模块 net/tipc/crypto.c 存在的一个栈溢出漏洞。该漏洞是由于对用户提供的 MSG_CRYPTO 消息类型的大小验证不足导致的。攻击者可以通过发送特制的 MSG_CRYPTO 消息，覆盖栈上的数据，从而可能导致系统崩溃或远程代码执行。

**有效性评估：**
漏洞库信息表明该漏洞存在于 Linux Kernel 5.14.16 之前的版本。提供的 POC 代码的 README.md 文件说明是 “trusty poc Provide it to legitimate people”，这表明代码作者希望提供一个可信的 POC 用于合法目的，但实际的利用代码缺失，因此需要获取并分析相关利用代码后才能判断有效性。

**投毒风险：**
虽然 README 文件声称是为合法用户提供，但仍然存在一定的投毒风险。目前提供的文件只包含 README，无法进行代码分析。根据目前的信息，假设存在投毒代码的可能性较低，估计投毒风险为10%。如果实际的漏洞利用代码内容复杂，包含不明显的恶意行为，投毒风险会显著增加。

**利用方式：**
利用方式通常涉及以下步骤：
1.  **环境准备：** 目标系统必须运行存在漏洞的 Linux Kernel 版本，并且启用 TIPC 模块。
2.  **构造恶意消息：** 攻击者需要构造一个 MSG_CRYPTO 类型的消息，其中包含精心设计的、过大的大小参数。
3.  **发送消息：** 将构造好的消息发送给目标系统。内核在处理该消息时，由于大小验证不足，导致栈溢出。
4.  **控制程序流程：** 通过栈溢出，攻击者可以覆盖返回地址或其他关键数据，从而控制程序的执行流程，最终实现任意代码执行。

**项目地址:** [DarkSprings/CVE-2021-43267-POC](https://github.com/DarkSprings/CVE-2021-43267-POC)

**漏洞详情:** [CVE-2021-43267](https://nvd.nist.gov/vuln/detail/CVE-2021-43267)