## CVE-2021-22205-GitLab-远程命令执行

**漏洞编号:** CVE-2021-22205

**漏洞类型:** 远程命令执行

**影响应用:** GitLab

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** >=11.9, <13.8.8；>=13.9, <13.9.6；>=13.10, <13.10.3

**利用条件:** 需要网络访问，受影响的GitLab实例未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22205是GitLab CE/EE中的一个远程命令执行漏洞。攻击者可以通过上传恶意构造的图像文件，利用GitLab使用的ExifTool工具中的漏洞执行任意命令。

**有效性分析：**
根据漏洞库信息，该漏洞影响GitLab 11.9到13.10.3之间的多个版本，且危害等级为CRITICAL。提供的POC代码`/tmp/2f45104b4dac4f2167b8fc87a9a77f9a/README.md` 仅仅是一个说明文件，本身不具备漏洞利用能力，只是说明了cve编号，并没有给出任何利用payload，需要配合搜索引擎查找真正的利用代码。

**投毒风险分析：**
提供的POC代码文件内容极其简单，只有CVE编号的描述，不包含任何可执行代码，因此投毒风险极低。可以认为投毒风险为0%。

**利用方式：**
1.  攻击者构造一个包含恶意 ExifTool 元数据的图像文件。
2.  攻击者将该图像文件上传到存在漏洞的 GitLab 实例上，例如通过头像上传、项目图片上传等功能。
3.  GitLab 使用 ExifTool 解析该图像文件时，恶意元数据中的命令会被执行，导致远程命令执行。

攻击者可以在图像文件中嵌入payload，通常是构造一个畸形的图片文件，利用ExifTool处理图片文件时执行恶意命令。

**优先级：**
根据排序优先级，搜索引擎结果（当前为空）> 漏洞利用代码（简单的README）> 漏洞库信息。


**项目地址:** [Hikikan/CVE-2021-22205](https://github.com/Hikikan/CVE-2021-22205)

**漏洞详情:** [CVE-2021-22205](https://nvd.nist.gov/vuln/detail/CVE-2021-22205)