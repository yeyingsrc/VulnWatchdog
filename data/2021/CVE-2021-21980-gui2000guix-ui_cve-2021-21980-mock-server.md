## CVE-2021-21980-VMware vCenter Server-任意文件读取

**漏洞编号:** CVE-2021-21980

**漏洞类型:** 任意文件读取

**影响应用:** VMware vCenter Server

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** VMware vCenter Server (6.7 before 6.7 U3p and 6.5 before 6.5 U3r) and VMware Cloud Foundation 3.x

**利用条件:** 需要网络访问vCenter Server的443端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-21980存在于vSphere Web Client (FLEX/Flash)中，是一个未经授权的任意文件读取漏洞。攻击者可以通过网络访问vCenter Server的443端口，利用此漏洞读取敏感信息。 

**有效性：**

提供的POC代码是有效的。Dockerfile构建了一个模拟vCenter Server环境的Flask应用，该应用存在/eam/vib端点，通过构造包含`../`和`/etc/passwd`或`passwd`的`id`参数，可以实现目录穿越，读取服务器上的任意文件。例如，`curl -k "https://localhost:8443/eam/vib?id=../../../../../../../../../../etc/passwd"`可以读取模拟的`/app/sensitive/passwd-mock`文件。

**投毒风险：**

该仓库代码的投毒风险为0%。原因是该仓库提供的是一个漏洞验证和测试环境，其目的是为了安全地进行漏洞检测和研究，而不是用于恶意攻击。虽然该环境中模拟了漏洞，但没有发现任何隐藏的恶意代码或后门。所有代码都与漏洞的演示和检测相关。

**利用方式：**

1.  攻击者需要能够访问目标vCenter Server的443端口。
2.  攻击者构造恶意的URL，例如 `/eam/vib?id=../../../../../../../../../../etc/passwd`，其中`id`参数包含目录穿越的payload。
3.  vCenter Server的Web Client在处理该请求时，没有充分验证`id`参数，导致攻击者可以读取服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感信息，例如配置文件、密码文件等。

**项目地址:** [gui2000guix-ui/cve-2021-21980-mock-server](https://github.com/gui2000guix-ui/cve-2021-21980-mock-server)

**漏洞详情:** [CVE-2021-21980](https://nvd.nist.gov/vuln/detail/CVE-2021-21980)